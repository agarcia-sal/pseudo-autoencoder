CLASS Solution
    FUNCTION numFactoredBinaryTrees(arr)
        DEFINE MOD as 1000000007
        ASSIGN arr TO sorted(arr)
        DECLARE dp AS array of pairs (key,value) with length = length(arr)
        DECLARE index_map AS array of size length(arr)
        FOR idx FROM 0 TO length(arr)-1
            dp[idx] = (arr[idx], 1)
            index_map[idx] = arr[idx]
        END FOR
        FUNCTION find_key(k, left, right)
            IF left > right THEN RETURN -1 END IF
            SET middle = (left + right) / 2
            IF index_map[middle] == k THEN RETURN middle END IF
            IF index_map[middle] > k THEN RETURN find_key(k, left, middle-1) ELSE RETURN find_key(k, middle+1, right) END IF
        END FUNCTION
        PROCEDURE process(i, j)
            IF j < 0 THEN RETURN END IF
            SET num = dp[i].0
            SET potential_factor = dp[j].0
            SET remainder_check = num % potential_factor
            IF remainder_check == 0 THEN
                SET right = num / potential_factor
                SET right_index = find_key(right, 0, length(arr)-1)
                IF right_index != -1 THEN
                    SET val = dp[i].1 + dp[j].1 * dp[right_index].1
                    SET dp[i].1 = val % MOD
                END IF
            END IF
            CALL process(i, j-1)
        END PROCEDURE
        FUNCTION outer_loop(i)
            IF i >= length(arr) THEN RETURN END IF
            CALL process(i, i-1)
            CALL outer_loop(i+1)
        END FUNCTION
        CALL outer_loop(0)
        SET total_sum = 0
        SET idx = 0
        WHILE idx < length(dp)
            SET total_sum = total_sum + dp[idx].1
            SET idx = idx + 1
        END WHILE
        RETURN total_sum % MOD
    END FUNCTION
END CLASS