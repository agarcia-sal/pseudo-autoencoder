CLASS Solution  
    FUNCTION minimumIncompatibility(nums k)  
        SET n TO the LENGTH OF nums  
        SET subset_size TO n DIVIDED BY k  
        CREATE counter_object AS a COUNT of each element IN nums  
        IF any count IN the VALUES OF counter_object is GREATER THAN k THEN  
            RETURN negative one  
        END IF  
        CREATE empty dictionary subset_incompatibility  
        FOR mask FROM zero TO TWO RAISED TO THE POWER OF n MINUS one  
            SET bit_count TO the NUMBER OF ONES IN the BINARY REPRESENTATION OF mask  
            IF bit_count EQUALS subset_size THEN  
                CREATE empty list elements  
                FOR i FROM zero TO n MINUS one  
                    IF the BITWISE AND OF mask AND TWO RAISED TO THE POWER OF i is NOT EQUAL TO zero THEN  
                        APPEND element at position i OF nums TO elements  
                    END IF  
                END FOR  
                IF the NUMBER OF UNIQUE ELEMENTS IN elements EQUALS subset_size THEN  
                    SET incompatibility TO the MAXIMUM ELEMENT IN elements MINUS the MINIMUM ELEMENT IN elements  
                    ASSIGN incompatibility TO subset_incompatibility AT key mask  
                END IF  
            END IF  
        END FOR  
        CREATE list dp WITH LENGTH TWO RAISED TO THE POWER OF n FILLED WITH infinity  
        SET dp AT position zero TO zero  
        FOR mask FROM zero TO TWO RAISED TO THE POWER OF n MINUS one  
            IF the REMAINDER OF the NUMBER OF ONES IN the BINARY REPRESENTATION OF mask DIVIDED BY subset_size IS NOT EQUAL TO zero THEN  
                CONTINUE TO the NEXT iteration  
            END IF  
            FOR each subset_mask IN the KEYS OF subset_incompatibility  
                IF the BITWISE AND OF mask AND subset_mask EQUALS subset_mask THEN  
                    SET candidate_value TO dp AT position mask MINUS subset_mask PLUS subset_incompatibility AT subset_mask  
                    IF candidate_value IS LESS THAN dp AT position mask THEN  
                        SET dp AT position mask TO candidate_value  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        SET full_mask TO TWO RAISED TO THE POWER OF n MINUS one  
        IF dp AT position full_mask IS NOT EQUAL TO infinity THEN  
            RETURN dp AT position full_mask  
        ELSE  
            RETURN negative one  
        END IF  
    END FUNCTION  
END CLASS