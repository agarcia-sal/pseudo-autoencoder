CLASS Solution  
    FUNCTION medianSlidingWindow(nums WITH TYPE List OF integer, k WITH TYPE integer) RETURNS List OF float  
        SET lo TO empty collection  
        SET hi TO empty collection  

        FUNCTION balance_heaps  
            IF the LENGTH OF lo IS GREATER THAN the LENGTH OF hi PLUS one  
                CALL heappush ON hi WITH the NEGATIVE of heappop FROM lo  
            ELSE IF the LENGTH OF hi IS GREATER THAN the LENGTH OF lo  
                CALL heappush ON lo WITH the NEGATIVE of heappop FROM hi  
            END ELSE IF  
        END FUNCTION  

        FUNCTION add_num(num)  
            IF lo IS empty OR num IS LESS THAN OR EQUAL TO the NEGATIVE of the element at position zero of lo  
                CALL heappush ON lo WITH the NEGATIVE of num  
            ELSE  
                CALL heappush ON hi WITH num  
            END IF  
            CALL balance_heaps  
        END FUNCTION  

        FUNCTION remove_num(num)  
            IF num IS LESS THAN OR EQUAL TO the NEGATIVE of the element at position zero of lo  
                REMOVE the NEGATIVE of num FROM lo  
                IF lo IS NOT empty  
                    CALL heapify ON lo  
                END IF  
            ELSE  
                REMOVE num FROM hi  
                IF hi IS NOT empty  
                    CALL heapify ON hi  
                END IF  
            END IF  
            CALL balance_heaps  
        END FUNCTION  

        FUNCTION get_median  
            IF the LENGTH OF lo IS GREATER THAN the LENGTH OF hi  
                RETURN the NEGATIVE of the element at position zero of lo  
            END IF  
            RETURN the SUM of the NEGATIVE of the element at position zero of lo AND the element at position zero of hi DIVIDED BY two  
        END FUNCTION  

        FOR index FROM zero TO k MINUS one  
            CALL add_num WITH the element at position index of nums  
        END FOR  

        SET medians TO collection CONTAINING the RESULT of get_median  

        FOR index FROM k TO the LENGTH OF nums MINUS one  
            CALL add_num WITH the element at position index of nums  
            CALL remove_num WITH the element at position index MINUS k of nums  
            APPEND the RESULT of get_median TO medians  
        END FOR  

        RETURN medians  
    END FUNCTION  
END CLASS