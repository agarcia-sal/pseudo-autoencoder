CLASS Solution
    FUNCTION areSentencesSimilarTwo(sentence1 sentence1 TO sentence1 OF TYPE list OF strings sentence2 sentence2 TO sentence2 OF TYPE list OF strings similarPairs similarPairs TO similarPairs OF TYPE list OF list OF strings) RETURNS boolean
        IF (sentence1 LENGTH MINUS sentence2 LENGTH) MULTIPLIED BY (sentence2 LENGTH MINUS sentence1 LENGTH) GREATER THAN 0
            RETURN false
        END IF

        INITIALIZE parent TO map WITHOUT ENTRIES

        FUNCTION find(x x TO x) RETURNS x
            VARIABLE currentNode ASSIGNED TO x
            WHILE parent[currentNode] IS NOT EXACTLY currentNode
                SET parent[currentNode] TO parent[parent[currentNode]]
                SET currentNode TO parent[currentNode]
            END WHILE
            RETURN currentNode
        END FUNCTION

        FUNCTION union(x x TO x y y TO y)
            VARIABLE rootA INITIALIZED TO find(x)
            VARIABLE rootB INITIALIZED TO find(y)
            IF rootA IS NOT rootB
                ASSIGN parent[rootB] TO rootA
            END IF
        END FUNCTION

        FOR pairIndex FROM 0 TO (similarPairs LENGTH MINUS 1)
            VARIABLE currPair ASSIGNED TO similarPairs[pairIndex]
            FOR elementPosition FROM 0 TO 1
                VARIABLE candidate ASSIGNED TO currPair[elementPosition]
                IF candidate NOT MEMBER OF parent
                    ASSIGN parent[candidate] TO candidate
                END IF
            END FOR
        END FOR

        FOR pairElement IN similarPairs
            union(pairElement[0] pairElement[1])
        END FOR

        VARIABLE idx ASSIGNED TO 0
        WHILE idx LESS THAN sentence1 LENGTH
            VARIABLE firstWord ASSIGNED TO sentence1[idx]
            VARIABLE secondWord ASSIGNED TO sentence2[idx]

            IF firstWord NOT MEMBER OF parent
                ASSIGN parent[firstWord] TO firstWord
            END IF
            IF secondWord NOT MEMBER OF parent
                ASSIGN parent[secondWord] TO secondWord
            END IF

            IF find(firstWord) IS NOT EQUAL TO find(secondWord)
                RETURN false
            END IF
            INCREMENT idx BY 1
        END WHILE

        RETURN true
    END FUNCTION
END CLASS