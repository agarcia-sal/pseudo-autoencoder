CLASS Solution  
    FUNCTION parseBoolExpr(expression)  
        SET stack TO empty list  
        FOR each character IN expression  
            IF character EQUALS one of the elements in the collection consisting of true literal token false literal token logical negation symbol logical conjunction symbol logical disjunction symbol  
                APPEND character TO stack  
            ELSE IF character EQUALS closing parenthesis symbol  
                SET count_true TO zero  
                SET count_false TO zero  
                WHILE the last element of stack EQUALS one of the elements in the collection consisting of true literal token false literal token  
                    INCREMENT count_true BY one IF the last element of stack EQUALS true literal token  
                    INCREMENT count_false BY one IF the last element of stack EQUALS false literal token  
                    REMOVE the last element FROM stack  
                END WHILE  
                SET operator TO the last element removed FROM stack  
                IF operator EQUALS logical negation symbol  
                    SET character TO true literal token IF count_false IS GREATER THAN zero EQUALS false ELSE false literal token  
                ELSE IF operator EQUALS logical conjunction symbol  
                    SET character TO false literal token IF count_false IS GREATER THAN zero ELSE true literal token  
                ELSE IF operator EQUALS logical disjunction symbol  
                    SET character TO true literal token IF count_true IS GREATER THAN zero ELSE false literal token  
                END IF  
                APPEND character TO stack  
            END IF  
        END FOR  
        RETURN the first element of stack EQUALS true literal token  
    END FUNCTION  
END CLASS