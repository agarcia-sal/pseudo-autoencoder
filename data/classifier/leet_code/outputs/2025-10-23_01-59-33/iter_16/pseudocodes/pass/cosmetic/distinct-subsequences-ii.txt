CLASS Solution  
    FUNCTION distinctSubseqII(s)  
        SET modValue AS 1_000_000_007  
        SET lengthOfString AS LENGTH OF s  
        SET dpArray AS A LIST CONTAINING ZEROS OF SIZE lengthOfString PLUS 1  
        SET dpArray AT 0 AS 1  
        SET seenPositions AS AN EMPTY MAP  
        
        SET indexCounter TO 1  
        WHILE indexCounter IS LESS THAN OR EQUAL TO lengthOfString  
            SET currentCharacter TO s AT POSITION (indexCounter MINUS 1)  
            
            SET doubledPrevious TO dpArray AT (indexCounter MINUS 1) PLUS dpArray AT (indexCounter MINUS 1)  
            SET dpArray AT indexCounter AS doubledPrevious MODULO modValue  
            
            IF NOT (currentCharacter NOT IN seenPositions) THEN  
                SET pastIndex TO seenPositions AT currentCharacter  
                SET subtractedValue TO dpArray AT (pastIndex MINUS 1)  
                SET updatedValue TO dpArray AT indexCounter MINUS subtractedValue PLUS modValue  
                SET dpArray AT indexCounter AS updatedValue MODULO modValue  
            END IF  
            
            SET seenPositions AT currentCharacter AS indexCounter  
            INCREMENT indexCounter BY 1  
        END WHILE  
        
        SET finalResult AS dpArray AT lengthOfString MINUS 1  
        RETURN finalResult MODULO modValue  
    END FUNCTION  
END CLASS