CLASS Solution
    FUNCTION numberOfArrays(s PARAMETER string, k PARAMETER integer) RETURNS integer
        SET MOD TO 1000000000 PLUS 7
        SET length_s TO LENGTH OF s
        INITIALIZE dp AS an array containing (length_s PLUS 1) zeros
        SET dp[0] AS 1

        SET outer_index TO 1
        WHILE outer_index LESS THAN OR EQUAL TO length_s DO
            SET inner_idx TO 0
            WHILE inner_idx LESS THAN outer_index DO
                SET current_char TO s[inner_idx]
                IF NOT (current_char EQUALS '0') THEN
                    SET substring_str TO EXTRACT s FROM inner_idx TO (outer_index MINUS 1)
                    SET num_value TO CONVERT substring_str TO integer
                    IF (num_value GREATER THAN OR EQUAL TO 1) AND (num_value LESS THAN OR EQUAL TO k) THEN
                        SET dp[outer_index] TO (dp[outer_index] PLUS dp[inner_idx]) MODULO MOD
                    END IF
                END IF
                INCREMENT inner_idx BY 1
            END WHILE
            INCREMENT outer_index BY 1
        END WHILE

        RETURN dp[length_s]
    END FUNCTION
END CLASS