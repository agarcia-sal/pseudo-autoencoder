CLASS Solution
    FUNCTION medianSlidingWindow(nums k)
        DECLARE lowerHalf AS an empty list
        DECLARE upperHalf AS an empty list

        FUNCTION balance_heaps()
            LOOP FOREVER
                IF LENGTH of lowerHalf GREATER THAN LENGTH of upperHalf PLUS 1 THEN
                    ASSIGN popped TO heappop(lowerHalf)
                    CALL heappush(upperHalf, -popped)
                    CONTINUE
                END IF

                IF LENGTH of upperHalf GREATER THAN LENGTH of lowerHalf THEN
                    ASSIGN popped TO heappop(upperHalf)
                    CALL heappush(lowerHalf, -popped)
                    CONTINUE
                END IF

                BREAK
            END LOOP
        END FUNCTION

        FUNCTION add_num(x)
            IF (LENGTH of lowerHalf IS 0) OR (x <= -lowerHalf[0]) THEN
                CALL heappush(lowerHalf, -x)
            ELSE
                CALL heappush(upperHalf, x)
            END IF
            CALL balance_heaps()
        END FUNCTION

        FUNCTION remove_num(x)
            IF (x <= -lowerHalf[0]) THEN
                SET tempList TO []
                FOR item IN lowerHalf
                    IF item != -x THEN
                        APPEND item TO tempList
                    END IF
                END FOR
                ASSIGN lowerHalf TO tempList
                IF LENGTH of lowerHalf > 0 THEN
                    CALL heapify(lowerHalf)
                END IF
            ELSE
                SET tempList TO []
                FOR item IN upperHalf
                    IF item != x THEN
                        APPEND item TO tempList
                    END IF
                END FOR
                ASSIGN upperHalf TO tempList
                IF LENGTH of upperHalf > 0 THEN
                    CALL heapify(upperHalf)
                END IF
            END IF
            CALL balance_heaps()
        END FUNCTION

        FUNCTION get_median()
            IF LENGTH of lowerHalf > LENGTH of upperHalf THEN
                RETURN -lowerHalf[0]
            ELSE
                RETURN (-lowerHalf[0] + upperHalf[0]) / 2
            END IF
        END FUNCTION

        DECLARE count AS 0
        WHILE count < k
            CALL add_num(nums[count])
            SET count TO count + 1
        END WHILE

        DECLARE medianList AS a single-element list containing get_median()

        DECLARE idx AS k
        WHILE idx < LENGTH of nums
            CALL add_num(nums[idx])
            CALL remove_num(nums[idx - k])
            APPEND get_median() TO medianList
            INCREMENT idx BY 1
        END WHILE

        RETURN medianList
    END FUNCTION
END CLASS