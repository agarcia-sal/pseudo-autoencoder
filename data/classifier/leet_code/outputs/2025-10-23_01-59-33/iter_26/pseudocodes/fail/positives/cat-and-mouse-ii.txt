CLASS Solution  
    FUNCTION canMouseWin(grid, catJump, mouseJump)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero of grid  
        SET cat_start TO zero  
        SET mouse_start TO zero  
        SET food TO zero  
        SET dirs TO the LIST of MINUS one zero ONE zero MINUS one  
        SET g_mouse TO a LIST containing an empty LIST repeated m MULTIPLIED BY n times  
        SET g_cat TO a LIST containing an empty LIST repeated m MULTIPLIED BY n times  

        FOR each index i AND element row IN the ENUMERATION OF grid  
            FOR each index j AND element c IN the ENUMERATION OF row  
                IF c EQUALS the character representing a HASH  
                    CONTINUE  
                END IF  
                SET v TO i MULTIPLIED BY n PLUS j  
                IF c EQUALS the character representing uppercase C  
                    SET cat_start TO v  
                ELSE IF c EQUALS the character representing uppercase M  
                    SET mouse_start TO v  
                ELSE IF c EQUALS the character representing uppercase F  
                    SET food TO v  
                END IF  
                FOR each element a AND next element b IN consecutive pairs of dirs  
                    FOR k FROM zero TO mouseJump INCLUSIVE  
                        SET x TO i PLUS k MULTIPLIED BY a  
                        SET y TO j PLUS k MULTIPLIED BY b  
                        IF x LESS THAN zero OR x GREATER THAN OR EQUAL TO m OR y LESS THAN zero OR y GREATER THAN OR EQUAL TO n OR element at position x AND position y of grid EQUALS the character representing a HASH  
                            BREAK  
                        END IF  
                        APPEND x MULTIPLIED BY n PLUS y TO element at position v of g_mouse  
                    END FOR  
                    FOR k FROM zero TO catJump INCLUSIVE  
                        SET x TO i PLUS k MULTIPLIED BY a  
                        SET y TO j PLUS k MULTIPLIED BY b  
                        IF x LESS THAN zero OR x GREATER THAN OR EQUAL TO m OR y LESS THAN zero OR y GREATER THAN OR EQUAL TO n OR element at position x AND position y of grid EQUALS the character representing a HASH  
                            BREAK  
                        END IF  
                        APPEND x MULTIPLIED BY n PLUS y TO element at position v of g_cat  
                    END FOR  
                END FOR  
            END FOR  
        END FOR  
        RETURN the RESULT OF calling calc WITH g_mouse, g_cat, mouse_start, cat_start, food EQUALS one  
    END FUNCTION  

    FUNCTION calc(g_mouse, g_cat, mouse_start, cat_start, hole)  
        FUNCTION get_prev_states(state)  
            SET m TO element at position zero of state  
            SET c TO element at position one of state  
            SET t TO element at position two of state  
            SET pt TO the EXCLUSIVE OR of t AND one  
            SET pre TO an empty LIST  
            IF pt EQUALS one  
                FOR each pc IN element at position c of g_cat  
                    IF element at position m AND position pc AND position one of ans EQUALS zero  
                        APPEND the TUPLE of m pc pt TO pre  
                    END IF  
                END FOR  
            ELSE  
                FOR each pm IN element at position m of g_mouse  
                    IF element at position pm AND position c AND position zero of ans EQUALS zero  
                        APPEND the TUPLE of pm c zero TO pre  
                    END IF  
                END FOR  
            END IF  
            RETURN pre  
        END FUNCTION  

        SET n TO the LENGTH OF g_mouse  
        SET degree TO a LIST containing a LIST containing a LIST of zero zero repeated twice repeated n times repeated n times  
        FOR i FROM zero TO n MINUS one  
            FOR j FROM zero TO n MINUS one  
                SET element at position zero of element at position j of element at position i of degree TO the LENGTH OF element at position i of g_mouse  
                SET element at position one of element at position j of element at position i of degree TO the LENGTH OF element at position j of g_cat  
            END FOR  
        END FOR  

        SET ans TO a LIST containing a LIST containing a LIST of zero zero repeated twice repeated n times repeated n times  
        SET q TO an empty double ended queue  
        FOR i FROM zero TO n MINUS one  
            SET element at position hole AND position i AND position one of ans TO one  
            SET element at position i AND position hole AND position zero of ans TO two  
            SET element at position i AND position i AND position one of ans TO two  
            SET element at position i AND position i AND position zero of ans TO two  
            ADD the TUPLE of hole i one TO the end of q  
            ADD the TUPLE of i hole zero TO the end of q  
            ADD the TUPLE of i i zero TO the end of q  
            ADD the TUPLE of i i one TO the end of q  
        END FOR  
        WHILE q is not empty  
            REMOVE the element from the front of q AND ASSIGN to state  
            SET t TO element at position zero AND position one AND position two of ans ACCORDING TO state  
            FOR each prev_state IN get_prev_states WITH state  
                SET pm TO element at position zero of prev_state  
                SET pc TO element at position one of prev_state  
                SET pt TO element at position two of prev_state  
                IF pt EQUALS t MINUS one  
                    SET element at position pm AND position pc AND position pt of ans TO t  
                    ADD prev_state TO the end of q  
                ELSE  
                    DECREMENT element at position pm AND position pc AND position pt of degree BY one  
                    IF element at position pm AND position pc AND position pt of degree EQUALS zero  
                        SET element at position pm AND position pc AND position pt of ans TO t  
                        ADD prev_state TO the end of q  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        RETURN element at position mouse_start AND position cat_start AND position zero of ans  
    END FUNCTION  
END CLASS