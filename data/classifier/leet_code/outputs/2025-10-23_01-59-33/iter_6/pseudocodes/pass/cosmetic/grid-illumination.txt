CLASS Solution  
    FUNCTION gridIllumination(n, lamps, queries)  
        INITIALIZE freqRows AS a dictionary defaulting to 0  
        INITIALIZE freqCols AS a dictionary defaulting to 0  
        INITIALIZE freqDiags AS a dictionary defaulting to 0  
        INITIALIZE freqAntiDiags AS a dictionary defaulting to 0  
        INITIALIZE activeLamps AS an empty set  
        
        SET idx TO 0  
        WHILE idx < LENGTH(lamps)  
            LET x TO lamps[idx][0]  
            LET y TO lamps[idx][1]  
            IF NOT (x, y) IN activeLamps  
                INSERT (x, y) INTO activeLamps  
                freqRows[x] ← freqRows[x] + 1  
                freqCols[y] ← freqCols[y] + 1  
                LET dKey TO x - y  
                LET adKey TO x + y  
                freqDiags[dKey] ← freqDiags[dKey] + 1  
                freqAntiDiags[adKey] ← freqAntiDiags[adKey] + 1  
            END IF  
            idx ← idx + 1  
        END WHILE  
        
        DECLARE neighbors AS a list containing (-1, -1), (-1, 0), (-1, 1), (0, -1), (0, 0), (0, 1), (1, -1), (1, 0), (1, 1)  
        
        DEFINE results AS an empty list  
        
        SET qIndex TO 0  
        WHILE qIndex < LENGTH(queries)  
            LET currRow TO queries[qIndex][0]  
            LET currCol TO queries[qIndex][1]  
            
            IF freqRows[currRow] > 0 OR freqCols[currCol] > 0 OR freqDiags[currRow - currCol] > 0 OR freqAntiDiags[currRow + currCol] > 0 THEN  
                APPEND 1 TO results  
            ELSE  
                APPEND 0 TO results  
            END IF  
            
            DECLARE nIndex AS 0  
            WHILE nIndex < LENGTH(neighbors)  
                LET deltaRow TO neighbors[nIndex][0]  
                LET deltaCol TO neighbors[nIndex][1]  
                LET newRow TO currRow + deltaRow  
                LET newCol TO currCol + deltaCol  
                
                IF (newRow, newCol) IN activeLamps THEN  
                    DELETE (newRow, newCol) FROM activeLamps  
                    freqRows[newRow] ← freqRows[newRow] - 1  
                    freqCols[newCol] ← freqCols[newCol] - 1  
                    freqDiags[newRow - newCol] ← freqDiags[newRow - newCol] - 1  
                    freqAntiDiags[newRow + newCol] ← freqAntiDiags[newRow + newCol] - 1  
                END IF  
                nIndex ← nIndex + 1  
            END WHILE  
            qIndex ← qIndex + 1  
        END WHILE  
        
        RETURN results  
    END FUNCTION  
END CLASS