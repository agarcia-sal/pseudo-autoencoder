CLASS Solution  
    FUNCTION minOperationsToFlip(expression)  
        SET stack TO empty list  
        FOR each element IN expression  
            IF element EQUALS open parenthesis OR element EQUALS ampersand OR element EQUALS vertical bar  
                APPEND pair of element AND zero TO stack  
                CONTINUE to next iteration  
            END IF  
            IF element EQUALS closing parenthesis  
                SET lastPair TO result of removing last element FROM stack  
                REMOVE last element FROM stack  
            ELSE  
                SET lastPair TO pair consisting of element AND one  
            END IF  
            IF stack is not empty AND first element of last pair in stack EQUALS ampersand OR vertical bar  
                REMOVE last element FROM stack AND ASSIGN first element of that pair TO operator  
                REMOVE last element FROM stack AND ASSIGN first element TO variable a AND second element TO costA  
                DESTRUCTURE lastPair INTO variable b AND costB  
                IF operator EQUALS ampersand  
                    IF a EQUALS zero AND b EQUALS zero  
                        SET lastPair TO pair consisting of zero AND one PLUS minimum of costA AND costB  
                    ELSE IF a EQUALS zero AND b EQUALS one  
                        SET lastPair TO pair consisting of zero AND one  
                    ELSE IF a EQUALS one AND b EQUALS zero  
                        SET lastPair TO pair consisting of zero AND one  
                    ELSE  
                        SET lastPair TO pair consisting of one AND minimum of costA AND costB  
                    END IF  
                ELSE  
                    IF a EQUALS zero AND b EQUALS zero  
                        SET lastPair TO pair consisting of zero AND minimum of costA AND costB  
                    ELSE IF a EQUALS zero AND b EQUALS one  
                        SET lastPair TO pair consisting of one AND one  
                    ELSE IF a EQUALS one AND b EQUALS zero  
                        SET lastPair TO pair consisting of one AND one  
                    ELSE  
                        SET lastPair TO pair consisting of one AND one PLUS minimum of costA AND costB  
                    END IF  
                END IF  
            END IF  
            APPEND lastPair TO stack  
        END FOR  
        RETURN second element of last element of stack  
    END FUNCTION  
END CLASS