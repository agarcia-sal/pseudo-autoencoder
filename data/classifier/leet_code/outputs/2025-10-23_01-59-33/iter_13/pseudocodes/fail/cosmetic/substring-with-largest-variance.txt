CLASS Solution  
    FUNCTION largestVariance(s)  
        FUNCTION calculate_variance(substring, char_a, char_b)  
            SET peak_variance ← 0  
            SET tally_a ← 0  
            SET tally_b ← 0  
            SET observed_b ← false  
            SET encountered_first_b ← false  
            
            SET iterator ← 0  
            WHILE iterator < LENGTH(substring)  
                SET current_char ← substring[iterator]  
                IF current_char = char_a THEN  
                    tally_a ← tally_a + 1  
                ELSE  
                    IF current_char = char_b THEN  
                        tally_b ← tally_b + 1  
                        observed_b ← true  
                    END IF  
                END IF  
                
                IF NOT (tally_b ≤ 0) THEN  
                    IF peak_variance < (tally_a - tally_b) THEN  
                        peak_variance ← tally_a - tally_b  
                    END IF  
                ELSE  
                    IF (tally_b = 0) AND encountered_first_b THEN  
                        IF peak_variance < (tally_a - 1) THEN  
                            peak_variance ← tally_a - 1  
                        END IF  
                    END IF  
                END IF  
                
                IF tally_b > tally_a THEN  
                    SET tally_a ← 0  
                    SET tally_b ← 0  
                    SET encountered_first_b ← observed_b  
                END IF  
                
                iterator ← iterator + 1  
            END WHILE  
            
            RETURN peak_variance  
        END FUNCTION  
        
        SET overall_max ← 0  
        SET character_pool ← EMPTY SET  
        SET index ← 0  
        WHILE index < LENGTH(s)  
            character_pool ← character_pool UNION { s[index] }  
            index ← index + 1  
        END WHILE  
        
        SET unique_list ← LIST(character_pool)  
        SET n ← LENGTH(unique_list)  
        SET outer_index ← 0  
        WHILE outer_index < n  
            SET inner_index ← 0  
            WHILE inner_index < n  
                IF outer_index ≠ inner_index THEN  
                    SET candidate_a ← unique_list[outer_index]  
                    SET candidate_b ← unique_list[inner_index]  
                    SET probe_variance ← calculate_variance(s, candidate_a, candidate_b)  
                    IF probe_variance > overall_max THEN  
                        overall_max ← probe_variance  
                    END IF  
                END IF  
                inner_index ← inner_index + 1  
            END WHILE  
            outer_index ← outer_index + 1  
        END WHILE  
        
        RETURN overall_max  
    END FUNCTION  
END CLASS