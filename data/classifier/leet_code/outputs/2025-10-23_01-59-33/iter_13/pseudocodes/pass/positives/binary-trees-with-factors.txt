CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MOD TO ten raised to the power of nine PLUS seven  
        SORT arr IN ascending order  
        SET dp TO an empty mapping FROM elements of arr TO the number one FOR each element in arr  
        FOR index i FROM zero TO the LENGTH OF arr MINUS one  
            SET num TO element at position i of arr  
            FOR index j FROM zero TO i MINUS one  
                SET potential_factor TO element at position j of arr  
                IF num MODULO potential_factor EQUALS zero THEN  
                    SET right_child TO num DIVIDED BY potential_factor  
                    IF right_child EXISTS AS a key IN dp THEN  
                        SET dp of num TO dp of num PLUS dp of potential_factor MULTIPLIED BY dp of right_child  
                        SET dp of num TO dp of num MODULO MOD  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        SET total TO zero  
        FOR each value IN dp values  
            INCREMENT total BY value  
        END FOR  
        RETURN total MODULO MOD  
    END FUNCTION  
END CLASS