CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        ASSIGN MODULO_CONST ← (10 ^ 9) + 7  
        SORT arr BY ascending order  
        
        INITIALIZE factorsCount AS empty mapping  
        FOR each element IN arr DO  
            SET factorsCount[element] ← 1  
        END FOR  
        
        SET outerIdx ← 0  
        WHILE outerIdx < LENGTH(arr) DO  
            SET currentVal ← arr[outerIdx]  
            SET innerIdx ← 0  
            WHILE innerIdx < outerIdx DO  
                SET divisorCandidate ← arr[innerIdx]  
                IF (currentVal − (currentVal DIV divisorCandidate) * divisorCandidate) = 0 THEN  
                    SET pairedFactor ← currentVal DIV divisorCandidate  
                    IF pairedFactor IN factorsCount THEN  
                        SET product ← factorsCount[divisorCandidate] * factorsCount[pairedFactor]  
                        SET factorsCount[currentVal] ← (factorsCount[currentVal] + product) MODULO MODULO_CONST  
                    END IF  
                END IF  
                INCREMENT innerIdx BY 1  
            END WHILE  
            INCREMENT outerIdx BY 1  
        END WHILE  
        
        ASSIGN accumulation ← 0  
        FOR each countValue IN factorsCount DO  
            SET accumulation ← accumulation + countValue  
        END FOR  
        
        RETURN accumulation MODULO MODULO_CONST  
    END FUNCTION  
END CLASS