CLASS Solution
    FUNCTION countTriplets(nums)
        INITIALIZE mapPairs WITH an empty map defaulting to 0
        
        FUNCTION buildPairs(index1, index2)
            IF index1 >= LENGTH(nums) THEN
                RETURN
            ELSE IF index2 >= LENGTH(nums) THEN
                CALL buildPairs(index1 + 1, 0)
                RETURN
            END IF
            
            SET mask TO nums[index1] BITWISE_AND nums[index2]
            SET mapPairs[mask] TO mapPairs[mask] + 1
            CALL buildPairs(index1, index2 + 1)
        END FUNCTION
        
        CALL buildPairs(0, 0)
        
        FUNCTION accumulateCount(position)
            IF position >= LENGTH(nums) THEN
                RETURN 0
            END IF
            
            SET acc TO 0
            FOR EACH pairKey, freq IN mapPairs AS entries
                IF (pairKey BITWISE_AND nums[position]) EQUALS 0 THEN
                    SET acc TO acc + freq
                END IF
            END FOR
            
            RETURN acc + accumulateCount(position + 1)
        END FUNCTION
        
        RETURN accumulateCount(0)
    END FUNCTION
END CLASS