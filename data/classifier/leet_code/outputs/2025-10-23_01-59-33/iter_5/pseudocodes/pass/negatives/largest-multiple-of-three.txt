CLASS Solution  
    FUNCTION largestMultipleOfThree(digits)  
        SET count TO frequency count of digits  
        SET total_sum TO sum of all digits  
        SET remainder TO total_sum MODULO 3  
        
        IF remainder EQUALS 1  
            FOR each d IN list of 1, 4, 7  
                IF count at d IS GREATER THAN 0  
                    DECREMENT count at d BY 1  
                    BREAK loop  
            ELSE  
                FOR each d IN list of 2, 5, 8  
                    IF count at d IS GREATER THAN 1  
                        DECREMENT count at d BY 2  
                        BREAK loop  
        
        IF remainder EQUALS 2  
            FOR each d IN list of 2, 5, 8  
                IF count at d IS GREATER THAN 0  
                    DECREMENT count at d BY 1  
                    BREAK loop  
            ELSE  
                FOR each d IN list of 1, 4, 7  
                    IF count at d IS GREATER THAN 1  
                        DECREMENT count at d BY 2  
                        BREAK loop  
        
        SET result TO empty list  
        FOR d FROM 9 DOWNTO 0  
            APPEND string representation of d repeated count at d times TO result  
        
        SET final_number TO concatenation of all elements in result  
        
        IF final_number IS NOT empty AND first character of final_number EQUALS '0'  
            RETURN string '0'  
        ELSE  
            RETURN final_number  
    END FUNCTION  
END CLASS