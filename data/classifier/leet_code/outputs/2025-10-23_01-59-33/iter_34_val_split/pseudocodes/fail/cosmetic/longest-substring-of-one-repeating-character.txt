CLASS Solution
    FUNCTION longestRepeating(s queryCharacters queryIndices)
        FUNCTION merge_intervals()
            ASSIGN 0 TO z
            WHILE z < (LENGTH(intervals) - 1)
                IF (intervals[z][2] = intervals[z + 1][2])
                    ASSIGN (intervals[z][0], intervals[z + 1][1], intervals[z][2]) TO intervals[z]
                    REMOVE intervals AT (z + 1)
                ELSE
                    ASSIGN (z + 1) TO z
                END IF
            END WHILE
        END FUNCTION

        ASSIGN [] TO intervals
        ASSIGN LENGTH(s) TO m
        ASSIGN 0 TO alpha
        ASSIGN 1 TO beta
        WHILE beta < m
            IF s[beta] <> s[alpha]
                APPEND (alpha, beta - 1, s[alpha]) TO intervals
                ASSIGN beta TO alpha
            END IF
            ASSIGN (beta + 1) - 1 TO beta
        END WHILE
        APPEND (alpha, m - 1, s[alpha]) TO intervals

        ASSIGN [] TO outputs
        ASSIGN MAXIMUM OF ((e - b) + 1) FOR EACH (b e t) IN intervals TO max_len

        ASSIGN 0 TO cc
        WHILE cc < LENGTH(queryCharacters)
            ASSIGN queryCharacters[cc] TO newChar
            ASSIGN queryIndices[cc] TO posIdx

            ASSIGN 0 TO rr
            WHILE rr < LENGTH(intervals)
                ASSIGN intervals[rr] TO (start_i, end_i, char_i)
                IF NOT (posIdx < start_i OR posIdx > end_i)
                    BREAK
                END IF
                ASSIGN (rr + 1) TO rr
            END WHILE

            IF posIdx > start_i
                INSERT (start_i, posIdx - 1, char_i) INTO intervals AT rr
                ASSIGN (posIdx, end_i, char_i) TO intervals[rr + 1]
            END IF
            IF posIdx < end_i
                INSERT (posIdx + 1, end_i, char_i) INTO intervals AT (rr + 1)
                ASSIGN (start_i, posIdx, char_i) TO intervals[rr]
            END IF

            ASSIGN (intervals[rr][0], intervals[rr][1], newChar) TO intervals[rr]

            CALL merge_intervals()

            ASSIGN MAXIMUM OF ((e - b) + 1) FOR EACH (b e t) IN intervals TO max_len
            APPEND max_len TO outputs

            ASSIGN (cc + 1) TO cc
        END WHILE

        RETURN outputs
    END FUNCTION
END CLASS