CLASS Solution  
    FUNCTION minimumIncompatibility(nums, k)  
        SET n TO the LENGTH OF nums  
        SET subset_size TO n DIVIDED BY k  
        
        IF there EXISTS a count of any number in nums WHERE the count GREATER THAN k  
            RETURN negative one  
        END IF  
        
        SET subset_incompatibility TO an empty mapping  
        
        FOR mask FROM zero TO two RAISED TO THE POWER OF n MINUS one  
            SET bit_count TO the COUNT OF positions IN mask WHERE the BIT AT position OF mask EQUALS one  
            IF bit_count EQUALS subset_size  
                SET elements TO an empty list  
                FOR i FROM zero TO n MINUS one  
                    IF the BIT AT position i OF mask EQUALS one  
                        APPEND the element at position i OF nums TO elements  
                    END IF  
                END FOR  
                
                IF the NUMBER OF UNIQUE elements IN elements EQUALS subset_size  
                    SET incompatibility TO the MAXIMUM OF elements MINUS the MINIMUM OF elements  
                    ASSIGN incompatibility TO the ENTRY of mask IN subset_incompatibility  
                END IF  
            END IF  
        END FOR  
        
        SET dp TO a list of LENGTH two RAISED TO THE POWER OF n FILLED WITH positive infinity  
        SET the ELEMENT AT position zero OF dp TO zero  
        
        FOR mask FROM zero TO two RAISED TO THE POWER OF n MINUS one  
            SET bit_count TO the COUNT OF positions IN mask WHERE the BIT AT position OF mask EQUALS one  
            IF the REMAINDER of bit_count DIVIDED BY subset_size NOT EQUAL TO zero  
                CONTINUE to the next iteration  
            END IF  
            
            FOR each subset_mask IN the KEYS OF subset_incompatibility  
                IF the BINARY AND OF mask AND subset_mask EQUALS subset_mask  
                    SET dp AT position mask TO the MINIMUM OF the CURRENT dp AT position mask AND the dp AT position of the BINARY XOR OF mask AND subset_mask PLUS the VALUE of subset_mask IN subset_incompatibility  
                END IF  
            END FOR  
        END FOR  
        
        SET full_mask TO two RAISED TO THE POWER OF n MINUS one  
        IF the ELEMENT AT position full_mask OF dp NOT EQUAL TO positive infinity  
            RETURN the ELEMENT AT position full_mask OF dp  
        ELSE  
            RETURN negative one  
        END IF  
    END FUNCTION  
END CLASS