CLASS Solution  
    FUNCTION longestRepeating WITH PARAMETERS s AND queryCharacters AND queryIndices  
        FUNCTION merge_intervals  
            SET i TO zero  
            WHILE i LESS THAN the LENGTH OF intervals MINUS one HOLDS  
                IF character at position two of tuple at position i of intervals EQUALS character at position two of tuple at position i PLUS one of intervals  
                    SET tuple at position i of intervals TO a tuple CONSISTING OF start FROM tuple at position i OF intervals AND end FROM tuple at position i PLUS one OF intervals AND character FROM tuple at position i OF intervals  
                    REMOVE element at position i PLUS one FROM intervals  
                ELSE  
                    INCREMENT i BY one  
                END IF  
            END WHILE  
        END FUNCTION  

        SET intervals TO empty list  
        SET n TO the LENGTH OF s  
        SET start TO zero  

        FOR i FROM one TO n MINUS one  
            IF character at position i OF string s NOT EQUALS character at position start OF string s  
                APPEND a tuple CONSISTING OF start AND i MINUS one AND character at position start OF string s TO intervals  
                SET start TO i  
            END IF  
        END FOR  

        APPEND a tuple CONSISTING OF start AND n MINUS one AND character at position start OF string s TO intervals  
        SET results TO empty list  
        SET longest TO the GREATEST VALUE OF end MINUS start PLUS one FOR each tuple CONSISTING OF start AND end AND character IN intervals  

        FOR each pair of char FROM queryCharacters AND idx FROM queryIndices  
            SET i TO zero  
            WHILE i LESS THAN the LENGTH OF intervals HOLDS  
                SET start TO the first element OF tuple at position i OF intervals  
                SET end TO the second element OF tuple at position i OF intervals  
                SET c TO the third element OF tuple at position i OF intervals  
                IF start LESS THAN OR EQUAL TO idx AND idx LESS THAN OR EQUAL TO end  
                    BREAK THE LOOP  
                END IF  
                INCREMENT i BY one  
            END WHILE  

            IF idx GREATER THAN start  
                INSERT a tuple CONSISTING OF start AND idx MINUS one AND c INTO intervals AT POSITION i  
                SET tuple at position i PLUS one OF intervals TO a tuple CONSISTING OF idx AND end AND c  
            END IF  

            IF idx LESS THAN end  
                INSERT a tuple CONSISTING OF idx PLUS one AND end AND c INTO intervals AT POSITION i PLUS one  
                SET tuple at position i OF intervals TO a tuple CONSISTING OF start AND idx AND c  
            END IF  

            SET tuple at position i OF intervals TO a tuple CONSISTING OF first element OF tuple at position i OF intervals AND second element OF tuple at position i OF intervals AND char  
            CALL merge_intervals  
            SET longest TO the GREATEST VALUE OF end MINUS start PLUS one FOR each tuple CONSISTING OF start AND end AND character IN intervals  
            APPEND longest TO results  
        END FOR  

        RETURN results  
    END FUNCTION  
END CLASS