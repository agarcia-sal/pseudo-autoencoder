CLASS Solution  
    FUNCTION distinctSubseqII(s)  
        ASSIGN (10^9 + 7) TO MOD  
        ASSIGN LENGTH OF s TO lengthVar  
        CREATE A list dpList WITH (lengthVar + 1) zeroes  
        ASSIGN 1 TO dpList[0]  
        CREATE an empty map charRecentIndex  
        
        ASSIGN 1 TO idx  
        WHILE idx <= lengthVar  
            ASSIGN s[idx - 1] TO currentSymbol  
            ASSIGN (dpList[idx - 1] * 2) TO dpList[idx]  
            ASSIGN dpList[idx] MODULO MOD TO dpList[idx]  
            
            IF currentSymbol IS IN charRecentIndex KEYS THEN
                ASSIGN (dpList[idx] - dpList[ charRecentIndex[currentSymbol] - 1 ] + MOD) TO dpList[idx]  
                ASSIGN dpList[idx] MODULO MOD TO dpList[idx]  
            END IF  
            
            ASSIGN idx TO charRecentIndex[currentSymbol]  
            INCREMENT idx BY 1  
        END WHILE  
        
        RETURN (dpList[lengthVar] - 1) MOD MOD  
    END FUNCTION  
END CLASS