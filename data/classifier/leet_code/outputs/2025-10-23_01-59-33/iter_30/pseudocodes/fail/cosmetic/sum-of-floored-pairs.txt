CLASS Solution
    FUNCTION sumOfFlooredPairs(nums)
        ASSIGN MOD ← 1_000_000_001
        ASSIGN max_val ← MAXIMUM element in nums
        ASSIGN freq_map ← DICTIONARY mapping elements in nums TO their respective counts
        ASSIGN prefix_arr ← ARRAY filled with 0, of size (max_val + 1)

        FOR EACH element IN freq_map DO
            prefix_arr[element] ← prefix_arr[element] + freq_map[element]
        END FOR

        SET idx ← 1
        WHILE idx ≤ max_val DO
            prefix_arr[idx] ← prefix_arr[idx] + prefix_arr[idx - 1]
            idx ← idx + 1
        END WHILE

        ASSIGN ans ← 0

        FOR key IN freq_map DO
            ASSIGN multiplier ← 1
            WHILE multiplier * key ≤ max_val DO
                ASSIGN range_start ← multiplier * key
                
                IF multiplier * key + key - 1 ≤ max_val THEN
                    ASSIGN range_end ← multiplier * key + key - 1
                ELSE
                    ASSIGN range_end ← max_val
                END IF
                
                ASSIGN count_in_range ← prefix_arr[range_end] - prefix_arr[range_start - 1]
                ans ← (ans + (count_in_range * multiplier * freq_map[key])) MOD MOD
                multiplier ← multiplier + 1
            END WHILE
        END FOR

        RETURN ans
    END FUNCTION
END CLASS