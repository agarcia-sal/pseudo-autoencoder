CLASS Solution  
    FUNCTION isValid(code)  
        IMPORT regular expression module  
        SET cdata_pattern TO the regular expression pattern representing the string starting with less than followed by an exclamation mark followed by open square bracket followed by CDATA followed by open square bracket followed by any character any number of times reluctantly followed by close square bracket followed by close square bracket followed by greater than  
        SET code TO the result of replacing all occurrences matching cdata_pattern in code with empty string using regular expression substitution  
        SET stack TO an empty list  
        SET i TO zero  
        WHILE i IS LESS THAN the LENGTH OF code  
            IF the character at position i of code EQUALS the less than character  
                SET j TO the position of the first occurrence of the greater than character in code starting from one position after i  
                IF j EQUALS negative one  
                    RETURN false  
                END IF  
                SET tag_content TO the substring from position i plus one TO position j of code  
                IF tag_content IS EMPTY  
                    RETURN false  
                END IF  
                IF the first character of tag_content EQUALS the forward slash character  
                    SET tag_name TO the substring from position two TO the end of tag_content  
                    IF stack IS EMPTY OR element at the last position of stack DOES NOT EQUAL tag_name  
                        RETURN false  
                    END IF  
                    REMOVE the element at the last position FROM stack  
                ELSE IF the first character of tag_content EQUALS the exclamation mark character  
                    RETURN false  
                ELSE  
                    IF NOT the condition that the LENGTH OF tag_content IS GREATER THAN OR EQUAL TO one AND IS LESS THAN OR EQUAL TO nine AND every character in tag_content IS AN UPPERCASE LETTER  
                        RETURN false  
                    END IF  
                    APPEND tag_content TO stack  
                END IF  
                SET i TO j PLUS one  
            ELSE  
                INCREMENT i BY one  
            END IF  
        END WHILE  
        SET valid_tag_pattern TO the regular expression pattern representing the string starting with less than followed by one or more uppercase letters followed by greater than followed by any character any number of times followed by less than followed by forward slash followed by one or more uppercase letters followed by greater than  
        RETURN the condition that stack IS EMPTY AND the count of all occurrences matching valid_tag_pattern in code IS GREATER THAN zero  
    END FUNCTION  
END CLASS