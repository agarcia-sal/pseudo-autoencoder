CLASS Solution  
    FUNCTION subStrHash(s string power integer modulo integer k integer hashValue integer) RETURNS string  
        
        FUNCTION val(c character) RETURNS integer  
            DECLARE code integer  
            SET code TO the unicode code of c  
            RETURN (code - the unicode code of 'a') + 1  
        END FUNCTION  

        DECLARE length integer  
        SET length TO LENGTH OF s  
        DECLARE rolling_hash integer  
        SET rolling_hash TO 0  
        DECLARE power_term integer  
        SET power_term TO 1  

        DECLARE idx integer  
        PROCEDURE calcInitialHash(pos integer)  
            IF pos > length - 1 THEN RETURN END IF  
            CALL calcInitialHash(pos + 1)  
            SET rolling_hash TO (rolling_hash + val(s[pos]) * power_term) MOD modulo  
            IF pos < length - 1 THEN  
                SET power_term TO (power_term * power) MOD modulo  
            END IF  
        END PROCEDURE  
        CALL calcInitialHash(length - k)  

        DECLARE starting_pos integer  
        SET starting_pos TO length - k  
        GUARD IF rolling_hash = hashValue THEN RETURN SUBSTRING OF s FROM starting_pos LENGTH k END IF  

        DECLARE highest_pow integer  
        SET highest_pow TO power_term  

        PROCEDURE slideWindow(position integer)  
            GUARD IF position < 0 THEN RETURN END IF  
            SET rolling_hash TO (rolling_hash - val(s[position + k]) * highest_pow) MOD modulo  
            IF rolling_hash < 0 THEN SET rolling_hash TO rolling_hash + modulo END IF  
            SET rolling_hash TO ((rolling_hash * power) MOD modulo + val(s[position])) MOD modulo  

            IF rolling_hash = hashValue THEN  
                SET starting_pos TO position  
            END IF  
            CALL slideWindow(position - 1)  
        END PROCEDURE  
        CALL slideWindow(length - k - 1)  

        RETURN SUBSTRING OF s FROM starting_pos LENGTH k  
    END FUNCTION  
END CLASS