CLASS Solution  
    FUNCTION largestMultipleOfThree(digits)  
        SET count TO a frequency mapping of digits  
        SET total_sum TO zero  
        FOR each digit IN digits  
            INCREMENT total_sum BY digit  
        END FOR  
        
        SET remainder TO total_sum MODULO three  
        
        IF remainder EQUALS one  
            FOR each digit IN the list consisting of one four and seven  
                IF the value mapped by digit in count is greater than zero  
                    DECREMENT the value mapped by digit in count BY one  
                    EXIT this loop  
                END IF  
            END FOR  
            IF the above loop did not break  
                FOR each digit IN the list consisting of two five and eight  
                    IF the value mapped by digit in count is greater than one  
                        DECREMENT the value mapped by digit in count BY two  
                        EXIT this loop  
                    END IF  
                END FOR  
            END IF  
        END IF  
        
        IF remainder EQUALS two  
            FOR each digit IN the list consisting of two five and eight  
                IF the value mapped by digit in count is greater than zero  
                    DECREMENT the value mapped by digit in count BY one  
                    EXIT this loop  
                END IF  
            END FOR  
            IF the above loop did not break  
                FOR each digit IN the list consisting of one four and seven  
                    IF the value mapped by digit in count is greater than one  
                        DECREMENT the value mapped by digit in count BY two  
                        EXIT this loop  
                    END IF  
                END FOR  
            END IF  
        END IF  
        
        SET result TO an empty list  
        FOR digit FROM nine DOWN TO zero  
            APPEND the repeated string of digit converted to string repeated the value mapped by digit in count times TO result  
        END FOR  
        
        SET final_number TO the concatenation of all elements in result  
        
        IF final_number is empty OR the first character of final_number EQUALS zero AS STRING  
            RETURN zero AS STRING  
        ELSE  
            RETURN final_number  
        END IF  
    END FUNCTION  
END CLASS