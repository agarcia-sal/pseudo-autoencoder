CLASS Solution  
    FUNCTION tilingRectangle(n, m)  
        FUNCTION backtrack(heights, moves)  
            DECLARE min_moves AS NONLOCAL  
            IF all elements of heights EQUAL TO n THEN  
                SET min_moves TO the MINIMUM OF min_moves AND moves  
                RETURN  
            END IF  
            IF moves GREATER THAN OR EQUAL TO min_moves THEN  
                RETURN  
            END IF  
            SET min_height TO the MINIMUM value in heights  
            SET left TO the POSITION of min_height in heights  
            SET right TO left  
            WHILE right LESS THAN m AND element at position right of heights EQUALS min_height  
                INCREMENT right BY one  
            END WHILE  
            FOR size FROM right MINUS left DOWN TO one  
                IF for each index FROM zero TO size MINUS one the element at position left PLUS index of heights PLUS size LESS THAN OR EQUAL TO n THEN  
                    SET new_heights TO a COPY of heights  
                    FOR i FROM zero TO size MINUS one  
                        INCREMENT element at position left PLUS i of new_heights BY size  
                    END FOR  
                    CALL backtrack WITH new_heights AND moves PLUS one  
                END IF  
            END FOR  
        END FUNCTION  
        SET min_moves TO positive infinity  
        CALL backtrack WITH a list of zero repeated m times AND zero  
        RETURN min_moves  
    END FUNCTION  
END CLASS