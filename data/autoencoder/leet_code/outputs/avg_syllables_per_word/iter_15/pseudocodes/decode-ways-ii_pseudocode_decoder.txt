CLASS Solution  
    FUNCTION numDecodings WITH parameter s  
        SET MOD TO ten RAISED TO THE POWER OF nine PLUS seven  
        SET dp TO a list OF zero REPEATED the LENGTH OF s PLUS one TIMES  
        SET element at position zero of dp TO one  

        FUNCTION ways_to_decode_single WITH parameter char  
            IF char EQUALS the CHARACTER representing asterisk  
                RETURN nine  
            ELSE IF char EQUALS the CHARACTER representing zero  
                RETURN zero  
            ELSE  
                RETURN one  
            END IF  
        END FUNCTION  

        FUNCTION ways_to_decode_pair WITH parameters char1, char2  
            IF char1 EQUALS the CHARACTER representing asterisk AND char2 EQUALS the CHARACTER representing asterisk  
                RETURN fifteen  
            ELSE IF char1 EQUALS the CHARACTER representing asterisk  
                IF char2 IS LESS THAN OR EQUAL TO the CHARACTER representing six  
                    RETURN two  
                ELSE  
                    RETURN one  
                END IF  
            ELSE IF char2 EQUALS the CHARACTER representing asterisk  
                IF char1 EQUALS the CHARACTER representing one  
                    RETURN nine  
                ELSE IF char1 EQUALS the CHARACTER representing two  
                    RETURN six  
                ELSE  
                    RETURN zero  
                END IF  
            ELSE  
                SET num TO the integer CONVERSION OF concatenating char1 FOLLOWED BY char2  
                IF num IS GREATER THAN OR EQUAL TO ten AND num IS LESS THAN OR EQUAL TO twenty six  
                    RETURN one  
                ELSE  
                    RETURN zero  
                END IF  
            END IF  
        END FUNCTION  

        FOR index FROM one TO the LENGTH OF s  
            SET element at position index of dp TO the REMAINDER AFTER DIVIDING the SUM OF element at position index of dp PLUS the PRODUCT OF element at position index MINUS one of dp AND the RESULT OF ways_to_decode_single WITH the CHARACTER at position index MINUS one of s BY MODULO MOD  
            IF index IS GREATER THAN one  
                SET element at position index of dp TO the REMAINDER AFTER DIVIDING the SUM OF element at position index of dp PLUS the PRODUCT OF element at position index MINUS two of dp AND the RESULT OF ways_to_decode_pair WITH the CHARACTERS at positions index MINUS two AND index MINUS one of s BY MODULO MOD  
            END IF  
        END FOR  

        RETURN element at the LAST POSITION OF dp  
    END FUNCTION  
END CLASS