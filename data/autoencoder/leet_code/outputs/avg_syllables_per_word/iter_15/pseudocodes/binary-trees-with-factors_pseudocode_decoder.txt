CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MOD TO one billion PLUS seven  
        SORT arr IN ascending order  
        SET dp TO A DICTIONARY THAT MAPS each number IN arr TO one  
        FOR index FROM zero TO the LENGTH OF arr MINUS one  
            SET num TO the element at position index of arr  
            FOR inner_index FROM zero TO index MINUS one  
                SET factor_candidate TO the element at position inner_index of arr  
                IF the remainder WHEN num IS DIVIDED BY factor_candidate EQUALS zero  
                    SET right_child TO num DIVIDED BY factor_candidate  
                    IF right_child IS A KEY IN dp  
                        SET dp at key num TO the REMAINDER WHEN the SUM OF dp at key num AND the PRODUCT OF dp at key factor_candidate AND dp at key right_child IS DIVIDED BY MOD  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        SET total_trees TO the SUM OF all VALUES IN dp  
        RETURN the REMAINDER WHEN total_trees IS DIVIDED BY MOD  
    END FUNCTION  
END CLASS