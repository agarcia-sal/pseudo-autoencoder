CLASS Solution  
    FUNCTION getMaxRepetitions(s1 string_parameter n1 integer_parameter s2 string_parameter n2 integer_parameter) RETURNS integer  
        IF n1 EQUALS zero THEN  
            RETURN zero  
        END IF  

        CREATE a list named s2_count with the LENGTH OF s2 PLUS one elements all initialized TO zero  
        CREATE a list named index_map with the LENGTH OF s2 PLUS one elements all initialized TO zero  

        SET current_index_s2 TO zero  
        SET s1_count TO zero  

        WHILE s1_count LESS THAN n1 HOLDS  
            INCREMENT s1_count BY one  
            FOR each character named char IN s1  
                IF character char EQUALS element at position current_index_s2 of s2 THEN  
                    INCREMENT current_index_s2 BY one  
                    IF current_index_s2 EQUALS the LENGTH OF s2 THEN  
                        SET element at position s1_count of s2_count TO element at position s1_count MINUS one of s2_count PLUS one  
                        SET current_index_s2 TO zero  
                    END IF  
                END IF  
                SET element at position s1_count of index_map TO current_index_s2  
            END FOR  

            IF current_index_s2 APPEARS IN the SUBLIST of index_map FROM position zero TO position s1_count MINUS one THEN  
                SET start TO the POSITION OF current_index_s2 IN index_map  
                SET cycle_length TO s1_count MINUS start  
                SET cycles_fit TO INTEGER DIVISION OF n1 MINUS start BY cycle_length  
                SET remainder TO the REMAINDER OF n1 MINUS start DIVIDED BY cycle_length  
                SET total_s2_count TO element at position start of s2_count PLUS cycles_fit MULTIPLIED BY element at position start PLUS cycle_length of s2_count MINUS element at position start of s2_count PLUS element at position start PLUS remainder of s2_count MINUS element at position start of s2_count  
                RETURN the INTEGER DIVISION OF total_s2_count BY n2  
            END IF  
        END WHILE  

        RETURN the INTEGER DIVISION OF element at position s1_count of s2_count BY n2  
    END FUNCTION  
END CLASS