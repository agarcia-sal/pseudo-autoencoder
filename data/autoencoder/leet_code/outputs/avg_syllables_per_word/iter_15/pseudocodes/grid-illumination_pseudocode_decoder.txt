CLASS Solution  
    FUNCTION gridIllumination(n, lamps, queries)  
        SET row_count TO a mapping from integer to integer with default zero  
        SET col_count TO a mapping from integer to integer with default zero  
        SET diag_count TO a mapping from integer to integer with default zero where keys represent row MINUS column  
        SET anti_diag_count TO a mapping from integer to integer with default zero where keys represent row PLUS column  
        
        SET lamp_positions TO an empty set  
        
        FOR each pair of values r AND c IN lamps  
            IF pair of r AND c is not in lamp_positions  
                ADD pair of r AND c TO lamp_positions  
                INCREMENT value mapped by r in row_count BY one  
                INCREMENT value mapped by c in col_count BY one  
                INCREMENT value mapped by r MINUS c in diag_count BY one  
                INCREMENT value mapped by r PLUS c in anti_diag_count BY one  
            END IF  
        END FOR  
        
        SET directions TO the list of pairs of values MINUS one MINUS one, MINUS one zero, MINUS one one, zero MINUS one, zero zero, zero one, one MINUS one, one zero, one one  
        
        SET result TO an empty list  
        
        FOR each pair of values r AND c IN queries  
            IF the value mapped by r in row_count is greater than zero OR the value mapped by c in col_count is greater than zero OR the value mapped by r MINUS c in diag_count is greater than zero OR the value mapped by r PLUS c in anti_diag_count is greater than zero  
                APPEND one TO result  
            ELSE  
                APPEND zero TO result  
            END IF  
            
            FOR each pair of values dr AND dc IN directions  
                SET nr TO r PLUS dr  
                SET nc TO c PLUS dc  
                IF pair of values nr AND nc is in lamp_positions  
                    REMOVE pair of nr AND nc FROM lamp_positions  
                    DECREMENT value mapped by nr in row_count BY one  
                    DECREMENT value mapped by nc in col_count BY one  
                    DECREMENT value mapped by nr MINUS nc in diag_count BY one  
                    DECREMENT value mapped by nr PLUS nc in anti_diag_count BY one  
                END IF  
            END FOR  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS