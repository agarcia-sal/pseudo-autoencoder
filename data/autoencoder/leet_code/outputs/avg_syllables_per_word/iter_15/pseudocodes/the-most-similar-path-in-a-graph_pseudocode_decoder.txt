CLASS Solution  
    FUNCTION mostSimilar(n, roads, names, targetPath)  
        SET graph TO a new mapping with default value of empty list  
        FOR each pair of nodes u and v IN roads  
            APPEND node v TO the list associated with node u in graph  
            APPEND node u TO the list associated with node v in graph  
        END FOR  
        
        SET m TO the length of targetPath  
        
        DEFINE FUNCTION dp(i, j) WITH memoization  
            IF i EQUALS zero THEN  
                IF the element at position j of names NOT EQUALS the element at position i of targetPath THEN  
                    RETURN one AND a list containing element j  
                ELSE  
                    RETURN zero AND a list containing element j  
                END IF  
            END IF  
            
            SET min_cost TO infinite  
            SET min_path TO an empty list  
            FOR each element k IN the list associated with element j in graph  
                CALL dp for position i MINUS one AND element k AND RECEIVE cost AND path  
                IF cost LESS THAN min_cost THEN  
                    SET min_cost TO cost  
                    SET min_path TO path  
                END IF  
            END FOR  
            
            IF the element at position j of names NOT EQUALS the element at position i of targetPath THEN  
                SET current_cost TO min_cost PLUS one  
            ELSE  
                SET current_cost TO min_cost  
            END IF  
            RETURN current_cost AND the concatenation of min_path WITH a list containing element j  
        END FUNCTION  
        
        SET min_cost TO infinite  
        SET min_path TO an empty list  
        FOR each integer j FROM zero TO n MINUS one  
            CALL dp for position m MINUS one AND element j AND RECEIVE cost AND path  
            IF cost LESS THAN min_cost THEN  
                SET min_cost TO cost  
                SET min_path TO path  
            END IF  
        END FOR  
        
        RETURN min_path  
    END FUNCTION  
END CLASS