CLASS Solution  
    FUNCTION numWays(words as List of strings, target as string) RETURNS integer  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF element at position zero of words  
        SET m TO the LENGTH OF target  
        SET freq TO a list containing n elements each being an empty mapping from characters to integers  
        FOR each word IN words  
            FOR each position j and character char IN word  
                INCREMENT element at key char of element at position j of freq BY one  
            END FOR  
        END FOR  
        SET dp TO a two dimensional list with (m PLUS one) rows and (n PLUS one) columns each initialized with zero  
        FOR each position j FROM zero TO n  
            SET element at row zero column j of dp TO one  
        END FOR  
        FOR each position i FROM one TO m  
            FOR each position j FROM one TO n  
                SET element at row i column j of dp TO element at row i column (j MINUS one) of dp  
                IF element at key element at position (i MINUS one) of target of element at position (j MINUS one) of freq IS GREATER THAN zero  
                    INCREMENT element at row i column j of dp BY element at row (i MINUS one) column (j MINUS one) of dp MULTIPLIED BY element at key element at position (i MINUS one) of target of element at position (j MINUS one) of freq  
                    SET element at row i column j of dp TO element at row i column j of dp MODULO MOD  
                END IF  
            END FOR  
        END FOR  
        RETURN element at row m column n of dp  
    END FUNCTION  
END CLASS