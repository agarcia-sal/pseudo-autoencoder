CLASS Solution  
    FUNCTION calcEquation(equations, values, queries)  
        SET graph TO a new default dictionary where each key maps to a dictionary  
        FOR each pair of variables A and B and corresponding value in the pairing of equations and values  
            SET the element at key B of the dictionary at key A in graph TO the value  
            SET the element at key A of the dictionary at key B in graph TO one DIVIDED BY the value  
        END FOR  
        
        FUNCTION dfs(start, end, visited)  
            IF start is NOT IN graph OR end is NOT IN graph THEN  
                RETURN negative one point zero  
            END IF  
            IF start EQUALS end THEN  
                RETURN one point zero  
            END IF  
            ADD start TO visited  
            FOR each neighbor and weight in the elements of the dictionary at key start in graph  
                IF neighbor is NOT IN visited THEN  
                    SET result TO the value RETURNED BY dfs(neighbor, end, visited)  
                    IF result is NOT EQUAL TO negative one point zero THEN  
                        RETURN weight MULTIPLIED BY result  
                    END IF  
                END IF  
            END FOR  
            REMOVE start FROM visited  
            RETURN negative one point zero  
        END FUNCTION  
        
        SET results TO an empty list  
        FOR each query in queries  
            SET start and end TO the first and second elements of query  
            SET visited TO a new empty set  
            SET result TO the value RETURNED BY dfs(start, end, visited)  
            APPEND result TO results  
        END FOR  
        
        RETURN results  
    END FUNCTION  
END CLASS