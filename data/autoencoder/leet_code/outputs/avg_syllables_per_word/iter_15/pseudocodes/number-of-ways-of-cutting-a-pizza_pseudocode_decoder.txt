CLASS Solution  
    FUNCTION ways(pizza, k)  
        FUNCTION dfs(i, j, k)  
            IF k EQUALS zero  
                RETURN one IF the NUMBER OF apple PIECES IN the SUBSECTION DEFINED BY i TO m AND j TO n IS GREATER THAN zero ELSE zero  
            END IF  
            SET ans TO zero  
            FOR x FROM i PLUS one TO m MINUS one  
                IF the NUMBER OF apple PIECES IN the SUBSECTION DEFINED BY x TO m AND j TO n IS GREATER THAN zero  
                    INCREMENT ans BY the RESULT OF calling dfs WITH x AND j AND k MINUS one  
                END IF  
            END FOR  
            FOR y FROM j PLUS one TO n MINUS one  
                IF the NUMBER OF apple PIECES IN the SUBSECTION DEFINED BY i TO m AND y TO n IS GREATER THAN zero  
                    INCREMENT ans BY the RESULT OF calling dfs WITH i AND y AND k MINUS one  
                END IF  
            END FOR  
            RETURN ans MODULO the VALUE OF mod  
        END FUNCTION  

        SET mod TO one billion PLUS seven  
        SET m TO the LENGTH OF pizza  
        SET n TO the LENGTH OF element at position zero of pizza  
        INITIALIZE s AS a TWO DIMENSIONAL LIST OF zero VALUES WITH DIMENSIONS m PLUS one BY n PLUS one  
        FOR i FROM one TO m  
            LET row BE the ELEMENT at position i MINUS one of pizza  
            FOR j FROM one TO n  
                LET c BE the ELEMENT at position j MINUS one of row  
                SET element at position i AND j of s TO the VALUE of element at position i MINUS one AND j of s PLUS the VALUE of element at position i AND j MINUS one of s MINUS the VALUE of element at position i MINUS one AND j MINUS one of s PLUS one IF c EQUALS the APPLE CHARACTER ELSE zero  
            END FOR  
        END FOR  
        RETURN the RESULT OF calling dfs WITH zero AND zero AND k MINUS one  
    END FUNCTION  
END CLASS