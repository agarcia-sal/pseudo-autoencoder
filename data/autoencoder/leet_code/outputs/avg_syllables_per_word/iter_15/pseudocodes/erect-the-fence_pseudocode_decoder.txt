CLASS Solution  
    FUNCTION outerTrees(trees)  
        FUNCTION cross(i, j, k)  
            SET a TO element at position i of trees  
            SET b TO element at position j of trees  
            SET c TO element at position k of trees  
            RETURN the result of the expression OPEN PARENTHESIS the first element of b MINUS the first element of a CLOSE PARENTHESIS MULTIPLIED BY the difference between the second element of c AND the second element of b MINUS the product of the difference between the second element of b AND the second element of a AND the difference between the first element of c AND the first element of b  
        END FUNCTION

        SET n TO the LENGTH OF trees  
        IF n LESS THAN four  
            RETURN trees  
        END IF  

        SORT trees in ascending order by default  
        SET vis TO a list of boolean values FALSE with length n  
        SET stk TO a list containing the integer zero  

        FOR i FROM one TO n MINUS one  
            WHILE the LENGTH OF stk GREATER THAN one AND the value of cross at positions element at position LENGTH OF stk MINUS two of stk, element at position LENGTH OF stk MINUS one of stk, and i LESS THAN zero  
                SET the element at position of pop from stk to FALSE in vis  
            END WHILE  
            SET the element at position i of vis TO TRUE  
            APPEND i TO stk  
        END FOR  

        SET m TO the LENGTH OF stk  
        FOR i FROM n MINUS two DOWN TO zero  
            IF the element at position i of vis IS TRUE  
                CONTINUE to next iteration  
            END IF  
            WHILE the LENGTH OF stk GREATER THAN m AND the value of cross at positions element at position LENGTH OF stk MINUS two of stk, element at position LENGTH OF stk MINUS one of stk, and i LESS THAN zero  
                POP the last element from stk  
            END WHILE  
            APPEND i TO stk  
        END FOR  

        POP the last element from stk  
        SET result TO an empty list  
        FOR each index i IN stk  
            APPEND the element at position i of trees TO result  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS