CLASS Solution  
    FUNCTION kthSmallestProduct(nums1 AS List of INTEGER, nums2 AS List of INTEGER, k AS INTEGER) RETURNS INTEGER  
        FUNCTION count(p AS INTEGER) RETURNS INTEGER  
            SET cnt TO zero  
            SET n TO the LENGTH OF nums2  
            FOR each element x IN nums1  
                IF x IS GREATER THAN zero  
                    INCREMENT cnt BY the POSITION IN nums2 WHERE p DIVIDED BY x WOULD BE INSERTED TO THE RIGHT TO KEEP ORDER  
                ELSE IF x IS LESS THAN zero  
                    INCREMENT cnt BY n MINUS the POSITION IN nums2 WHERE p DIVIDED BY x WOULD BE INSERTED TO THE LEFT TO KEEP ORDER  
                ELSE  
                    INCREMENT cnt BY n MULTIPLIED BY the VALUE one IF p IS GREATER THAN OR EQUAL TO zero OTHERWISE zero  
                END IF  
            END FOR  
            RETURN cnt  
        END FUNCTION  

        SET mx TO the MAXIMUM OF the ABSOLUTE VALUE OF element at POSITION zero OF nums1 AND the ABSOLUTE VALUE OF element at POSITION the LAST POSITION OF nums1  
        SET mx TO mx MULTIPLIED BY the MAXIMUM OF the ABSOLUTE VALUE OF element at POSITION zero OF nums2 AND the ABSOLUTE VALUE OF element at POSITION the LAST POSITION OF nums2  

        RETURN the POSITION IN THE RANGE FROM NEGATIVE mx TO mx INCLUDING THE END WHERE k WOULD BE INSERTED TO THE LEFT ACCORDING TO THE count FUNCTION MINUS mx  
    END FUNCTION  
END CLASS