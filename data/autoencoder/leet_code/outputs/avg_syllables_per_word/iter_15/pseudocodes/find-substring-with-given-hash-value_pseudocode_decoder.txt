CLASS Solution  
    FUNCTION subStrHash WITH PARAMETERS s power modulo k hashValue  
        FUNCTION val WITH PARAMETER c  
            RETURN the Unicode code point of character c MINUS the Unicode code point of character a PLUS one  
        END FUNCTION  
        
        SET n TO the LENGTH OF s  
        SET current_hash TO zero  
        SET p_pow TO one  
        
        FOR i FROM n MINUS k TO n MINUS one  
            SET current_hash TO the remainder after division of the sum of current_hash PLUS the value of the element at position i of s MULTIPLIED BY p_pow BY modulo  
            IF i IS LESS THAN n MINUS one  
                SET p_pow TO the remainder after division of p_pow MULTIPLIED BY power BY modulo  
            END IF  
        END FOR  
        
        SET start_index TO n MINUS k  
        
        IF current_hash EQUALS hashValue  
            RETURN the substring from position start_index TO the sum of start_index PLUS k of s  
        END IF  
        
        SET p_pow_k_minus_1 TO p_pow  
        
        FOR i FROM n MINUS k MINUS one DOWN TO zero  
            SET current_hash TO the remainder after division of current_hash MINUS the value of the element at position i PLUS k of s MULTIPLIED BY p_pow_k_minus_1 BY modulo  
            SET current_hash TO the remainder after division of current_hash MULTIPLIED BY power PLUS the value of the element at position i of s BY modulo  
            IF current_hash EQUALS hashValue  
                SET start_index TO i  
            END IF  
        END FOR  
        
        RETURN the substring from position start_index TO the sum of start_index PLUS k of s  
    END FUNCTION  
END CLASS