CLASS Solution  
    FUNCTION pathsWithMaxScore(board)  
        SET MOD TO one billion plus seven  
        SET n TO the LENGTH OF board  
        SET dp TO a two dimensional array of size n by n where each element is a list containing negative infinity and zero  
        SET the element at position n minus one n minus one of dp TO a list containing zero and one  
        FOR i FROM n minus one DOWN TO zero  
            FOR j FROM n minus one DOWN TO zero  
                IF the element at position i of board at position j IN the list containing character X AND character S THEN  
                    CONTINUE to the next iteration  
                END IF  
                IF the element at position i of board at position j EQUALS character E THEN  
                    SET value TO zero  
                ELSE  
                    SET value TO the integer conversion of the element at position i of board at position j  
                END IF  
                FOR each pair x y IN the list containing pair one zero pair zero one pair one one  
                    SET ni TO i PLUS x  
                    SET nj TO j PLUS y  
                    IF ni IS GREATER THAN OR EQUAL TO zero AND ni IS LESS THAN n AND nj IS GREATER THAN OR EQUAL TO zero AND nj IS LESS THAN n THEN  
                        IF the first element of the list at position ni nj of dp IS GREATER THAN the first element of the list at position i j of dp THEN  
                            SET the element at position i j of dp TO a list containing the first element of the list at position ni nj of dp PLUS value and the second element of the list at position ni nj of dp  
                        ELSE IF the first element of the list at position ni nj of dp EQUALS the first element of the list at position i j of dp THEN  
                            SET the second element of the list at position i j of dp TO the sum of the second element of the list at position i j of dp AND the second element of the list at position ni nj of dp MODULO MOD  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        IF the first element of the list at position zero zero of dp EQUALS negative infinity THEN  
            RETURN a list containing zero and zero  
        END IF  
        RETURN the list at position zero zero of dp  
    END FUNCTION  
END CLASS