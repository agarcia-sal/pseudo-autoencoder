CLASS Solution  
    FUNCTION maxEqualFreq(nums)  
        SET count TO a new counter data structure to store frequency of each number  
        SET freq TO a new counter data structure to store frequency of each frequency value  
        SET max_len TO zero  

        FOR each index i FROM zero TO the length of nums MINUS one  
            SET num TO element at position i of nums  
            INCREMENT the frequency count of num in count by one  

            IF frequency count of num in count GREATER THAN one  
                DECREMENT the frequency count of frequency count of num MINUS one in freq by one  
                IF frequency count of frequency count of num MINUS one in freq EQUALS zero  
                    REMOVE frequency count of num MINUS one FROM freq  
                END IF  
            END IF  

            INCREMENT the frequency count of frequency count of num in count in freq by one  

            IF the number of distinct keys in freq EQUALS one AND (freq has key one OR the first value of freq EQUALS one)  
                SET max_len TO i PLUS one  
            ELSE IF the number of distinct keys in freq EQUALS two AND ((freq has key one AND the value for key one in freq EQUALS one) OR (the difference BETWEEN the maximum key in freq AND the minimum key in freq EQUALS one AND the value associated with the maximum key in freq EQUALS one))  
                SET max_len TO i PLUS one  
            END IF  
        END FOR  

        RETURN max_len  
    END FUNCTION  
END CLASS