CLASS Solution  
    FUNCTION kthSmallest(mat AS List OF List OF Integer, k AS Integer) RETURNS Integer  
        SET m TO LENGTH OF mat  
        SET n TO LENGTH OF element at position zero of mat  
        SET initial_sum TO the SUM OF element at position zero of each row IN mat  
        SET initial_indices TO a tuple of zero for each integer FROM zero TO m MINUS one  
        SET min_heap TO a list containing the tuple of initial_sum AND initial_indices  
        SET visited TO a set containing initial_indices  
        
        WHILE k GREATER THAN zero HOLDS  
            SET current_tuple TO the element REMOVED FROM min_heap WITH THE SMALLEST current sum  
            SET current_sum TO the first element of current_tuple  
            SET indices TO the second element of current_tuple  
            DECREMENT k BY one  
            
            IF k EQUALS zero THEN  
                RETURN current_sum  
            END IF  
            
            FOR i FROM zero TO m MINUS one  
                IF the element at position i of indices PLUS one IS LESS THAN n THEN  
                    SET new_indices TO a list copied FROM indices  
                    INCREMENT the element at position i of new_indices BY one  
                    SET new_indices_tuple TO a tuple converted FROM new_indices  
                    SET old_element TO the element at position specified by the element at position i of indices of row i of mat  
                    SET new_element TO the element at position specified by the element at position i of new_indices of row i of mat  
                    SET new_sum TO current_sum MINUS old_element PLUS new_element  
                    
                    IF new_indices_tuple NOT IN visited THEN  
                        ADD new_indices_tuple TO visited  
                        ADD the tuple of new_sum AND new_indices_tuple TO min_heap MAINTAINING MIN HEAP PROPERTY  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN negative one  
    END FUNCTION  
END CLASS