CLASS Solution  
    FUNCTION profitableSchemes(n, minProfit, group, profit)  
        SET MOD TO one billion PLUS seven  
        CALL initialize_two_dimensional_list_named dp WITH dimensions n PLUS one BY minProfit PLUS one FILLED WITH zero  
        FOR index i FROM zero TO n  
            SET element at position zero of dp at position i TO one  
        END FOR  
        FOR each pair of elements p AND g IN profit AND group respectively  
            FOR index i FROM n DOWN TO g  
                FOR index j FROM minProfit DOWN TO zero  
                    SET temporary_profit_threshold TO the GREATER OF zero AND j MINUS p  
                    SET element at position j of dp at position i TO the element at position j of dp at position i PLUS the element at position temporary_profit_threshold of dp at position i MINUS g  
                    SET element at position j of dp at position i TO element at position j of dp at position i MODULO MOD  
                END FOR  
            END FOR  
        END FOR  
        RETURN element at position minProfit of dp at position n  
    END FUNCTION  
END CLASS