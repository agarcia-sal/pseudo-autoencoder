CLASS Solution  
    FUNCTION leastBricks WITH PARAMETERS wall  
        INITIALIZE gap_counts AS a default dictionary that returns zero for missing keys  
        FOR each row IN wall  
            SET total TO zero  
            FOR each brick IN all elements of row except the last one  
                SET total TO total PLUS brick  
                INCREMENT the element at position total of gap_counts BY one  
            END FOR  
        END FOR  
        SET max_gaps TO the maximum value among all values of gap_counts OR zero if gap_counts is empty  
        RETURN the LENGTH OF wall MINUS max_gaps  
    END FUNCTION  
END CLASS