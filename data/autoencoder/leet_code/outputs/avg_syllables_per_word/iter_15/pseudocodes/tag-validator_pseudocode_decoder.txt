CLASS Solution  
    FUNCTION isValid(code)  
        IMPORT regular expression module  
        SET cdata pattern TO a pattern matching opening bracket, exclamation mark, uppercase letters, any characters lazily, and closing bracket  
        REMOVE all substrings matching cdata pattern from code  
        INITIALIZE empty list stack  
        SET integer i TO zero  
        WHILE i LESS THAN the LENGTH of code holds  
            IF the element at position i of code EQUALS less than symbol  
                SET integer j TO the position of greater than symbol in code starting from position i incremented by one  
                IF j EQUALS negative one  
                    RETURN false  
                END IF  
                SET tag content TO the substring from position i plus one TO position j minus one of code  
                IF tag content IS empty  
                    RETURN false  
                END IF  
                IF the element at position zero of tag content EQUALS forward slash  
                    SET tag name TO the substring from position one TO the end of tag content  
                    IF stack IS empty OR the element at the last position of stack DOES NOT EQUAL tag name  
                        RETURN false  
                    END IF  
                    REMOVE the element at the last position FROM stack  
                ELSE IF the element at position zero of tag content EQUALS exclamation mark  
                    RETURN false  
                ELSE  
                    IF the LENGTH of tag content IS LESS THAN one OR GREATER THAN nine OR tag content IS NOT composed of uppercase letters only  
                        RETURN false  
                    END IF  
                    APPEND tag content TO stack  
                END IF  
                SET i TO j PLUS one  
            ELSE  
                INCREMENT i BY one  
            END IF  
        END WHILE  
        RETURN the logical negation of stack IS NOT empty AND the COUNT of all matching substrings in code for the pattern opening tag with uppercase letters followed by any characters followed by matching closing tag with uppercase letters IS GREATER THAN zero  
    END FUNCTION  
END CLASS