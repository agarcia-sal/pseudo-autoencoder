CLASS Solution  
    FUNCTION numberOfCombinations WITH parameter num  
        SET MODULO TO ten RAISED TO THE POWER OF nine PLUS seven  
        SET n TO the LENGTH OF num  
        SET memoization_dictionary TO an empty dictionary  
        
        FUNCTION dp WITH parameters index AND previous_length  
            IF index EQUALS n THEN  
                RETURN one  
            END IF  
            
            IF the PAIR of index AND previous_length IS IN memoization_dictionary THEN  
                RETURN the VALUE ASSOCIATED WITH the PAIR of index AND previous_length IN memoization_dictionary  
            END IF  
            
            SET count TO zero  
            
            FOR length FROM one TO n MINUS index DO  
                IF the element at position index OF num EQUALS the digit zero THEN  
                    BREAK the loop  
                END IF  
                
                SET current_number TO the SUBSTRING from position index TO index PLUS length OF num  
                
                IF previous_length EQUALS zero OR current_number IS GREATER THAN OR EQUAL TO the SUBSTRING from position index MINUS previous_length TO index OF num THEN  
                    SET count TO the REMAINDER AFTER DIVIDING the SUM of count AND the RESULT OF dp CALLED WITH index PLUS length AND length BY MODULO  
                END IF  
            END FOR  
            
            SET the VALUE ASSOCIATED WITH the PAIR of index AND previous_length IN memoization_dictionary TO count  
            RETURN count  
        END FUNCTION  
        
        RETURN the RESULT OF dp CALLED WITH zero AND zero  
    END FUNCTION  
END CLASS