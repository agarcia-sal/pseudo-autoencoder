CLASS Solution
    FUNCTION constrainedSubsetSum(nums, k)
        SET n TO LENGTH OF nums
        SET dp TO LIST OF n ZEROS
        SET dp[0] TO nums[0]
        SET max_sum TO nums[0]
        SET q TO DEQUE WITH ELEMENT 0

        FOR i FROM 1 TO n - 1
            IF dp[q[0]] > 0 THEN
                SET dp[i] TO nums[i] + dp[q[0]]
            ELSE
                SET dp[i] TO nums[i]
            END IF

            IF dp[i] > max_sum THEN
                SET max_sum TO dp[i]
            END IF

            WHILE q IS NOT EMPTY AND dp[i] >= dp[q[-1]] DO
                REMOVE LAST ELEMENT FROM q
            END WHILE

            APPEND i TO q

            IF q[0] == i - k THEN
                REMOVE FIRST ELEMENT FROM q
            END IF
        END FOR

        RETURN max_sum
    END FUNCTION
END CLASS