```
CLASS Solution
    FUNCTION solve(nums, queries)
        SET MOD TO 10^9 + 7
        SET n TO LENGTH OF nums
        SET max_y TO MAXIMUM y VALUE FROM queries
        SET prefix_sums TO A LIST OF LENGTH (max_y + 1), EACH ELEMENT IS A LIST OF LENGTH n FILLED WITH 0

        FOR y FROM 1 TO max_y INCLUSIVE
            FOR i FROM n - 1 DOWNTO 0
                IF i + y < n THEN
                    SET prefix_sums[y][i] TO nums[i] PLUS prefix_sums[y][i + y]
                ELSE
                    SET prefix_sums[y][i] TO nums[i]

        SET answer TO EMPTY LIST
        FOR EACH (x, y) IN queries
            APPEND prefix_sums[y][x] MODULO MOD TO answer

        RETURN answer
    END FUNCTION
END CLASS
```