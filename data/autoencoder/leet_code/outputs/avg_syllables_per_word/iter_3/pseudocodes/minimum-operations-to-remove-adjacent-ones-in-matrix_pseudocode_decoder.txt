CLASS Solution
    FUNCTION minimumOperations(grid)
        FUNCTION bfs()
            SET queue TO empty deque
            FOR u FROM 0 TO n - 1
                IF match[u] EQUALS -1
                    SET dist[u] TO 0
                    APPEND u TO queue
                ELSE
                    SET dist[u] TO infinity
            SET dist[-1] TO infinity
            WHILE queue IS NOT empty
                SET u TO queue POP left
                IF dist[u] LESS THAN dist[-1]
                    FOR each v IN graph[u]
                        IF dist[match[v]] EQUALS infinity
                            SET dist[match[v]] TO dist[u] + 1
                            APPEND match[v] TO queue
            RETURN dist[-1] LESS THAN infinity
        END FUNCTION

        FUNCTION dfs(u)
            IF u IS NOT EQUAL TO -1
                FOR each v IN graph[u]
                    IF dist[match[v]] EQUALS dist[u] + 1
                        IF dfs(match[v]) IS true
                            SET match[v] TO u
                            SET match[u] TO v
                            RETURN true
                SET dist[u] TO infinity
                RETURN false
            RETURN true
        END FUNCTION

        SET rows TO LENGTH OF grid
        SET cols TO LENGTH OF grid[0]
        SET n TO rows TIMES cols
        SET graph TO list of empty sets WITH LENGTH n + 1
        SET match TO list of -1 WITH LENGTH n + 1
        SET dist TO list of 0 WITH LENGTH n + 1

        FOR r FROM 0 TO rows - 1
            FOR c FROM 0 TO cols - 1
                IF grid[r][c] EQUALS 1
                    SET u TO r TIMES cols PLUS c
                    FOR each (dr, dc) IN [(-1, 0), (1, 0), (0, -1), (0, 1)]
                        SET nr TO r PLUS dr
                        SET nc TO c PLUS dc
                        IF nr GREATER OR EQUAL TO 0 AND nr LESS THAN rows AND nc GREATER OR EQUAL TO 0 AND nc LESS THAN cols AND grid[nr][nc] EQUALS 1
                            SET v TO nr TIMES cols PLUS nc
                            ADD v TO graph[u]

        SET matching TO 0
        WHILE bfs()
            FOR u FROM 0 TO n - 1
                IF match[u] EQUALS -1 AND dfs(u)
                    INCREMENT matching BY 1

        RETURN matching
    END FUNCTION
END CLASS