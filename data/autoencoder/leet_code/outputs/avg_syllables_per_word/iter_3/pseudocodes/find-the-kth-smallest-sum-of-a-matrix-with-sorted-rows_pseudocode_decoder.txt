CLASS Solution
    FUNCTION kthSmallest(mat, k)
        SET m TO LENGTH OF mat
        SET n TO LENGTH OF mat[0]
        SET initial_sum TO 0
        FOR EACH row IN mat
            INCREMENT initial_sum BY row[0]
        SET min_heap TO [(initial_sum, TUPLE OF ZEROS OF LENGTH m)]
        SET visited TO SET CONTAINING min_heap[0][1]
        
        WHILE k > 0
            SET current_sum, indices TO REMOVE SMALLEST ELEMENT FROM min_heap
            DECREMENT k BY 1
            
            IF k EQUALS 0
                RETURN current_sum
            
            FOR i FROM 0 TO m - 1
                IF indices[i] + 1 < n
                    SET new_indices TO COPY OF indices
                    INCREMENT new_indices[i] BY 1
                    SET new_indices_tuple TO TUPLE OF new_indices
                    SET new_sum TO current_sum MINUS mat[i][indices[i]] PLUS mat[i][new_indices[i]]
                    
                    IF new_indices_tuple NOT IN visited
                        ADD new_indices_tuple TO visited
                        ADD (new_sum, new_indices_tuple) TO min_heap
        
        RETURN -1
    END FUNCTION
END CLASS