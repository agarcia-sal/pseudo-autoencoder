CLASS Solution
    FUNCTION trapRainWater(heightMap: List of List of Integer) RETURNS Integer
        IF heightMap IS EMPTY OR heightMap[0] IS EMPTY
            RETURN 0
        END IF

        SET m TO LENGTH OF heightMap
        SET n TO LENGTH OF heightMap[0]
        SET visited TO 2D LIST OF FALSE VALUES WITH DIMENSIONS m BY n
        SET min_heap TO EMPTY LIST

        FOR i FROM 0 TO m MINUS 1
            ADD (heightMap[i][0], i, 0) TO min_heap
            ADD (heightMap[i][n MINUS 1], i, n MINUS 1) TO min_heap
            SET visited[i][0] TO TRUE
            SET visited[i][n MINUS 1] TO TRUE
        END FOR

        FOR j FROM 0 TO n MINUS 1
            ADD (heightMap[0][j], 0, j) TO min_heap
            ADD (heightMap[m MINUS 1][j], m MINUS 1, j) TO min_heap
            SET visited[0][j] TO TRUE
            SET visited[m MINUS 1][j] TO TRUE
        END FOR

        SET directions TO LIST OF (−1,0), (1,0), (0,−1), (0,1)
        SET water_trapped TO 0

        WHILE min_heap IS NOT EMPTY
            REMOVE AND SET (height, x, y) TO the smallest element FROM min_heap

            FOR EACH (dx, dy) IN directions
                SET nx TO x PLUS dx
                SET ny TO y PLUS dy

                IF nx IS BETWEEN 0 AND m MINUS 1 AND ny IS BETWEEN 0 AND n MINUS 1 AND visited[nx][ny] IS FALSE
                    SET visited[nx][ny] TO TRUE
                    INCREMENT water_trapped BY MAXIMUM OF 0 AND (height MINUS heightMap[nx][ny])
                    ADD (MAXIMUM OF height AND heightMap[nx][ny], nx, ny) TO min_heap
                END IF
            END FOR
        END WHILE

        RETURN water_trapped
    END FUNCTION
END CLASS