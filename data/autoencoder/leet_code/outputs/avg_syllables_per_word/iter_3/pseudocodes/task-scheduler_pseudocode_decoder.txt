```
CLASS Solution
    FUNCTION leastInterval(tasks: List of String, n: Integer) RETURNS Integer
        SET task_counts TO frequency count of each task in tasks
        SET max_heap TO list of negative values of task_counts
        CONVERT max_heap into a heap structure

        SET time TO 0
        SET queue TO empty list

        WHILE max_heap IS NOT empty OR queue IS NOT empty
            WHILE queue IS NOT empty AND first element's time EQUALS time
                REMOVE first element FROM queue AND UNPACK as _, count
                IF count IS less than 0
                    ADD count INTO max_heap as heap element
            END WHILE

            IF max_heap IS NOT empty
                REMOVE smallest element FROM max_heap AND SET as count
                INCREMENT count BY 1
                IF count IS less than 0
                    APPEND tuple (time + n + 1, count) TO queue
            END IF

            INCREMENT time BY 1
        END WHILE

        RETURN time
    END FUNCTION
END CLASS
```