CLASS Solution
    FUNCTION longestObstacleCourseAtEachPosition(obstacles)
        SET n TO LENGTH OF obstacles
        SET ans TO empty list
        SET increasing_subseq TO empty list

        FOR each obstacle IN obstacles
            SET idx TO POSITION TO INSERT obstacle IN increasing_subseq TO KEEP IT NON-DECREASING

            IF idx EQUALS LENGTH OF increasing_subseq THEN
                APPEND obstacle TO increasing_subseq
            ELSE
                SET increasing_subseq[idx] TO obstacle
            END IF

            APPEND idx PLUS 1 TO ans
        END FOR

        RETURN ans
    END FUNCTION
END CLASS