CLASS Solution
    FUNCTION findRedundantDirectedConnection(edges)
        FUNCTION find(parent, i)
            IF parent[i] IS NOT i THEN
                SET parent[i] TO find(parent, parent[i])
            END IF
            RETURN parent[i]
        END FUNCTION

        FUNCTION union(parent, rank, x, y)
            SET rootX TO find(parent, x)
            SET rootY TO find(parent, y)
            IF rootX IS NOT rootY THEN
                IF rank[rootX] > rank[rootY] THEN
                    SET parent[rootY] TO rootX
                ELSE IF rank[rootX] < rank[rootY] THEN
                    SET parent[rootX] TO rootY
                ELSE
                    SET parent[rootY] TO rootX
                    INCREMENT rank[rootX] BY 1
                END IF
                RETURN True
            END IF
            RETURN False
        END FUNCTION

        SET n TO LENGTH OF edges
        SET parent TO LIST OF INTEGERS FROM 0 TO n
        SET rank TO LIST OF ZEROS WITH LENGTH n+1

        SET candidate1 TO None
        SET candidate2 TO None
        SET last TO None

        FOR EACH (u, v) IN edges DO
            IF parent[v] IS NOT v THEN
                SET candidate1 TO [parent[v], v]
                SET candidate2 TO [u, v]
            ELSE
                IF union(parent, rank, u, v) IS False THEN
                    SET last TO [u, v]
                END IF
            END IF
        END FOR

        IF candidate1 IS None THEN
            RETURN last
        END IF

        IF last IS NOT None THEN
            RETURN candidate1
        END IF

        RETURN candidate2
    END FUNCTION
END CLASS