CLASS Solution
    FUNCTION minAbbreviation(target, dictionary)
        FUNCTION is_valid_abbr(s, abbr)
            SET i TO 0
            SET j TO 0
            WHILE i LESS THAN LENGTH OF s AND j LESS THAN LENGTH OF abbr
                IF abbr[j] IS A DIGIT
                    IF abbr[j] IS '0'
                        RETURN False
                    SET shift TO 0
                    WHILE j LESS THAN LENGTH OF abbr AND abbr[j] IS A DIGIT
                        SET shift TO shift MULTIPLIED BY 10 PLUS INTEGER VALUE OF abbr[j]
                        INCREMENT j BY 1
                    INCREMENT i BY shift
                ELSE
                    IF s[i] NOT EQUAL TO abbr[j]
                        RETURN False
                    INCREMENT i BY 1
                    INCREMENT j BY 1
            RETURN i EQUALS LENGTH OF s AND j EQUALS LENGTH OF abbr
        END FUNCTION

        FUNCTION generate_abbrs(word, length, abbr, index, skip_count)
            IF index EQUALS length
                IF skip_count GREATER THAN 0
                    SET abbr TO abbr CONCATENATED WITH STRING VALUE OF skip_count
                APPEND abbr TO abbrs
                RETURN
            CALL generate_abbrs(word, length, abbr, index INCREMENTED BY 1, skip_count INCREMENTED BY 1)
            IF skip_count GREATER THAN 0
                SET abbr TO abbr CONCATENATED WITH STRING VALUE OF skip_count
            CALL generate_abbrs(word, length, abbr CONCATENATED WITH word[index], index INCREMENTED BY 1, 0)
        END FUNCTION

        FUNCTION find_unique_abbr()
            FOR length FROM 1 TO LENGTH OF target
                SET abbrs TO EMPTY LIST
                CALL generate_abbrs(target, LENGTH OF target, EMPTY STRING, 0, 0)
                SET min_abbr TO NULL
                SET min_length TO INFINITY
                FOR EACH abbr IN abbrs
                    IF ALL is_valid_abbr(word, abbr) RETURNS False FOR EACH word IN filtered_dict
                        IF LENGTH OF abbr LESS THAN min_length
                            SET min_length TO LENGTH OF abbr
                            SET min_abbr TO abbr
                IF min_abbr IS NOT NULL
                    RETURN min_abbr
        END FUNCTION

        SET filtered_dict TO LIST OF word IN dictionary WHERE LENGTH OF word EQUALS LENGTH OF target
        SET abbrs TO EMPTY LIST
        RETURN find_unique_abbr()
    END FUNCTION
END CLASS