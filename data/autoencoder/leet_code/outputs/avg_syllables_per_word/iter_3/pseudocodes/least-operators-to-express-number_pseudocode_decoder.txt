CLASS Solution
    FUNCTION leastOpsExpressTarget(x, target)
        FUNCTION dp(target)
            IF target == 0 THEN
                RETURN -1
            END IF

            IF target < x THEN
                RETURN MINIMUM OF (2 * target - 1) AND (2 * (x - target))
            END IF

            SET power TO 1
            WHILE x RAISED TO power IS LESS THAN OR EQUAL TO target DO
                INCREMENT power BY 1
            END WHILE
            DECREMENT power BY 1

            SET res TO dp(target MINUS x RAISED TO power) PLUS power

            IF (x RAISED TO (power + 1)) MINUS target IS LESS THAN target THEN
                SET res TO MINIMUM OF res AND dp(x RAISED TO (power + 1) MINUS target) PLUS power PLUS 1
            END IF

            RETURN res
        END FUNCTION

        RETURN dp(target)
    END FUNCTION
END CLASS