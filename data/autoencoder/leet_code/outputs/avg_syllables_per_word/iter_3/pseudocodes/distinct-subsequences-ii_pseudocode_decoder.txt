```
CLASS Solution
    FUNCTION distinctSubseqII(s)
        SET MOD TO 10^9 + 7
        SET n TO LENGTH OF s
        SET dp TO LIST OF SIZE (n + 1) FILLED WITH 0
        SET dp[0] TO 1
        SET last TO EMPTY MAP

        FOR i FROM 1 TO n
            SET char TO s[i - 1]
            SET dp[i] TO (2 MULTIPLIED BY dp[i - 1]) MODULO MOD

            IF char EXISTS IN last THEN
                SET dp[i] TO (dp[i] MINUS dp[last[char] - 1] PLUS MOD) MODULO MOD
            END IF

            SET last[char] TO i
        END FOR

        RETURN (dp[n] MINUS 1) MODULO MOD
    END FUNCTION
END CLASS
```