CLASS Solution
    FUNCTION minMalwareSpread(graph: List of List of int, initial: List of int) RETURNS int
        FUNCTION dfs(node, component)
            IF node IN visited THEN
                RETURN
            END IF
            ADD node TO visited
            ADD node TO component
            FOR neighbor FROM 0 TO LENGTH OF graph MINUS 1
                IF graph[node][neighbor] EQUALS 1 AND neighbor NOT IN visited THEN
                    CALL dfs(neighbor, component)
                END IF
            END FOR
        END FUNCTION

        SET visited TO empty set
        SET components TO empty list
        FOR node FROM 0 TO LENGTH OF graph MINUS 1
            IF node NOT IN visited THEN
                SET component TO empty set
                CALL dfs(node, component)
                APPEND component TO components
            END IF
        END FOR

        SET infected_count TO list of zeroes of size LENGTH OF graph
        FOR node IN initial
            SET infected_count[node] TO 1
        END FOR

        SET component_infected_count TO list of zeroes of size LENGTH OF components
        FOR node IN initial
            FOR i FROM 0 TO LENGTH OF components MINUS 1
                IF node IN components[i] THEN
                    INCREMENT component_infected_count[i] BY 1
                END IF
            END FOR
        END FOR

        SET max_saving TO 0
        SET best_node TO MINIMUM value IN initial
        FOR node IN initial
            FOR i FROM 0 TO LENGTH OF components MINUS 1
                IF node IN components[i] AND component_infected_count[i] EQUALS 1 THEN
                    SET saving TO LENGTH OF components[i]
                    IF saving GREATER THAN max_saving OR (saving EQUALS max_saving AND node LESS THAN best_node) THEN
                        SET max_saving TO saving
                        SET best_node TO node
                    END IF
                END IF
            END FOR
        END FOR

        RETURN best_node
    END FUNCTION
END CLASS