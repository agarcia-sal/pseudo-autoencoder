CLASS Solution
    FUNCTION uniqueLetterString(s)
        SET MOD TO 1000000007
        SET n TO LENGTH OF s

        SET last TO LIST OF 26 ELEMENTS ALL -1
        SET last2 TO LIST OF 26 ELEMENTS ALL -1

        SET result TO 0

        FOR i FROM 0 TO n - 1
            SET char TO s[i]
            SET idx TO ASCII VALUE OF char MINUS ASCII VALUE OF 'A'

            SET contribution TO (i MINUS last[idx]) MULTIPLIED BY (last[idx] MINUS last2[idx])
            SET result TO (result PLUS contribution) MODULO MOD

            SET last2[idx] TO last[idx]
            SET last[idx] TO i

        FOR i FROM 0 TO 25
            SET contribution TO (n MINUS last[i]) MULTIPLIED BY (last[i] MINUS last2[i])
            SET result TO (result PLUS contribution) MODULO MOD

        RETURN result
    END FUNCTION
END CLASS