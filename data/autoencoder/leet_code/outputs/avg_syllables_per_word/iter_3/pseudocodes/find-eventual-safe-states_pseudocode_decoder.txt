CLASS Solution
    FUNCTION eventualSafeNodes(graph)
        FUNCTION is_safe(node)
            IF visited[node] EQUALS 1 THEN
                RETURN False
            END IF
            IF visited[node] EQUALS 2 THEN
                RETURN True
            END IF
            
            SET visited[node] TO 1
            FOR each neighbor IN graph[node]
                IF is_safe(neighbor) IS False THEN
                    RETURN False
                END IF
            END FOR
            
            SET visited[node] TO 2
            RETURN True
        END FUNCTION
        
        SET n TO LENGTH OF graph
        SET visited TO LIST OF SIZE n FILLED WITH 0
        SET safe_nodes TO EMPTY LIST
        
        FOR node FROM 0 TO n MINUS 1
            IF is_safe(node) THEN
                APPEND node TO safe_nodes
            END IF
        END FOR
        
        RETURN safe_nodes
    END FUNCTION
END CLASS