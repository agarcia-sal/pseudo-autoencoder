CLASS Solution
    FUNCTION subsetsWithDup(nums)
        SORT nums
        SET result TO empty list
        SET subset TO empty list
        
        FUNCTION dfs(i)
            IF i >= LENGTH OF nums THEN
                APPEND COPY OF subset TO result
                RETURN
            END IF
            
            APPEND nums[i] TO subset
            CALL dfs(i + 1)
            
            REMOVE last element FROM subset
            WHILE i + 1 < LENGTH OF nums AND nums[i] EQUALS nums[i + 1] DO
                INCREMENT i BY 1
            END WHILE
            CALL dfs(i + 1)
        END FUNCTION
        
        CALL dfs(0)
        RETURN result
    END FUNCTION
END CLASS