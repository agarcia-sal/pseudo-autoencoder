CLASS Solution
    FUNCTION minimumIncompatibility(nums: List[int], k: int)
        SET n TO LENGTH OF nums
        SET subset_size TO n DIVIDED BY k

        IF any count of nums elements is greater than k
            RETURN -1

        SET subset_incompatibility TO empty dictionary
        FOR mask FROM 0 TO (2 TO THE POWER OF n) MINUS 1
            IF count of set bits in mask EQUALS subset_size
                SET elements TO list of nums[i] WHERE i FROM 0 TO n - 1 AND bit i in mask IS SET
                IF number of unique elements EQUALS subset_size
                    SET incompatibility TO maximum element MINUS minimum element in elements
                    SET subset_incompatibility[mask] TO incompatibility

        SET dp TO list of size (2 TO THE POWER OF n) FILLED WITH infinity
        SET dp[0] TO 0

        FOR mask FROM 0 TO (2 TO THE POWER OF n) MINUS 1
            IF count of set bits in mask MODULO subset_size NOT EQUAL 0
                CONTINUE to next iteration
            FOR each subset_mask IN subset_incompatibility keys
                IF subset_mask is a subset of mask
                    SET dp[mask] TO minimum of dp[mask] and dp[mask XOR subset_mask] PLUS subset_incompatibility[subset_mask]

        IF dp[(2 TO THE POWER OF n) MINUS 1] IS NOT infinity
            RETURN dp[(2 TO THE POWER OF n) MINUS 1]
        ELSE
            RETURN -1
    END FUNCTION
END CLASS