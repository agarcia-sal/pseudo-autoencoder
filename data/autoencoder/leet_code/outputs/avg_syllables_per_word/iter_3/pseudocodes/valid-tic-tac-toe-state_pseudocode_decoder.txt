CLASS Solution
    FUNCTION validTicTacToe(board)
        SET countX TO 0
        SET countO TO 0
        FOR each row IN board
            INCREMENT countX BY number of times 'X' appears in row
            INCREMENT countO BY number of times 'O' appears in row
        IF countX < countO OR countX > countO + 1
            RETURN False
        FUNCTION check_win(player)
            FOR each row IN board
                IF row equals player repeated 3 times
                    RETURN True
            FOR col FROM 0 TO 2
                IF board[0][col] equals player AND board[1][col] equals player AND board[2][col] equals player
                    RETURN True
            IF board[0][0] equals player AND board[1][1] equals player AND board[2][2] equals player
                RETURN True
            IF board[0][2] equals player AND board[1][1] equals player AND board[2][0] equals player
                RETURN True
            RETURN False
        SET winX TO result of check_win('X')
        SET winO TO result of check_win('O')
        IF winX AND winO
            RETURN False
        IF winX AND countX equals countO
            RETURN False
        IF winO AND countX not equals countO
            RETURN False
        RETURN True
    END FUNCTION
END CLASS