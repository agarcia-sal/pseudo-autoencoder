CLASS Solution
    FUNCTION maxNumber(nums1, nums2, k)
        FUNCTION maxSingleArray(nums, k)
            SET drop TO LENGTH OF nums MINUS k
            SET stack TO empty list
            FOR each num IN nums
                WHILE drop GREATER THAN 0 AND stack NOT EMPTY AND last element of stack LESS THAN num
                    REMOVE last element FROM stack
                    DECREMENT drop BY 1
                END WHILE
                APPEND num TO stack
            END FOR
            RETURN first k elements FROM stack
        END FUNCTION

        FUNCTION merge(arr1, arr2)
            RETURN list constructed by repeatedly taking the maximum between arr1 and arr2 and removing the first element, until total length consumed
        END FUNCTION

        SET max_number TO empty list
        FOR i FROM 0 TO k INCLUSIVE
            IF i LESS THAN OR EQUAL TO LENGTH OF nums1 AND (k MINUS i) LESS THAN OR EQUAL TO LENGTH OF nums2
                SET candidate TO merge(maxSingleArray(nums1, i), maxSingleArray(nums2, k MINUS i))
                SET max_number TO the maximum of max_number and candidate considering lexicographical order
            END IF
        END FOR

        RETURN max_number
    END FUNCTION
END CLASS