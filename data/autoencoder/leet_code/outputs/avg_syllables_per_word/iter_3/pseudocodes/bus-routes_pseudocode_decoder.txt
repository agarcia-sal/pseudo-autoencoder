CLASS Solution
    FUNCTION numBusesToDestination(routes, source, target)
        IF source EQUALS target THEN
            RETURN 0

        SET stop_to_buses TO a mapping with default empty list

        FOR bus INDEX AND route IN routes
            FOR each stop IN route
                APPEND bus TO stop_to_buses[stop]

        SET bus_queue TO an empty queue
        SET visited_buses TO an empty set
        SET visited_stops TO an empty set

        FOR each bus IN stop_to_buses[source]
            APPEND (bus, 1) TO bus_queue
            ADD bus TO visited_buses
            ADD source TO visited_stops

        WHILE bus_queue IS NOT empty
            REMOVE first element FROM bus_queue AND STORE AS (current_bus, bus_count)

            FOR each stop IN routes[current_bus]
                IF stop EQUALS target THEN
                    RETURN bus_count

                IF stop NOT IN visited_stops THEN
                    ADD stop TO visited_stops

                    FOR each next_bus IN stop_to_buses[stop]
                        IF next_bus NOT IN visited_buses THEN
                            ADD next_bus TO visited_buses
                            APPEND (next_bus, bus_count + 1) TO bus_queue

        RETURN -1
    END FUNCTION
END CLASS