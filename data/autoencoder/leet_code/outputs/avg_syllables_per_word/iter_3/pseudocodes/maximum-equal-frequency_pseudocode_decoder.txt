```
CLASS Solution
    FUNCTION maxEqualFreq(nums)
        SET count TO empty counter
        SET freq TO empty counter
        SET max_len TO 0

        FOR i, num IN enumerated nums
            INCREMENT count[num] BY 1

            IF count[num] > 1
                DECREMENT freq[count[num] - 1] BY 1
                IF freq[count[num] - 1] EQUALS 0
                    REMOVE freq[count[num] - 1]
            
            INCREMENT freq[count[num]] BY 1

            IF LENGTH OF freq EQUALS 1 AND (freq CONTAINS 1 OR THE ONLY VALUE IN freq EQUALS 1)
                SET max_len TO i + 1
            ELSE IF LENGTH OF freq EQUALS 2 AND 
                     ((freq CONTAINS 1 AND freq[1] EQUALS 1) OR 
                      (MAXIMUM KEY IN freq MINUS MINIMUM KEY IN freq EQUALS 1 AND freq[MAXIMUM KEY IN freq] EQUALS 1))
                SET max_len TO i + 1

        RETURN max_len
    END FUNCTION
END CLASS
```