CLASS Solution
    FUNCTION candyCrush(board)
        SET R TO LENGTH OF board
        SET C TO LENGTH OF board AT INDEX 0
        SET stable TO FALSE
        
        WHILE NOT stable
            SET stable TO TRUE
            SET to_crush TO EMPTY SET
            
            FOR r FROM 0 TO R - 1
                FOR c FROM 0 TO C - 3
                    IF ABSOLUTE VALUE OF board[r][c] EQUALS ABSOLUTE VALUE OF board[r][c + 1] AND
                       ABSOLUTE VALUE OF board[r][c + 1] EQUALS ABSOLUTE VALUE OF board[r][c + 2] AND
                       ABSOLUTE VALUE OF board[r][c] NOT EQUAL 0
                        SET stable TO FALSE
                        ADD (r, c), (r, c + 1), (r, c + 2) TO to_crush
            
            FOR r FROM 0 TO R - 3
                FOR c FROM 0 TO C - 1
                    IF ABSOLUTE VALUE OF board[r][c] EQUALS ABSOLUTE VALUE OF board[r + 1][c] AND
                       ABSOLUTE VALUE OF board[r + 1][c] EQUALS ABSOLUTE VALUE OF board[r + 2][c] AND
                       ABSOLUTE VALUE OF board[r][c] NOT EQUAL 0
                        SET stable TO FALSE
                        ADD (r, c), (r + 1, c), (r + 2, c) TO to_crush
            
            FOR EACH (r, c) IN to_crush
                SET board[r][c] TO 0
            
            FOR c FROM 0 TO C - 1
                SET wr TO R - 1
                FOR r FROM R - 1 DOWNTO 0
                    IF board[r][c] NOT EQUAL 0
                        SET board[wr][c] TO board[r][c]
                        DECREMENT wr BY 1
                FOR i FROM wr DOWNTO 0
                    SET board[i][c] TO 0
        
        RETURN board
    END FUNCTION
END CLASS