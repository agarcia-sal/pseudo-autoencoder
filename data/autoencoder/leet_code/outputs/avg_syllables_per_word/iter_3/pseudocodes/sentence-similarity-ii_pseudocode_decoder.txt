CLASS Solution
    FUNCTION areSentencesSimilarTwo(sentence1, sentence2, similarPairs)
        IF LENGTH OF sentence1 IS NOT EQUAL TO LENGTH OF sentence2
            RETURN False

        SET parent TO empty dictionary

        FUNCTION find(x)
            IF parent[x] IS NOT EQUAL TO x
                SET parent[x] TO find(parent[x])
            RETURN parent[x]
        END FUNCTION

        FUNCTION union(x, y)
            SET rootX TO find(x)
            SET rootY TO find(y)
            IF rootX IS NOT EQUAL TO rootY
                SET parent[rootY] TO rootX
        END FUNCTION

        FOR EACH pair IN similarPairs
            FOR EACH word IN pair
                IF word NOT IN parent
                    SET parent[word] TO word

        FOR EACH x, y IN similarPairs
            CALL union(x, y)

        FOR EACH w1, w2 IN PARALLEL FROM sentence1 AND sentence2
            IF w1 NOT IN parent
                SET parent[w1] TO w1
            IF w2 NOT IN parent
                SET parent[w2] TO w2
            IF find(w1) IS NOT EQUAL TO find(w2)
                RETURN False

        RETURN True
    END FUNCTION
END CLASS