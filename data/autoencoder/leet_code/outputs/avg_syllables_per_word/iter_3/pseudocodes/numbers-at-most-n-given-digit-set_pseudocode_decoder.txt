CLASS Solution
    FUNCTION atMostNGivenDigitSet(digits, n)
        FUNCTION count_numbers_with_length(length)
            RETURN LENGTH OF digits RAISED TO length
        END FUNCTION

        FUNCTION count_numbers_up_to_n(n)
            SET str_n TO STRING REPRESENTATION OF n
            SET length TO LENGTH OF str_n
            SET count TO 0

            FOR l FROM 1 TO length MINUS 1
                INCREMENT count BY count_numbers_with_length(l)
            END FOR

            FOR i FROM 0 TO length MINUS 1
                SET current_digit TO INTEGER VALUE OF str_n AT POSITION i

                FOR each digit IN digits
                    SET digit_value TO INTEGER VALUE OF digit
                    IF digit_value LESS THAN current_digit
                        INCREMENT count BY count_numbers_with_length(length MINUS i MINUS 1)
                    ELSE IF digit_value EQUALS current_digit
                        IF i EQUALS length MINUS 1
                            INCREMENT count BY 1
                        END IF
                    ELSE
                        BREAK FROM INNER LOOP
                    END IF
                END FOR
            END FOR

            RETURN count
        END FUNCTION

        RETURN count_numbers_up_to_n(n)
    END FUNCTION
END CLASS