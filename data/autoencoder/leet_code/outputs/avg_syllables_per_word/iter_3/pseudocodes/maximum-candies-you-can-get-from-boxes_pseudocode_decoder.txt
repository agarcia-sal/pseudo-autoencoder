CLASS Solution
    FUNCTION maxCandies(status, candies, keys, containedBoxes, initialBoxes)
        SET boxes_we_have TO SET OF initialBoxes
        SET keys_we_have TO EMPTY SET
        SET total_candies TO 0
        SET progress_made TO TRUE
        
        WHILE progress_made IS TRUE
            SET progress_made TO FALSE
            FOR EACH box IN LIST OF boxes_we_have
                IF status AT box IS 1 OR box IN keys_we_have THEN
                    INCREMENT total_candies BY candies AT box
                    ADD ALL keys AT box TO keys_we_have
                    ADD ALL containedBoxes AT box TO boxes_we_have
                    REMOVE box FROM boxes_we_have
                    SET progress_made TO TRUE
                END IF
            END FOR
        END WHILE
        
        RETURN total_candies
    END FUNCTION
END CLASS