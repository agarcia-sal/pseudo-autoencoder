CLASS Solution
    FUNCTION wordSquares(words)
        SET prefix_to_words TO an empty dictionary with default value as empty list
        FOR each word IN words
            FOR i FROM 0 TO LENGTH OF word MINUS 1
                SET prefix TO substring of word FROM start TO i
                APPEND word TO prefix_to_words[prefix]
        SET results TO empty list
        FUNCTION backtrack(square)
            IF LENGTH OF square EQUALS LENGTH OF words[0]
                APPEND square TO results
                RETURN
            SET prefix TO empty string
            FOR each word IN square
                APPEND character at position LENGTH OF square IN word TO prefix
            FOR each candidate IN prefix_to_words[prefix]
                CALL backtrack WITH square APPENDED BY candidate
        FOR each word IN words
            CALL backtrack WITH list containing word
        RETURN results
    END FUNCTION
END CLASS