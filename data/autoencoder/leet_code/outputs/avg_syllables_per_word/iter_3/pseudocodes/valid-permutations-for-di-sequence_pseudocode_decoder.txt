CLASS Solution
    FUNCTION numPermsDISequence(s)
        SET MOD TO 1000000007
        SET n TO LENGTH OF s
        INITIALIZE dp AS 2D LIST WITH DIMENSIONS (n + 1) BY (n + 1), FILLED WITH 0
        
        FOR j FROM 0 TO n
            SET dp[0][j] TO 1
        END FOR
        
        FOR i FROM 1 TO n
            SET prefix_sum TO 0
            IF s[i - 1] EQUALS 'I' THEN
                FOR j FROM 0 TO (n - i)
                    SET prefix_sum TO (prefix_sum + dp[i - 1][j]) MODULO MOD
                    SET dp[i][j] TO prefix_sum
                END FOR
            ELSE
                FOR j FROM (n - i) DOWN TO 0
                    SET prefix_sum TO (prefix_sum + dp[i - 1][j + 1]) MODULO MOD
                    SET dp[i][j] TO prefix_sum
                END FOR
            END IF
        END FOR
        
        SET result TO SUM OF dp[n]
        RETURN result MODULO MOD
    END FUNCTION
END CLASS