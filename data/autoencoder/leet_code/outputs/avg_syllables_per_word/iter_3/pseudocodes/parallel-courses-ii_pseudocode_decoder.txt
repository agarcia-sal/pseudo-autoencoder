```
CLASS Solution
    FUNCTION minNumberOfSemesters(n, relations, k)
        SET graph TO empty mapping with default list
        SET in_degree TO list of size (n + 1) with all zeros
        
        FOR each pair (prevCourse, nextCourse) IN relations
            APPEND nextCourse TO graph[prevCourse]
            INCREMENT in_degree[nextCourse] BY 1
        
        SET queue TO empty double-ended queue
        FOR course FROM 1 TO n
            IF in_degree[course] EQUALS 0 THEN
                APPEND course TO queue
        
        SET semesters TO 0
        
        WHILE queue IS NOT empty
            SET count TO minimum of k and LENGTH OF queue
            FOR i FROM 1 TO count
                SET current_course TO REMOVE first element FROM queue
                FOR each next_course IN graph[current_course]
                    DECREMENT in_degree[next_course] BY 1
                    IF in_degree[next_course] EQUALS 0 THEN
                        APPEND next_course TO queue
            INCREMENT semesters BY 1
        
        RETURN semesters
    END FUNCTION
END CLASS
```