CLASS Solution
    FUNCTION calcEquation(equations, values, queries)
        SET graph TO a new empty dictionary with default value as empty dictionary
        FOR each (a, b) and value IN pairs from equations and values
            SET graph[a][b] TO value
            SET graph[b][a] TO 1.0 DIVIDED BY value
        END FOR

        FUNCTION dfs(start, end, visited)
            IF start NOT IN graph OR end NOT IN graph
                RETURN -1.0
            END IF

            IF start EQUALS end
                RETURN 1.0
            END IF

            ADD start TO visited
            FOR each neighbor and weight IN graph[start]
                IF neighbor NOT IN visited
                    SET result TO dfs(neighbor, end, visited)
                    IF result NOT EQUALS -1.0
                        RETURN weight MULTIPLIED BY result
                    END IF
                END IF
            END FOR
            REMOVE start FROM visited
            RETURN -1.0
        END FUNCTION

        SET results TO empty list
        FOR each query IN queries
            SET start, end TO values in query
            SET visited TO empty set
            SET result TO dfs(start, end, visited)
            APPEND result TO results
        END FOR

        RETURN results
    END FUNCTION
END CLASS