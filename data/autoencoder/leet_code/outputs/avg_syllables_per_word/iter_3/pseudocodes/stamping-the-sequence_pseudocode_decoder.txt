CLASS Solution
    FUNCTION movesToStamp(stamp, target)
        SET m TO LENGTH OF stamp
        SET n TO LENGTH OF target
        SET indeg TO LIST OF m REPEATED (n - m + 1) TIMES
        INITIALIZE q AS EMPTY QUEUE
        SET g TO LIST OF EMPTY LISTS OF SIZE n
        FOR i FROM 0 TO (n - m)
            FOR j, c IN ENUMERATE(stamp)
                IF target[i + j] EQUALS c
                    DECREMENT indeg[i] BY 1
                    IF indeg[i] EQUALS 0
                        APPEND i TO q
                ELSE
                    APPEND i TO g[i + j]
        SET ans TO EMPTY LIST
        SET vis TO LIST OF False OF SIZE n
        WHILE q IS NOT EMPTY
            SET i TO q POP LEFT
            APPEND i TO ans
            FOR j FROM 0 TO (m - 1)
                IF vis[i + j] IS False
                    SET vis[i + j] TO True
                    FOR k IN g[i + j]
                        DECREMENT indeg[k] BY 1
                        IF indeg[k] EQUALS 0
                            APPEND k TO q
        IF ALL ELEMENTS IN vis ARE True
            RETURN ans REVERSED
        ELSE
            RETURN EMPTY LIST
    END FUNCTION
END CLASS