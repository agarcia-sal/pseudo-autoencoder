CLASS Solution
    FUNCTION validArrangement(pairs)
        SET graph TO a new mapping with default empty list
        SET out_degree TO a new mapping with default 0
        SET in_degree TO a new mapping with default 0

        FOR each (u, v) IN pairs
            APPEND v TO graph[u]
            INCREMENT out_degree[u] BY 1
            INCREMENT in_degree[v] BY 1

        SET start_node TO None
        FOR each node IN graph
            IF out_degree[node] EQUALS in_degree[node] PLUS 1
                SET start_node TO node
                BREAK
        IF start_node IS None
            SET start_node TO any node from graph keys

        SET path TO empty list
        SET stack TO list containing start_node

        WHILE stack is not empty
            SET u TO last element in stack
            IF graph[u] is not empty
                SET v TO last element popped from graph[u]
                APPEND v TO stack
            ELSE
                APPEND last element popped from stack TO path

        REVERSE path

        SET result TO empty list
        FOR i FROM 0 TO length of path MINUS 2
            APPEND list containing path[i] and path[i + 1] TO result

        RETURN result
    END FUNCTION
END CLASS