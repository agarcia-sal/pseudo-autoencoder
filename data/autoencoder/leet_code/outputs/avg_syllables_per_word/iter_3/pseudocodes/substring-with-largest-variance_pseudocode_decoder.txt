CLASS Solution
    FUNCTION largestVariance(s)
        FUNCTION calculate_variance(substring, char_a, char_b)
            SET max_variance TO 0
            SET count_a TO 0
            SET count_b TO 0
            SET has_b TO False
            SET first_b TO False

            FOR each char IN substring
                IF char IS EQUAL TO char_a THEN
                    INCREMENT count_a BY 1
                ELSE IF char IS EQUAL TO char_b THEN
                    INCREMENT count_b BY 1
                    SET has_b TO True
                END IF

                IF count_b > 0 THEN
                    SET max_variance TO MAXIMUM OF max_variance AND (count_a MINUS count_b)
                ELSE IF count_b IS 0 AND first_b IS True THEN
                    SET max_variance TO MAXIMUM OF max_variance AND (count_a MINUS 1)
                END IF

                IF count_b > count_a THEN
                    SET count_a TO 0
                    SET count_b TO 0
                    SET first_b TO has_b
                END IF
            END FOR

            RETURN max_variance
        END FUNCTION

        SET max_variance TO 0
        SET unique_chars TO SET OF UNIQUE CHARACTERS IN s

        FOR EACH pair (char_a, char_b) IN ALL PERMUTATIONS OF unique_chars OF LENGTH 2
            IF char_a IS EQUAL TO char_b THEN
                CONTINUE TO NEXT ITERATION
            END IF
            SET max_variance TO MAXIMUM OF max_variance AND calculate_variance(s, char_a, char_b)
        END FOR

        RETURN max_variance
    END FUNCTION
END CLASS