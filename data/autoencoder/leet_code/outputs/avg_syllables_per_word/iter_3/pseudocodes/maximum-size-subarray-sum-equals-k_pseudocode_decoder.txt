CLASS Solution
    FUNCTION maxSubArrayLen(nums, k)
        SET cumulative_sum_index TO dictionary with key 0 and value -1
        SET cumulative_sum TO 0
        SET max_length TO 0
        
        FOR i, num IN enumeration of nums
            INCREMENT cumulative_sum BY num
            
            IF cumulative_sum MINUS k IS IN cumulative_sum_index
                SET max_length TO maximum of max_length AND i MINUS cumulative_sum_index AT (cumulative_sum MINUS k)
            
            IF cumulative_sum NOT IN cumulative_sum_index
                SET cumulative_sum_index AT cumulative_sum TO i
        
        RETURN max_length
    END FUNCTION
END CLASS