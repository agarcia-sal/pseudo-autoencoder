CLASS Trie
    FUNCTION __init__(self)
        SET self.children TO a list containing twenty six None elements
        SET self.ref TO negative one
    END FUNCTION

    FUNCTION insert(self, w, ref)
        ASSIGN reference TO self IN variable named node
        FOR each character IN w
            SET idx TO the numerical ASCII code of character MINUS the numerical ASCII code of letter a in lowercase
            IF the element at position idx of the children list of node EQUALS None
                ASSIGN reference TO a new instance of Trie IN the element at position idx of the children list of node
            END IF
            ASSIGN reference TO the element at position idx of the children list of node IN variable named node
        END FOR
        SET the ref attribute of node TO ref
    END FUNCTION
END CLASS

CLASS Solution
    FUNCTION findWords(self, board, words)
        FUNCTION dfs(node, i, j)
            SET idx TO the numerical ASCII code of the character at position j of the element at position i of board MINUS the numerical ASCII code of letter a in lowercase
            IF the element at position idx of the children list of node EQUALS None
                RETURN
            END IF
            ASSIGN reference TO the element at position idx of the children list of node IN variable named node
            IF the ref attribute of node IS GREATER THAN OR EQUAL TO zero
                APPEND the element at position the ref attribute of node of words TO ans
                SET the ref attribute of node TO negative one
            END IF
            SET variable c TO the character at position j of the element at position i of board
            SET the character at position j of the element at position i of board TO the character hash
            FOR each a and b IN consecutive pairs taken from the sequence negative one zero one zero negative one
                SET x TO i PLUS a
                SET y TO j PLUS b
                IF x IS GREATER THAN OR EQUAL TO zero AND x IS LESS THAN the number of elements of board AND y IS GREATER THAN OR EQUAL TO zero AND y IS LESS THAN the number of elements of the element at position zero of board AND the character at position y of the element at position x of board IS NOT the character hash
                    CALL dfs WITH parameters node x y
                END IF
            END FOR
            SET the character at position j of the element at position i of board TO c
        END FUNCTION

        ASSIGN reference TO a new instance of Trie IN variable named tree
        FOR each index i and word w IN words enumerated starting from zero
            CALL insert of tree WITH parameters w i
        END FOR
        SET m TO the number of elements of board
        SET n TO the number of elements of the element at position zero of board
        SET ans TO an empty list
        FOR each i FROM zero TO one LESS THAN m
            FOR each j FROM zero TO one LESS THAN n
                CALL dfs WITH parameters tree i j
            END FOR
        END FOR
        RETURN ans
    END FUNCTION
END CLASS