CLASS Solution  
    FUNCTION containVirus WITH PARAMETER isInfected of TYPE List of List of integer  
        FUNCTION neighbors WITH PARAMETERS r of TYPE integer AND c of TYPE integer  
            RETURN list containing element of r PLUS one and c  
            APPEND element of r MINUS one and c TO the list  
            APPEND element of r and c PLUS one TO the list  
            APPEND element of r and c MINUS one TO the list  
        END FUNCTION

        FUNCTION bfs WITH PARAMETERS r of TYPE integer AND c of TYPE integer  
            SET infected TO empty set  
            SET threatened TO empty set  
            SET queue TO deque initialized with tuple of r and c  
            SET visited TO set initialized with tuple of r and c  
            WHILE queue is not empty  
                REMOVE the leftmost element from queue AND ASSIGN TO x and y  
                ADD tuple of x and y TO infected  
                FOR each nx and ny IN neighbors WITH r AS x AND c AS y  
                    IF number nx is GREATER THAN OR EQUAL TO zero AND number nx is LESS THAN m AND number ny is GREATER THAN OR EQUAL TO zero AND number ny is LESS THAN n AND tuple of nx and ny is NOT IN visited  
                        ADD tuple of nx and ny TO visited  
                        IF element at position nx of isInfected AT position ny EQUALS one  
                            APPEND tuple of nx and ny TO queue  
                        ELSE IF element at position nx of isInfected AT position ny EQUALS zero  
                            ADD tuple of nx and ny TO threatened  
                        END IF  
                    END IF  
                END FOR  
            END WHILE  
            RETURN tuple consisting of infected and threatened  
        END FUNCTION

        FUNCTION build_walls WITH PARAMETER infected of TYPE Set of Tuple of integer and integer  
            SET walls TO zero  
            FOR each x and y IN infected  
                FOR each nx and ny IN neighbors WITH r AS x AND c AS y  
                    IF number nx is GREATER THAN OR EQUAL TO zero AND number nx is LESS THAN m AND number ny is GREATER THAN OR EQUAL TO zero AND number ny is LESS THAN n AND element at position nx of isInfected AT position ny EQUALS zero  
                        INCREMENT walls BY one  
                    END IF  
                END FOR  
            END FOR  
            RETURN walls  
        END FUNCTION

        FUNCTION spread_virus WITH PARAMETER threatened of TYPE Set of Tuple of integer and integer  
            FOR each x and y IN threatened  
                SET element at position x of isInfected AT position y TO one  
            END FOR  
        END FUNCTION

        SET m TO the LENGTH OF isInfected  
        SET n TO the LENGTH OF element at position zero of isInfected  
        SET total_walls TO zero

        WHILE true holds  
            SET regions TO empty list  
            SET visited TO empty set  
            FOR r FROM zero TO m MINUS one  
                FOR c FROM zero TO n MINUS one  
                    IF element at position r of isInfected AT position c EQUALS one AND tuple of r and c is NOT IN visited  
                        CALL bfs WITH r and c AND ASSIGN RESULT TO infected and threatened  
                        APPEND tuple of infected and threatened TO regions  
                        UNION visited WITH infected  
                    END IF  
                END FOR  
            END FOR

            IF regions is empty  
                BREAK  
            END IF

            SORT regions IN ORDER by descending LENGTH OF second element of each tuple

            INCREMENT total_walls BY the RESULT OF build_walls APPLIED TO first element of first tuple in regions

            FOR each x and y IN first element of first tuple in regions  
                SET element at position x of isInfected AT position y TO negative one  
            END FOR

            FOR i FROM one TO LENGTH OF regions MINUS one  
                CALL spread_virus WITH second element of tuple at position i in regions  
            END FOR

        END WHILE

        RETURN total_walls  
    END FUNCTION  
END CLASS