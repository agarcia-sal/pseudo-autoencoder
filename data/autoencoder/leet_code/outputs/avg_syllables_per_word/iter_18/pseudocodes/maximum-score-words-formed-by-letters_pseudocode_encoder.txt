CLASS Solution  
    FUNCTION maxScoreWords(words AS List OF string, letters AS List OF string, score AS List OF integer) RETURNS integer  
        FUNCTION word_score(word AS string, score_map AS mapping FROM string TO integer) RETURNS integer  
            SET total_word_score TO zero  
            FOR each character IN word  
                INCREMENT total_word_score BY the value IN score_map AT key character  
            END FOR  
            RETURN total_word_score  
        END FUNCTION  

        FUNCTION can_form(word AS string, letter_count AS mapping FROM string TO integer) RETURNS boolean  
            SET word_count TO an auxiliary FUNCTION Counter TAKING word  
            FOR each character AND count IN word_count  
                IF the value IN letter_count AT key character IS LESS THAN count  
                    RETURN false  
                END IF  
            END FOR  
            RETURN true  
        END FUNCTION  

        FUNCTION update_letter_count(letter_count AS mapping FROM string TO integer, word AS string, add AS boolean)  
            FOR each character IN word  
                IF add IS true  
                    INCREMENT the value IN letter_count AT key character BY one  
                ELSE  
                    DECREMENT the value IN letter_count AT key character BY one  
                END IF  
            END FOR  
        END FUNCTION  

        FUNCTION backtrack(index AS integer, current_score AS integer, letter_count AS mapping FROM string TO integer) RETURNS integer  
            IF index EQUALS the LENGTH OF words  
                RETURN current_score  
            END IF  

            SET max_score TO current_score  
            FOR i FROM index TO the LENGTH OF words MINUS one  
                IF can_form(the element AT position i IN words, letter_count) IS true  
                    CALL update_letter_count(letter_count, the element AT position i IN words, add equals false)  
                    SET candidate_score TO backtrack(i PLUS one, current_score PLUS word_score(the element AT position i IN words, score_map), letter_count)  
                    IF candidate_score GREATER THAN max_score  
                        SET max_score TO candidate_score  
                    END IF  
                    CALL update_letter_count(letter_count, the element AT position i IN words, add equals true)  
                END IF  
            END FOR  
            RETURN max_score  
        END FUNCTION  

        SET score_map TO an mapping FROM string TO integer WHERE for each integer i FROM zero TO twenty five, the key IS character at position i PLUS character a, AND the value IS element at position i IN score  
        SET letter_count TO an auxiliary FUNCTION Counter TAKING letters  
        RETURN backtrack(zero, zero, letter_count)  
    END FUNCTION  
END CLASS