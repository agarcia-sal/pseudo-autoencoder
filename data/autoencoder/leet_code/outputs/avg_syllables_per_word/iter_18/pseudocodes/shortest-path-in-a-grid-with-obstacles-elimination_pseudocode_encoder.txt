CLASS Solution  
    FUNCTION shortestPath(grid AS list of list of integer, k AS integer) RETURNS integer  
        IF grid DOES NOT EXIST OR element at position zero of grid DOES NOT EXIST THEN  
            RETURN negative one  
        END IF  
  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero of grid  
  
        IF k IS GREATER THAN OR EQUAL TO m PLUS n MINUS two THEN  
            RETURN m PLUS n MINUS two  
        END IF  
  
        SET directions TO list of tuples containing zero AND one PLUS one AND zero PLUS zero AND negative one PLUS negative one AND zero  
  
        INITIALIZE queue AS a double ended queue containing the tuple of zero zero k zero  
  
        INITIALIZE visited AS a set containing the tuple of zero zero k  
  
        WHILE queue IS NOT EMPTY  
            REMOVE AND RETURN the FIRST element FROM queue INTO variables x y remaining_k steps  
  
            IF x EQUALS m MINUS one AND y EQUALS n MINUS one THEN  
                RETURN steps  
            END IF  
  
            FOR each dx AND dy IN directions  
                SET nx TO x PLUS dx  
                SET ny TO y PLUS dy  
  
                IF nx IS GREATER THAN OR EQUAL TO zero AND nx IS LESS THAN m AND ny IS GREATER THAN OR EQUAL TO zero AND ny IS LESS THAN n THEN  
                    SET new_k TO remaining_k MINUS element at position nx of grid AT POSITION ny  
                    IF new_k IS GREATER THAN OR EQUAL TO zero AND tuple of nx ny new_k DOES NOT EXIST IN visited THEN  
                        ADD tuple of nx ny new_k TO visited  
                        APPEND tuple of nx ny new_k steps PLUS one TO queue  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
  
        RETURN negative one  
    END FUNCTION  
END CLASS