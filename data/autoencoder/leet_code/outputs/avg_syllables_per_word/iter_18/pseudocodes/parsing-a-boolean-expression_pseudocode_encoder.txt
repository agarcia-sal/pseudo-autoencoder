CLASS Solution  
    FUNCTION parseBoolExpr(expression)  
        SET stk TO empty list  
        FOR each character IN expression  
            IF character EQUALS one of the characters t or f or exclamation mark or ampersand or vertical bar  
                APPEND character TO stk  
            ELSE IF character EQUALS closing parenthesis  
                SET t TO zero  
                SET f TO zero  
                WHILE element at last position of stk EQUALS one of the characters t or f holds  
                    INCREMENT t BY one IF element at last position of stk EQUALS t OTHERWISE zero  
                    INCREMENT f BY one IF element at last position of stk EQUALS f OTHERWISE zero  
                    REMOVE element at last position FROM stk  
                END WHILE  
                SET op TO element at last position of stk  
                REMOVE element at last position FROM stk  
                IF op EQUALS exclamation mark  
                    IF f GREATER THAN zero  
                        SET character TO t  
                    ELSE  
                        SET character TO f  
                    END IF  
                ELSE IF op EQUALS ampersand  
                    IF f GREATER THAN zero  
                        SET character TO f  
                    ELSE  
                        SET character TO t  
                    END IF  
                ELSE IF op EQUALS vertical bar  
                    IF t GREATER THAN zero  
                        SET character TO t  
                    ELSE  
                        SET character TO f  
                    END IF  
                END IF  
                APPEND character TO stk  
            END IF  
        END FOR  
        RETURN element at position zero of stk EQUALS t  
    END FUNCTION  
END CLASS