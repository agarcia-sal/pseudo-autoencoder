CLASS Solution  
    FUNCTION minWastedSpace(packages AS List OF integer, boxes AS List OF List OF integer) RETURNS integer  
        SET MOD TO ten to the power of nine PLUS one  
        SORT packages IN ascending order  
        SET n TO the LENGTH OF packages  
          
        SET prefix_sum TO a list of zero REPEATED n PLUS one times  
        FOR index FROM zero TO n MINUS one  
            SET element at position index PLUS one of prefix_sum TO element at position index of prefix_sum PLUS element at position index of packages  
        END FOR  
          
        SET min_wasted_space TO infinity  
          
        FOR each box IN boxes  
            SORT box IN ascending order  
            IF the largest element at position LENGTH OF box MINUS one of box IS LESS THAN the largest element at position n MINUS one of packages  
                CONTINUE TO the next iteration of the box loop  
            END IF  
              
            SET total_wasted TO zero  
            SET last_index TO zero  
              
            FOR each box_size IN box  
                SET index TO last_index  
                WHILE index IS LESS THAN n AND element at position index of packages IS LESS THAN OR EQUAL TO box_size  
                    INCREMENT index BY one  
                END WHILE  
                  
                IF index IS GREATER THAN last_index  
                    INCREMENT total_wasted BY (index MINUS last_index) MULTIPLIED BY box_size MINUS (element at position index of prefix_sum MINUS element at position last_index of prefix_sum)  
                    SET last_index TO index  
                END IF  
            END FOR  
              
            IF last_index EQUALS n  
                SET min_wasted_space TO the lesser of min_wasted_space AND total_wasted  
            END IF  
        END FOR  
          
        IF min_wasted_space IS NOT EQUAL TO infinity  
            RETURN min_wasted_space MODULO MOD  
        ELSE  
            RETURN negative one  
        END IF  
    END FUNCTION  
END CLASS