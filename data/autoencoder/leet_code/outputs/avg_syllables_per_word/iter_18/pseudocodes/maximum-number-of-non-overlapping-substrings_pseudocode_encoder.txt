CLASS Solution  
    FUNCTION maxNumOfSubstrings WITH PARAMETER s AS string  
        SET first TO an empty mapping  
        SET last TO an empty mapping  
        FOR each index FROM zero TO the LENGTH OF s minus one  
            SET c TO character at position index of s  
            IF key c NOT IN first  
                SET the value of key c in first TO index  
            END IF  
            SET the value of key c in last TO index  
        END FOR  
        SET intervals TO an empty list  
        FOR each key c IN first  
            SET start TO the value of key c in first  
            SET end TO the value of key c in last  
            SET i TO start  
            WHILE i LESS THAN OR EQUAL TO end  
                SET current_char TO character at position i of s  
                IF the value of key current_char in first LESS THAN start  
                    BREAK the loop  
                END IF  
                SET end TO the greater value BETWEEN end AND the value of key current_char in last  
                INCREMENT i BY one  
            END WHILE  
            IF the loop completed without BREAKING  
                APPEND the tuple start and end TO intervals  
            END IF  
        END FOR  
        SORT intervals ACCORDING TO the second element of each tuple in ascending order  
        SET result TO an empty list  
        SET prev_end TO negative one  
        FOR each tuple start and end IN intervals  
            IF start GREATER THAN prev_end  
                APPEND the substring of s FROM start TO end inclusive TO result  
                SET prev_end TO end  
            END IF  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS