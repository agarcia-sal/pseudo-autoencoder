CLASS Solution  
    FUNCTION validTicTacToe(board AS list of string) RETURNS boolean  
        SET countX TO zero  
        FOR each row IN board  
            INCREMENT countX BY the number of occurrences of uppercase letter X in row  
        END FOR  
        SET countO TO zero  
        FOR each row IN board  
            INCREMENT countO BY the number of occurrences of uppercase letter O in row  
        END FOR  
  
        IF countX IS LESS THAN countO OR countX IS GREATER THAN countO PLUS one THEN  
            RETURN false  
        END IF  
  
        FUNCTION check_win(player AS character) RETURNS boolean  
            FOR each row IN board  
                IF row IS EQUAL TO player REPEATED three times THEN  
                    RETURN true  
                END IF  
            END FOR  
            FOR column_index FROM zero TO two  
                IF character at position column_index of element at position zero of board IS EQUAL TO player AND character at position column_index of element at position one of board IS EQUAL TO player AND character at position column_index of element at position two of board IS EQUAL TO player THEN  
                    RETURN true  
                END IF  
            END FOR  
            IF character at position zero of element at position zero of board IS EQUAL TO player AND character at position one of element at position one of board IS EQUAL TO player AND character at position two of element at position two of board IS EQUAL TO player THEN  
                RETURN true  
            END IF  
            IF character at position two of element at position zero of board IS EQUAL TO player AND character at position one of element at position one of board IS EQUAL TO player AND character at position zero of element at position two of board IS EQUAL TO player THEN  
                RETURN true  
            END IF  
            RETURN false  
        END FUNCTION  
  
        SET winX TO the result of calling check_win with uppercase letter X as argument  
        SET winO TO the result of calling check_win with uppercase letter O as argument  
  
        IF winX AND winO THEN  
            RETURN false  
        END IF  
        IF winX AND countX IS EQUAL TO countO THEN  
            RETURN false  
        END IF  
        IF winO AND countX IS NOT EQUAL TO countO THEN  
            RETURN false  
        END IF  
  
        RETURN true  
    END FUNCTION  
END CLASS