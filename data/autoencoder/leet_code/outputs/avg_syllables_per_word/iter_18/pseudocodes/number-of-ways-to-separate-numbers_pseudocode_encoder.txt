CLASS Solution  
    FUNCTION numberOfCombinations(num)  
        SET MOD TO ten raised to the power of nine PLUS one  
        SET n TO the LENGTH OF num  
        SET memo TO an empty mapping  
        
        FUNCTION dp(index, prev_len)  
            IF index EQUALS n THEN  
                RETURN one  
            END IF  
            
            IF the pair of index AND prev_len EXISTS IN memo THEN  
                RETURN the value ASSOCIATED WITH the pair of index AND prev_len IN memo  
            END IF  
            
            SET count TO zero  
            FOR length FROM one TO the result of n MINUS index PLUS one MINUS one  
                IF the character at position index of num EQUALS zero THEN  
                    BREAK the loop  
                END IF  
                
                SET current_num TO the substring of num from position index TO the position index PLUS length MINUS one  
                
                IF prev_len EQUALS zero OR current_num GREATER THAN OR EQUAL TO the substring of num from position index MINUS prev_len TO the position index MINUS one THEN  
                    SET count TO the remainder of count PLUS the result of dp with parameters index PLUS length AND length DIVIDED BY MOD  
                END IF  
            END FOR  
            
            ASSIGN the key of the pair of index AND prev_len IN memo TO count  
            RETURN count  
        END FUNCTION  
        
        RETURN the result of dp with parameters zero AND zero  
    END FUNCTION  
END CLASS