CLASS Solution  
    FUNCTION tallestBillboard WITH PARAMETER rods  
        SET dp TO a mapping assigning zero TO zero  
        FOR each rod IN rods  
            SET new_dp TO a copy of dp  
            FOR each key d AND value y IN dp  
                SET sum_for_taller TO d PLUS rod  
                IF sum_for_taller IS IN new_dp THEN  
                    SET current_value TO element at key sum_for_taller of new_dp  
                    IF y GREATER THAN current_value THEN  
                        SET element at key sum_for_taller of new_dp TO y  
                    END IF  
                ELSE  
                    SET element at key sum_for_taller of new_dp TO y  
                END IF  
                SET difference_to_add TO the absolute value of d MINUS rod  
                SET value_for_shorter TO y PLUS the lesser BETWEEN d AND rod  
                IF difference_to_add IS IN new_dp THEN  
                    SET current_value_shorter TO element at key difference_to_add of new_dp  
                    IF value_for_shorter GREATER THAN current_value_shorter THEN  
                        SET element at key difference_to_add of new_dp TO value_for_shorter  
                    END IF  
                ELSE  
                    SET element at key difference_to_add of new_dp TO value_for_shorter  
                END IF  
            END FOR  
            SET dp TO new_dp  
        END FOR  
        RETURN element at key zero of dp  
    END FUNCTION  
END CLASS