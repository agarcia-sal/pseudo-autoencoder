CLASS Solution  
    FUNCTION braceExpansionII WITH PARAMETER expression  
        FUNCTION parse_expression WITH PARAMETER index  
            SET current_set TO an empty set  
            SET current_product TO a list containing an empty string  
            
            WHILE index is less than the length of expression holds  
                SET char TO character at position index of expression  
                
                IF char equals the opening brace symbol  
                    CALL parse_expression with parameter index incremented by one  
                    ASSIGN inner_set and index TO the returned values of that call  
                    SET current_product TO a new list of concatenations where FOR each element a IN current_product and FOR each element b IN inner_set concatenate a followed by b  
                ELSE IF char equals the closing brace symbol  
                    ADD to current_set every string formed by concatenating all elements in current_product  
                    RETURN current_set and index  
                ELSE IF char equals the comma symbol  
                    ADD to current_set every string formed by concatenating all elements in current_product  
                    SET current_product TO a list containing an empty string  
                ELSE  
                    SET current_product TO a new list where FOR each element a IN current_product concatenate a followed by the char  
                END IF  
                
                INCREMENT index BY one  
            END WHILE  
            
            ADD to current_set every string formed by concatenating all elements in current_product  
            RETURN current_set and index  
        END FUNCTION  
        
        CALL parse_expression with parameter zero  
        ASSIGN result_set and an unused variable TO the returned values of that call  
        RETURN the sorted list of elements in result_set  
    END FUNCTION  
END CLASS