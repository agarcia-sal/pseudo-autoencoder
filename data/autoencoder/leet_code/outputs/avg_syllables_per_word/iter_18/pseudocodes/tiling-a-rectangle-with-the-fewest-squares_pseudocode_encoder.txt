CLASS Solution  
    FUNCTION tilingRectangle WITH PARAMETERS n AND m  
        FUNCTION backtrack WITH PARAMETERS heights AND moves  
            SET min_height TO THE MINIMUM VALUE AMONG ELEMENTS IN heights  
            IF all ELEMENTS IN heights EQUAL TO n THEN  
                SET min_moves TO THE MINIMUM OF min_moves AND moves  
                RETURN from backtrack  
            END IF  
            IF moves IS GREATER THAN OR EQUAL TO min_moves THEN  
                RETURN from backtrack  
            END IF  
            SET left TO THE POSITION OF min_height IN heights  
            SET right TO left  
            WHILE right IS LESS THAN m AND ELEMENT AT POSITION right OF heights EQUALS min_height HOLD  
                INCREMENT right BY one  
            END WHILE  
            FOR size FROM right MINUS left DOWN TO one  
                IF for each index i FROM zero TO size MINUS one THE ELEMENT AT POSITION left PLUS i OF heights PLUS size IS LESS THAN OR EQUAL TO n THEN  
                    SET new_heights TO A COPY OF heights  
                    FOR i FROM zero TO size MINUS one  
                        INCREMENT ELEMENT AT POSITION left PLUS i OF new_heights BY size  
                    END FOR  
                    CALL backtrack WITH new_heights AND moves PLUS one  
                END IF  
            END FOR  
        END FUNCTION  
        SET min_moves TO positive infinity  
        CALL backtrack WITH A LIST OF zero REPEATED m TIMES AND zero  
        RETURN min_moves  
END CLASS