CLASS Solution  
    FUNCTION kthSmallestProduct(nums1 AS list of integer, nums2 AS list of integer, k AS integer) RETURNS integer  
        FUNCTION count(p AS integer) RETURNS integer  
            SET cnt TO zero  
            SET n TO the LENGTH OF nums2  
            FOR each element x IN nums1  
                IF x GREATER THAN zero THEN  
                    INCREMENT cnt BY the POSITION returned BY the OPERATION bisect_right ON nums2 WITH the VALUE of p DIVIDED BY x  
                ELSE IF x LESS THAN zero THEN  
                    INCREMENT cnt BY n MINUS the POSITION returned BY the OPERATION bisect_left ON nums2 WITH the VALUE of p DIVIDED BY x  
                ELSE  
                    INCREMENT cnt BY n MULTIPLIED BY the TRUTH VALUE OF p GREATER THAN OR EQUAL TO zero  
                END IF  
            END FOR  
            RETURN cnt  
        END FUNCTION  
  
        SET absolute_max_first_element_nums1 TO the ABSOLUTE VALUE OF the ELEMENT AT POSITION zero OF nums1  
        SET absolute_max_last_element_nums1 TO the ABSOLUTE VALUE OF the ELEMENT AT POSITION the LENGTH OF nums1 MINUS one OF nums1  
        SET absolute_max_first_element_nums2 TO the ABSOLUTE VALUE OF the ELEMENT AT POSITION zero OF nums2  
        SET absolute_max_last_element_nums2 TO the ABSOLUTE VALUE OF the ELEMENT AT POSITION the LENGTH OF nums2 MINUS one OF nums2  
        SET mx TO the MAXIMUM BETWEEN absolute_max_first_element_nums1 AND absolute_max_last_element_nums1 MULTIPLIED BY the MAXIMUM BETWEEN absolute_max_first_element_nums2 AND absolute_max_last_element_nums2  
  
        SET bisect_range TO the INTEGER RANGE FROM negative mx TO mx PLUS one  
        SET result_position TO the POSITION returned BY the OPERATION bisect_left ON bisect_range WITH the VALUE k AND USING THE FUNCTION count AS key  
        SET final_result TO result_position MINUS mx  
        RETURN final_result  
    END FUNCTION  
END CLASS