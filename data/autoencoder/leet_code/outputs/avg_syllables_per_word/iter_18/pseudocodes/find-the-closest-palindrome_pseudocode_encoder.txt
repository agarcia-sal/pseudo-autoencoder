CLASS Solution  
    FUNCTION nearestPalindromic WITH PARAMETER n AS string  
        SET length TO the LENGTH OF n  
        IF length EQUALS one  
            SET numeric_value TO the INTEGER VALUE OF n  
            SET result_value TO numeric_value MINUS one  
            RETURN the STRING REPRESENTATION OF result_value  
        END IF  
        
        SET candidates TO an EMPTY SET  
        
        SET ten_power_length TO ten RAISED TO THE POWER OF length  
        SET candidates TO candidates WITH the ADDITION OF ten_power_length PLUS one  
        
        SET ten_power_length_minus_one TO ten RAISED TO THE POWER OF length MINUS one  
        SET candidates TO candidates WITH the ADDITION OF ten_power_length_minus_one MINUS one  
        
        SET half_length TO the INTEGER DIVISION OF the SUM OF length AND one BY two  
        SET prefix TO the INTEGER VALUE OF the SUBSTRING OF n FROM POSITION zero TO POSITION half_length MINUS one  
        
        FOR each integer i FROM negative one TO one  
            SET modified_prefix_value TO prefix PLUS i  
            SET modified_prefix_string TO the STRING REPRESENTATION OF modified_prefix_value  
            
            IF length MODULO two EQUALS zero  
                SET reversed_part TO the STRING RESULT OF reversed modified_prefix_string ENTIRELY  
                SET candidate_string TO modified_prefix_string CONCATENATED WITH reversed_part  
            ELSE  
                SET reversed_part TO the STRING RESULT OF reversed modified_prefix_string FROM POSITION negative two DOWN TO zero EXCLUSIVE  
                SET candidate_string TO modified_prefix_string CONCATENATED WITH reversed_part  
            END IF  
            
            SET candidate_numeric TO the INTEGER VALUE OF candidate_string  
            ADD candidate_numeric TO candidates  
        END FOR  
        
        SET original_number TO the INTEGER VALUE OF n  
        REMOVE original_number FROM candidates IF PRESENT  
        
        SET minimum_difference TO a VERY LARGE NUMBER  
        SET closest_palindrome TO none  
        
        FOR each candidate IN candidates  
            SET absolute_difference TO the ABSOLUTE VALUE OF candidate MINUS original_number  
            IF absolute_difference LESS THAN minimum_difference OR  
               absolute_difference EQUALS minimum_difference AND candidate LESS THAN closest_palindrome  
                SET minimum_difference TO absolute_difference  
                SET closest_palindrome TO candidate  
            END IF  
        END FOR  
        
        RETURN the STRING REPRESENTATION OF closest_palindrome  
    END FUNCTION  
END CLASS