CLASS Solution  
    FUNCTION wordPatternMatch WITH PARAMETERS pattern STRING and s STRING  
        FUNCTION backtrack WITH PARAMETERS pattern_index and string_index and mapping and used  
            IF pattern_index EQUALS the LENGTH OF pattern AND string_index EQUALS the LENGTH OF s  
                RETURN true  
            END IF  
            IF pattern_index EQUALS the LENGTH OF pattern OR string_index EQUALS the LENGTH OF s  
                RETURN false  
            END IF  
            
            SET current_char TO character at position pattern_index of pattern  
            IF current_char IN mapping  
                SET word TO value mapped by current_char in mapping  
                IF substring of s from position string_index to position string_index PLUS the LENGTH OF word DOES NOT EQUAL word  
                    RETURN false  
                END IF  
                IF backtrack WITH PARAMETERS pattern_index PLUS one and string_index PLUS the LENGTH OF word and mapping and used RETURNS true  
                    RETURN true  
                END IF  
            ELSE  
                FOR end FROM string_index PLUS one TO the LENGTH OF s PLUS one  
                    SET word TO substring of s from position string_index to position end  
                    IF word IN used  
                        CONTINUE  
                    END IF  
                    SET value mapped by current_char in mapping TO word  
                    ADD word TO used  
                    IF backtrack WITH PARAMETERS pattern_index PLUS one and end and mapping and used RETURNS true  
                        RETURN true  
                    END IF  
                    REMOVE the mapping for current_char from mapping  
                    REMOVE word FROM used  
                END FOR  
            END IF  
            RETURN false  
        END FUNCTION  
        RETURN backtrack WITH PARAMETERS zero and zero and an empty mapping and an empty used collection  
    END FUNCTION  
END CLASS