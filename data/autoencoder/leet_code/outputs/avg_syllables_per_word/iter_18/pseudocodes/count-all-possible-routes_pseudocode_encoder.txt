CLASS Solution  
    FUNCTION countRoutes WITH PARAMETERS locations AND start AND finish AND fuel  
        SET MOD TO ten raised to the power of nine PLUS one  
        SET n TO the LENGTH OF locations  
        
        FUNCTION dp WITH PARAMETERS city AND remaining_fuel  
            IF remaining_fuel LESS THAN zero  
                RETURN zero  
            END IF  
            SET routes TO zero  
            IF city EQUALS finish  
                SET routes TO one  
            END IF  
            FOR each next_city FROM zero TO n MINUS one  
                IF next_city NOT EQUALS city  
                    SET fuel_cost TO absolute value of the difference BETWEEN element at position city OF locations AND element at position next_city OF locations  
                    IF remaining_fuel GREATER THAN OR EQUAL TO fuel_cost  
                        SET routes TO remainder of the sum of routes AND dp WITH ARGUMENTS next_city AND remaining_fuel MINUS fuel_cost DIVIDED BY MOD  
                    END IF  
                END IF  
            END FOR  
            RETURN routes  
        END FUNCTION  
        
        RETURN dp WITH ARGUMENTS start AND fuel  
    END FUNCTION  
END CLASS