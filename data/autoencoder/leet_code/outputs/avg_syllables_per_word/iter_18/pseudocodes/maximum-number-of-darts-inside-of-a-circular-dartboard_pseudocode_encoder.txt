CLASS Solution  
    FUNCTION numPoints WITH PARAMETERS darts AND r  
        FUNCTION distance WITH PARAMETERS p1 AND p2  
            SET horizontal_difference TO the element at position zero of p1 MINUS the element at position zero of p2  
            SET vertical_difference TO the element at position one of p1 MINUS the element at position one of p2  
            SET squared_horizontal_difference TO horizontal_difference MULTIPLIED BY horizontal_difference  
            SET squared_vertical_difference TO vertical_difference MULTIPLIED BY vertical_difference  
            SET sum_of_squares TO squared_horizontal_difference PLUS squared_vertical_difference  
            SET result TO the square root of sum_of_squares  
            RETURN result  
        END FUNCTION  

        FUNCTION circle_center WITH PARAMETERS p1 AND p2 AND r  
            SET d TO the result of calling distance WITH p1 AND p2  
            IF d GREATER THAN two MULTIPLIED BY r THEN  
                RETURN none  
            END IF  
            SET half_distance TO d DIVIDED BY two  
            SET a TO the square root of r MULTIPLIED BY r MINUS half_distance MULTIPLIED BY half_distance  
            SET midpoint_horizontal TO the element at position zero of p1 PLUS the element at position zero of p2 DIVIDED BY two  
            SET midpoint_vertical TO the element at position one of p1 PLUS the element at position one of p2 DIVIDED BY two  
            SET dx TO the element at position one of p2 MINUS the element at position one of p1 MULTIPLIED BY a DIVIDED BY d  
            SET dy TO the element at position zero of p2 MINUS the element at position zero of p1 MULTIPLIED BY a DIVIDED BY d  
            SET first_center TO a pair consisting of midpoint_horizontal MINUS dx AND midpoint_vertical PLUS dy  
            SET second_center TO a pair consisting of midpoint_horizontal PLUS dx AND midpoint_vertical MINUS dy  
            RETURN a list consisting of first_center AND second_center  
        END FUNCTION  

        FUNCTION is_inside WITH PARAMETERS circle AND point AND r  
            SET dist TO the result of calling distance WITH circle AND point  
            IF dist LESS THAN OR EQUAL TO r THEN  
                RETURN true  
            ELSE  
                RETURN false  
            END IF  
        END FUNCTION  

        SET n TO the number of elements in darts  
        IF n EQUALS one THEN  
            RETURN one  
        END IF  

        SET max_count TO one  

        FOR index_i FROM zero TO n MINUS one  
            FOR index_j FROM index_i PLUS one TO n MINUS one  
                SET centers TO the result of calling circle_center WITH the element at position index_i of darts AND the element at position index_j of darts AND r  
                IF centers IS NOT none THEN  
                    FOR each center IN centers  
                        SET count TO zero  
                        FOR each dart IN darts  
                            IF the result of calling is_inside WITH center AND dart AND r IS true THEN  
                                INCREMENT count BY one  
                            END IF  
                        END FOR  
                        IF count GREATER THAN max_count THEN  
                            SET max_count TO count  
                        END IF  
                    END FOR  
                END IF  
            END FOR  
        END FOR  

        RETURN max_count  
    END FUNCTION  
END CLASS