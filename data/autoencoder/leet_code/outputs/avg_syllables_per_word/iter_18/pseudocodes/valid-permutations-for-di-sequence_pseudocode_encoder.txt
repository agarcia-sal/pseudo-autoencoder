CLASS Solution  
    FUNCTION numPermsDISequence WITH PARAMETER s AS string  
        SET MODULO TO ten raised TO the power of nine PLUS seven  
        SET length_of_s TO the LENGTH OF s  
        SET dp_table TO a list of lists each containing zero repeated length_of_s PLUS one times repeated length_of_s PLUS one times  
        
        FOR each index_j FROM zero TO length_of_s inclusive  
            SET element at position zero and position index_j of dp_table TO one  
        END FOR  
        
        FOR each index_i FROM one TO length_of_s inclusive  
            SET cumulative_prefix_sum TO zero  
            
            IF character at position index_i MINUS one of s EQUALS uppercase letter I  
                FOR each index_j FROM zero TO length_of_s PLUS one MINUS index_i exclusive  
                    SET cumulative_prefix_sum TO cumulative_prefix_sum PLUS element at position index_i MINUS one and position index_j of dp_table MODULO MODULO  
                    SET element at position index_i and position index_j of dp_table TO cumulative_prefix_sum  
                END FOR  
            ELSE  
                FOR each index_j FROM length_of_s MINUS index_i DOWN TO zero inclusive  
                    SET cumulative_prefix_sum TO cumulative_prefix_sum PLUS element at position index_i MINUS one and position index_j PLUS one of dp_table MODULO MODULO  
                    SET element at position index_i and position index_j of dp_table TO cumulative_prefix_sum  
                END FOR  
            END IF  
        END FOR  
        
        SET result_sum TO zero  
        FOR each element IN element at position length_of_s of dp_table  
            SET result_sum TO result_sum PLUS element  
        END FOR  
        SET result_sum TO result_sum MODULO MODULO  
        
        RETURN result_sum  
    END FUNCTION  
END CLASS