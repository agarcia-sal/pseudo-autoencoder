CLASS Solution  
    FUNCTION mostSimilar(n parameter of type integer comma roads parameter of type list of lists of integers comma names parameter of type list of strings comma targetPath parameter of type list of strings) RETURNS list of integers  
        SET graph TO a new mapping with default value as an empty list  
        FOR each element consisting of two parts u and v IN roads  
            APPEND v TO element at key u in graph  
            APPEND u TO element at key v in graph  
        END FOR  
        
        SET m TO the length of targetPath  
        
        DEFINE FUNCTION dp(i parameter of type integer comma j parameter of type integer) RETURNS a tuple of cost and path  
            IF i EQUALS zero THEN  
                IF element at position j of names NOT EQUALS element at position i of targetPath THEN  
                    SET cost_at_base TO one  
                ELSE  
                    SET cost_at_base TO zero  
                END IF  
                RETURN cost_at_base comma a list containing only j  
            END IF  
            
            SET min_cost TO a value representing positive infinity  
            SET min_path TO an empty list  
            FOR each element k IN element at key j in graph  
                SET cost comma path TO the result of dp called with parameters i MINUS one and k  
                IF cost LESS THAN min_cost THEN  
                    SET min_cost TO cost  
                    SET min_path TO path  
                END IF  
            END FOR  
            
            IF element at position j of names NOT EQUALS element at position i of targetPath THEN  
                SET current_cost TO min_cost PLUS one  
            ELSE  
                SET current_cost TO min_cost  
            END IF  
            RETURN current_cost comma concatenation of min_path and a list containing j  
        END FUNCTION  
        
        SET overall_min_cost TO a value representing positive infinity  
        SET overall_min_path TO an empty list  
        FOR index j FROM zero TO n MINUS one  
            SET cost comma path TO the result of dp called with parameters m MINUS one and j  
            IF cost LESS THAN overall_min_cost THEN  
                SET overall_min_cost TO cost  
                SET overall_min_path TO path  
            END IF  
        END FOR  
        
        RETURN overall_min_path  
    END FUNCTION  
END CLASS