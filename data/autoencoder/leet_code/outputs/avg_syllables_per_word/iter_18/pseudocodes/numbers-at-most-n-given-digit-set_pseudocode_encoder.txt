CLASS Solution  
    FUNCTION atMostNGivenDigitSet WITH PARAMETERS digits AND n  
        FUNCTION count_numbers_with_length WITH PARAMETER length  
            RETURN the LENGTH OF digits RAISED TO THE POWER OF length  
        END FUNCTION  

        FUNCTION count_numbers_up_to_n WITH PARAMETER n  
            SET string_representation_of_n TO string representation of n  
            SET length_of_n TO the LENGTH OF string_representation_of_n  
            SET total_count TO zero  

            FOR length_index FROM one TO length_of_n MINUS one  
                INCREMENT total_count BY count_numbers_with_length WITH length_index AS ARGUMENT  
            END FOR  

            FOR digit_index FROM zero TO length_of_n MINUS one  
                SET current_digit TO the INTEGER VALUE OF character at position digit_index OF string_representation_of_n  
                FOR each digit IN digits  
                    SET digit_value TO the INTEGER VALUE OF digit  
                    IF digit_value LESS THAN current_digit THEN  
                        INCREMENT total_count BY count_numbers_with_length WITH the VALUE length_of_n MINUS digit_index MINUS one AS ARGUMENT  
                    ELSE IF digit_value EQUALS current_digit THEN  
                        IF digit_index EQUALS length_of_n MINUS one THEN  
                            INCREMENT total_count BY one  
                        END IF  
                    ELSE  
                        BREAK  
                    END IF  
                END FOR  
            END FOR  

            RETURN total_count  
        END FUNCTION  

        RETURN count_numbers_up_to_n WITH n AS ARGUMENT  
    END FUNCTION  
END CLASS