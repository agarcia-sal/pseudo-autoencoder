CLASS Solution  
    FUNCTION getLengthOfOptimalCompression WITH PARAMETERS s AS string AND k AS integer  
        FUNCTION dp WITH PARAMETERS i AS integer AND k AS integer AND prev_char AS character AND prev_count AS integer  
            IF k IS LESS THAN zero THEN  
                RETURN positive infinity constant  
            END IF  

            IF i IS EQUAL TO the LENGTH OF s THEN  
                RETURN zero  
            END IF  

            IF character at position i of s IS EQUAL TO prev_char THEN  
                IF prev_count IS EQUAL TO one OR prev_count IS EQUAL TO nine OR prev_count IS EQUAL TO ninety nine THEN  
                    SET increment TO one  
                ELSE  
                    SET increment TO zero  
                END IF  
                RETURN increment PLUS dp WITH PARAMETERS i PLUS one AND k AND prev_char AND prev_count PLUS one  
            ELSE  
                SET keep TO one PLUS dp WITH PARAMETERS i PLUS one AND k AND character at position i of s AND one  
                SET delete TO dp WITH PARAMETERS i PLUS one AND k MINUS one AND prev_char AND prev_count  
                RETURN the smaller BETWEEN keep AND delete  
            END IF  
        END FUNCTION  

        RETURN dp WITH PARAMETERS zero AND k AND empty string AND zero  
    END FUNCTION  
END CLASS