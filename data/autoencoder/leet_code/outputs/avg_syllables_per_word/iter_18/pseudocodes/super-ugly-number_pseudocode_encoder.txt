CLASS Solution  
    FUNCTION nthSuperUglyNumber(n AS integer, primes AS list of integer) RETURNS integer  
        SET ugly_numbers TO list containing one  
        SET heap TO list of pairs each containing element at position index of primes AND index for each index and element in primes  
        APPLY heap construction to heap to organize it as a minimum heap  
        SET indices TO list of zeros with the length equal to the length of primes  
        
        WHILE the length of ugly_numbers is less than n holds  
            REMOVE and RETURN the smallest pair from heap ASSIGN TO next_ugly and prime_index  
            
            IF next_ugly is not EQUALS to the last element of ugly_numbers THEN  
                APPEND next_ugly TO ugly_numbers  
            END IF  
            
            INCREMENT element at position prime_index of indices BY one  
            SET next_multiple TO element at position prime_index of primes MULTIPLIED BY element at position element at position prime_index of indices of ugly_numbers  
            ADD the pair containing next_multiple and prime_index TO heap  
        END WHILE  
        
        RETURN the last element of ugly_numbers  
    END FUNCTION  
END CLASS