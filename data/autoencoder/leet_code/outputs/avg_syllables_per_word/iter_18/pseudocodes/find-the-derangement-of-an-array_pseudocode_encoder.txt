CLASS Solution  
    FUNCTION findDerangement WITH PARAMETER n  
        SET MOD TO one billion PLUS seven  
        IF n EQUALS one  
            RETURN zero  
        END IF  
        IF n EQUALS two  
            RETURN one  
        END IF  
        SET prev2 TO one  
        SET prev1 TO zero  
        FOR i FROM three TO n INCLUSIVE  
            SET current TO the quantity of i MINUS one MULTIPLIED BY the sum of prev1 AND prev2  
            SET current TO current MODULO MOD  
            SET prev2 TO prev1  
            SET prev1 TO current  
        END FOR  
        RETURN prev1  
    END FUNCTION  
END CLASS