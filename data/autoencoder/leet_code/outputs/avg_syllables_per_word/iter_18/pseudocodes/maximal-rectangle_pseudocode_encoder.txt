CLASS Solution  
    FUNCTION maximalRectangle(matrix AS List OF List OF string)  
        IF matrix IS empty OR element at position zero of matrix IS empty  
            RETURN zero  
        END IF  
        SET rows TO the LENGTH OF matrix  
        SET cols TO the LENGTH OF element at position zero of matrix  
        SET heights TO a list of cols elements each initialized TO zero  
        SET max_area TO zero  
        FOR index_i FROM zero TO rows MINUS one  
            FOR index_j FROM zero TO cols MINUS one  
                IF element at position index_j of element at position index_i of matrix EQUALS character one  
                    INCREMENT element at position index_j of heights BY one  
                ELSE  
                    SET element at position index_j of heights TO zero  
                END IF  
            END FOR  
            SET max_area TO the GREATER OF max_area AND the RESULT OF self CALLING largestRectangleArea WITH heights  
        END FOR  
        RETURN max_area  
    END FUNCTION  
  
    FUNCTION largestRectangleArea(heights AS List OF integer)  
        SET stack TO empty list  
        SET max_area TO zero  
        SET index TO zero  
        WHILE index IS LESS THAN the LENGTH OF heights HOLDS  
            IF stack IS empty OR element at position index of heights IS GREATER THAN OR EQUAL TO element at position element at the LAST position of stack of heights  
                APPEND index TO stack  
                INCREMENT index BY one  
            ELSE  
                SET top_of_stack TO the RESULT OF REMOVING the LAST element FROM stack  
                IF stack IS empty  
                    SET width TO index  
                ELSE  
                    SET width TO index MINUS element at the LAST position of stack MINUS one  
                END IF  
                SET area TO element at position top_of_stack of heights MULTIPLIED BY width  
                SET max_area TO the GREATER OF max_area AND area  
            END IF  
        END WHILE  
        WHILE stack IS NOT empty  
            SET top_of_stack TO the RESULT OF REMOVING the LAST element FROM stack  
            IF stack IS empty  
                SET width TO index  
            ELSE  
                SET width TO index MINUS element at the LAST position of stack MINUS one  
            END IF  
            SET area TO element at position top_of_stack of heights MULTIPLIED BY width  
            SET max_area TO the GREATER OF max_area AND area  
        END WHILE  
        RETURN max_area  
    END FUNCTION  
END CLASS