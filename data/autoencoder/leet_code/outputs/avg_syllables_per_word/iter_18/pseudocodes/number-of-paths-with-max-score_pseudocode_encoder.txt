CLASS Solution  
    FUNCTION pathsWithMaxScore WITH PARAMETER board OF TYPE list of string  
        SET MOD TO ten raised to the power of nine PLUS one  
        SET n TO the LENGTH OF board  
          
        CALL auxiliary FUNCTION initialize_dp WITH PARAMETERS n  
        ASSIGN reference TO dp  
          
        CALL auxiliary FUNCTION set_starting_point WITH PARAMETERS dp n  
          
        FOR i FROM n MINUS one DOWN TO zero  
            FOR j FROM n MINUS one DOWN TO zero  
                IF element at position j of element at position i of board IS EQUAL TO character X OR IS EQUAL TO character S  
                    CONTINUE TO next iteration of inner loop  
                END IF  
                  
                CALL auxiliary FUNCTION get_cell_value WITH PARAMETERS board i j  
                ASSIGN reference TO value  
                  
                FOR each pair x and y IN list containing pair one zero and pair zero one and pair one one  
                    SET ni TO i PLUS x  
                    SET nj TO j PLUS y  
                      
                    IF ni IS GREATER THAN OR EQUAL TO zero AND ni IS LESS THAN n AND nj IS GREATER THAN OR EQUAL TO zero AND nj IS LESS THAN n  
                        IF first element of element at position nj of element at position ni of dp IS GREATER THAN first element of element at position j of element at position i of dp  
                            SET element at position j of element at position i of dp TO list containing first element of element at position nj of element at position ni of dp PLUS value AND second element of element at position nj of element at position ni of dp  
                        ELSE IF first element of element at position nj of element at position ni of dp IS EQUAL TO first element of element at position j of element at position i of dp  
                            SET second element of element at position j of element at position i of dp TO (second element of element at position j of element at position i of dp PLUS second element of element at position nj of element at position ni of dp) MODULO MOD  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
          
        IF first element of element at position zero of element at position zero of dp IS EQUAL TO negative infinity  
            RETURN list containing zero AND zero  
        END IF  
          
        RETURN list containing first element of element at position zero of element at position zero of dp AND second element of element at position zero of element at position zero of dp  
    END FUNCTION  
      
    FUNCTION initialize_dp WITH PARAMETER n  
        DESCRIBE dp AS two dimensional list with n rows each containing n elements each being a list with negative infinity and zero  
        RETURN dp  
    END FUNCTION  
      
    FUNCTION set_starting_point WITH PARAMETERS dp n  
        SET element at position n MINUS one of element at position n MINUS one of dp TO list containing zero AND one  
    END FUNCTION  
      
    FUNCTION get_cell_value WITH PARAMETERS board i j  
        IF element at position j of element at position i of board IS NOT EQUAL TO character E  
            RETURN integer value of element at position j of element at position i of board  
        ELSE  
            RETURN zero  
        END IF  
    END FUNCTION  
END CLASS