CLASS Solution  
    FUNCTION magicalString WITH PARAMETER n  
        IF n EQUALS zero THEN  
            RETURN zero  
        END IF  
  
        IF n LESS THAN OR EQUAL TO three THEN  
            RETURN one  
        END IF  
  
        SET s TO list containing one followed by two followed by two  
        SET count TO one  
        SET index TO two  
  
        WHILE the LENGTH OF s LESS THAN n DO  
            SET next_num TO three MINUS element at position negative one of s  
            FOR each repetition FROM one TO element at position index of s DO  
                APPEND next_num TO s  
            END FOR  
  
            IF next_num EQUALS one THEN  
                INCREMENT count BY element at position index of s  
            END IF  
  
            INCREMENT index BY one  
        END WHILE  
  
        IF the LENGTH OF s GREATER THAN n THEN  
            SET excess_length TO the LENGTH OF s MINUS n  
            SET last_element TO element at position negative one of s  
            DECREMENT count BY last_element MULTIPLIED BY excess_length  
        END IF  
  
        RETURN count  
    END FUNCTION  
END CLASS