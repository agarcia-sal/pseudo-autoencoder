CLASS Solution  
    FUNCTION minMalwareSpread(graph AS list of list of integer, initial AS list of integer) RETURNS integer  
        SET n TO the LENGTH OF graph  
        SET adj_list TO a mapping from integer to list initialized empty  
        FOR index i FROM zero TO n MINUS one  
            FOR index j FROM i PLUS one TO n MINUS one  
                IF element at position j of element at position i of graph EQUALS one THEN  
                    APPEND j TO element at position i of adj_list  
                    APPEND i TO element at position j of adj_list  
                END IF  
            END FOR  
        END FOR  
        
        FUNCTION dfs(node AS integer, visited AS set of integer) RETURNS integer  
            IF node IS IN visited THEN  
                RETURN zero  
            END IF  
            APPEND node TO visited  
            SET size TO one  
            FOR each neighbor IN element at position node of adj_list  
                INCREMENT size BY dfs(neighbor, visited)  
            END FOR  
            RETURN size  
        END FUNCTION  
        
        SET infected TO a set initialized with elements from initial  
        SET component_sizes TO empty list  
        SET visited TO empty set  
        SET component_index TO a mapping from integer to integer initialized empty  
        
        FOR node FROM zero TO n MINUS one  
            IF node NOT IN visited AND node NOT IN infected THEN  
                SET size TO dfs(node, visited)  
                APPEND size TO component_sizes  
                SET i TO the LENGTH OF component_sizes MINUS one  
                WHILE i GREATER THAN OR EQUAL TO zero  
                    IF element at position i of component_sizes EQUALS size THEN  
                        BREAK  
                    END IF  
                    DECREMENT i BY one  
                END WHILE  
                FOR each neighbor IN element at position node of adj_list  
                    SET element at key neighbor of component_index TO i  
                END FOR  
            END IF  
        END FOR  
        
        SET infected_in_component TO a mapping from integer to integer with default zero  
        FOR each node IN infected  
            IF node IS IN component_index THEN  
                INCREMENT element at key element at key node of component_index of infected_in_component BY one  
            END IF  
        END FOR  
        
        SET max_size TO zero  
        SET node_to_remove TO the minimum element IN initial  
        
        FOR each node IN infected  
            IF node IS IN component_index THEN  
                SET comp_idx TO element at key node of component_index  
                IF element at key comp_idx of infected_in_component EQUALS one THEN  
                    IF element at position comp_idx of component_sizes GREATER THAN max_size THEN  
                        SET max_size TO element at position comp_idx of component_sizes  
                        SET node_to_remove TO node  
                    ELSE IF element at position comp_idx of component_sizes EQUALS max_size THEN  
                        SET node_to_remove TO the minimum BETWEEN node_to_remove AND node  
                    END IF  
                END IF  
            END IF  
        END FOR  
        
        RETURN node_to_remove  
    END FUNCTION  
END CLASS