CLASS Solution  
    FUNCTION findPaths WITH PARAMETERS m n maxMove startRow startColumn  
        SET MOD TO ten raised to the power of nine PLUS one  
        SET directions TO the list containing the following pairs of integers zero and one zero and negative one one and zero negative one and zero  
        CALL auxiliary FUNCTION initialize3DDPArray WITH PARAMETERS m n maxMove AND ASSIGN RESULT TO dp  
        FOR each number k FROM one TO maxMove  
            FOR each number i FROM zero TO m MINUS one  
                FOR each number j FROM zero TO n MINUS one  
                    FOR each pair di and dj IN directions  
                        SET ni TO i PLUS di  
                        SET nj TO j PLUS dj  
                        IF ni IS LESS THAN zero OR ni IS GREATER THAN OR EQUAL TO m OR nj IS LESS THAN zero OR nj IS GREATER THAN OR EQUAL TO n THEN  
                            SET element at position i of dp then element at position j then element at position k TO the remainder of the division of the sum of the element at position i of dp then element at position j then element at position k PLUS one BY MOD  
                        ELSE  
                            SET element at position i of dp then element at position j then element at position k TO the remainder of the division of the sum of the element at position i of dp then element at position j then element at position k PLUS element at position ni of dp then element at position nj then element at position k MINUS one BY MOD  
                        END IF  
                    END FOR  
                END FOR  
            END FOR  
        END FOR  
        RETURN element at position startRow of dp then element at position startColumn then element at position maxMove  
    END FUNCTION  

    FUNCTION initialize3DDPArray WITH PARAMETERS m n maxMove  
        RETURN a three dimensional array of size m by n by maxMove PLUS one filled with zeros  
    END FUNCTION  
END CLASS