CLASS Solution  
    FUNCTION minAbbreviation WITH PARAMETERS target AND dictionary  
        FUNCTION is_valid_abbr WITH PARAMETERS s AND abbr  
            SET i TO zero  
            SET j TO zero  
            WHILE i IS LESS THAN the LENGTH OF s AND j IS LESS THAN the LENGTH OF abbr  
                IF character at position j of abbr IS a digit  
                    IF character at position j of abbr EQUALS zero AS CHARACTER  
                        RETURN False  
                    END IF  
                    SET shift TO zero  
                    WHILE j IS LESS THAN the LENGTH OF abbr AND character at position j of abbr IS a digit  
                        SET shift TO shift MULTIPLIED BY ten PLUS numeric value of character at position j of abbr  
                        INCREMENT j BY one  
                    END WHILE  
                    INCREMENT i BY shift  
                ELSE  
                    IF character at position i of s IS NOT EQUAL TO character at position j of abbr  
                        RETURN False  
                    END IF  
                    INCREMENT i BY one  
                    INCREMENT j BY one  
                END IF  
            END WHILE  
            RETURN i EQUALS the LENGTH OF s AND j EQUALS the LENGTH OF abbr  
        END FUNCTION  
        
        FUNCTION generate_abbrs WITH PARAMETERS word length abbr AS empty string index SET TO zero skip_count SET TO zero  
            IF index EQUALS length  
                IF skip_count IS GREATER THAN zero  
                    SET abbr TO abbr CONCATENATED WITH string representation of skip_count  
                END IF  
                APPEND abbr TO abbrs  
                RETURN  
            END IF  
            CALL generate_abbrs WITH PARAMETERS word length abbr index INCREMENTED BY one skip_count INCREMENTED BY one  
            IF skip_count IS GREATER THAN zero  
                SET abbr TO abbr CONCATENATED WITH string representation of skip_count  
            END IF  
            CALL generate_abbrs WITH PARAMETERS word length abbr CONCATENATED WITH character at position index of word index INCREMENTED BY one zero  
        END FUNCTION  
        
        FUNCTION find_unique_abbr  
            FOR length FROM one TO the LENGTH OF target  
                SET abbrs TO empty list  
                CALL generate_abbrs WITH PARAMETERS target the LENGTH OF target  
                SET min_abbr TO None  
                SET min_length TO positive infinity  
                FOR each abbr IN abbrs  
                    IF for all words in filtered_dict the result of is_valid_abbr with the word AND abbr IS False  
                        IF the LENGTH OF abbr IS LESS THAN min_length  
                            SET min_length TO the LENGTH OF abbr  
                            SET min_abbr TO abbr  
                        END IF  
                    END IF  
                END FOR  
                IF min_abbr IS NOT None  
                    RETURN min_abbr  
                END IF  
            END FOR  
        END FUNCTION  
        
        SET filtered_dict TO empty list  
        FOR each word IN dictionary  
            IF the LENGTH OF word EQUALS the LENGTH OF target  
                APPEND word TO filtered_dict  
            END IF  
        END FOR  
        
        SET abbrs TO empty list  
        RETURN the RESULT OF find_unique_abbr  
    END FUNCTION  
END CLASS