CLASS Solution
    FUNCTION cutOffTree WITH PARAMETER forest AS list of list of integer
        IF forest IS empty OR first element at position zero of forest IS empty
            RETURN minus one
        END IF

        SET trees TO an empty list
        FOR each index_i FROM zero TO the length of forest MINUS one
            FOR each index_j FROM zero TO the length of element at position zero of forest MINUS one
                IF element at position index_i of forest at position index_j IS GREATER THAN one
                    APPEND tuple consisting of element at position index_i of forest at position index_j and index_i and index_j TO trees
                END IF
            END FOR
        END FOR

        SORT trees in ascending order

        FUNCTION bfs WITH PARAMETERS start AS tuple and end AS tuple
            IF start EQUALS end
                RETURN zero
            END IF

            SET m TO the length of forest
            SET n TO the length of element at position zero of forest
            SET queue TO a new deque initialized with element start
            SET visited TO a new set initialized with element start
            SET steps TO zero

            WHILE queue CONTAINS elements
                FOR each number from zero TO the length of queue MINUS one
                    SET x and y TO the unpacked first element removed from the left of queue
                    FOR each tuple dx and dy IN the list of tuples consisting of minus one and zero PLUS one and zero PLUS zero and minus one PLUS zero and one
                        SET nx TO x PLUS dx
                        SET ny TO y PLUS dy
                        IF nx IS GREATER THAN OR EQUAL TO zero AND nx IS LESS THAN m AND ny IS GREATER THAN OR EQUAL TO zero AND ny IS LESS THAN n AND tuple nx and ny IS NOT IN visited AND element at position nx of forest at position ny IS NOT EQUAL TO zero
                            IF tuple nx and ny EQUALS end
                                RETURN steps PLUS one
                            END IF
                            ADD tuple nx and ny TO visited
                            APPEND tuple nx and ny TO queue
                        END IF
                    END FOR
                END FOR
                INCREMENT steps BY one
            END WHILE

            RETURN minus one
        END FUNCTION

        SET x TO zero
        SET y TO zero
        SET total_steps TO zero

        FOR each tuple height tx and ty IN trees
            SET steps TO bfs with parameters tuple x and y and tuple tx and ty
            IF steps EQUALS minus one
                RETURN minus one
            END IF
            INCREMENT total_steps BY steps
            SET x TO tx
            SET y TO ty
        END FOR

        RETURN total_steps
    END FUNCTION
END CLASS