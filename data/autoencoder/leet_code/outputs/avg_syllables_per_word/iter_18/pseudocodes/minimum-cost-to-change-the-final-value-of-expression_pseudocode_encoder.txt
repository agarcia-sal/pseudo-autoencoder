CLASS Solution  
    FUNCTION minOperationsToFlip(expression)  
        SET stack TO empty list  
        FOR each element IN expression  
            IF element IS IN the collection of characters ampersand open parenthesis pipe  
                APPEND a tuple consisting of element and zero TO stack  
                CONTINUE to the next iteration  
            END IF  
            IF element IS the character close parenthesis  
                SET lastPair TO the result of removing the last element from stack  
                REMOVE the last element from stack  
            ELSE  
                SET lastPair TO a tuple consisting of element and one  
            END IF  
            IF the stack IS NOT empty AND the first component of the last element of stack IS IN the collection of characters ampersand pipe  
                SET op TO the first component of the result of removing the last element from stack  
                SET a and costA TO the components of the result of removing the last element from stack  
                SET b and costB TO the components of lastPair  
                IF op EQUALS ampersand  
                    IF a EQUALS character zero AND b EQUALS character zero  
                        SET lastPair TO a tuple consisting of character zero and the sum of one AND the minimum of costA AND costB  
                    ELSE IF a EQUALS character zero AND b EQUALS character one  
                        SET lastPair TO a tuple consisting of character zero and one  
                    ELSE IF a EQUALS character one AND b EQUALS character zero  
                        SET lastPair TO a tuple consisting of character zero and one  
                    ELSE  
                        SET lastPair TO a tuple consisting of character one AND the minimum of costA AND costB  
                    END IF  
                ELSE  
                    IF a EQUALS character zero AND b EQUALS character zero  
                        SET lastPair TO a tuple consisting of character zero AND the minimum of costA AND costB  
                    ELSE IF a EQUALS character zero AND b EQUALS character one  
                        SET lastPair TO a tuple consisting of character one AND one  
                    ELSE IF a EQUALS character one AND b EQUALS character zero  
                        SET lastPair TO a tuple consisting of character one AND one  
                    ELSE  
                        SET lastPair TO a tuple consisting of character one AND the sum of one AND the minimum of costA AND costB  
                    END IF  
                END IF  
            END IF  
            APPEND lastPair TO stack  
        END FOR  
        RETURN the second component of the last element of stack  
    END FUNCTION  
END CLASS