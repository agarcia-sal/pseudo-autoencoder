CLASS Solution  
    FUNCTION maxProfit WITH PARAMETERS k AND prices  
        IF prices IS EMPTY OR k EQUALS zero THEN  
            RETURN zero  
        END IF  
        
        SET n TO the LENGTH OF prices  
        
        IF k GREATER THAN OR EQUAL TO n DIVIDED BY two THEN  
            SET profit TO zero  
            FOR index FROM one TO n MINUS one  
                IF the element at position index of prices GREATER THAN the element at position index MINUS one of prices THEN  
                    INCREMENT profit BY the element at position index of prices MINUS the element at position index MINUS one of prices  
                END IF  
            END FOR  
            RETURN profit  
        END IF  
        
        SET hold TO a list of length k PLUS one with each element SET TO negative infinity  
        SET release TO a list of length k PLUS one with each element SET TO zero  
        
        FOR each price IN prices  
            FOR transaction_index FROM one TO k  
                SET hold at position transaction_index TO the MAXIMUM OF hold at position transaction_index AND release at position transaction_index MINUS one MINUS price  
                SET release at position transaction_index TO the MAXIMUM OF release at position transaction_index AND hold at position transaction_index PLUS price  
            END FOR  
        END FOR  
        
        RETURN release at position k  
    END FUNCTION  
END CLASS