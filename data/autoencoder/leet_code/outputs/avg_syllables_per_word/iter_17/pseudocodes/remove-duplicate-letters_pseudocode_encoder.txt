CLASS Solution
    FUNCTION removeDuplicateLetters(s)
        SET last_occurrence TO CALL compute_last_occurrence WITH s
        SET stack TO an empty list
        SET in_stack TO an empty set

        FOR each index AND character IN enumerations of s
            IF character IS IN in_stack
                CONTINUE to next iteration
            END IF

            WHILE stack IS NOT empty AND character IS LESS THAN element at position last of stack AND index IS LESS THAN element at position element at position last of stack of last_occurrence
                SET removed_char TO CALL pop last element FROM stack
                REMOVE removed_char FROM in_stack
            END WHILE

            APPEND character TO stack
            ADD character TO in_stack
        END FOR

        RETURN CALL join elements of stack INTO string
    END FUNCTION
END CLASS