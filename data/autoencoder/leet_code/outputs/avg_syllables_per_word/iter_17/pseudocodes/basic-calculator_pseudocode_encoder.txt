CLASS Solution
    FUNCTION calculate(string s)
        FUNCTION helper(list_of_characters s)
            SET list_of_numbers stack TO empty list
            SET character sign TO plus
            SET number num TO zero
            
            WHILE the LENGTH OF s GREATER THAN zero holds
                SET character char TO the element at position zero of list_of_characters s
                REMOVE element at position zero FROM list_of_characters s
                
                IF character char IS A DIGIT
                    SET num TO num MULTIPLIED BY ten PLUS the integer value of character char
                END IF
                
                IF character char EQUALS open parenthesis
                    SET num TO CALL helper WITH list_of_characters s
                END IF
                
                IF character char IS NOT A DIGIT AND character char IS NOT A WHITESPACE CHARACTER OR the LENGTH OF s EQUALS zero
                    IF character sign EQUALS plus
                        APPEND num TO list_of_numbers stack
                    ELSE IF character sign EQUALS minus
                        APPEND the NEGATION OF num TO list_of_numbers stack
                    ELSE IF character sign EQUALS multiplication symbol
                        SET the element at position the LENGTH OF stack MINUS one OF list_of_numbers stack TO the element at position the LENGTH OF stack MINUS one OF list_of_numbers stack MULTIPLIED BY num
                    ELSE IF character sign EQUALS division symbol
                        SET the element at position the LENGTH OF stack MINUS one OF list_of_numbers stack TO the integer value of the element at position the LENGTH OF stack MINUS one OF list_of_numbers stack DIVIDED BY num
                    END IF
                    SET sign TO character char
                    SET num TO zero
                END IF
                
                IF character char EQUALS close parenthesis
                    BREAK
                END IF
            END WHILE
            
            RETURN the SUM OF list_of_numbers stack
        END FUNCTION
        
        RETURN CALL helper WITH the list of characters of string s
    END FUNCTION
END CLASS