CLASS Solution
    FUNCTION customSortString(order_string, s_string)
        SET character_order_dictionary TO CALL buildCharacterOrderDictionary WITH order_string
        SET sorted_character_list TO CALL sortStringWithCustomOrder WITH s_string AND character_order_dictionary
        SET result_string TO CALL joinCharacters WITH sorted_character_list
        RETURN result_string
    END FUNCTION

    FUNCTION buildCharacterOrderDictionary(order_string)
        SET order_dictionary TO an empty dictionary
        FOR each index FROM zero TO the LENGTH OF order_string MINUS one
            SET character_at_position TO element at position index of order_string
            SET value_at_character TO index
            SET order_dictionary AT character_at_position TO value_at_character
        END FOR
        RETURN order_dictionary
    END FUNCTION

    FUNCTION sortStringWithCustomOrder(s_string, order_dictionary)
        SET list_of_characters TO CALL convertStringToList WITH s_string
        SET sorted_list TO CALL sortCharactersByOrderDictionary WITH list_of_characters AND order_dictionary
        RETURN sorted_list
    END FUNCTION

    FUNCTION convertStringToList(s_string)
        IMPLEMENTATION OMITTED
    END FUNCTION

    FUNCTION sortCharactersByOrderDictionary(list_of_characters, order_dictionary)
        IMPLEMENTATION OMITTED
    END FUNCTION

    FUNCTION joinCharacters(list_of_characters)
        IMPLEMENTATION OMITTED
    END FUNCTION
END CLASS