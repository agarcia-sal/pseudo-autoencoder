CLASS Solution
    FUNCTION minCost(grid)
        SET m TO the LENGTH OF grid
        SET n TO the LENGTH OF element at position zero of grid
        SET directions TO list containing elements zero comma one comma zero comma MINUS one comma one comma zero comma MINUS one comma zero
        CALL initializeCosts WITH parameters m comma n AND SET costs TO result
        
        SET element at position zero of element at position zero of costs TO zero
        
        CALL initializePriorityQueue WITH no parameters AND SET pq TO result containing tuple zero comma zero comma zero
        CALL initializeVisitedSet WITH no parameters AND SET visited TO result
        
        WHILE pq is NOT empty
            CALL popHeap FROM pq AND SET cost comma i comma j TO result
            
            IF tuple i comma j IS IN visited
                CONTINUE
            END IF
            
            ADD tuple i comma j TO visited
            
            IF i EQUALS m MINUS one AND j EQUALS n MINUS one
                RETURN cost
            END IF
            
            FOR k FROM zero TO the LENGTH OF directions MINUS one
                SET di TO element at position zero of element at position k of directions
                SET dj TO element at position one of element at position k of directions
                SET ni TO i PLUS di
                SET nj TO j PLUS dj
                
                IF ni IS GREATER THAN OR EQUAL TO zero AND ni IS LESS THAN m AND nj IS GREATER THAN OR EQUAL TO zero AND nj IS LESS THAN n
                    SET grid_direction TO element at position ni of element at position nj of grid
                    SET increment_cost TO one IF k PLUS one IS NOT EQUAL TO element at position i of element at position j of grid ELSE zero
                    SET new_cost TO cost PLUS increment_cost
                    
                    IF new_cost IS LESS THAN element at position ni of element at position nj of costs
                        SET element at position ni of element at position nj of costs TO new_cost
                        CALL pushHeap TO pq WITH tuple new_cost comma ni comma nj
                    END IF
                END IF
            END FOR
        END WHILE
        
        RETURN MINUS one
    END FUNCTION

    FUNCTION initializeCosts(m comma n)
        RETURN a two dimensional list with m rows AND n columns filled with positive infinity
    END FUNCTION
    
    FUNCTION initializePriorityQueue()
        RETURN an empty priority queue
    END FUNCTION
    
    FUNCTION initializeVisitedSet()
        RETURN an empty set
    END FUNCTION
    
    FUNCTION popHeap(pq)
        RETURN the tuple with smallest first element popped FROM priority queue pq
    END FUNCTION
    
    FUNCTION pushHeap(pq comma element)
        INSERT element INTO priority queue pq maintaining heap order
    END FUNCTION
END CLASS