CLASS Solution
    FUNCTION longestDupSubstring(s)
        FUNCTION search(length)
            SET seen TO empty set
            FOR index FROM zero TO the LENGTH OF s MINUS length PLUS one MINUS one
                SET substring TO the substring from position index TO index PLUS length MINUS one of s
                IF substring IS IN seen
                    RETURN substring
                END IF
                ADD substring TO seen
            END FOR
            RETURN the empty string
        END FUNCTION

        SET left TO one
        SET right TO the LENGTH OF s MINUS one
        SET longest TO the empty string

        WHILE left IS LESS THAN OR EQUAL TO right
            SET mid TO the integer division of left PLUS right BY two
            CALL search WITH mid AND ASSIGN TO candidate
            IF candidate IS NOT the empty string
                SET longest TO candidate
                SET left TO mid PLUS one
            ELSE
                SET right TO mid MINUS one
            END IF
        END WHILE

        RETURN longest
    END FUNCTION
END CLASS