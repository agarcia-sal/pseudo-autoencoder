CLASS Solution
    FUNCTION subStrHash(s, power, modulo, k, hashValue)
        FUNCTION val(c)
            RETURN the Unicode code point of character c MINUS the Unicode code point of character a PLUS one
        END FUNCTION

        SET n TO the LENGTH OF s
        SET current_hash TO zero
        SET p_pow TO one

        FOR index FROM n MINUS k TO n MINUS one
            SET current_hash TO the REMAINDER AFTER DIVIDING current_hash PLUS val(element at position index of s) MULTIPLIED BY p_pow BY modulo
            IF index LESS THAN n MINUS one
                SET p_pow TO the REMAINDER AFTER DIVIDING p_pow MULTIPLIED BY power BY modulo
            END IF
        END FOR

        SET start_index TO n MINUS k
        IF current_hash EQUALS hashValue
            RETURN the SUBSTRING from position start_index TO start_index PLUS k OF s
        END IF

        SET p_pow_k_minus_1 TO p_pow

        FOR index FROM n MINUS k MINUS one DOWN TO zero
            SET current_hash TO the REMAINDER AFTER DIVIDING current_hash MINUS val(element at position index PLUS k of s) MULTIPLIED BY p_pow_k_minus_1 BY modulo
            SET current_hash TO the REMAINDER AFTER DIVIDING current_hash MULTIPLIED BY power PLUS val(element at position index of s) BY modulo

            IF current_hash EQUALS hashValue
                SET start_index TO index
            END IF
        END FOR

        RETURN the SUBSTRING from position start_index TO start_index PLUS k OF s
    END FUNCTION
END CLASS