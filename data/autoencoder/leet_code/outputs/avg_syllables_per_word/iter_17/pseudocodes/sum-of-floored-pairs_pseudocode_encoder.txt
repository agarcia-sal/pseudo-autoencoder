CLASS Solution
    FUNCTION sumOfFlooredPairs(nums)
        SET MODULO TO one billion PLUS seven
        SET maximum_number TO the MAXIMUM element of nums
        SET count_map TO CALL Counter WITH nums
        SET prefix_sum_list TO A LIST OF zero REPEATED maximum_number PLUS one TIMES

        FOR each number IN the KEYS OF count_map
            INCREMENT element at position number of prefix_sum_list BY element at position number of count_map
        END FOR

        FOR index FROM one TO maximum_number
            INCREMENT element at position index of prefix_sum_list BY element at position index MINUS one of prefix_sum_list
        END FOR

        SET result_sum TO zero

        FOR each number IN the KEYS OF count_map
            FOR multiplier FROM one TO the INTEGER DIVISION OF maximum_number BY number
                SET start_position TO number MULTIPLIED BY multiplier
                SET end_position TO the MINIMUM OF number MULTIPLIED BY (multiplier PLUS one) MINUS one AND maximum_number
                SET multiples_count TO element at position end_position of prefix_sum_list MINUS element at position start_position MINUS one of prefix_sum_list
                SET increment_value TO multiples_count MULTIPLIED BY multiplier MULTIPLIED BY element at position number of count_map
                INCREMENT result_sum BY increment_value
                SET result_sum TO result_sum MODULO MODULO
            END FOR
        END FOR

        RETURN result_sum
    END FUNCTION
END CLASS