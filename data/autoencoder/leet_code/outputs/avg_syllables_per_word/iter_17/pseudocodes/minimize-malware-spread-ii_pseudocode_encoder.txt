CLASS Solution
    FUNCTION minMalwareSpread(graph, initial)
        SET number_of_nodes TO the LENGTH OF graph
        SET adjacency_list TO CALL defaultdict WITH parameter list
        
        FOR index i FROM zero TO number_of_nodes MINUS one
            FOR index j FROM i PLUS one TO number_of_nodes MINUS one
                IF element at position i of graph AT position j EQUALS one
                    APPEND j TO element at position i OF adjacency_list
                    APPEND i TO element at position j OF adjacency_list
                END IF
            END FOR
        END FOR

        FUNCTION dfs(node, visited)
            IF node IS IN visited
                RETURN zero
            END IF
            APPEND node TO visited
            SET component_size TO one
            FOR each neighbor IN element at position node OF adjacency_list
                INCREMENT component_size BY CALL dfs WITH parameters neighbor AND visited
            END FOR
            RETURN component_size
        END FUNCTION

        SET infected_nodes TO a SET OF elements IN initial
        SET component_sizes TO an empty LIST
        SET visited TO an empty SET
        SET component_index TO an empty DICTIONARY

        FOR index node FROM zero TO number_of_nodes MINUS one
            IF node IS NOT IN visited AND node IS NOT IN infected_nodes
                SET size TO CALL dfs WITH parameters node AND visited
                APPEND size TO component_sizes
                
                FOR index i FROM the LENGTH OF component_sizes MINUS one DOWN TO zero
                    IF element at position i OF component_sizes EQUALS size
                        BREAK loop
                    END IF
                END FOR

                FOR each neighbor IN element at position node OF adjacency_list
                    SET element at position neighbor OF component_index TO i
                END FOR
            END IF
        END FOR

        SET infected_in_component TO CALL defaultdict WITH parameter int
        FOR each node IN infected_nodes
            IF node IS IN component_index
                INCREMENT element at position component_index AT key node OF infected_in_component BY one
            END IF
        END FOR

        SET maximum_component_size TO zero
        SET node_to_remove TO the MINIMUM element IN initial

        FOR each node IN infected_nodes
            IF node IS IN component_index
                SET comp_idx TO element at position node OF component_index
                IF element at position comp_idx OF infected_in_component EQUALS one
                    IF element at position comp_idx OF component_sizes GREATER THAN maximum_component_size
                        SET maximum_component_size TO element at position comp_idx OF component_sizes
                        SET node_to_remove TO node
                    ELSE IF element at position comp_idx OF component_sizes EQUALS maximum_component_size
                        SET node_to_remove TO the MINIMUM OF node_to_remove AND node
                    END IF
                END IF
            END IF
        END FOR

        RETURN node_to_remove
    END FUNCTION
END CLASS