CLASS Solution
    FUNCTION longestSubsequenceRepeatedK(input_string, repetition_count)
        CALL import_counter_class_from_collections
        
        SET frequency_map TO CALL Counter WITH input_string
        
        SET valid_characters TO empty list
        FOR each character, count IN frequency_map
            IF count GREATER THAN OR EQUAL TO repetition_count
                APPEND character TO valid_characters
            END IF
        END FOR
        
        SORT valid_characters IN descending lexicographical order
        
        FUNCTION is_valid_subsequence(candidate_subsequence)
            SET occurrence_count TO zero
            SET position_index TO zero
            FOR each character IN input_string
                IF character EQUALS element at position position_index of candidate_subsequence
                    INCREMENT position_index BY one
                    IF position_index EQUALS the LENGTH OF candidate_subsequence
                        INCREMENT occurrence_count BY one
                        SET position_index TO zero
                        IF occurrence_count EQUALS repetition_count
                            RETURN true
                        END IF
                    END IF
                END IF
            END FOR
            RETURN false
        END FUNCTION
        
        SET maximum_length TO the LENGTH OF valid_characters DIVIDED BY repetition_count
        SET best_candidate TO empty string
        
        FUNCTION backtrack(current_candidate)
            IF the LENGTH OF current_candidate GREATER THAN the LENGTH OF best_candidate
                SET best_candidate TO current_candidate
            END IF
            FOR each character IN valid_characters
                SET new_candidate TO current_candidate CONCATENATED WITH character
                IF CALL is_valid_subsequence WITH new_candidate RETURNS true
                    CALL backtrack WITH new_candidate
                END IF
            END FOR
        END FUNCTION
        
        CALL backtrack WITH empty string
        RETURN best_candidate
    END FUNCTION
END CLASS