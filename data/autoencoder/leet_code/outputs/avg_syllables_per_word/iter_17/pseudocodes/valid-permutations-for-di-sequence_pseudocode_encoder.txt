CLASS Solution
    FUNCTION numPermsDISequence(sequence_string)
        SET MODULO_VALUE TO ten POWERED BY nine PLUS seven
        SET sequence_length TO the LENGTH OF sequence_string
        
        CALL initialize_two_dimensional_list WITH parameters sequence_length PLUS one AND sequence_length PLUS one RETURNING dp_table
        
        FOR index_j FROM zero TO sequence_length
            SET element at position index_j of element at position zero of dp_table TO one
        END FOR
        
        FOR index_i FROM one TO sequence_length
            SET running_prefix_sum TO zero
            
            IF element at position index_i MINUS one of sequence_string EQUALS character I
                FOR index_j FROM zero TO sequence_length PLUS one MINUS index_i MINUS one
                    SET running_prefix_sum TO running_prefix_sum PLUS element at position index_j of element at position index_i MINUS one of dp_table MODULO MODULO_VALUE
                    SET element at position index_j of element at position index_i of dp_table TO running_prefix_sum
                END FOR
            ELSE
                FOR index_j FROM sequence_length MINUS index_i DOWN TO zero
                    SET running_prefix_sum TO running_prefix_sum PLUS element at position index_j PLUS one of element at position index_i MINUS one of dp_table MODULO MODULO_VALUE
                    SET element at position index_j of element at position index_i of dp_table TO running_prefix_sum
                END FOR
            END IF
        END FOR
        
        SET total_permutations TO the SUM OF element at position sequence_length of dp_table MODULO MODULO_VALUE
        RETURN total_permutations
    END FUNCTION
END CLASS