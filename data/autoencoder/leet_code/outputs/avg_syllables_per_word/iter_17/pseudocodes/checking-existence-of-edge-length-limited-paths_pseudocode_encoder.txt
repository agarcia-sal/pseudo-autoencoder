CLASS UnionFind
    FUNCTION __init__(self, size)
        SET self.parent TO a list containing integers from zero TO size MINUS one
        SET self.rank TO a list containing one repeated size times
    END FUNCTION

    FUNCTION find(self, p)
        IF element at position p of self.parent NOT EQUALS p
            SET element at position p of self.parent TO CALL find WITH parameter element at position p of self.parent
        END IF
        RETURN element at position p of self.parent
    END FUNCTION

    FUNCTION union(self, p, q)
        SET rootP TO CALL find WITH parameter p
        SET rootQ TO CALL find WITH parameter q
        IF rootP EQUALS rootQ
            RETURN False
        END IF
        IF element at position rootP of self.rank GREATER THAN element at position rootQ of self.rank
            SET element at position rootQ of self.parent TO rootP
        ELSE IF element at position rootP of self.rank LESS THAN element at position rootQ of self.rank
            SET element at position rootP of self.parent TO rootQ
        ELSE
            SET element at position rootQ of self.parent TO rootP
            INCREMENT element at position rootP of self.rank BY one
        END IF
        RETURN True
    END FUNCTION
END CLASS

CLASS Solution
    FUNCTION distanceLimitedPathsExist(self, n, edgeList, queries)
        CALL sort ON edgeList WITH key as element at position two of each element
        SET indexedQueries TO a list of tuples containing limit, p, q, and original index FROM enumerating queries where each element is p, q, limit
        CALL sort ON indexedQueries
        SET uf TO a new instance of UnionFind INITIALIZED with n
        SET edgeIndex TO zero
        SET numEdges TO the LENGTH OF edgeList
        SET results TO a list containing False repeated the LENGTH OF queries times
        FOR each limit, p, q, originalIndex IN indexedQueries
            WHILE edgeIndex LESS THAN numEdges AND element at position two of element at position edgeIndex of edgeList LESS THAN limit
                SET u TO element at position zero of element at position edgeIndex of edgeList
                SET v TO element at position one of element at position edgeIndex of edgeList
                CALL union ON uf WITH parameters u, v
                INCREMENT edgeIndex BY one
            END WHILE
            IF CALL find ON uf WITH parameter p EQUALS CALL find ON uf WITH parameter q
                SET element at position originalIndex of results TO True
            END IF
        END FOR
        RETURN results
    END FUNCTION
END CLASS