CLASS Solution
    FUNCTION parseBoolExpr(expression)
        SET stk TO empty list
        FOR each character IN expression
            IF character IS IN the collection of characters t f not and or
                CALL APPEND character TO stk
            ELSE IF character EQUALS the closing parenthesis
                SET true_count TO zero
                SET false_count TO zero
                WHILE the element at the last position of stk IS IN the collection of characters t f
                    INCREMENT true_count BY one IF the element at the last position of stk EQUALS t
                    INCREMENT false_count BY one IF the element at the last position of stk EQUALS f
                    REMOVE the element at the last position FROM stk
                END WHILE
                SET operator TO the element at the last position of stk
                REMOVE the element at the last position FROM stk
                IF operator EQUALS not
                    SET character TO t IF false_count IS GREATER THAN zero ELSE f
                ELSE IF operator EQUALS and
                    SET character TO f IF false_count IS GREATER THAN zero ELSE t
                ELSE IF operator EQUALS or
                    SET character TO t IF true_count IS GREATER THAN zero ELSE f
                END IF
                CALL APPEND character TO stk
            END IF
        END FOR
        RETURN the element at position zero of stk EQUALS t
    END FUNCTION
END CLASS