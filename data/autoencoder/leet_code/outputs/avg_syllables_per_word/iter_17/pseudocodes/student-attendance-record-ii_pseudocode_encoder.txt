CLASS Solution
    FUNCTION checkRecord(n)
        SET MOD TO one billion PLUS seven
        SET dp TO the RESULT OF initialize_three_dimensional_list WITH parameters n PLUS one FOR the first dimension AND two FOR the second dimension AND three FOR the third dimension WITH all elements initialized TO zero
        SET element at position zero of dp at position zero at position zero TO one

        FOR i FROM one TO n
            FOR j FROM zero TO one
                FOR k FROM zero TO two
                    SET element at position i of dp at position j at position zero TO element at position i of dp at position j at position zero PLUS element at position i MINUS one of dp at position j at position k MODULO MOD

                    IF j EQUALS zero
                        SET element at position i of dp at position one at position zero TO element at position i of dp at position one at position zero PLUS element at position i MINUS one of dp at position zero at position k MODULO MOD
                    END IF

                    IF k LESS THAN two
                        SET element at position i of dp at position j at position k PLUS one TO element at position i of dp at position j at position k PLUS one PLUS element at position i MINUS one of dp at position j at position k MODULO MOD
                    END IF
                END FOR
            END FOR
        END FOR

        SET result TO zero
        FOR j FROM zero TO one
            FOR k FROM zero TO two
                SET result TO result PLUS element at position n of dp at position j at position k MODULO MOD
            END FOR
        END FOR

        RETURN result
    END FUNCTION

    FUNCTION initialize_three_dimensional_list(first_dimension, second_dimension, third_dimension)
        // Auxiliary FUNCTION to create a three-dimensional list filled with zeros
    END FUNCTION
END CLASS