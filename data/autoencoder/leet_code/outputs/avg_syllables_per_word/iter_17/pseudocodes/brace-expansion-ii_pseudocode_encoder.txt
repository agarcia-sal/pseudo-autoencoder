CLASS Solution
    FUNCTION braceExpansionII(expression)
        FUNCTION parse_expression(index)
            SET current_set TO an empty set
            SET current_product TO a list containing empty string

            WHILE index LESS THAN the LENGTH OF expression
                SET char TO element at position index of expression
                
                IF char EQUALS the character left brace
                    CALL parse_expression WITH parameter index PLUS one AND ASSIGN results TO inner_set AND index
                    SET current_product TO a list of CONCATENATION OF each element a IN current_product WITH each element b IN inner_set
                ELSE IF char EQUALS the character right brace
                    ADD each concatenated element from current_product TO current_set
                    RETURN current_set AND index
                ELSE IF char EQUALS the character comma
                    ADD each concatenated element from current_product TO current_set
                    SET current_product TO a list containing empty string
                ELSE
                    SET current_product TO a list of CONCATENATION OF each element a IN current_product WITH char
                END IF
                
                INCREMENT index BY one
            END WHILE
            
            ADD each concatenated element from current_product TO current_set
            RETURN current_set AND index
        END FUNCTION
        
        CALL parse_expression WITH parameter zero AND ASSIGN result TO result_set AND an unused variable
        RETURN the SORTED list of elements in result_set
    END FUNCTION
END CLASS