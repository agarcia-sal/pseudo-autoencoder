CLASS Solution
    FUNCTION countRangeSum(nums, lower, upper)
        SET prefix_sums TO list containing zero
        SET current_sum TO zero
        SET count TO zero
        FOR each num IN nums
            INCREMENT current_sum BY num
            SET left TO current_sum MINUS upper
            SET right TO current_sum MINUS lower
            INCREMENT count BY the number of elements LESS THAN OR EQUAL TO right IN prefix_sums MINUS the number of elements LESS THAN left IN prefix_sums
            CALL insert current_sum INTO prefix_sums preserving order
        END FOR
        RETURN count
    END FUNCTION
END CLASS