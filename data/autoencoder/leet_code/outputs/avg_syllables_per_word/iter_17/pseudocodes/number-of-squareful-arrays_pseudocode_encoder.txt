CLASS Solution
    FUNCTION numSquarefulPerms(nums)
        FUNCTION is_square(n)
            RETURN the INTEGER PART OF the SQUARE ROOT OF n MULTIPLIED BY the INTEGER PART OF the SQUARE ROOT OF n EQUALS n
        END FUNCTION

        FUNCTION backtrack(path, count)
            IF the LENGTH OF path EQUALS the LENGTH OF nums
                RETURN one
            END IF

            SET ans TO zero
            FOR each x IN count
                IF the ELEMENT AT position x OF count GREATER THAN zero AND (path IS EMPTY OR is_square(the ELEMENT at the LAST POSITION OF path PLUS x) IS true)
                    DECREMENT the ELEMENT AT position x OF count BY one
                    INCREMENT ans BY CALL backtrack WITH path APPENDED WITH x AND count
                    INCREMENT the ELEMENT AT position x OF count BY one
                END IF
            END FOR
            RETURN ans
        END FUNCTION

        SET count TO CALL Counter WITH nums
        RETURN CALL backtrack WITH empty list AND count
    END FUNCTION
END CLASS