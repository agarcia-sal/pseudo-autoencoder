CLASS Solution
    FUNCTION countPairs(n, edges, queries)
        SET degree TO a list of zero repeated n PLUS one times
        FOR each u, v IN edges
            INCREMENT element at position u of degree BY one
            INCREMENT element at position v of degree BY one
        END FOR

        ASSIGN shared TO a new defaultdict of integer
        FOR each u, v IN edges
            IF u GREATER THAN v
                SWAP u AND v
            END IF
            INCREMENT element at key tuple of u and v of shared BY one
        END FOR

        SET sorted_degree TO the SORTED version of degree

        SET answers TO an empty list
        FOR each q IN queries
            SET count TO zero
            SET left TO one
            SET right TO n
            WHILE left LESS THAN right
                IF element at position left of sorted_degree PLUS element at position right of sorted_degree GREATER THAN q
                    INCREMENT count BY right MINUS left
                    DECREMENT right BY one
                ELSE
                    INCREMENT left BY one
                END IF
            END WHILE

            FOR each tuple of u and v, count_uv IN shared items
                SET degree_uv TO element at position u of degree PLUS element at position v of degree
                IF degree_uv GREATER THAN q AND degree_uv MINUS count_uv LESS THAN OR EQUAL TO q
                    DECREMENT count BY one
                END IF
            END FOR

            APPEND count TO answers
        END FOR

        RETURN answers
    END FUNCTION
END CLASS