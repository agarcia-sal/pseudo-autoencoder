CLASS Solution
    FUNCTION maxProduct(s)
        SET n TO the LENGTH OF s
        SET max_len_end TO a list of length n WITH each element SET TO one
        SET max_len_start TO a list of length n WITH each element SET TO one

        FUNCTION expand_around_center(left, right)
            WHILE left GREATER THAN OR EQUAL TO zero AND right LESS THAN n AND element at position left of s EQUALS element at position right of s
                SET length TO right MINUS left PLUS one
                SET element at position right of max_len_end TO the GREATER OF element at position right of max_len_end AND length
                SET element at position left of max_len_start TO the GREATER OF element at position left of max_len_start AND length
                DECREMENT left BY one
                INCREMENT right BY one
            END WHILE
        END FUNCTION

        FOR i FROM zero TO n MINUS one
            CALL expand_around_center WITH parameters i AND i
        END FOR

        SET prefix_max TO a list of length n WITH each element SET TO zero
        SET suffix_max TO a list of length n WITH each element SET TO zero

        SET element at position zero of prefix_max TO element at position zero of max_len_end
        FOR i FROM one TO n MINUS one
            SET element at position i of prefix_max TO the GREATER OF element at position i MINUS one of prefix_max AND element at position i of max_len_end
        END FOR

        SET element at position n MINUS one of suffix_max TO element at position n MINUS one of max_len_start
        FOR i FROM n MINUS two TO zero STEP MINUS one
            SET element at position i of suffix_max TO the GREATER OF element at position i PLUS one of suffix_max AND element at position i of max_len_start
        END FOR

        SET max_product TO zero
        FOR i FROM zero TO n MINUS two
            SET max_product TO the GREATER OF max_product AND element at position i of prefix_max MULTIPLIED BY element at position i PLUS one of suffix_max
        END FOR

        RETURN max_product
    END FUNCTION
END CLASS