CLASS Solution
    FUNCTION findDerangement(n)
        SET MODULO TO one billion PLUS seven

        IF n EQUALS one
            RETURN zero
        END IF

        IF n EQUALS two
            RETURN one
        END IF

        SET previous_two TO one
        SET previous_one TO zero

        FOR index FROM three TO n
            SET current_value TO index MINUS one MULTIPLIED BY the SUM OF previous_one AND previous_two MODULO MODULO
            SET previous_two TO previous_one
            SET previous_one TO current_value
        END FOR

        RETURN previous_one
    END FUNCTION
END CLASS