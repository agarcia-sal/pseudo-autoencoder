CLASS Solution
    FUNCTION countSubranges(nums1, nums2)
        SET n TO the LENGTH OF nums1
        SET count TO zero
        SET dp TO auxiliary FUNCTION create_defaultdict_list WITH parameter n
        
        FOR index FROM zero TO n MINUS one
            INCREMENT element at position nums1 AT index OF element at position index OF dp BY one
            INCREMENT element at position NEGATIVE element at position index OF nums2 OF element at position index OF dp BY one
            
            IF index GREATER THAN zero
                FOR each balance AND frequency IN items OF element at position index MINUS one OF dp
                    SET temp_balance_plus TO balance PLUS element at position index OF nums1
                    SET temp_balance_minus TO balance MINUS element at position index OF nums2
                    SET element at position temp_balance_plus OF element at position index OF dp TO the SUM OF element at position temp_balance_plus OF element at position index OF dp AND frequency MODULO MOD
                    SET element at position temp_balance_minus OF element at position index OF dp TO the SUM OF element at position temp_balance_minus OF element at position index OF dp AND frequency MODULO MOD
                END FOR
            END IF
            
            SET count TO the SUM OF count AND element at position zero OF element at position index OF dp MODULO MOD
        END FOR
        
        RETURN count
    END FUNCTION
END CLASS