CLASS Solution
    FUNCTION minSwapsCouples(list row AS List OF Integers) RETURNS Integer
        CALL create_position_dictionary WITH list row RETURNING dictionary position
        SET swaps TO zero

        FOR index FROM zero TO the LENGTH OF row MINUS one STEP two
            CALL find_correct_pair WITH element at position index of row RETURNING correct_pair

            IF element at position index PLUS one of row IS NOT EQUALS TO correct_pair
                CALL find_swap_index WITH correct_pair AND dictionary position RETURNING swap_idx

                CALL swap_elements IN row AT index PLUS one AND swap_idx

                CALL update_position_dictionary WITH row AND dictionary position AND swap_idx

                CALL update_position_dictionary WITH row AND dictionary position AND index PLUS one

                INCREMENT swaps BY one
            END IF
        END FOR

        RETURN swaps
    END FUNCTION

    FUNCTION create_position_dictionary(list row) RETURNS dictionary
    END FUNCTION

    FUNCTION find_correct_pair(integer person) RETURNS integer
    END FUNCTION

    FUNCTION find_swap_index(integer correct_pair, dictionary position) RETURNS integer
    END FUNCTION

    FUNCTION swap_elements(list collection, integer index_one, integer index_two)
    END FUNCTION

    FUNCTION update_position_dictionary(list row, dictionary position, integer index)
    END FUNCTION
END CLASS