CLASS Solution
    FUNCTION numberOfCombinations(num)
        SET MOD TO one billion PLUS seven
        SET n TO the LENGTH OF num
        
        INITIALIZE memo AS an empty dictionary
        
        FUNCTION dp(index, prev_len)
            IF index IS EQUAL TO n
                RETURN one
            END IF
            
            IF the TUPLE of index AND prev_len IS IN memo
                RETURN the ELEMENT AT the TUPLE of index AND prev_len IN memo
            END IF
            
            SET count TO zero
            FOR length FROM one TO n MINUS index
                IF the ELEMENT at position index of num IS EQUAL TO zero
                    BREAK the FOR loop
                END IF
                
                SET current_num TO the SUBSTRING from position index TO index PLUS length MINUS one of num
                
                IF prev_len IS EQUAL TO zero OR current_num IS GREATER THAN OR EQUAL TO the SUBSTRING from position index MINUS prev_len TO index MINUS one of num
                    SET count TO count PLUS CALL dp WITH PARAMETERS index PLUS length AND length MODULO MOD
                END IF
            END FOR
            
            SET the ELEMENT AT the TUPLE of index AND prev_len IN memo TO count
            RETURN count
        END FUNCTION
        
        RETURN CALL dp WITH PARAMETERS zero AND zero
    END FUNCTION
END CLASS