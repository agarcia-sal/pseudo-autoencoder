CLASS Solution
    FUNCTION countSubgraphsForEachDiameter(n AS integer, edges AS list of list of integers)
        SET graph TO an empty mapping FROM integers TO lists
        FOR each integer i FROM one TO n
            SET element at position i of graph TO an empty list
        END FOR
        
        FOR each pair u, v IN edges
            APPEND v TO element at position u of graph
            APPEND u TO element at position v of graph
        END FOR
        
        FUNCTION bfs(subtree AS set of integers)
            SET start TO the first element of subtree
            SET queue TO a new empty queue WITH start as initial element
            SET visited TO a new empty set WITH start as initial element
            SET distance TO zero
            SET farthest_node TO start
            
            WHILE queue is not empty
                SET node TO element removed from the front of queue
                FOR each neighbor IN element at position node of graph
                    IF neighbor IS IN subtree AND neighbor IS NOT IN visited
                        ADD neighbor TO visited
                        ADD neighbor TO the end of queue
                        SET farthest_node TO neighbor
                    END IF
                END FOR
            END WHILE
            
            SET queue TO a new empty queue WITH farthest_node as initial element
            SET visited TO a new empty set WITH farthest_node as initial element
            SET max_distance TO zero
            
            WHILE queue is not empty
                SET size TO the LENGTH OF queue
                FOR each iteration FROM one TO size
                    SET node TO element removed from the front of queue
                    FOR each neighbor IN element at position node of graph
                        IF neighbor IS IN subtree AND neighbor IS NOT IN visited
                            ADD neighbor TO visited
                            ADD neighbor TO the end of queue
                        END IF
                    END FOR
                END FOR
                IF queue is not empty
                    INCREMENT max_distance BY one
                END IF
            END WHILE
            
            RETURN max_distance
        END FUNCTION
        
        SET result TO a list of zero repeated n MINUS one times
        
        FOR size FROM two TO n
            FOR each subset IN combinations OF integers FROM one TO n TAKEN size at a time
                SET visited TO an empty set
                SET stack TO a list CONTAINING the first element of subset
                
                WHILE stack is not empty
                    SET node TO element removed from the end of stack
                    IF node IS NOT IN visited
                        ADD node TO visited
                        FOR each neighbor IN element at position node of graph
                            IF neighbor IS IN subset AND neighbor IS NOT IN visited
                                ADD neighbor TO stack
                            END IF
                        END FOR
                    END IF
                END WHILE
                
                IF visited IS EQUAL TO set formed from elements in subset
                    SET diameter TO CALL bfs WITH set formed from elements in subset
                    IF diameter IS GREATER THAN zero
                        INCREMENT element at position diameter MINUS one of result BY one
                    END IF
                END IF
            END FOR
        END FOR
        
        RETURN result
    END FUNCTION
END CLASS