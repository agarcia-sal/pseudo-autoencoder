CLASS Solution
    FUNCTION getLengthOfOptimalCompression(string_s, integer_k)
        AUXILIARY FUNCTION dp(integer_i, integer_k, character_prev_char, integer_prev_count)
            IF integer_k LESS THAN zero
                RETURN positive_infinity
            END IF

            IF integer_i EQUALS the LENGTH OF string_s
                RETURN zero
            END IF

            IF the element at position integer_i of string_s EQUALS character_prev_char
                IF integer_prev_count EQUALS one OR integer_prev_count EQUALS nine OR integer_prev_count EQUALS ninety_nine
                    SET increment_value TO one
                ELSE
                    SET increment_value TO zero
                END IF
                RETURN increment_value PLUS CALL dp WITH parameters integer_i PLUS one, integer_k, character_prev_char, integer_prev_count PLUS one
            ELSE
                SET keep_option TO one PLUS CALL dp WITH parameters integer_i PLUS one, integer_k, the element at position integer_i of string_s, one
                SET delete_option TO CALL dp WITH parameters integer_i PLUS one, integer_k MINUS one, character_prev_char, integer_prev_count
                RETURN the MINIMUM OF keep_option AND delete_option
            END IF
        END FUNCTION

        RETURN CALL dp WITH parameters zero, integer_k, empty_string, zero
    END FUNCTION
END CLASS