CLASS Solution
    FUNCTION countRoutes(locations, start, finish, fuel)
        SET MODULUS TO ten TO THE POWER OF nine PLUS one
        SET number_of_locations TO the LENGTH OF locations
        
        FUNCTION dp(city, remaining_fuel)
            IF remaining_fuel LESS THAN zero
                RETURN zero
            END IF
            SET routes TO zero
            IF city EQUALS finish
                SET routes TO one
            END IF
            FOR each next_city FROM zero TO number_of_locations MINUS one
                IF next_city NOT EQUALS city
                    SET fuel_cost TO the ABSOLUTE VALUE OF the element at position city of locations MINUS the element at position next_city of locations
                    IF remaining_fuel GREATER THAN OR EQUAL TO fuel_cost
                        SET routes TO routes PLUS CALL dp WITH next_city AND remaining_fuel MINUS fuel_cost MODULO MODULUS
                    END IF
                END IF
            END FOR
            RETURN routes
        END FUNCTION
        
        RETURN CALL dp WITH start AND fuel
    END FUNCTION
END CLASS