CLASS Solution
    FUNCTION validTicTacToe(board)
        SET countX TO zero
        FOR each row IN board
            INCREMENT countX BY CALL count_occurrences WITH parameters row player_symbol X
        END FOR
        SET countO TO zero
        FOR each row IN board
            INCREMENT countO BY CALL count_occurrences WITH parameters row player_symbol O
        END FOR

        IF countX LESS THAN countO OR countX GREATER THAN countO PLUS one
            RETURN False
        END IF

        FUNCTION check_win(player)
            FOR each row IN board
                IF row EQUALS player REPEATED three TIMES
                    RETURN True
                END IF
            END FOR

            FOR col FROM zero TO two
                IF element at position col of element at position zero of board EQUALS player AND element at position col of element at position one of board EQUALS player AND element at position col of element at position two of board EQUALS player
                    RETURN True
                END IF
            END FOR

            IF element at position zero of element at position zero of board EQUALS player AND element at position one of element at position one of board EQUALS player AND element at position two of element at position two of board EQUALS player
                RETURN True
            END IF

            IF element at position two of element at position zero of board EQUALS player AND element at position one of element at position one of board EQUALS player AND element at position zero of element at position two of board EQUALS player
                RETURN True
            END IF

            RETURN False
        END FUNCTION

        SET winX TO CALL check_win WITH parameter player X
        SET winO TO CALL check_win WITH parameter player O

        IF winX AND winO
            RETURN False
        END IF

        IF winX AND countX EQUALS countO
            RETURN False
        END IF

        IF winO AND countX NOT EQUALS countO
            RETURN False
        END IF

        RETURN True
    END FUNCTION
END CLASS

FUNCTION count_occurrences WITH parameters collection player_symbol symbol
    // Auxiliary function to count occurrences of symbol in collection
END FUNCTION