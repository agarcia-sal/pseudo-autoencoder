CLASS Solution
    FUNCTION longestRepeating(s, queryCharacters, queryIndices)
        FUNCTION merge_intervals()
            SET i TO zero
            WHILE i IS LESS THAN the LENGTH OF intervals MINUS one
                IF the element at position two of the tuple element at position i of intervals EQUALS the element at position two of the tuple element at position i plus one of intervals
                    SET intervals at position i TO a tuple with first element as the element at position zero of the tuple element at position i of intervals, second element as the element at position one of the tuple element at position i plus one of intervals, and third element as the element at position two of the tuple element at position i of intervals
                    REMOVE the element at position i plus one FROM intervals
                ELSE
                    INCREMENT i BY one
                END IF
            END WHILE
        END FUNCTION

        SET intervals TO an empty list
        SET n TO the LENGTH OF s
        SET start TO zero
        FOR i FROM one TO n MINUS one
            IF the element at position i of s IS NOT EQUALS TO the element at position start of s
                APPEND a tuple consisting of start, i MINUS one, and the element at position start of s TO intervals
                SET start TO i
            END IF
        END FOR
        APPEND a tuple consisting of start, n MINUS one, and the element at position start of s TO intervals

        SET results TO an empty list
        SET longest TO the MAXIMUM OF each element at position one MINUS element at position zero PLUS one FOR each tuple with elements start, end, and character IN intervals

        FOR each pair of char and idx IN queryCharacters AND queryIndices
            SET i TO zero
            WHILE i IS LESS THAN the LENGTH OF intervals
                SET start, end, c TO the unpacked tuple element at position i of intervals
                IF start IS LESS THAN OR EQUAL TO idx AND idx IS LESS THAN OR EQUAL TO end
                    BREAK out of the loop
                END IF
                INCREMENT i BY one
            END WHILE

            IF idx IS GREATER THAN start
                INSERT a tuple consisting of start, idx MINUS one, c INTO intervals AT position i
                SET the element at position i plus one of intervals TO a tuple consisting of idx, end, c
            END IF
            IF idx IS LESS THAN end
                INSERT a tuple consisting of idx plus one, end, c INTO intervals AT position i plus one
                SET the element at position i of intervals TO a tuple consisting of start, idx, c
            END IF

            SET the element at position i of intervals TO a tuple consisting of the element at position zero of the tuple element at position i of intervals, the element at position one of the tuple element at position i of intervals, and char

            CALL merge_intervals

            SET longest TO the MAXIMUM OF each element at position one MINUS element at position zero PLUS one FOR each tuple with elements start, end, and character IN intervals
            APPEND longest TO results
        END FOR

        RETURN results
    END FUNCTION
END CLASS