CLASS Solution
    FUNCTION crackSafe(n, k)
        SET visited TO empty set
        SET sequence TO empty list

        FUNCTION dfs(node)
            FOR index FROM zero TO k MINUS one
                SET edge TO concatenation of node AND string representation of index
                IF edge IS NOT IN visited
                    ADD edge TO visited
                    CALL dfs WITH element from position one TO end of edge
                    APPEND string representation of index TO sequence
                END IF
            END FOR
        END FUNCTION

        SET start_node TO zero REPEATED n MINUS one times
        CALL dfs WITH start_node
        SET result_sequence TO concatenation of all elements IN sequence IN reverse order
        RETURN concatenation of result_sequence AND start_node
    END FUNCTION
END CLASS