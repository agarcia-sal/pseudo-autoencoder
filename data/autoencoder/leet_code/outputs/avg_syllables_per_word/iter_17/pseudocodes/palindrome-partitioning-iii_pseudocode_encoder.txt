CLASS Solution
    FUNCTION palindromePartition(s STRING, k INTEGER)
        FUNCTION min_changes_to_palindrome(sub STRING)
            SET i TO zero
            SET j TO the LENGTH OF sub MINUS one
            SET changes TO zero
            WHILE i LESS THAN j
                IF element at position i of sub NOT EQUALS element at position j of sub
                    INCREMENT changes BY one
                END IF
                INCREMENT i BY one
                DECREMENT j BY one
            END WHILE
            RETURN changes
        END FUNCTION

        SET n TO the LENGTH OF s
        SET dp TO a two dimensional list of size n PLUS one BY k PLUS one FILLED WITH positive infinity

        SET element at position zero and zero of dp TO zero

        FOR i FROM one TO n
            FOR j FROM one TO the MINIMUM OF k AND i
                FOR start FROM zero TO i MINUS one
                    SET changes TO CALL min_changes_to_palindrome WITH the substring from position start TO i MINUS one of s
                    SET element at position i and j of dp TO the MINIMUM OF element at position i and j of dp AND element at position start and j MINUS one of dp PLUS changes
                END FOR
            END FOR
        END FOR

        RETURN element at position n and k of dp
    END FUNCTION
END CLASS