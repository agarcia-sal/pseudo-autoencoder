CLASS Solution
    FUNCTION boxDelivering(boxes, portsCount, maxBoxes, maxWeight)
        SET number_of_boxes TO the LENGTH OF boxes
        SET dp TO a list of size number_of_boxes PLUS one with all elements set TO infinity
        SET element at position zero of dp TO zero
        
        SET left_pointer TO zero
        SET current_total_weight TO zero
        SET extra_trips_count TO zero
        
        FOR right_pointer FROM zero TO number_of_boxes MINUS one
            INCREMENT current_total_weight BY the element at position one of the element at position right_pointer of boxes
            IF right_pointer IS GREATER THAN zero AND the element at position zero of the element at position right_pointer of boxes IS NOT EQUAL TO the element at position zero of the element at position right_pointer MINUS one of boxes
                INCREMENT extra_trips_count BY one
            END IF
            
            WHILE left_pointer IS LESS THAN OR EQUAL TO right_pointer AND (right_pointer MINUS left_pointer PLUS one IS GREATER THAN maxBoxes OR current_total_weight IS GREATER THAN maxWeight) HOLDS
                DECREMENT current_total_weight BY the element at position one of the element at position left_pointer of boxes
                IF left_pointer IS GREATER THAN zero AND the element at position zero of the element at position left_pointer of boxes IS NOT EQUAL TO the element at position zero of the element at position left_pointer MINUS one of boxes
                    DECREMENT extra_trips_count BY one
                END IF
                INCREMENT left_pointer BY one
            END WHILE
            
            SET element at position right_pointer PLUS one of dp TO the element at position left_pointer of dp PLUS two PLUS extra_trips_count
        END FOR
        
        RETURN element at position number_of_boxes of dp
    END FUNCTION
END CLASS