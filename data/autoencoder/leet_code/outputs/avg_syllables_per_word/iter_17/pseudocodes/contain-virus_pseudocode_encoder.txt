CLASS Solution
    FUNCTION containVirus(isInfected)
        FUNCTION neighbors(row, column)
            RETURN a list containing tuple of row PLUS one AND column
                            tuple of row MINUS one AND column
                            tuple of row AND column PLUS one
                            tuple of row AND column MINUS one
        END FUNCTION

        FUNCTION bfs(row, column)
            INITIALIZE infected AS empty set
            INITIALIZE threatened AS empty set
            INITIALIZE queue AS deque containing tuple of row AND column
            INITIALIZE visited AS set containing tuple of row AND column
            WHILE queue is not empty
                ASSIGN x, y TO the element REMOVED FROM the left of queue
                ADD tuple of x AND y TO infected
                FOR each nx, ny IN neighbors x AND y
                    IF zero LESS THAN OR EQUAL TO nx AND nx LESS THAN m AND zero LESS THAN OR EQUAL TO ny AND ny LESS THAN n AND tuple of nx AND ny NOT IN visited THEN
                        ADD tuple of nx AND ny TO visited
                        IF element at position nx of isInfected AND element at position ny of that row EQUALS one THEN
                            APPEND tuple of nx AND ny TO queue
                        ELSE IF element at position nx of isInfected AND element at position ny of that row EQUALS zero THEN
                            ADD tuple of nx AND ny TO threatened
                        END IF
                    END IF
                END FOR
            END WHILE
            RETURN infected AND threatened
        END FUNCTION

        FUNCTION build_walls(infected)
            SET walls TO zero
            FOR each x, y IN infected
                FOR each nx, ny IN neighbors x AND y
                    IF zero LESS THAN OR EQUAL TO nx AND nx LESS THAN m AND zero LESS THAN OR EQUAL TO ny AND ny LESS THAN n AND element at position nx of isInfected AND element at position ny of that row EQUALS zero THEN
                        INCREMENT walls BY one
                    END IF
                END FOR
            END FOR
            RETURN walls
        END FUNCTION

        FUNCTION spread_virus(threatened)
            FOR each x, y IN threatened
                SET element at position x of isInfected AND element at position y of that row TO one
            END FOR
        END FUNCTION

        SET m TO the LENGTH OF isInfected
        SET n TO the LENGTH OF element at position zero of isInfected
        SET total_walls TO zero

        WHILE True holds
            SET regions TO empty list
            INITIALIZE visited AS empty set
            FOR r FROM zero TO m MINUS one
                FOR c FROM zero TO n MINUS one
                    IF element at position r of isInfected AND element at position c of that row EQUALS one AND tuple of r AND c NOT IN visited THEN
                        CALL bfs WITH parameters r AND c ASSIGNING TO infected AND threatened
                        APPEND tuple of infected AND threatened TO regions
                        SET visited TO visited UNION infected
                    END IF
                END FOR
            END FOR

            IF regions is empty THEN
                BREAK
            END IF

            SORT regions BY the LENGTH OF the second element IN each tuple IN descending order

            INCREMENT total_walls BY CALL build_walls WITH the first element's first component of regions
            FOR each x, y IN the first element's first component of regions
                SET element at position x of isInfected AND element at position y of that row TO negative one
            END FOR

            FOR i FROM one TO the LENGTH OF regions MINUS one
                CALL spread_virus WITH the second component of regions at position i
            END FOR
        END WHILE

        RETURN total_walls
    END FUNCTION
END CLASS