CLASS Solution
    FUNCTION ways(pizza, k)
        FUNCTION dfs(i, j, k)
            IF k EQUALS zero
                IF element at position m and position n of matrix s MINUS element at position i and position n of matrix s MINUS element at position m and position j of matrix s PLUS element at position i and position j of matrix s GREATER THAN zero
                    RETURN one
                ELSE
                    RETURN zero
                END IF
            END IF
            SET ans TO zero
            FOR x FROM i PLUS one TO m MINUS one
                IF element at position x and position n of matrix s MINUS element at position i and position n of matrix s MINUS element at position x and position j of matrix s PLUS element at position i and position j of matrix s GREATER THAN zero
                    INCREMENT ans BY CALL dfs WITH parameters x, j, k MINUS one
                END IF
            END FOR
            FOR y FROM j PLUS one TO n MINUS one
                IF element at position m and position y of matrix s MINUS element at position i and position y of matrix s MINUS element at position m and position j of matrix s PLUS element at position i and position j of matrix s GREATER THAN zero
                    INCREMENT ans BY CALL dfs WITH parameters i, y, k MINUS one
                END IF
            END FOR
            RETURN ans MODULO mod
        END FUNCTION

        SET mod TO one billion PLUS seven
        SET m TO the LENGTH OF pizza
        SET n TO the LENGTH OF element at position zero of pizza
        SET s TO the RESULT OF CALL create_prefix_sum_matrix WITH parameters pizza, m, n

        RETURN CALL dfs WITH parameters zero, zero, k MINUS one
    END FUNCTION

    FUNCTION create_prefix_sum_matrix(pizza, m, n)
        INITIALIZE s AS a two dimensional list of zeros WITH dimensions m PLUS one BY n PLUS one
        FOR i FROM one TO m
            FOR j FROM one TO n
                SET element at position i and position j of matrix s TO element at position i MINUS one and position j of matrix s PLUS element at position i and position j MINUS one of matrix s MINUS element at position i MINUS one and position j MINUS one of matrix s PLUS CALL is_apple WITH parameters element at position i MINUS one and position j MINUS one of pizza
            END FOR
        END FOR
        RETURN s
    END FUNCTION

    FUNCTION is_apple(character)
        IF character EQUALS apple
            RETURN one
        ELSE
            RETURN zero
        END IF
    END FUNCTION
END CLASS