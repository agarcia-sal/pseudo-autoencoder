CLASS Solution
    FUNCTION numberOfGoodSubsets(nums)
        CALL count_frequency OF nums ASSIGN TO count
        CALL initialize_dp_array ASSIGN TO dp
        SET element at position zero of dp TO one
        
        FOR each num IN count
            IF num EQUALS one
                SET element at position zero of dp TO element at position zero of dp MULTIPLIED BY two RAISED TO the power of element at position one of count MODULO MOD
                CONTINUE
            END IF
            
            IF num IS NOT IN prime_factors
                CONTINUE
            END IF
            
            CALL get_prime_factors OF num ASSIGN TO factors
            SET mask TO zero
            
            FOR each prime IN factors
                SET mask TO mask OR one LEFT SHIFTED BY the value of prime MINUS one
            END FOR
            
            FOR m FROM two RAISED TO the power of ten MINUS one DOWN TO zero
                IF m AND mask EQUALS zero
                    SET element at position m OR mask of dp TO element at position m OR mask of dp PLUS element at position m of dp MULTIPLIED BY element at position num of count MODULO MOD
                END IF
            END FOR
        END FOR
        
        CALL sum_of_elements FROM position one TO end OF dp ASSIGN TO result
        SET result TO result MODULO MOD
        RETURN result
    END FUNCTION
END CLASS