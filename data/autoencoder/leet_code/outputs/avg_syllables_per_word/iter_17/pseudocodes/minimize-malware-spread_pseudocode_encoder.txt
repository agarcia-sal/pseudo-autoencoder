CLASS Solution
    FUNCTION minMalwareSpread(graph, initial)
        FUNCTION dfs(node, component)
            IF node IS IN visited
                RETURN
            END IF
            ADD node TO visited
            ADD node TO component
            FOR neighbor FROM zero TO the LENGTH OF graph MINUS one
                IF the element at position node of graph at position neighbor EQUALS one AND neighbor IS NOT IN visited
                    CALL dfs WITH node neighbor AND component component
                END IF
            END FOR
        END FUNCTION

        SET visited TO an empty set
        SET components TO an empty list
        FOR node FROM zero TO the LENGTH OF graph MINUS one
            IF node IS NOT IN visited
                SET component TO an empty set
                CALL dfs WITH node node AND component component
                APPEND component TO components
            END IF
        END FOR

        SET infected_count TO a list of zeros with length the LENGTH OF graph
        FOR node IN initial
            SET element at position node OF infected_count TO one
        END FOR

        SET component_infected_count TO a list of zeros with length the LENGTH OF components
        FOR node IN initial
            FOR i FROM zero TO the LENGTH OF components MINUS one
                IF node IS IN element at position i OF components
                    INCREMENT element at position i OF component_infected_count BY one
                END IF
            END FOR
        END FOR

        SET max_saving TO zero
        SET best_node TO the MINIMUM element IN initial
        FOR node IN initial
            FOR i FROM zero TO the LENGTH OF components MINUS one
                IF node IS IN element at position i OF components AND element at position i OF component_infected_count EQUALS one
                    SET saving TO the LENGTH OF element at position i OF components
                    IF saving GREATER THAN max_saving OR saving EQUALS max_saving AND node LESS THAN best_node
                        SET max_saving TO saving
                        SET best_node TO node
                    END IF
                END IF
            END FOR
        END FOR

        RETURN best_node
    END FUNCTION
END CLASS