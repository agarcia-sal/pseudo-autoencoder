CLASS Solution
    FUNCTION spiralMatrixIII(rows, cols, rStart, cStart)
        SET directions TO list of (0, 1), (1, 0), (0, -1), (-1, 0)
        SET direction_index TO 0
        SET steps TO 0
        SET increment TO 0
        SET visited TO empty list
        SET x TO rStart
        SET y TO cStart

        WHILE LENGTH OF visited LESS THAN rows TIMES cols
            IF increment MODULO 2 EQUALS 0 THEN
                INCREMENT steps BY 1
            FOR each number FROM 1 TO steps
                IF x GREATER OR EQUAL TO 0 AND x LESS THAN rows AND y GREATER OR EQUAL TO 0 AND y LESS THAN cols THEN
                    APPEND list of x, y TO visited
                SET dx, dy TO directions AT direction_index
                INCREMENT x BY dx
                INCREMENT y BY dy
            SET direction_index TO (direction_index PLUS 1) MODULO 4
            INCREMENT increment BY 1
        
        RETURN visited
    END FUNCTION
END CLASS