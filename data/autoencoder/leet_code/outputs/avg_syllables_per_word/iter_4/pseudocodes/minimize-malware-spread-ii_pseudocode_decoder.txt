CLASS Solution
    FUNCTION minMalwareSpread(graph, initial)
        SET n TO LENGTH OF graph
        SET adj_list TO new map with default empty list

        FOR i FROM 0 TO n - 1
            FOR j FROM i + 1 TO n - 1
                IF graph[i][j] EQUALS 1 THEN
                    APPEND j TO adj_list[i]
                    APPEND i TO adj_list[j]

        FUNCTION dfs(node, visited)
            IF node IN visited THEN
                RETURN 0
            ADD node TO visited
            SET size TO 1
            FOR each neighbor IN adj_list[node]
                INCREMENT size BY dfs(neighbor, visited)
            RETURN size

        SET infected TO set of initial
        SET component_sizes TO empty list
        SET visited TO empty set
        SET component_index TO empty map

        FOR node FROM 0 TO n - 1
            IF node NOT IN visited AND node NOT IN infected THEN
                SET size TO dfs(node, visited)
                APPEND size TO component_sizes
                FOR i FROM LENGTH OF component_sizes - 1 DOWNTO 0
                    IF component_sizes[i] EQUALS size THEN
                        BREAK
                FOR each neighbor IN adj_list[node]
                    SET component_index[neighbor] TO i

        SET infected_in_component TO new map with default 0
        FOR each node IN infected
            IF node IN component_index THEN
                INCREMENT infected_in_component[component_index[node]] BY 1

        SET max_size TO 0
        SET node_to_remove TO minimum value in initial

        FOR each node IN infected
            IF node IN component_index THEN
                SET comp_idx TO component_index[node]
                IF infected_in_component[comp_idx] EQUALS 1 THEN
                    IF component_sizes[comp_idx] GREATER THAN max_size THEN
                        SET max_size TO component_sizes[comp_idx]
                        SET node_to_remove TO node
                    ELSE IF component_sizes[comp_idx] EQUALS max_size THEN
                        SET node_to_remove TO minimum of node_to_remove AND node

        RETURN node_to_remove
    END FUNCTION
END CLASS