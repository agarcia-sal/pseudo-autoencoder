CLASS Solution
    FUNCTION smallestSubsequence(s, k, letter, repetition)
        SET letter_count TO COUNT occurrences of letter IN s
        SET stack TO empty list
        FOR i, char IN ENUMERATE s
            WHILE stack IS NOT empty AND char IS LESS THAN LAST ELEMENT OF stack AND LENGTH OF s MINUS i PLUS LENGTH OF stack MINUS 1 IS AT LEAST k
                IF LAST ELEMENT OF stack IS letter
                    IF letter_count IS GREATER THAN repetition
                        INCREMENT repetition BY 1
                        REMOVE LAST ELEMENT FROM stack
                    ELSE
                        BREAK
                ELSE
                    REMOVE LAST ELEMENT FROM stack
            IF LENGTH OF stack IS LESS THAN k
                IF char IS letter
                    APPEND char TO stack
                    DECREMENT repetition BY 1
                ELSE IF k MINUS LENGTH OF stack IS GREATER THAN repetition
                    APPEND char TO stack
                IF char IS letter
                    DECREMENT letter_count BY 1
        WHILE LENGTH OF stack IS LESS THAN k
            APPEND letter TO stack
        RETURN CONCATENATION OF ELEMENTS IN stack
    END FUNCTION
END CLASS