```
CLASS Solution
    FUNCTION maxProfit(k, prices)
        IF prices IS EMPTY OR k EQUALS 0
            RETURN 0
        END IF

        SET n TO LENGTH OF prices

        IF k GREATER THAN OR EQUAL TO n DIVIDED BY 2
            SET profit TO 0
            FOR i FROM 1 TO n - 1
                IF prices[i] GREATER THAN prices[i - 1]
                    INCREMENT profit BY prices[i] MINUS prices[i - 1]
                END IF
            END FOR
            RETURN profit
        END IF

        SET hold TO LIST OF SIZE k + 1 FILLED WITH NEGATIVE INFINITY
        SET release TO LIST OF SIZE k + 1 FILLED WITH 0

        FOR EACH price IN prices
            FOR i FROM 1 TO k
                SET hold[i] TO MAXIMUM OF hold[i] AND release[i - 1] MINUS price
                SET release[i] TO MAXIMUM OF release[i] AND hold[i] PLUS price
            END FOR
        END FOR

        RETURN release[k]
    END FUNCTION
END CLASS
```