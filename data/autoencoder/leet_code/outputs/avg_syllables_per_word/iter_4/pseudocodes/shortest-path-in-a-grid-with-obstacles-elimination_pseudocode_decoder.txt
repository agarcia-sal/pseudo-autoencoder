```
CLASS Solution
    FUNCTION shortestPath(grid, k)
        IF grid is empty OR grid[0] is empty THEN
            RETURN -1

        SET m TO LENGTH OF grid
        SET n TO LENGTH OF grid[0]

        IF k IS GREATER THAN OR EQUAL TO m PLUS n MINUS 2 THEN
            RETURN m PLUS n MINUS 2

        SET directions TO LIST OF (0, 1), (1, 0), (0, -1), (-1, 0)

        INITIALIZE queue WITH (0, 0, k, 0)
        INITIALIZE visited SET WITH (0, 0, k)

        WHILE queue IS NOT EMPTY DO
            REMOVE FRONT ELEMENT FROM queue INTO (x, y, remaining_k, steps)

            IF x IS m MINUS 1 AND y IS n MINUS 1 THEN
                RETURN steps

            FOR EACH (dx, dy) IN directions DO
                SET nx TO x PLUS dx
                SET ny TO y PLUS dy

                IF nx IS GREATER THAN OR EQUAL TO 0 AND LESS THAN m AND ny IS GREATER THAN OR EQUAL TO 0 AND LESS THAN n THEN
                    SET new_k TO remaining_k MINUS grid[nx][ny]
                    IF new_k IS GREATER THAN OR EQUAL TO 0 AND (nx, ny, new_k) NOT IN visited THEN
                        ADD (nx, ny, new_k) TO visited
                        APPEND (nx, ny, new_k, steps PLUS 1) TO queue

        RETURN -1
    END FUNCTION
END CLASS
```