CLASS Solution
    FUNCTION maximizeXor(nums: List of int, queries: List of List of int) RETURNS List of int
        SORT nums
        
        SET sorted_queries TO list of pairs (index, query) FROM queries SORTED BY query's second element (mi)
        
        SET result TO list of length LENGTH OF queries FILLED WITH -1
        
        SET trie TO empty dictionary
        
        SET num_index TO 0
        
        FOR each (query_index, (xi, mi)) IN sorted_queries
            WHILE num_index LESS THAN LENGTH OF nums AND nums[num_index] LESS THAN OR EQUAL TO mi
                SET num TO nums[num_index]
                SET node TO trie
                FOR i FROM 31 DOWNTO 0
                    SET bit TO the i-th bit of num
                    IF bit NOT IN node
                        SET node[bit] TO empty dictionary
                    SET node TO node[bit]
                INCREMENT num_index BY 1
            
            IF trie IS empty
                CONTINUE to next query
            
            SET node TO trie
            SET max_xor TO 0
            
            FOR i FROM 31 DOWNTO 0
                SET bit TO the i-th bit of xi
                SET toggle_bit TO 1 MINUS bit
                IF toggle_bit IN node
                    SET max_xor TO max_xor OR (1 LEFT SHIFTED BY i)
                    SET node TO node[toggle_bit]
                ELSE
                    SET node TO node[bit]
            
            SET result[query_index] TO max_xor
        
        RETURN result
    END FUNCTION
END CLASS