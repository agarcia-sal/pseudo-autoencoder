CLASS Solution
    FUNCTION numBusesToDestination(routes, source, target)
        IF source EQUALS target THEN
            RETURN 0
        END IF

        SET stop_to_buses TO empty map with default list
        FOR each bus INDEX and route IN routes
            FOR each stop IN route
                APPEND bus TO stop_to_buses[stop]
            END FOR
        END FOR

        SET bus_queue TO empty queue
        SET visited_buses TO empty set
        SET visited_stops TO empty set

        FOR each bus IN stop_to_buses[source]
            ENQUEUE (bus, 1) INTO bus_queue
            ADD bus TO visited_buses
            ADD source TO visited_stops
        END FOR

        WHILE bus_queue IS NOT empty
            DEQUEUE current_bus, bus_count FROM bus_queue

            FOR each stop IN routes[current_bus]
                IF stop EQUALS target THEN
                    RETURN bus_count
                END IF

                IF stop NOT IN visited_stops THEN
                    ADD stop TO visited_stops

                    FOR each next_bus IN stop_to_buses[stop]
                        IF next_bus NOT IN visited_buses THEN
                            ADD next_bus TO visited_buses
                            ENQUEUE (next_bus, bus_count + 1) INTO bus_queue
                        END IF
                    END FOR
                END IF
            END FOR
        END WHILE

        RETURN -1
    END FUNCTION
END CLASS