CLASS Solution
    FUNCTION findRedundantDirectedConnection(edges)
        FUNCTION find(parent, i)
            IF parent[i] IS NOT i
                SET parent[i] TO find(parent, parent[i])
            RETURN parent[i]
        END FUNCTION

        FUNCTION union(parent, rank, x, y)
            SET rootX TO find(parent, x)
            SET rootY TO find(parent, y)
            IF rootX IS NOT rootY
                IF rank[rootX] > rank[rootY]
                    SET parent[rootY] TO rootX
                ELSE IF rank[rootX] < rank[rootY]
                    SET parent[rootX] TO rootY
                ELSE
                    SET parent[rootY] TO rootX
                    INCREMENT rank[rootX] BY 1
                RETURN True
            RETURN False
        END FUNCTION

        SET n TO LENGTH OF edges
        SET parent TO LIST OF INTEGERS FROM 0 TO n
        SET rank TO LIST OF ZEROS WITH LENGTH n + 1

        SET candidate1 TO None
        SET candidate2 TO None
        SET last TO None

        FOR EACH u, v IN edges
            IF parent[v] IS NOT v
                SET candidate1 TO LIST OF parent[v], v
                SET candidate2 TO LIST OF u, v
            ELSE
                IF union(parent, rank, u, v) IS False
                    SET last TO LIST OF u, v

        IF candidate1 IS None
            RETURN last

        IF last IS NOT None
            RETURN candidate1

        RETURN candidate2
    END FUNCTION
END CLASS