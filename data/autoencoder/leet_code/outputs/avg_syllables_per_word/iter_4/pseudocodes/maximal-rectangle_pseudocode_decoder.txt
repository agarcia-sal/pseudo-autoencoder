CLASS Solution
    FUNCTION maximalRectangle(matrix)
        IF matrix IS EMPTY OR matrix[0] IS EMPTY
            RETURN 0
        END IF

        SET rows TO LENGTH OF matrix
        SET cols TO LENGTH OF matrix[0]
        SET heights TO LIST OF SIZE cols FILLED WITH 0
        SET max_area TO 0

        FOR i FROM 0 TO rows - 1
            FOR j FROM 0 TO cols - 1
                IF matrix[i][j] EQUALS '1'
                    INCREMENT heights[j] BY 1
                ELSE
                    SET heights[j] TO 0
                END IF
            END FOR

            SET max_area TO MAXIMUM OF max_area AND CALL self.largestRectangleArea(heights)
        END FOR

        RETURN max_area
    END FUNCTION

    FUNCTION largestRectangleArea(heights)
        SET stack TO EMPTY LIST
        SET max_area TO 0
        SET index TO 0

        WHILE index LESS THAN LENGTH OF heights
            IF stack IS EMPTY OR heights[index] GREATER THAN OR EQUAL TO heights[STACK LAST ELEMENT]
                APPEND index TO stack
                INCREMENT index BY 1
            ELSE
                SET top_of_stack TO REMOVE LAST ELEMENT FROM stack
                IF stack IS NOT EMPTY
                    SET width TO index MINUS (stack LAST ELEMENT PLUS 1)
                ELSE
                    SET width TO index
                END IF
                SET area TO heights[top_of_stack] MULTIPLIED BY width
                SET max_area TO MAXIMUM OF max_area AND area
            END IF
        END WHILE

        WHILE stack IS NOT EMPTY
            SET top_of_stack TO REMOVE LAST ELEMENT FROM stack
            IF stack IS NOT EMPTY
                SET width TO index MINUS (stack LAST ELEMENT PLUS 1)
            ELSE
                SET width TO index
            END IF
            SET area TO heights[top_of_stack] MULTIPLIED BY width
            SET max_area TO MAXIMUM OF max_area AND area
        END WHILE

        RETURN max_area
    END FUNCTION
END CLASS