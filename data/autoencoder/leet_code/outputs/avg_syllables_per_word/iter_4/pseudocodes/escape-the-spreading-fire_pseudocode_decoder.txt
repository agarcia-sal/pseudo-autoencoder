CLASS Solution
    FUNCTION maximumMinutes(grid: List of List of Integer) RETURNS Integer
        SET m TO LENGTH OF grid
        SET n TO LENGTH OF grid[0]
        SET directions TO LIST OF (1, 0), (-1, 0), (0, 1), (0, -1)

        FUNCTION can_escape(wait: Integer) RETURNS Boolean
            SET fire_times TO 2D LIST of size m by n initialized with infinity
            SET queue TO empty deque

            FOR i FROM 0 TO m - 1
                FOR j FROM 0 TO n - 1
                    IF grid[i][j] EQUALS 1
                        APPEND (i, j, 0) TO queue
                        SET fire_times[i][j] TO 0

            WHILE queue IS NOT empty
                POP LEFT (x, y, t) FROM queue
                FOR EACH (dx, dy) IN directions
                    SET nx TO x + dx
                    SET ny TO y + dy
                    IF nx IS BETWEEN 0 AND m - 1 AND ny IS BETWEEN 0 AND n - 1
                        AND grid[nx][ny] EQUALS 0
                        AND fire_times[nx][ny] EQUALS infinity
                            SET fire_times[nx][ny] TO t + 1
                            APPEND (nx, ny, t + 1) TO queue

            SET queue TO deque with (0, 0, wait)
            SET visited TO SET containing (0, 0)

            WHILE queue IS NOT empty
                POP LEFT (x, y, t) FROM queue
                FOR EACH (dx, dy) IN directions
                    SET nx TO x + dx
                    SET ny TO y + dy
                    IF nx IS BETWEEN 0 AND m - 1 AND ny IS BETWEEN 0 AND n - 1
                        AND (nx, ny) NOT IN visited
                        AND grid[nx][ny] EQUALS 0
                            IF nx EQUALS m - 1 AND ny EQUALS n - 1
                                IF fire_times[nx][ny] >= t + 1
                                    RETURN True
                                ELSE
                                    RETURN False
                            IF fire_times[nx][ny] > t + 1
                                ADD (nx, ny) TO visited
                                APPEND (nx, ny, t + 1) TO queue

            RETURN False
        END FUNCTION

        SET left TO 0
        SET right TO m * n
        SET result TO -1

        WHILE left <= right
            SET mid TO (left + right) DIVIDED BY 2
            IF can_escape(mid) IS True
                SET result TO mid
                SET left TO mid + 1
            ELSE
                SET right TO mid - 1

        IF result EQUALS m * n
            RETURN 10 TO THE POWER OF 9
        ELSE
            RETURN result
    END FUNCTION
END CLASS