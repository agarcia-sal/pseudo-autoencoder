CLASS Solution
    FUNCTION countSubranges(nums1, nums2)
        SET n TO LENGTH OF nums1
        SET count TO 0
        SET dp TO LIST OF LENGTH n WHERE EACH ELEMENT IS A DICTIONARY WITH DEFAULT 0
        
        FOR i FROM 0 TO n - 1
            INCREMENT dp[i][nums1[i]] BY 1
            INCREMENT dp[i][-nums2[i]] BY 1
            
            IF i > 0 THEN
                FOR EACH balance, freq IN dp[i-1]
                    SET dp[i][balance + nums1[i]] TO (dp[i][balance + nums1[i]] + freq) MODULO 10^9 + 7
                    SET dp[i][balance - nums2[i]] TO (dp[i][balance - nums2[i]] + freq) MODULO 10^9 + 7
                END FOR
            END IF
            
            SET count TO (count + dp[i][0]) MODULO 10^9 + 7
        END FOR
        
        RETURN count
    END FUNCTION
END CLASS