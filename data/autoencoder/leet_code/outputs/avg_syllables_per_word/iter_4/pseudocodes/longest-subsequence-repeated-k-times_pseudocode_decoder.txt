CLASS Solution
    FUNCTION longestSubsequenceRepeatedK(s, k)
        SET freq TO count frequencies of each character in s
        SET valid_chars TO list of characters in freq with count AT LEAST k
        SORT valid_chars IN descending lexicographical order

        FUNCTION is_valid_subsequence(candidate)
            SET count TO 0
            SET index TO 0
            FOR each char IN s
                IF char EQUALS candidate[index]
                    INCREMENT index BY 1
                    IF index EQUALS length of candidate
                        INCREMENT count BY 1
                        SET index TO 0
                        IF count EQUALS k
                            RETURN True
            RETURN False
        END FUNCTION

        SET max_length TO length of valid_chars DIVIDED BY k
        SET best_candidate TO empty string

        FUNCTION backtrack(candidate)
            IF length of candidate GREATER THAN length of best_candidate
                SET best_candidate TO candidate
            FOR each char IN valid_chars
                SET new_candidate TO candidate concatenated with char
                IF is_valid_subsequence(new_candidate)
                    CALL backtrack(new_candidate)
        END FUNCTION

        CALL backtrack(empty string)
        RETURN best_candidate
    END FUNCTION
END CLASS