CLASS Solution
    FUNCTION minimumMountainRemovals(nums: List[int]) RETURNS int
        SET n TO LENGTH OF nums
        
        SET lis TO LIST OF SIZE n WITH ALL VALUES 1
        FOR i FROM 0 TO n - 1
            FOR j FROM 0 TO i - 1
                IF nums[i] IS GREATER THAN nums[j]
                    SET lis[i] TO MAXIMUM OF lis[i] AND lis[j] PLUS 1
        
        SET lds TO LIST OF SIZE n WITH ALL VALUES 1
        FOR i FROM n - 1 DOWNTO 0
            FOR j FROM i + 1 TO n - 1
                IF nums[i] IS GREATER THAN nums[j]
                    SET lds[i] TO MAXIMUM OF lds[i] AND lds[j] PLUS 1
        
        SET max_mountain_length TO 0
        FOR i FROM 1 TO n - 2
            IF lis[i] IS GREATER THAN 1 AND lds[i] IS GREATER THAN 1
                SET max_mountain_length TO MAXIMUM OF max_mountain_length AND lis[i] PLUS lds[i] MINUS 1
        
        RETURN n MINUS max_mountain_length
    END FUNCTION
END CLASS