CLASS Solution
    FUNCTION wordSquares(words)
        CREATE prefix_to_words AS DEFAULT DICTIONARY OF LISTS
        FOR each word IN words
            FOR index FROM 0 TO LENGTH OF word MINUS 1
                SET prefix TO SUBSTRING OF word FROM START TO index
                APPEND word TO prefix_to_words AT prefix
        CREATE results AS EMPTY LIST
        FUNCTION backtrack(square)
            IF LENGTH OF square EQUALS LENGTH OF words AT 0 THEN
                APPEND square TO results
                RETURN
            SET prefix TO EMPTY STRING
            FOR each word IN square
                APPEND CHARACTER AT POSITION LENGTH OF square FROM word TO prefix
            FOR each candidate IN prefix_to_words AT prefix
                CALL backtrack WITH square CONCATENATED WITH candidate
        FOR each word IN words
            CALL backtrack WITH LIST CONTAINING word
        RETURN results
END CLASS