```
CLASS Solution
    FUNCTION maxValueOfCoins(piles, k)
        SET n TO LENGTH OF piles
        SET dp TO 2D LIST OF SIZE (n + 1) BY (k + 1) FILLED WITH 0

        FOR i FROM 1 TO n INCLUSIVE
            FOR j FROM 1 TO k INCLUSIVE
                SET current_pile TO piles[i - 1]
                SET current_value TO 0
                FOR l FROM 0 TO MINIMUM OF (j, LENGTH OF current_pile) INCLUSIVE
                    IF l GREATER THAN 0
                        INCREMENT current_value BY current_pile[l - 1]
                    SET dp[i][j] TO MAXIMUM OF dp[i][j] AND (dp[i - 1][j - l] PLUS current_value)
        RETURN dp[n][k]
    END FUNCTION
END CLASS
```