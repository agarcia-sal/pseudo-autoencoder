```
CLASS Solution
    FUNCTION isPrintable(targetGrid)
        SET color_bounds TO map with default [infinity, infinity, -infinity, -infinity]
        FOR r FROM 0 TO LENGTH OF targetGrid MINUS 1
            FOR c FROM 0 TO LENGTH OF targetGrid[0] MINUS 1
                SET color TO targetGrid[r][c]
                SET color_bounds[color][0] TO minimum of color_bounds[color][0] AND r
                SET color_bounds[color][1] TO minimum of color_bounds[color][1] AND c
                SET color_bounds[color][2] TO maximum of color_bounds[color][2] AND r
                SET color_bounds[color][3] TO maximum of color_bounds[color][3] AND c

        SET graph TO map with default empty list
        SET in_degree TO map with default 0

        FOR each color, bounds IN color_bounds
            SET minr, minc, maxr, maxc TO bounds[0], bounds[1], bounds[2], bounds[3]
            FOR r FROM minr TO maxr
                FOR c FROM minc TO maxc
                    IF targetGrid[r][c] NOT EQUAL TO color
                        SET other_color TO targetGrid[r][c]
                        APPEND color TO graph[other_color]
                        INCREMENT in_degree[color] BY 1

        SET queue TO empty deque
        FOR each color IN color_bounds
            IF in_degree[color] EQUALS 0
                ADD color TO queue

        SET visited_colors TO 0
        WHILE queue IS NOT empty
            SET color TO REMOVE first element FROM queue
            INCREMENT visited_colors BY 1
            FOR each next_color IN graph[color]
                DECREMENT in_degree[next_color] BY 1
                IF in_degree[next_color] EQUALS 0
                    ADD next_color TO queue

        RETURN visited_colors EQUALS LENGTH OF color_bounds
    END FUNCTION
END CLASS
```