CLASS Trie
    FUNCTION __init__()
        SET children TO list of 26 None elements
        SET ref TO -1
    END FUNCTION

    FUNCTION insert(w, ref)
        SET node TO self
        FOR each character c IN w
            SET idx TO position of c in alphabet starting at 0
            IF node.children[idx] IS None THEN
                SET node.children[idx] TO new Trie instance
            END IF
            SET node TO node.children[idx]
        END FOR
        SET node.ref TO ref
    END FUNCTION
END CLASS

CLASS Solution
    FUNCTION findWords(board, words)
        FUNCTION dfs(node, i, j)
            SET idx TO position of board[i][j] in alphabet starting at 0
            IF node.children[idx] IS None THEN
                RETURN
            END IF
            SET node TO node.children[idx]
            IF node.ref >= 0 THEN
                APPEND words[node.ref] TO ans
                SET node.ref TO -1
            END IF
            SET c TO board[i][j]
            SET board[i][j] TO '#'
            FOR each pair (a, b) in adjacent position offsets (-1,0), (0,1), (1,0), (0,-1)
                SET x TO i + a
                SET y TO j + b
                IF x IS WITHIN 0 AND m-1 AND y IS WITHIN 0 AND n-1 AND board[x][y] IS NOT '#' THEN
                    CALL dfs(node, x, y)
                END IF
            END FOR
            SET board[i][j] TO c
        END FUNCTION

        SET tree TO new Trie instance
        FOR each index i and word w IN words
            CALL tree.insert(w, i)
        END FOR
        SET m TO number of rows in board
        SET n TO number of columns in board
        SET ans TO empty list
        FOR i FROM 0 TO m-1
            FOR j FROM 0 TO n-1
                CALL dfs(tree, i, j)
            END FOR
        END FOR
        RETURN ans
    END FUNCTION
END CLASS