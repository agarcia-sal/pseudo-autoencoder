CLASS Solution
    FUNCTION sumScores(s)
        SET n TO LENGTH OF s
        SET lcp TO LIST OF n ZEROES

        SET l TO 0
        SET r TO 0
        FOR i FROM 1 TO n - 1
            IF i <= r THEN
                SET lcp[i] TO MINIMUM OF (r - i + 1) AND lcp[i - l]
            END IF

            WHILE i + lcp[i] < n AND CHARACTER AT s[lcp[i]] EQUALS CHARACTER AT s[i + lcp[i]] DO
                INCREMENT lcp[i] BY 1
            END WHILE

            IF i + lcp[i] - 1 > r THEN
                SET l TO i
                SET r TO i + lcp[i] - 1
            END IF
        END FOR

        RETURN SUM OF lcp PLUS n
    END FUNCTION
END CLASS