CLASS Solution
    FUNCTION nthMagicalNumber(n, a, b)
        SET MOD TO 10^9 + 7
        
        FUNCTION gcd(x, y)
            WHILE y IS NOT 0
                SET temp TO y
                SET y TO x MODULO y
                SET x TO temp
            RETURN x
        END FUNCTION
        
        FUNCTION lcm(x, y)
            RETURN x MULTIPLIED BY y DIVIDED BY gcd(x, y)
        END FUNCTION
        
        SET L TO lcm(a, b)
        SET left TO 1
        SET right TO n MULTIPLIED BY MINIMUM OF a AND b
        
        WHILE left IS LESS THAN right
            SET mid TO (left PLUS right) DIVIDED BY 2
            SET count TO (mid DIVIDED BY a) PLUS (mid DIVIDED BY b) MINUS (mid DIVIDED BY L)
            
            IF count IS LESS THAN n
                SET left TO mid PLUS 1
            ELSE
                SET right TO mid
        RETURN left MODULO MOD
    END FUNCTION
END CLASS