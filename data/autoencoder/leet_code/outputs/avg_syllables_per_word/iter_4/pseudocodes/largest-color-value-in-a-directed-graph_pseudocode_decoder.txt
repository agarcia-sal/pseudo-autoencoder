CLASS Solution
    FUNCTION largestPathValue(colors, edges)
        SET n TO LENGTH OF colors
        SET graph TO empty map with default list
        SET in_degree TO list of zeros with length n

        FOR each (u, v) IN edges
            APPEND v TO graph[u]
            INCREMENT in_degree[v] BY 1

        SET queue TO empty deque
        FOR i FROM 0 TO n - 1
            IF in_degree[i] EQUALS 0
                APPEND i TO queue

        SET dp TO list of n lists, each with 26 zeros
        SET visited TO 0
        SET max_color_value TO 0

        WHILE queue is not empty
            SET node TO REMOVE first element FROM queue
            INCREMENT dp[node][ASCII value of colors[node] MINUS ASCII value of 'a'] BY 1
            SET max_color_value TO MAXIMUM OF max_color_value AND dp[node][ASCII value of colors[node] MINUS ASCII value of 'a']
            INCREMENT visited BY 1

            FOR each neighbor IN graph[node]
                FOR c FROM 0 TO 25
                    SET dp[neighbor][c] TO MAXIMUM OF dp[neighbor][c] AND dp[node][c]
                DECREMENT in_degree[neighbor] BY 1
                IF in_degree[neighbor] EQUALS 0
                    APPEND neighbor TO queue

        IF visited EQUALS n
            RETURN max_color_value
        ELSE
            RETURN -1
    END FUNCTION
END CLASS