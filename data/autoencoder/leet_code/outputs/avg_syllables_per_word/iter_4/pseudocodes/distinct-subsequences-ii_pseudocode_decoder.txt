CLASS Solution
    FUNCTION distinctSubseqII(s)
        SET MOD TO 10 POWER 9 PLUS 7
        SET n TO LENGTH OF s
        SET dp TO LIST OF SIZE n PLUS 1 WITH ALL ELEMENTS 0
        SET dp[0] TO 1
        SET last TO EMPTY DICTIONARY

        FOR i FROM 1 TO n
            SET char TO CHARACTER s AT POSITION i MINUS 1
            SET dp[i] TO (2 TIMES dp[i MINUS 1]) MODULO MOD

            IF char IN last THEN
                SET dp[i] TO (dp[i] MINUS dp[last[char] MINUS 1] PLUS MOD) MODULO MOD
            END IF

            SET last[char] TO i
        END FOR

        RETURN (dp[n] MINUS 1) MODULO MOD
    END FUNCTION
END CLASS