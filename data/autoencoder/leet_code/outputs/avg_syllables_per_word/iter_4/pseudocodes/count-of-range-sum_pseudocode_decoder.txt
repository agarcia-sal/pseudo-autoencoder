CLASS Solution
    FUNCTION countRangeSum(nums, lower, upper)
        SET prefix_sums TO LIST containing 0
        SET current_sum TO 0
        SET count TO 0

        FOR each num IN nums
            SET current_sum TO current_sum + num
            SET left TO current_sum - upper
            SET right TO current_sum - lower
            SET count TO count + (number of elements in prefix_sums less than or equal to right MINUS number of elements in prefix_sums less than left)
            INSERT current_sum INTO prefix_sums maintaining sorted order
        END FOR

        RETURN count
    END FUNCTION
END CLASS