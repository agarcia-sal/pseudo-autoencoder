CLASS Solution
    FUNCTION eventualSafeNodes(graph)
        FUNCTION is_safe(node)
            IF visited[node] EQUALS 1
                RETURN False
            IF visited[node] EQUALS 2
                RETURN True
            SET visited[node] TO 1
            FOR each neighbor IN graph[node]
                IF NOT is_safe(neighbor)
                    RETURN False
            SET visited[node] TO 2
            RETURN True
        END FUNCTION

        SET n TO LENGTH OF graph
        SET visited TO LIST OF 0 WITH LENGTH n
        SET safe_nodes TO EMPTY LIST

        FOR node FROM 0 TO n MINUS 1
            IF is_safe(node)
                APPEND node TO safe_nodes

        RETURN safe_nodes
    END FUNCTION
END CLASS