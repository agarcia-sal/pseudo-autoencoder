CLASS Solution
    FUNCTION maxNumOfSubstrings(s)
        SET first TO empty map
        SET last TO empty map
        FOR each index i AND character c IN s
            IF c NOT IN first
                SET first[c] TO i
            SET last[c] TO i
        
        SET intervals TO empty list
        FOR each character c IN first
            SET start TO first[c]
            SET end TO last[c]
            SET i TO start
            WHILE i <= end
                IF first[s[i]] < start
                    BREAK
                SET end TO maximum of end AND last[s[i]]
                INCREMENT i BY 1
            IF loop completed without break
                APPEND (start, end) TO intervals
        
        SORT intervals BY their second element in ascending order
        
        SET result TO empty list
        SET prev_end TO -1
        FOR each start, end IN intervals
            IF start > prev_end
                APPEND substring of s FROM start TO end inclusive TO result
                SET prev_end TO end
        
        RETURN result
    END FUNCTION
END CLASS