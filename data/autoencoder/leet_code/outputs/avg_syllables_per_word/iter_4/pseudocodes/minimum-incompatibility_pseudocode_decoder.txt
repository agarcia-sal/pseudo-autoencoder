```
CLASS Solution
    FUNCTION minimumIncompatibility(nums: List[int], k: int)
        SET n TO LENGTH OF nums
        SET subset_size TO n DIVIDED BY k

        IF any number appears more than k times in nums
            RETURN -1

        SET subset_incompatibility TO empty dictionary
        FOR mask FROM 0 TO (2 TO THE POWER OF n) MINUS 1
            IF count of set bits in mask EQUALS subset_size
                SET elements TO list of nums[i] for each i WHERE ith bit of mask is set
                IF all elements in elements are unique
                    SET incompatibility TO maximum element in elements MINUS minimum element in elements
                    SET subset_incompatibility[mask] TO incompatibility

        SET dp TO list of size (2 TO THE POWER OF n), each initialized to infinity
        SET dp[0] TO 0

        FOR mask FROM 0 TO (2 TO THE POWER OF n) MINUS 1
            IF count of set bits in mask MODULO subset_size NOT EQUALS 0
                CONTINUE to next iteration
            FOR each subset_mask IN keys of subset_incompatibility
                IF subset_mask is subset of mask
                    SET dp[mask] TO minimum of dp[mask] AND dp[mask XOR subset_mask] PLUS subset_incompatibility[subset_mask]

        IF dp[(2 TO THE POWER OF n) MINUS 1] IS infinity
            RETURN -1
        ELSE
            RETURN dp[(2 TO THE POWER OF n) MINUS 1]
    END FUNCTION
END CLASS
```