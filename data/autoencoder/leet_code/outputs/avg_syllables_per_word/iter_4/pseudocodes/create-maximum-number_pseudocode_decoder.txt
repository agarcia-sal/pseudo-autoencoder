CLASS Solution
    FUNCTION maxNumber(nums1, nums2, k)
        FUNCTION maxSingleArray(nums, k)
            SET drop TO LENGTH OF nums MINUS k
            SET stack TO empty list
            FOR each num IN nums
                WHILE drop IS GREATER THAN 0 AND stack IS NOT EMPTY AND LAST ELEMENT OF stack IS LESS THAN num
                    REMOVE last element FROM stack
                    DECREMENT drop BY 1
                END WHILE
                APPEND num TO stack
            END FOR
            RETURN first k elements OF stack
        END FUNCTION

        FUNCTION merge(arr1, arr2)
            SET merged TO empty list
            WHILE LENGTH OF arr1 PLUS LENGTH OF arr2 IS GREATER THAN 0
                IF arr1 IS GREATER THAN arr2 (lexicographically)
                    APPEND first element OF arr1 TO merged
                    REMOVE first element FROM arr1
                ELSE
                    APPEND first element OF arr2 TO merged
                    REMOVE first element FROM arr2
                END IF
            END WHILE
            RETURN merged
        END FUNCTION

        SET max_number TO empty list
        FOR i FROM 0 TO k INCLUSIVE
            IF i IS LESS THAN OR EQUAL TO LENGTH OF nums1 AND k MINUS i IS LESS THAN OR EQUAL TO LENGTH OF nums2
                SET candidate TO merge(maxSingleArray(nums1, i), maxSingleArray(nums2, k MINUS i))
                SET max_number TO maximum OF max_number AND candidate
            END IF
        END FOR

        RETURN max_number
    END FUNCTION
END CLASS