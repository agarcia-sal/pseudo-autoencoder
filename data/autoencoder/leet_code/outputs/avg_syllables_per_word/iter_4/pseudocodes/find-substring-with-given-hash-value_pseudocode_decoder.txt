CLASS Solution
    FUNCTION subStrHash(s, power, modulo, k, hashValue)
        FUNCTION val(c)
            RETURN ASCII value of c MINUS ASCII value of 'a' PLUS 1
        END FUNCTION

        SET n TO LENGTH OF s
        SET current_hash TO 0
        SET p_pow TO 1

        FOR i FROM n MINUS k TO n MINUS 1
            SET current_hash TO (current_hash PLUS val(s[i]) TIMES p_pow) MODULO modulo
            IF i LESS THAN n MINUS 1 THEN
                SET p_pow TO (p_pow TIMES power) MODULO modulo
            END IF
        END FOR

        SET start_index TO n MINUS k
        IF current_hash EQUALS hashValue THEN
            RETURN SUBSTRING OF s FROM start_index TO END
        END IF

        SET p_pow_k_minus_1 TO p_pow

        FOR i FROM n MINUS k MINUS 1 DOWNTO 0
            SET current_hash TO (current_hash MINUS val(s[i PLUS k]) TIMES p_pow_k_minus_1) MODULO modulo
            SET current_hash TO (current_hash TIMES power PLUS val(s[i])) MODULO modulo
            IF current_hash EQUALS hashValue THEN
                SET start_index TO i
            END IF
        END FOR

        RETURN SUBSTRING OF s FROM start_index TO start_index PLUS k
    END FUNCTION
END CLASS