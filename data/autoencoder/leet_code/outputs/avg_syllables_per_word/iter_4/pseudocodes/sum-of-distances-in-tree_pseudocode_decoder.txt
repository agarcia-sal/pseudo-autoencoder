CLASS Solution
    FUNCTION sumOfDistancesInTree(n, edges)
        SET graph TO a default dictionary of lists
        FOR each a, b IN edges
            APPEND b TO graph[a]
            APPEND a TO graph[b]

        SET count TO a list of size n with all elements 1
        SET dist TO a list of size n with all elements 0

        FUNCTION dfs1(u, p)
            FOR each v IN graph[u]
                IF v IS NOT p THEN
                    CALL dfs1(v, u)
                    INCREMENT count[u] BY count[v]
                    INCREMENT dist[u] BY dist[v] + count[v]
        END FUNCTION

        CALL dfs1(0, -1)

        FUNCTION dfs2(u, p)
            FOR each v IN graph[u]
                IF v IS NOT p THEN
                    SET dist[v] TO dist[u] - count[v] + (n - count[v])
                    CALL dfs2(v, u)
        END FUNCTION

        CALL dfs2(0, -1)

        RETURN dist
    END FUNCTION
END CLASS