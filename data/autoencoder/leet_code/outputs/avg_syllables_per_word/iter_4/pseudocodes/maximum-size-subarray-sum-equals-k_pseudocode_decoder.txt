CLASS Solution
    FUNCTION maxSubArrayLen(nums, k)
        SET cumulative_sum_index TO dictionary with key 0 and value -1
        SET cumulative_sum TO 0
        SET max_length TO 0
        FOR each index i, value num IN nums
            INCREMENT cumulative_sum BY num
            IF cumulative_sum MINUS k EXISTS IN cumulative_sum_index
                SET max_length TO maximum of max_length AND (i MINUS cumulative_sum_index[cumulative_sum MINUS k])
            END IF
            IF cumulative_sum NOT IN cumulative_sum_index
                SET cumulative_sum_index[cumulative_sum] TO i
            END IF
        END FOR
        RETURN max_length
    END FUNCTION
END CLASS