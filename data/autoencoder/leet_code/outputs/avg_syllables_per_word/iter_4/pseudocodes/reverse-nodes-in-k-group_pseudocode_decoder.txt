CLASS ListNode
    FUNCTION __init__(val = 0, next = None)
        SET self.val TO val
        SET self.next TO next
    END FUNCTION
END CLASS

FUNCTION list_node(values: list)
    IF values IS EMPTY
        RETURN None
    SET head TO ListNode(values[0])
    SET p TO head
    FOR val IN values FROM SECOND ELEMENT TO END
        SET node TO ListNode(val)
        SET p.next TO node
        SET p TO node
    RETURN head
END FUNCTION

FUNCTION is_same_list(p1, p2)
    IF p1 IS None AND p2 IS None
        RETURN True
    IF p1 IS None OR p2 IS None
        RETURN False
    RETURN (p1.val EQUALS p2.val) AND is_same_list(p1.next, p2.next)
END FUNCTION

CLASS Solution
    FUNCTION reverseKGroup(head: Optional[ListNode], k: int) -> Optional[ListNode]
        FUNCTION reverseLinkedList(start, end)
            SET prev TO None
            SET curr TO start
            WHILE curr IS NOT end
                SET next_node TO curr.next
                SET curr.next TO prev
                SET prev TO curr
                SET curr TO next_node
            SET curr.next TO prev
            RETURN (end, start)
        END FUNCTION

        SET dummy TO ListNode(0)
        SET dummy.next TO head
        SET prev_group_end TO dummy

        WHILE True
            SET kth_node TO prev_group_end
            FOR i FROM 1 TO k
                SET kth_node TO kth_node.next
                IF kth_node IS None
                    RETURN dummy.next

            SET next_group_start TO kth_node.next
            SET kth_node.next TO None
            SET (new_group_start, new_group_end) TO reverseLinkedList(prev_group_end.next, kth_node)

            SET prev_group_end.next TO new_group_start
            SET new_group_end.next TO next_group_start

            SET prev_group_end TO new_group_end

        RETURN dummy.next
    END FUNCTION
END CLASS