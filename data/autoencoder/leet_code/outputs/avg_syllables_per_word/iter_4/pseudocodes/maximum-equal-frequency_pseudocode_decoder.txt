CLASS Solution
    FUNCTION maxEqualFreq(nums: List of int) RETURNS int
        SET count TO empty frequency map
        SET freq TO empty frequency map
        SET max_len TO 0

        FOR i FROM 0 TO LENGTH OF nums MINUS 1
            SET num TO nums[i]
            INCREMENT count[num] BY 1

            IF count[num] GREATER THAN 1
                DECREMENT freq[count[num] MINUS 1] BY 1
                IF freq[count[num] MINUS 1] EQUALS 0
                    REMOVE freq[count[num] MINUS 1]

            INCREMENT freq[count[num]] BY 1

            IF LENGTH OF freq EQUALS 1 AND (freq CONTAINS KEY 1 OR THE ONLY VALUE IN freq EQUALS 1)
                SET max_len TO i PLUS 1
            ELSE IF LENGTH OF freq EQUALS 2 AND ((freq CONTAINS KEY 1 AND freq[1] EQUALS 1) OR ((MAXIMUM KEY IN freq MINUS MINIMUM KEY IN freq) EQUALS 1 AND freq[MAXIMUM KEY IN freq] EQUALS 1))
                SET max_len TO i PLUS 1

        RETURN max_len
    END FUNCTION
END CLASS