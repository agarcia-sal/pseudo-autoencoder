CLASS Solution
    FUNCTION largestMultipleOfThree(digits: List of Integer) RETURNS String
        SET count TO frequency map of digits
        SET total_sum TO sum of digits
        SET remainder TO total_sum MODULO 3

        IF remainder EQUALS 1 THEN
            FOR each d IN [1, 4, 7]
                IF count[d] GREATER THAN 0 THEN
                    DECREMENT count[d] BY 1
                    BREAK loop
            ELSE
                FOR each d IN [2, 5, 8]
                    IF count[d] GREATER THAN 1 THEN
                        DECREMENT count[d] BY 2
                        BREAK loop
        END IF

        IF remainder EQUALS 2 THEN
            FOR each d IN [2, 5, 8]
                IF count[d] GREATER THAN 0 THEN
                    DECREMENT count[d] BY 1
                    BREAK loop
            ELSE
                FOR each d IN [1, 4, 7]
                    IF count[d] GREATER THAN 1 THEN
                        DECREMENT count[d] BY 2
                        BREAK loop
        END IF

        SET result TO empty list
        FOR d FROM 9 DOWN TO 0
            APPEND string of digit d REPEATED count[d] TIMES TO result

        SET final_number TO concatenation of all elements in result
        
        IF final_number IS EMPTY OR final_number STARTS WITH '0' THEN
            RETURN '0'
        ELSE
            RETURN final_number
        END IF
    END FUNCTION
END CLASS