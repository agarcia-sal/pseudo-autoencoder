CLASS UnionFind
    FUNCTION __init__(self, size)
        SET self.parent TO list of integers from 0 to size - 1
        SET self.rank TO list of 1 repeated size times
        SET self.size TO list of 1 repeated size times
    END FUNCTION

    FUNCTION find(self, u)
        IF self.parent[u] NOT EQUAL TO u THEN
            SET self.parent[u] TO self.find(self.parent[u])
        END IF
        RETURN self.parent[u]
    END FUNCTION

    FUNCTION union(self, u, v)
        SET rootU TO self.find(u)
        SET rootV TO self.find(v)
        IF rootU NOT EQUAL TO rootV THEN
            IF self.rank[rootU] GREATER THAN self.rank[rootV] THEN
                SET self.parent[rootV] TO rootU
                INCREMENT self.size[rootU] BY self.size[rootV]
            ELSE IF self.rank[rootU] LESS THAN self.rank[rootV] THEN
                SET self.parent[rootU] TO rootV
                INCREMENT self.size[rootV] BY self.size[rootU]
            ELSE
                SET self.parent[rootV] TO rootU
                INCREMENT self.rank[rootU] BY 1
                INCREMENT self.size[rootU] BY self.size[rootV]
            END IF
        END IF
    END FUNCTION
END CLASS

CLASS Solution
    FUNCTION largestComponentSize(self, nums)
        SET max_num TO maximum value in nums
        SET uf TO new UnionFind with size max_num + 1
        SET prime_to_index TO empty map

        FOR each num IN nums DO
            FOR each prime IN self.prime_factors(num) DO
                IF prime IN prime_to_index THEN
                    CALL uf.union(prime_to_index[prime], num)
                ELSE
                    SET prime_to_index[prime] TO num
                END IF
            END FOR
        END FOR

        SET max_component_size TO 0
        FOR each num IN nums DO
            SET root TO uf.find(num)
            SET max_component_size TO maximum of max_component_size and uf.size[root]
        END FOR

        RETURN max_component_size
    END FUNCTION

    FUNCTION prime_factors(self, n)
        SET factors TO empty set

        WHILE n MODULO 2 EQUALS 0 DO
            ADD 2 TO factors
            SET n TO n DIVIDED BY 2
        END WHILE

        FOR i FROM 3 TO integer square root of n PLUS 1 STEP 2 DO
            WHILE n MODULO i EQUALS 0 DO
                ADD i TO factors
                SET n TO n DIVIDED BY i
            END WHILE
        END FOR

        IF n GREATER THAN 2 THEN
            ADD n TO factors
        END IF

        RETURN factors
    END FUNCTION
END CLASS