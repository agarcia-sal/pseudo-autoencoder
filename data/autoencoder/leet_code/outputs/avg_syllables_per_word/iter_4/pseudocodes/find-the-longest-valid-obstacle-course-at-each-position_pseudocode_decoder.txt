CLASS Solution
    FUNCTION longestObstacleCourseAtEachPosition(obstacles: List[int])
        SET n TO LENGTH OF obstacles
        SET ans TO empty list
        SET increasing_subseq TO empty list

        FOR each obstacle IN obstacles
            SET idx TO POSITION TO INSERT obstacle IN increasing_subseq MAINTAINING SORTED ORDER (right insertion)

            IF idx EQUALS LENGTH OF increasing_subseq
                APPEND obstacle TO increasing_subseq
            ELSE
                SET increasing_subseq[idx] TO obstacle
            END IF

            APPEND idx + 1 TO ans
        END FOR

        RETURN ans
    END FUNCTION
END CLASS