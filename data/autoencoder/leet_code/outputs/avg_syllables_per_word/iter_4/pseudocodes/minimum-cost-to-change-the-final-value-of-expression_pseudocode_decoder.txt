```
CLASS Solution
    FUNCTION minOperationsToFlip(expression: string) RETURNS int
        SET stack TO empty list

        FOR each character e IN expression
            IF e IS '(' OR e IS '&' OR e IS '|'
                APPEND (e, 0) TO stack
                CONTINUE
            END IF

            IF e IS ')'
                SET lastPair TO POP from stack
                POP from stack    # Remove '('
            ELSE
                SET lastPair TO (e, 1)    # '0' or '1' with toggle cost 1
            END IF

            IF stack IS NOT empty AND last item in stack HAS operator '&' OR '|'
                SET op TO POP operator from stack
                SET a, costA TO POP expression from stack
                SET b, costB TO lastPair

                IF op IS '&'
                    IF a IS '0' AND b IS '0'
                        SET lastPair TO ('0', 1 + MIN(costA, costB))
                    ELSE IF (a IS '0' AND b IS '1') OR (a IS '1' AND b IS '0')
                        SET lastPair TO ('0', 1)
                    ELSE   # a IS '1' AND b IS '1'
                        SET lastPair TO ('1', MIN(costA, costB))
                    END IF
                ELSE   # op IS '|'
                    IF a IS '0' AND b IS '0'
                        SET lastPair TO ('0', MIN(costA, costB))
                    ELSE IF (a IS '0' AND b IS '1') OR (a IS '1' AND b IS '0')
                        SET lastPair TO ('1', 1)
                    ELSE   # a IS '1' AND b IS '1'
                        SET lastPair TO ('1', 1 + MIN(costA, costB))
                    END IF
                END IF
            END IF

            APPEND lastPair TO stack
        END FOR

        RETURN second element of last item in stack
    END FUNCTION
END CLASS
```