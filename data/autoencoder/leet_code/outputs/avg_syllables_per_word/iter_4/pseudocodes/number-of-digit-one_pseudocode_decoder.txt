```
CLASS Solution
    FUNCTION countDigitOne(n)
        IF n <= 0 THEN
            RETURN 0
        END IF

        SET count TO 0
        SET factor TO 1

        WHILE factor <= n DO
            SET lower_nums TO n MINUS (n DIVIDED BY factor TIMES factor)
            SET cur_num TO (n DIVIDED BY factor) MODULO 10
            SET higher_nums TO n DIVIDED BY (factor TIMES 10)

            IF cur_num EQUALS 0 THEN
                INCREMENT count BY higher_nums TIMES factor
            ELSE IF cur_num EQUALS 1 THEN
                INCREMENT count BY higher_nums TIMES factor PLUS lower_nums PLUS 1
            ELSE
                INCREMENT count BY (higher_nums PLUS 1) TIMES factor
            END IF

            SET factor TO factor TIMES 10
        END WHILE

        RETURN count
    END FUNCTION
END CLASS
```