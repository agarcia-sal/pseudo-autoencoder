CLASS Solution
    FUNCTION minimumOperations(grid)
        FUNCTION bfs()
            SET queue TO empty deque
            FOR u FROM 0 TO n - 1
                IF match[u] EQUALS -1
                    SET dist[u] TO 0
                    APPEND u TO queue
                ELSE
                    SET dist[u] TO infinity
            SET dist[-1] TO infinity
            WHILE queue NOT empty
                SET u TO queue POP from left
                IF dist[u] LESS THAN dist[-1]
                    FOR EACH v IN graph[u]
                        IF dist[match[v]] EQUALS infinity
                            SET dist[match[v]] TO dist[u] + 1
                            APPEND match[v] TO queue
            RETURN dist[-1] LESS THAN infinity
        END FUNCTION

        FUNCTION dfs(u)
            IF u NOT EQUAL TO -1
                FOR EACH v IN graph[u]
                    IF dist[match[v]] EQUALS dist[u] + 1
                        IF dfs(match[v])
                            SET match[v] TO u
                            SET match[u] TO v
                            RETURN True
                SET dist[u] TO infinity
                RETURN False
            RETURN True
        END FUNCTION

        SET rows TO LENGTH OF grid
        SET cols TO LENGTH OF grid[0]
        SET n TO rows MULTIPLIED BY cols
        SET graph TO LIST OF EMPTY SETS OF SIZE n + 1
        SET match TO LIST OF -1 OF SIZE n + 1
        SET dist TO LIST OF 0 OF SIZE n + 1

        FOR r FROM 0 TO rows - 1
            FOR c FROM 0 TO cols - 1
                IF grid[r][c] EQUALS 1
                    SET u TO r MULTIPLIED BY cols PLUS c
                    FOR EACH (dr, dc) IN [(-1, 0), (1, 0), (0, -1), (0, 1)]
                        SET nr TO r PLUS dr
                        SET nc TO c PLUS dc
                        IF nr GREATER THAN OR EQUAL TO 0 AND nr LESS THAN rows AND nc GREATER THAN OR EQUAL TO 0 AND nc LESS THAN cols AND grid[nr][nc] EQUALS 1
                            SET v TO nr MULTIPLIED BY cols PLUS nc
                            ADD v TO graph[u]

        SET matching TO 0
        WHILE bfs()
            FOR u FROM 0 TO n - 1
                IF match[u] EQUALS -1 AND dfs(u)
                    INCREMENT matching BY 1

        RETURN matching
    END FUNCTION
END CLASS