CLASS Solution
    FUNCTION palindromePairs(words)
        FUNCTION is_palindrome(s)
            RETURN s EQUALS reverse of s
        END FUNCTION

        SET word_dict TO dictionary mapping each word TO its index in words
        SET result TO empty list

        FOR i, word IN enumeration of words
            IF word IS empty string
                CONTINUE to next iteration

            IF empty string IN word_dict AND is_palindrome(word)
                APPEND list containing i and word_dict empty string TO result
                APPEND list containing word_dict empty string and i TO result

            SET reversed_word TO reverse of word
            IF reversed_word IN word_dict AND word_dict[reversed_word] NOT EQUAL i
                APPEND list containing i and word_dict[reversed_word] TO result

            FOR j FROM 1 TO length of word MINUS 1
                SET prefix TO substring of word from start TO j
                SET suffix TO substring of word from j TO end
                SET reversed_prefix TO reverse of prefix
                SET reversed_suffix TO reverse of suffix

                IF is_palindrome(suffix) AND reversed_prefix IN word_dict
                    APPEND list containing i and word_dict[reversed_prefix] TO result

                IF is_palindrome(prefix) AND reversed_suffix IN word_dict
                    APPEND list containing word_dict[reversed_suffix] and i TO result

        RETURN result
    END FUNCTION
END CLASS