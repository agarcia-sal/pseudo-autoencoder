CLASS Solution
    FUNCTION minMalwareSpread(graph, initial)
        FUNCTION dfs(node, component)
            IF node IN visited THEN
                RETURN
            visited ADD node
            component ADD node
            FOR neighbor FROM 0 TO LENGTH OF graph MINUS 1
                IF graph[node][neighbor] EQUALS 1 AND neighbor NOT IN visited THEN
                    CALL dfs(neighbor, component)
        
        SET visited TO empty set
        SET components TO empty list
        FOR node FROM 0 TO LENGTH OF graph MINUS 1
            IF node NOT IN visited THEN
                SET component TO empty set
                CALL dfs(node, component)
                APPEND component TO components
        
        SET infected_count TO list of zeros WITH LENGTH OF graph
        FOR each node IN initial
            SET infected_count[node] TO 1
        
        SET component_infected_count TO list of zeros WITH LENGTH OF components
        FOR each node IN initial
            FOR i FROM 0 TO LENGTH OF components MINUS 1
                SET component TO components[i]
                IF node IN component THEN
                    INCREMENT component_infected_count[i] BY 1
        
        SET max_saving TO 0
        SET best_node TO minimum value IN initial
        FOR each node IN initial
            FOR i FROM 0 TO LENGTH OF components MINUS 1
                SET component TO components[i]
                IF node IN component AND component_infected_count[i] EQUALS 1 THEN
                    SET saving TO LENGTH OF component
                    IF saving GREATER THAN max_saving OR (saving EQUALS max_saving AND node LESS THAN best_node) THEN
                        SET max_saving TO saving
                        SET best_node TO node
        
        RETURN best_node
    END FUNCTION
END CLASS