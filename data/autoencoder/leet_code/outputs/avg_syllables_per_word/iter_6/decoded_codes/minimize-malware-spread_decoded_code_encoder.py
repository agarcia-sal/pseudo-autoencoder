class Solution:
    def minMalwareSpread(self, graph, initial):
        def dfs(node, component):
            if node in visited:
                return
            visited.add(node)
            component.add(node)
            for neighbor, connected in enumerate(graph[node]):
                if connected == 1 and neighbor not in visited:
                    dfs(neighbor, component)

        visited = set()
        components = []
        for node in range(len(graph)):
            if node not in visited:
                component = set()
                dfs(node, component)
                components.append(component)

        component_infected_count = [0] * len(components)
        node_to_component = {}
        for i, comp in enumerate(components):
            for node in comp:
                node_to_component[node] = i

        for node in initial:
            component_infected_count[node_to_component[node]] += 1

        max_saving = 0
        best_node = min(initial)

        for node in initial:
            comp_idx = node_to_component[node]
            if component_infected_count[comp_idx] == 1:
                saving = len(components[comp_idx])
                if saving > max_saving or (saving == max_saving and node < best_node):
                    max_saving = saving
                    best_node = node

        return best_node