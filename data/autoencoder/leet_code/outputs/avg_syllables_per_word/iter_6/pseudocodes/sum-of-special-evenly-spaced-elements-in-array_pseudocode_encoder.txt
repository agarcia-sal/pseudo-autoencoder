CLASS Solution  
    FUNCTION solve(nums, queries)  
        SET MOD TO one billion plus seven  
        SET n TO length of nums  
        
        SET max_y TO maximum second element IN queries  
        SET prefix_sums TO list containing (max_y plus one) lists each of length n initialized to zero  
        
        FOR y FROM 1 TO max_y  
            FOR i FROM n minus one DOWN TO zero  
                IF i PLUS y IS LESS THAN n  
                    SET prefix_sums[y][i] TO nums[i] PLUS prefix_sums[y][i PLUS y]  
                ELSE  
                    SET prefix_sums[y][i] TO nums[i]  
        
        SET answer TO empty list  
        FOR each pair x, y IN queries  
            APPEND prefix_sums[y][x] MODULO MOD TO answer  
        
        RETURN answer  
    END FUNCTION  
END CLASS