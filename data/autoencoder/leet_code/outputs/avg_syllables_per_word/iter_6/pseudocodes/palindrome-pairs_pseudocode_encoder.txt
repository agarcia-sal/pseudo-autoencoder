CLASS Solution  
    FUNCTION palindromePairs(words)  
        FUNCTION is_palindrome(s)  
            RETURN s EQUALS s REVERSED  
        END FUNCTION  
        
        SET word_dict TO empty map  
        FOR index FROM 0 TO LENGTH OF words MINUS 1  
            SET word_dict AT words AT index TO index  
        
        SET result TO empty list  
        
        FOR i FROM 0 TO LENGTH OF words MINUS 1  
            SET word TO words AT i  
            IF word EQUALS empty string THEN  
                CONTINUE  
            
            IF empty string EXISTS IN word_dict AND CALL is_palindrome WITH word THEN  
                APPEND list CONTAINING i AND word_dict AT empty string TO result  
                APPEND list CONTAINING word_dict AT empty string AND i TO result  
            
            SET reversed_word TO word REVERSED  
            IF reversed_word EXISTS IN word_dict AND word_dict AT reversed_word NOT EQUALS i THEN  
                APPEND list CONTAINING i AND word_dict AT reversed_word TO result  
            
            FOR j FROM 1 TO LENGTH OF word MINUS 1  
                SET prefix TO SUBSTRING OF word FROM START TO j MINUS 1  
                SET suffix TO SUBSTRING OF word FROM j TO END  
                SET reversed_prefix TO prefix REVERSED  
                SET reversed_suffix TO suffix REVERSED  
                
                IF CALL is_palindrome WITH suffix AND reversed_prefix EXISTS IN word_dict THEN  
                    APPEND list CONTAINING i AND word_dict AT reversed_prefix TO result  
                
                IF CALL is_palindrome WITH prefix AND reversed_suffix EXISTS IN word_dict THEN  
                    APPEND list CONTAINING word_dict AT reversed_suffix AND i TO result  
        
        RETURN result  
    END FUNCTION  
END CLASS