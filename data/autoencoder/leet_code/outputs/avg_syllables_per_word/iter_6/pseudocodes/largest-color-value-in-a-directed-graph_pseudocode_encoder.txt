CLASS Solution  
    FUNCTION largestPathValue(colors, edges)  
        SET n TO LENGTH OF colors  
        SET graph TO new mapping from default to empty list  
        SET in_degree TO list of zeros with length n  
        
        FOR each pair u, v IN edges  
            APPEND v TO graph AT u  
            INCREMENT in_degree AT v BY 1  
        
        SET queue TO new double-ended queue containing all indices i FROM 0 TO n MINUS 1 WHERE in_degree AT i EQUALS 0  
        SET dp TO new list with n elements each being a list of 26 zeros  
        SET visited TO 0  
        SET max_color_value TO 0  
        
        WHILE queue IS NOT empty  
            REMOVE first element FROM queue AND SET TO node  
            INCREMENT dp AT node AT (numeric position of colors AT node MINUS numeric position of 'a') BY 1  
            SET max_color_value TO maximum of max_color_value AND dp AT node AT (numeric position of colors AT node MINUS numeric position of 'a')  
            INCREMENT visited BY 1  
            
            FOR each neighbor IN graph AT node  
                FOR c FROM 0 TO 25  
                    SET dp AT neighbor AT c TO maximum of dp AT neighbor AT c AND dp AT node AT c  
                DECREMENT in_degree AT neighbor BY 1  
                IF in_degree AT neighbor EQUALS 0  
                    APPEND neighbor TO queue  
        
        IF visited EQUALS n  
            RETURN max_color_value  
        ELSE  
            RETURN minus one  
    END FUNCTION  
END CLASS