CLASS Solution  
    FUNCTION maxSubArrayLen(nums, k)  
        SET cumulative_sum_index TO dictionary with key zero mapped to value minus one  
        SET cumulative_sum TO zero  
        SET max_length TO zero  

        FOR index FROM zero TO LENGTH OF nums MINUS one  
            SET num TO element at position index in nums  
            INCREMENT cumulative_sum BY num  

            IF cumulative_sum MINUS k EXISTS AS KEY IN cumulative_sum_index  
                SET potential_length TO index MINUS value from cumulative_sum_index at key cumulative_sum MINUS k  
                IF potential_length GREATER THAN max_length  
                    SET max_length TO potential_length  
            
            IF cumulative_sum NOT EXISTS AS KEY IN cumulative_sum_index  
                SET value in cumulative_sum_index at key cumulative_sum TO index  

        RETURN max_length  
    END FUNCTION  
END CLASS