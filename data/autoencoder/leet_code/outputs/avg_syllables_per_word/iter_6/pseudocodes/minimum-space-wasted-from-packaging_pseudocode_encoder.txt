CLASS Solution  
    FUNCTION minWastedSpace(packages, boxes)  
        SET MOD TO 10 raised to the power of 9 PLUS 7  
        CALL packages SORT  
        SET n TO LENGTH OF packages  
        
        DEFINE prefix_sum AS list of size n PLUS 1 FILLED WITH 0  
        FOR i FROM 0 TO n MINUS 1  
            SET prefix_sum AT i PLUS 1 TO prefix_sum AT i PLUS packages AT i  
        
        SET min_wasted_space TO infinity  
        
        FOR each box IN boxes  
            CALL box SORT  
            IF last element in box LESS THAN last element in packages THEN  
                CONTINUE to next box  
            
            SET total_wasted TO 0  
            SET last_index TO 0  
            
            FOR each box_size IN box  
                SET index TO last_index  
                WHILE index LESS THAN n AND packages AT index LESS THAN OR EQUAL TO box_size IS TRUE  
                    INCREMENT index BY 1  
                
                IF index GREATER THAN last_index THEN  
                    SET total_wasted TO total_wasted PLUS (index MINUS last_index) MULTIPLIED BY box_size MINUS (prefix_sum AT index MINUS prefix_sum AT last_index)  
                    SET last_index TO index  
            
            IF last_index EQUALS n THEN  
                SET min_wasted_space TO minimum of min_wasted_space AND total_wasted  
        
        IF min_wasted_space NOT EQUALS infinity THEN  
            RETURN min_wasted_space MODULO MOD  
        ELSE  
            RETURN -1  
    END FUNCTION  
END CLASS