CLASS Solution  
    FUNCTION maxTotalFruits(fruits, startPos, k)  
        SET max_fruits TO 0  
        SET total_fruits TO 0  
        SET left TO 0  
        
        FOR right FROM 0 TO LENGTH OF fruits MINUS 1  
            SET position TO fruits AT right FIRST ELEMENT  
            SET amount TO fruits AT right SECOND ELEMENT  
            INCREMENT total_fruits BY amount  
            
            WHILE left LESS THAN OR EQUAL TO right AND NOT (  
                fruits AT left FIRST ELEMENT GREATER THAN OR EQUAL TO startPos MINUS k AND  
                fruits AT left FIRST ELEMENT LESS THAN OR EQUAL TO startPos PLUS k AND  
                fruits AT right FIRST ELEMENT GREATER THAN OR EQUAL TO startPos MINUS k AND  
                fruits AT right FIRST ELEMENT LESS THAN OR EQUAL TO startPos PLUS k AND  
                MINIMUM OF (ABSOLUTE VALUE OF fruits AT right FIRST ELEMENT MINUS startPos, ABSOLUTE VALUE OF fruits AT left FIRST ELEMENT MINUS startPos) PLUS  
                fruits AT right FIRST ELEMENT MINUS fruits AT left FIRST ELEMENT LESS THAN OR EQUAL TO k  
            )  
                DECREMENT total_fruits BY fruits AT left SECOND ELEMENT  
                INCREMENT left BY 1  
            
            IF max_fruits LESS THAN total_fruits  
                SET max_fruits TO total_fruits  
        
        RETURN max_fruits  
    END FUNCTION  
END CLASS