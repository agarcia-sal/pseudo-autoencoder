CLASS Solution  
    FUNCTION calcEquation(equations, values, queries)  
        SET graph TO empty map with default value as map  
        
        FOR each pair (a, b) AND corresponding value IN equations AND values  
            SET graph at key a and subkey b TO value  
            SET graph at key b and subkey a TO one DIVIDED BY value  
        
        FUNCTION dfs(start, end, visited)  
            IF start NOT IN graph OR end NOT IN graph THEN  
                RETURN negative one point zero  
            IF start EQUALS end THEN  
                RETURN one point zero  
            ADD start TO visited  
            FOR each neighbor and weight IN graph at key start  
                IF neighbor NOT IN visited THEN  
                    SET result TO CALL dfs WITH neighbor, end, visited  
                    IF result NOT EQUALS negative one point zero THEN  
                        RETURN weight MULTIPLIED BY result  
            REMOVE start FROM visited  
            RETURN negative one point zero  
        END FUNCTION  
        
        SET results TO empty list  
        FOR each query IN queries  
            SET start TO first element of query  
            SET end TO second element of query  
            SET visited TO empty set  
            SET result TO CALL dfs WITH start, end, visited  
            APPEND result TO results  
        
        RETURN results  
    END FUNCTION  
END CLASS