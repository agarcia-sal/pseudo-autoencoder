CLASS Solution
    FUNCTION constrainedSubsetSum(nums, k)
        SET n TO LENGTH OF nums
        SET dp TO list of zeros with LENGTH n
        SET dp at index 0 TO nums at index 0
        SET max_sum TO nums at index 0
        
        INITIALIZE q AS deque containing 0
        
        FOR i FROM 1 TO n MINUS 1
            IF dp at index q at front IS GREATER THAN 0
                SET dp at index i TO nums at index i PLUS dp at index q at front
            ELSE
                SET dp at index i TO nums at index i
            END IF
            
            IF dp at index i IS GREATER THAN max_sum
                SET max_sum TO dp at index i
            END IF
            
            WHILE q IS NOT EMPTY AND dp at index i IS GREATER THAN OR EQUAL TO dp at index q at back
                REMOVE element from back of q
            END WHILE
            
            APPEND i TO q
            
            IF q at front EQUALS i MINUS k
                REMOVE element from front of q
            END IF
        END FOR
        
        RETURN max_sum
    END FUNCTION
END CLASS