CLASS Solution  
    FUNCTION findDerangement(n)  
        SET MOD TO 10 raised to the power of 9 PLUS 7  
        
        IF n EQUALS 1  
            RETURN 0  
        ELSE IF n EQUALS 2  
            RETURN 1  
        
        SET prev2 TO 1  
        SET prev1 TO 0  
        
        FOR i FROM 3 TO n  
            SET sum_previous TO prev1 PLUS prev2  
            SET current TO (i MINUS 1) MULTIPLIED BY sum_previous MODULO MOD  
            SET prev2 TO prev1  
            SET prev1 TO current  
        
        RETURN prev1  
    END FUNCTION  
END CLASS