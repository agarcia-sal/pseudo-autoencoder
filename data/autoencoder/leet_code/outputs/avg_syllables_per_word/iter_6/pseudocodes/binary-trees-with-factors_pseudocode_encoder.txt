CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MOD TO 1000000007  
        SORT arr IN ASCENDING ORDER  
        INITIALIZE dp AS MAPPING FROM each number IN arr TO 1  

        FOR i FROM 0 TO LENGTH OF arr MINUS 1  
            SET num TO arr AT INDEX i  
            FOR j FROM 0 TO i MINUS 1  
                IF num DIVIDED BY arr AT INDEX j MULTIPLIED BY arr AT INDEX j EQUALS num  
                    SET right_child TO num DIVIDED BY arr AT INDEX j  
                    IF right_child EXISTS IN dp  
                        SET dp AT num TO dp AT num PLUS dp AT arr AT INDEX j MULTIPLIED BY dp AT right_child  
                        SET dp AT num TO dp AT num MODULO MOD  

        SET result TO SUM OF ALL VALUES IN dp MODULO MOD  
        RETURN result  
    END FUNCTION  
END CLASS