CLASS Solution  
    FUNCTION expressiveWords(s, words)  
        FUNCTION compress(word)  
            IF word IS EMPTY  
                RETURN empty list  
            SET count TO 1  
            SET compressed TO empty list  
            FOR index FROM 1 TO LENGTH OF word MINUS 1  
                IF character AT word index EQUALS character AT word index MINUS 1  
                    INCREMENT count BY 1  
                ELSE  
                    APPEND pair OF character AT word index MINUS 1 AND count TO compressed  
                    SET count TO 1  
            APPEND pair OF last character IN word AND count TO compressed  
            RETURN compressed  
        END FUNCTION  
        
        FUNCTION is_stretchy(s_compressed, word_compressed)  
            IF LENGTH OF s_compressed NOT EQUALS LENGTH OF word_compressed  
                RETURN False  
            FOR each pair (sc, sc_count) IN s_compressed AND each pair (wc, wc_count) IN word_compressed  
                IF sc NOT EQUALS wc  
                    RETURN False  
                IF sc_count NOT EQUALS wc_count AND (sc_count LESS THAN 3 OR sc_count LESS THAN wc_count)  
                    RETURN False  
            RETURN True  
        END FUNCTION  
        
        SET s_compressed TO CALL compress WITH s  
        SET stretchy_count TO 0  
        
        FOR each word IN words  
            SET word_compressed TO CALL compress WITH word  
            IF CALL is_stretchy WITH s_compressed AND word_compressed IS TRUE  
                INCREMENT stretchy_count BY 1  
        
        RETURN stretchy_count  
    END FUNCTION  
END CLASS