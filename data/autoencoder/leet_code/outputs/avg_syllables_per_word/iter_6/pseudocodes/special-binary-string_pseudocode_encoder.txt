CLASS Solution  
    FUNCTION makeLargestSpecial(s)  
        FUNCTION dfs(s)  
            SET count TO 0  
            SET start TO 0  
            SET specials TO empty list  
            
            FOR index FROM 0 TO LENGTH OF s MINUS 1  
                SET char TO character AT s index  
                IF char EQUALS '1'  
                    INCREMENT count BY 1  
                ELSE  
                    DECREMENT count BY 1  
                
                IF count EQUALS 0  
                    CALL dfs WITH substring OF s FROM start PLUS 1 TO index AS argument  
                    APPEND concatenation OF '1', result OF dfs, AND '0' TO specials  
                    SET start TO index PLUS 1  
            END FOR  
            
            SORT specials IN descending lexicographical order  
            RETURN concatenation OF all elements IN specials  
        END FUNCTION  
        
        RETURN CALL dfs WITH s AS argument  
    END FUNCTION  
END CLASS