CLASS Solution  
    FUNCTION kthSmallest(mat, k)  
        SET m TO LENGTH OF mat  
        SET n TO LENGTH OF mat AT ZERO  
        SET initial_sum TO SUM of each row element at index zero in mat  
        SET initial_indices TO tuple of zero repeated m times  
        CREATE min_heap WITH element of tuple of initial_sum and initial_indices  
        CREATE visited AS set containing initial_indices  
        
        WHILE k GREATER THAN zero  
            REMOVE and RETURN smallest element from min_heap INTO current_sum and indices  
            DECREMENT k BY one  
            
            IF k EQUALS zero  
                RETURN current_sum  
            
            FOR i FROM zero TO m MINUS one  
                IF indices at i PLUS one LESS THAN n  
                    SET new_indices TO list version of indices  
                    INCREMENT new_indices at i BY one  
                    SET new_indices_tuple TO tuple version of new_indices  
                    SET new_sum TO current_sum MINUS mat at i and indices at i PLUS mat at i and new_indices at i  
                    
                    IF new_indices_tuple NOT IN visited  
                        ADD new_indices_tuple TO visited  
                        ADD tuple of new_sum and new_indices_tuple TO min_heap  
        RETURN negative one  
    END FUNCTION  
END CLASS