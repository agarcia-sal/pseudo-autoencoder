CLASS Solution  
    FUNCTION lengthOfLongestSubstringTwoDistinct(s)  
        INITIALIZE char_count AS dictionary with default integer zero  
        SET left TO 0  
        SET max_length TO 0  
        
        FOR right FROM 0 TO LENGTH OF s MINUS 1  
            INCREMENT count of character at position right in char_count BY 1  
            
            WHILE number of keys in char_count GREATER THAN 2  
                DECREMENT count of character at position left in char_count BY 1  
                IF count of character at position left in char_count EQUALS 0  
                    REMOVE character at position left FROM char_count  
                INCREMENT left BY 1  
            
            SET max_length TO maximum of max_length AND right MINUS left PLUS 1  
        
        RETURN max_length  
    END FUNCTION  
END CLASS