CLASS Solution  
    FUNCTION movesToStamp(stamp, target)  
        SET m TO LENGTH OF stamp  
        SET n TO LENGTH OF target  
        SET indeg TO list of m repeated (n MINUS m PLUS 1) times  
        CALL queue initialization FOR q  
        SET g TO list of empty lists for n times  
        FOR i FROM 0 TO n MINUS m  
            FOR j, c IN enumeration of stamp  
                IF target AT position (i PLUS j) EQUALS c THEN  
                    DECREMENT indeg AT position i BY 1  
                    IF indeg AT position i EQUALS 0 THEN  
                        APPEND i TO q  
                ELSE  
                    APPEND i TO g AT position (i PLUS j)  
        SET ans TO empty list  
        SET vis TO list of False repeated n times  
        WHILE q IS NOT empty  
            REMOVE leftmost element FROM q AND SET TO i  
            APPEND i TO ans  
            FOR j FROM 0 TO m MINUS 1  
                IF vis AT position (i PLUS j) IS False THEN  
                    SET vis AT position (i PLUS j) TO True  
                    FOR each k IN g AT position (i PLUS j)  
                        DECREMENT indeg AT position k BY 1  
                        IF indeg AT position k EQUALS 0 THEN  
                            APPEND k TO q  
        IF all elements in vis ARE True THEN  
            RETURN ans reversed  
        ELSE  
            RETURN empty list  
    END FUNCTION  
END CLASS