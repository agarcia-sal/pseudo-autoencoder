CLASS Solution  
    FUNCTION minCost(grid)  
        SET m TO LENGTH OF grid  
        SET n TO LENGTH OF FIRST ELEMENT IN grid  
        SET directions TO list of four pairs: (0, 1), (0, -1), (1, 0), (-1, 0)  
        SET costs TO a two-dimensional list of size m by n filled with infinity  
        SET costs at position (0, 0) TO 0  
        
        SET pq TO list containing one element: tuple of 0, 0, 0  
        SET visited TO empty set  
        
        WHILE pq IS NOT empty  
            EXTRACT the element with smallest cost from pq INTO cost, i, j  
            
            IF position (i, j) IS IN visited  
                CONTINUE to next iteration  
            END IF  
            ADD position (i, j) TO visited  
            
            IF i EQUALS m MINUS 1 AND j EQUALS n MINUS 1  
                RETURN cost  
            END IF  
            
            FOR each index k and pair (di, dj) IN directions  
                SET ni TO i PLUS di  
                SET nj TO j PLUS dj  
                IF ni IS GREATER THAN OR EQUAL TO 0 AND ni IS LESS THAN m AND nj IS GREATER THAN OR EQUAL TO 0 AND nj IS LESS THAN n  
                    SET new_cost TO cost PLUS 1 IF (k PLUS 1) NOT EQUALS value at grid position (i, j), OTHERWISE cost PLUS 0  
                    IF new_cost IS LESS THAN costs at position (ni, nj)  
                        SET costs at position (ni, nj) TO new_cost  
                        ADD tuple of new_cost, ni, nj TO pq  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN negative 1  
    END FUNCTION  
END CLASS