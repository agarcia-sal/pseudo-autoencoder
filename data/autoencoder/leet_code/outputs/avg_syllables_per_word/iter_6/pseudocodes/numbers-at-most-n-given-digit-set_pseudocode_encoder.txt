CLASS Solution  
    FUNCTION atMostNGivenDigitSet(digits, n)  
        FUNCTION count_numbers_with_length(length)  
            RETURN length OF digits RAISED TO THE POWER OF length  
        END FUNCTION  
        
        FUNCTION count_numbers_up_to_n(n)  
            SET str_n TO string representation OF n  
            SET length TO length OF str_n  
            SET count TO 0  
            
            FOR l FROM 1 TO length MINUS 1  
                INCREMENT count BY CALL count_numbers_with_length WITH l  
            
            FOR i FROM 0 TO length MINUS 1  
                SET current_digit TO integer value OF character AT position i IN str_n  
                FOR each digit IN digits  
                    IF integer value OF digit LESS THAN current_digit THEN  
                        INCREMENT count BY CALL count_numbers_with_length WITH length MINUS i MINUS 1  
                    ELSE IF integer value OF digit EQUALS current_digit THEN  
                        IF i EQUALS length MINUS 1 THEN  
                            INCREMENT count BY 1  
                        END IF  
                    ELSE  
                        BREAK  
                    END IF  
                END FOR  
            END FOR  
            
            RETURN count  
        END FUNCTION  
        
        RETURN CALL count_numbers_up_to_n WITH n  
    END FUNCTION  
END CLASS