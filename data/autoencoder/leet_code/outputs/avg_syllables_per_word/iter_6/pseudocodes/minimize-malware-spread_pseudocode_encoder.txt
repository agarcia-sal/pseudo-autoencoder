CLASS Solution  
    FUNCTION minMalwareSpread(graph, initial)  
        FUNCTION dfs(node, component)  
            IF node IS IN visited  
                RETURN  
            END IF  
            ADD node TO visited  
            ADD node TO component  
            FOR neighbor FROM 0 TO LENGTH OF graph MINUS 1  
                IF graph AT node AT neighbor EQUALS 1 AND neighbor NOT IN visited  
                    CALL dfs WITH neighbor AND component  
                END IF  
            END FOR  
        END FUNCTION  

        SET visited TO empty set  
        SET components TO empty list  
        FOR node FROM 0 TO LENGTH OF graph MINUS 1  
            IF node NOT IN visited  
                SET component TO empty set  
                CALL dfs WITH node AND component  
                APPEND component TO components  
            END IF  
        END FOR  

        SET infected_count TO list of zeros WITH LENGTH EQUAL TO LENGTH OF graph  
        FOR each node IN initial  
            SET infected_count AT node TO 1  
        END FOR  

        SET component_infected_count TO list of zeros WITH LENGTH EQUAL TO LENGTH OF components  
        FOR each node IN initial  
            FOR i FROM 0 TO LENGTH OF components MINUS 1  
                IF node IS IN components AT i  
                    INCREMENT component_infected_count AT i BY 1  
                END IF  
            END FOR  
        END FOR  

        SET max_saving TO 0  
        SET best_node TO MINIMUM value IN initial  
        FOR each node IN initial  
            FOR i FROM 0 TO LENGTH OF components MINUS 1  
                IF node IS IN components AT i AND component_infected_count AT i EQUALS 1  
                    SET saving TO LENGTH OF components AT i  
                    IF saving GREATER THAN max_saving OR (saving EQUALS max_saving AND node LESS THAN best_node)  
                        SET max_saving TO saving  
                        SET best_node TO node  
                    END IF  
                END IF  
            END FOR  
        END FOR  

        RETURN best_node  
    END FUNCTION  
END CLASS