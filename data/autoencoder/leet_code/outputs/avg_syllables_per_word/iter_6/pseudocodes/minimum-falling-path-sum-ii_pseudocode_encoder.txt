CLASS Solution  
    FUNCTION minFallingPathSum(grid)  
        IF grid IS EMPTY OR first row of grid IS EMPTY  
            RETURN 0  
        
        SET n TO LENGTH OF grid  
        
        IF n EQUALS 1  
            RETURN minimum value IN first row of grid  
        
        SET dp TO COPY OF first row of grid  
        
        FOR index i FROM 1 TO n MINUS 1  
            SET new_dp TO list of zeros WITH length n  
            SET min1 TO positive infinity  
            SET min2 TO positive infinity  
            SET min1_index TO negative one  
            
            FOR index j FROM 0 TO n MINUS 1  
                IF dp at position j LESS THAN min1  
                    SET min2 TO min1  
                    SET min1 TO dp at position j  
                    SET min1_index TO j  
                ELSE IF dp at position j LESS THAN min2  
                    SET min2 TO dp at position j  
            
            FOR index j FROM 0 TO n MINUS 1  
                IF j EQUALS min1_index  
                    SET new_dp at position j TO grid at row i and column j PLUS min2  
                ELSE  
                    SET new_dp at position j TO grid at row i and column j PLUS min1  
            
            SET dp TO COPY OF new_dp  
        
        RETURN minimum value IN dp  
    END FUNCTION  
END CLASS