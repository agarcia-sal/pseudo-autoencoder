CLASS Solution  
    FUNCTION numPermsDISequence(s)  
        SET MOD TO one billion plus seven  
        SET n TO LENGTH OF s  
        INITIALIZE dp AS two-dimensional list of zeros with dimensions (n plus one) by (n plus one)  
        
        FOR j FROM 0 TO n  
            SET dp at index zero and j TO 1  
        
        FOR i FROM 1 TO n  
            SET prefix_sum TO 0  
            IF character at index (i minus one) in s EQUALS 'I'  
                FOR j FROM 0 TO (n plus one MINUS i) MINUS one  
                    SET prefix_sum TO prefix_sum PLUS dp at index (i minus one) and j  
                    SET prefix_sum TO prefix_sum MODULO MOD  
                    SET dp at index i and j TO prefix_sum  
            ELSE  
                FOR j FROM (n MINUS i) DOWN TO 0  
                    SET prefix_sum TO prefix_sum PLUS dp at index (i minus one) and (j plus one)  
                    SET prefix_sum TO prefix_sum MODULO MOD  
                    SET dp at index i and j TO prefix_sum  
        
        SET result TO sum of dp at index n  
        SET result TO result MODULO MOD  
        RETURN result  
    END FUNCTION  
END CLASS