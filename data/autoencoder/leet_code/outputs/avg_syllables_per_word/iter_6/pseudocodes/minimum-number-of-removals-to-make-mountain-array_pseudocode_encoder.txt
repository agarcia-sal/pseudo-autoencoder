CLASS Solution  
    FUNCTION minimumMountainRemovals(nums)  
        SET n TO LENGTH OF nums  
        
        SET lis TO list of size n with all elements EQUALS 1  
        FOR i FROM 0 TO n MINUS 1  
            FOR j FROM 0 TO i MINUS 1  
                IF nums at i GREATER THAN nums at j THEN  
                    SET lis at i TO maximum of lis at i AND lis at j PLUS 1  
        
        SET lds TO list of size n with all elements EQUALS 1  
        FOR i FROM n MINUS 1 DOWN TO 0  
            FOR j FROM i PLUS 1 TO n MINUS 1  
                IF nums at i GREATER THAN nums at j THEN  
                    SET lds at i TO maximum of lds at i AND lds at j PLUS 1  
        
        SET max_mountain_length TO 0  
        FOR i FROM 1 TO n MINUS 2  
            IF lis at i GREATER THAN 1 AND lds at i GREATER THAN 1 THEN  
                SET max_mountain_length TO maximum of max_mountain_length AND lis at i PLUS lds at i MINUS 1  
        
        RETURN n MINUS max_mountain_length  
    END FUNCTION  
END CLASS