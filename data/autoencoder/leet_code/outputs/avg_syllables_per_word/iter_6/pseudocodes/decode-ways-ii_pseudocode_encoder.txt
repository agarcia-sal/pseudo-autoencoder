CLASS Solution  
    FUNCTION numDecodings(s)  
        SET MOD TO 10 raised to the power 9 PLUS 7  
        INITIALIZE dp AS list of zeros WITH length LENGTH OF s PLUS 1  
        SET dp at index 0 TO 1  

        FUNCTION ways_to_decode_single(char)  
            IF char EQUALS '*'  
                RETURN 9  
            ELSE IF char EQUALS '0'  
                RETURN 0  
            ELSE  
                RETURN 1  
        END FUNCTION  

        FUNCTION ways_to_decode_pair(char1, char2)  
            IF char1 EQUALS '*' AND char2 EQUALS '*'  
                RETURN 15  
            ELSE IF char1 EQUALS '*'  
                IF char2 LESS THAN OR EQUAL TO '6'  
                    RETURN 2  
                ELSE  
                    RETURN 1  
            ELSE IF char2 EQUALS '*'  
                IF char1 EQUALS '1'  
                    RETURN 9  
                ELSE IF char1 EQUALS '2'  
                    RETURN 6  
                ELSE  
                    RETURN 0  
            ELSE  
                SET num TO integer value of concatenation of char1 AND char2  
                IF num GREATER THAN OR EQUAL TO 10 AND num LESS THAN OR EQUAL TO 26  
                    RETURN 1  
                ELSE  
                    RETURN 0  
        END FUNCTION  

        FOR i FROM 1 TO LENGTH OF s  
            SET dp at index i TO dp at index i PLUS dp at index i MINUS 1 MULTIPLIED BY CALL ways_to_decode_single WITH s at index i MINUS 1  
            SET dp at index i TO dp at index i MODULO MOD  
            IF i GREATER THAN 1  
                SET dp at index i TO dp at index i PLUS dp at index i MINUS 2 MULTIPLIED BY CALL ways_to_decode_pair WITH s at index i MINUS 2 AND s at index i MINUS 1  
                SET dp at index i TO dp at index i MODULO MOD  
        RETURN dp at last index  
    END FUNCTION  
END CLASS