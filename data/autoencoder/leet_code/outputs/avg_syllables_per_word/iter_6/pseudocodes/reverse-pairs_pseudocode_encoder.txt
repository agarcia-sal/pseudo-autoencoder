CLASS Solution  
    FUNCTION reversePairs(nums)  
        FUNCTION merge_and_count(nums, start, end)  
            IF start GREATER THAN OR EQUAL TO end THEN  
                RETURN 0  
            END IF  
            
            SET mid TO start PLUS end DIVIDED BY 2  
            SET count TO CALL merge_and_count WITH nums, start, mid PLUS CALL merge_and_count WITH nums, mid PLUS 1, end  
            
            SET j TO mid PLUS 1  
            FOR i FROM start TO mid  
                WHILE j LESS THAN OR EQUAL TO end AND nums AT i GREATER THAN 2 MULTIPLIED BY nums AT j IS TRUE  
                    INCREMENT j BY 1  
                END WHILE  
                INCREMENT count BY j MINUS (mid PLUS 1)  
            END FOR  
            
            SET merged TO empty list  
            SET left TO start  
            SET right TO mid PLUS 1  
            WHILE left LESS THAN OR EQUAL TO mid AND right LESS THAN OR EQUAL TO end  
                IF nums AT left LESS THAN OR EQUAL TO nums AT right THEN  
                    APPEND nums AT left TO merged  
                    INCREMENT left BY 1  
                ELSE  
                    APPEND nums AT right TO merged  
                    INCREMENT right BY 1  
                END IF  
            END WHILE  
            
            APPEND elements FROM nums STARTING AT left TO mid TO merged  
            APPEND elements FROM nums STARTING AT right TO end TO merged  
            
            SET elements FROM nums STARTING AT start TO end TO merged  
            
            RETURN count  
        END FUNCTION  
        
        RETURN CALL merge_and_count WITH nums, 0, LENGTH OF nums MINUS 1  
    END FUNCTION  
END CLASS