CLASS Solution  
    FUNCTION countSubranges(nums1, nums2)  
        SET n TO LENGTH OF nums1  
        SET count TO 0  
        SET dp TO LIST OF n ELEMENTS WHERE EACH ELEMENT IS A DICTIONARY WITH DEFAULT VALUE 0  
        
        FOR i FROM 0 TO n MINUS 1  
            INCREMENT dp AT i AT KEY nums1 AT i BY 1  
            INCREMENT dp AT i AT KEY NEGATIVE OF nums2 AT i BY 1  
            
            IF i GREATER THAN 0 THEN  
                FOR each balance, freq IN ITEMS OF dp AT i MINUS 1  
                    SET dp AT i AT KEY balance PLUS nums1 AT i TO REMAINDER OF (dp AT i AT KEY balance PLUS nums1 AT i PLUS freq) DIVIDED BY MOD  
                    SET dp AT i AT KEY balance MINUS nums2 AT i TO REMAINDER OF (dp AT i AT KEY balance MINUS nums2 AT i PLUS freq) DIVIDED BY MOD  
            
            SET count TO REMAINDER OF (count PLUS dp AT i AT KEY 0) DIVIDED BY MOD  
        
        RETURN count  
    END FUNCTION  
END CLASS