CLASS Solution  
    FUNCTION validIPAddress(queryIP)  
        FUNCTION is_valid_ipv4_block(block)  
            IF block CONSISTS OF DIGITS ONLY  
                SET num TO CONVERT block TO INTEGER  
                RETURN num LESS THAN OR EQUAL TO 255 AND CONVERT num TO STRING EQUALS block  
            ELSE  
                RETURN False  
            END IF  
        END FUNCTION  

        FUNCTION is_valid_ipv6_block(block)  
            IF LENGTH OF block GREATER THAN OR EQUAL TO 1 AND LESS THAN OR EQUAL TO 4  
                TRY  
                    CONVERT block FROM HEXADECIMAL TO INTEGER  
                    RETURN True  
                CATCH CONVERSION ERROR  
                    RETURN False  
                END TRY  
            ELSE  
                RETURN False  
            END IF  
        END FUNCTION  

        SET parts_ipv4 TO RESULT OF SPLITTING queryIP BY '.'  
        SET parts_ipv6 TO RESULT OF SPLITTING queryIP BY ':'  

        IF LENGTH OF parts_ipv4 EQUALS 4 AND ALL PARTS IN parts_ipv4 SATISFY is_valid_ipv4_block  
            RETURN "IPv4"  
        ELSE IF LENGTH OF parts_ipv6 EQUALS 8 AND ALL PARTS IN parts_ipv6 SATISFY is_valid_ipv6_block  
            RETURN "IPv6"  
        ELSE  
            RETURN "Neither"  
        END IF  
    END FUNCTION  
END CLASS