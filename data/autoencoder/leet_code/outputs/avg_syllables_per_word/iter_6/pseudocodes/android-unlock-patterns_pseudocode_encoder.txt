CLASS Solution  
    FUNCTION numberOfPatterns(m, n)  
        SET jumps TO mapping of pairs TO intermediate dot as follows:  
            pair (1, 3) TO 2  
            pair (1, 7) TO 4  
            pair (1, 9) TO 5  
            pair (2, 8) TO 5  
            pair (3, 1) TO 2  
            pair (3, 7) TO 5  
            pair (3, 9) TO 6  
            pair (4, 6) TO 5  
            pair (5, 5) TO 5  
            pair (6, 4) TO 5  
            pair (7, 1) TO 4  
            pair (7, 3) TO 5  
            pair (7, 9) TO 8  
            pair (8, 2) TO 5  
            pair (9, 1) TO 5  
            pair (9, 3) TO 6  
            pair (9, 7) TO 8  

        FUNCTION countPatternsFromDot(current, visited, length)  
            IF length EQUALS n THEN  
                RETURN 1  
            END IF  
            SET count TO 1 IF length GREATER THAN OR EQUAL TO m ELSE 0  
            FOR next_dot FROM 1 TO 9  
                IF visited at next_dot IS FALSE THEN  
                    SET jump TO jumps value AT pair (current, next_dot) IF EXISTS  
                    IF jump DOES NOT EXIST OR visited at jump IS TRUE THEN  
                        SET visited at next_dot TO TRUE  
                        INCREMENT count BY CALL countPatternsFromDot WITH (next_dot, visited, length PLUS 1)  
                        SET visited at next_dot TO FALSE  
                    END IF  
                END IF  
            END FOR  
            RETURN count  
        END FUNCTION  

        SET visited TO list of FALSE repeated 10 TIMES  
        SET result TO 0  
        FOR i FROM 1 TO 9  
            SET visited at i TO TRUE  
            INCREMENT result BY CALL countPatternsFromDot WITH (i, visited, 1)  
            SET visited at i TO FALSE  
        END FOR  

        RETURN result  
    END FUNCTION  
END CLASS