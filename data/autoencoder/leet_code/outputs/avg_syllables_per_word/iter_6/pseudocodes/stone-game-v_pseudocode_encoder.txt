CLASS Solution  
    FUNCTION stoneGameV(stoneValue)  
        SET prefix_sum TO list of zeros with length LENGTH OF stoneValue PLUS 1  
        FOR i FROM 0 TO LENGTH OF stoneValue MINUS 1  
            SET prefix_sum AT i PLUS 1 TO prefix_sum AT i PLUS stoneValue AT i  
        
        FUNCTION get_range_sum(left, right)  
            RETURN prefix_sum AT right PLUS 1 MINUS prefix_sum AT left  
        END FUNCTION  
        
        FUNCTION dp(left, right)  
            IF left EQUALS right  
                RETURN 0  
            
            SET max_score TO 0  
            FOR i FROM left TO right MINUS 1  
                SET left_sum TO CALL get_range_sum WITH left, i  
                SET right_sum TO CALL get_range_sum WITH i PLUS 1, right  
                
                IF left_sum LESS THAN right_sum  
                    SET max_score TO THE GREATER OF max_score AND left_sum PLUS CALL dp WITH left, i  
                ELSE IF left_sum GREATER THAN right_sum  
                    SET max_score TO THE GREATER OF max_score AND right_sum PLUS CALL dp WITH i PLUS 1, right  
                ELSE  
                    SET max_score TO THE GREATER OF max_score, left_sum PLUS CALL dp WITH left, i, AND right_sum PLUS CALL dp WITH i PLUS 1, right  
            RETURN max_score  
        END FUNCTION  
        
        RETURN CALL dp WITH 0, LENGTH OF stoneValue MINUS 1  
    END FUNCTION  
END CLASS