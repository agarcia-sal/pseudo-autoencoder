CLASS Solution  
    FUNCTION candyCrush(board)  
        SET R TO LENGTH OF board  
        SET C TO LENGTH OF board AT FIRST ROW  
        SET stable TO False  
        
        WHILE stable IS FALSE  
            SET stable TO True  
            SET to_crush TO empty set  
            
            FOR r FROM 0 TO R MINUS 1  
                FOR c FROM 0 TO C MINUS 3  
                    IF absolute value of board AT r, c EQUALS absolute value of board AT r, c PLUS 1 AND  
                       absolute value of board AT r, c PLUS 1 EQUALS absolute value of board AT r, c PLUS 2 AND  
                       absolute value of board AT r, c NOT EQUALS 0  
                        SET stable TO False  
                        ADD tuple (r, c) TO to_crush  
                        ADD tuple (r, c PLUS 1) TO to_crush  
                        ADD tuple (r, c PLUS 2) TO to_crush  
            
            FOR r FROM 0 TO R MINUS 3  
                FOR c FROM 0 TO C MINUS 1  
                    IF absolute value of board AT r, c EQUALS absolute value of board AT r PLUS 1, c AND  
                       absolute value of board AT r PLUS 1, c EQUALS absolute value of board AT r PLUS 2, c AND  
                       absolute value of board AT r, c NOT EQUALS 0  
                        SET stable TO False  
                        ADD tuple (r, c) TO to_crush  
                        ADD tuple (r PLUS 1, c) TO to_crush  
                        ADD tuple (r PLUS 2, c) TO to_crush  
            
            FOR each tuple (r, c) IN to_crush  
                SET board AT r, c TO 0  
            
            FOR c FROM 0 TO C MINUS 1  
                SET wr TO R MINUS 1  
                FOR r FROM R MINUS 1 DOWN TO 0  
                    IF board AT r, c NOT EQUALS 0  
                        SET board AT wr, c TO board AT r, c  
                        DECREMENT wr BY 1  
                FOR wr FROM wr DOWN TO 0  
                    SET board AT wr, c TO 0  
        
        RETURN board  
    END FUNCTION  
END CLASS