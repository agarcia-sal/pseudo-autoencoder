CLASS Solution  
    FUNCTION longestDupSubstring(s)  
        FUNCTION search(length)  
            SET seen TO empty set  
            FOR i FROM 0 TO length of s MINUS length PLUS 1  
                SET substring TO part of s FROM i TO i PLUS length  
                IF substring IS IN seen  
                    RETURN substring  
                END IF  
                ADD substring TO seen  
            END FOR  
            RETURN empty string  
        END FUNCTION  

        SET left TO 1  
        SET right TO length of s MINUS 1  
        SET longest TO empty string  

        WHILE left IS LESS THAN OR EQUAL TO right  
            SET mid TO left PLUS right DIVIDED BY 2  
            SET candidate TO CALL search WITH mid  
            IF candidate IS NOT empty string  
                SET longest TO candidate  
                SET left TO mid PLUS 1  
            ELSE  
                SET right TO mid MINUS 1  
            END IF  
        END WHILE  

        RETURN longest  
    END FUNCTION  
END CLASS