CLASS Solution  
    FUNCTION shortestPath(grid, k)  
        IF grid IS EMPTY OR grid AT INDEX 0 IS EMPTY THEN  
            RETURN minus one  
        END IF  
        
        SET m TO LENGTH OF grid  
        SET n TO LENGTH OF grid AT INDEX 0  
        
        IF k IS GREATER THAN OR EQUAL TO m PLUS n MINUS 2 THEN  
            RETURN m PLUS n MINUS 2  
        END IF  
        
        SET directions TO list of tuples representing up, down, left, right moves  
        
        INITIALIZE queue WITH tuple containing zero, zero, k, zero  
        
        INITIALIZE visited SET containing tuple zero, zero, k  
        
        WHILE queue IS NOT EMPTY  
            REMOVE first element FROM queue AND UNPACK INTO x, y, remaining_k, steps  
            
            IF x EQUALS m MINUS 1 AND y EQUALS n MINUS 1 THEN  
                RETURN steps  
            END IF  
            
            FOR each dx, dy IN directions  
                SET nx TO x PLUS dx  
                SET ny TO y PLUS dy  
                
                IF nx IS GREATER THAN OR EQUAL TO zero AND LESS THAN m AND ny IS GREATER THAN OR EQUAL TO zero AND LESS THAN n THEN  
                    SET new_k TO remaining_k MINUS value in grid at nx, ny  
                    IF new_k IS GREATER THAN OR EQUAL TO zero AND tuple nx, ny, new_k NOT IN visited THEN  
                        ADD tuple nx, ny, new_k TO visited  
                        APPEND tuple nx, ny, new_k, steps PLUS one TO queue  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN minus one  
    END FUNCTION  
END CLASS