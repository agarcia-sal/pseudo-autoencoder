CLASS Solution
    FUNCTION calculate(s)
        FUNCTION helper(s)
            SET stack TO empty list
            SET num TO 0
            SET sign TO plus
            WHILE LENGTH OF s GREATER THAN 0
                SET char TO first element REMOVED FROM s
                IF char IS digit
                    SET num TO num MULTIPLIED BY 10 PLUS integer value of char
                IF char EQUALS open parenthesis
                    SET num TO CALL helper WITH s
                IF char IN list of plus, minus, multiply, divide, open parenthesis, close parenthesis OR LENGTH OF s EQUALS 0
                    IF sign EQUALS plus
                        APPEND num TO stack
                    ELSE IF sign EQUALS minus
                        APPEND negative num TO stack
                    ELSE IF sign EQUALS multiply
                        SET last element of stack TO last element MULTIPLIED BY num
                    ELSE IF sign EQUALS divide
                        SET last element of stack TO integer part of last element DIVIDED BY num
                    SET sign TO char
                    SET num TO 0
                IF char EQUALS close parenthesis
                    BREAK loop
            RETURN sum of stack
        END FUNCTION
        SET s TO list of characters FROM s
        RETURN CALL helper WITH s
    END FUNCTION
END CLASS