CLASS Solution  
    FUNCTION subStrHash(s, power, modulo, k, hashValue)  
        FUNCTION val(c)  
            RETURN ASCII VALUE OF c MINUS ASCII VALUE OF 'a' PLUS 1  
        END FUNCTION  
        
        SET n TO LENGTH OF s  
        SET current_hash TO 0  
        SET p_pow TO 1  
        
        FOR i FROM n MINUS k TO n MINUS 1  
            SET current_hash TO (current_hash PLUS val(s AT i) MULTIPLIED BY p_pow) MODULO modulo  
            IF i LESS THAN n MINUS 1 THEN  
                SET p_pow TO (p_pow MULTIPLIED BY power) MODULO modulo  
            END IF  
        END FOR  
        
        SET start_index TO n MINUS k  
        IF current_hash EQUALS hashValue THEN  
            RETURN SUBSTRING OF s FROM start_index TO END  
        END IF  
        
        SET p_pow_k_minus_1 TO p_pow  
        FOR i FROM n MINUS k MINUS 1 DOWN TO 0  
            SET current_hash TO (current_hash MINUS val(s AT i PLUS k) MULTIPLIED BY p_pow_k_minus_1) MODULO modulo  
            SET current_hash TO (current_hash MULTIPLIED BY power PLUS val(s AT i)) MODULO modulo  
            
            IF current_hash EQUALS hashValue THEN  
                SET start_index TO i  
            END IF  
        END FOR  
        
        RETURN SUBSTRING OF s FROM start_index TO start_index PLUS k  
    END FUNCTION  
END CLASS