CLASS Solution  
    FUNCTION removeDuplicateLetters(s)  
        SET last_occurrence TO empty dictionary  
        FOR each index AND character IN s  
            SET last_occurrence[character] TO index  
        SET stack TO empty list  
        SET in_stack TO empty set  
        FOR each index AND character IN s  
            IF character IS IN in_stack  
                CONTINUE  
            WHILE stack IS NOT empty AND character IS LESS THAN last element IN stack AND index IS LESS THAN last_occurrence[last element IN stack]  
                SET removed_char TO last element REMOVED FROM stack  
                REMOVE removed_char FROM in_stack  
            APPEND character TO stack  
            ADD character TO in_stack  
        SET result TO concatenation OF elements IN stack  
        RETURN result  
    END FUNCTION  
END CLASS