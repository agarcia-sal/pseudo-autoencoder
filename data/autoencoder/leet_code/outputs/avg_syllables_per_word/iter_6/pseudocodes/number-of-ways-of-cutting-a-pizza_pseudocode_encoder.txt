CLASS Solution  
    FUNCTION ways(pizza, k)  
        FUNCTION dfs(i, j, k)  
            IF k EQUALS 0 THEN  
                RETURN integer value of (number of apples in submatrix from (i,j) to bottom right GREATER THAN 0)  
            SET ans TO 0  
            FOR x FROM i PLUS 1 TO m MINUS 1  
                IF number of apples in submatrix from (i,j) to (x,n) GREATER THAN 0 THEN  
                    INCREMENT ans BY CALL dfs WITH arguments x, j, k MINUS 1  
            FOR y FROM j PLUS 1 TO n MINUS 1  
                IF number of apples in submatrix from (i,j) to (m,y) GREATER THAN 0 THEN  
                    INCREMENT ans BY CALL dfs WITH arguments i, y, k MINUS 1  
            RETURN ans MODULO mod  
        END FUNCTION  

        SET mod TO 10 TO THE POWER OF 9 PLUS 7  
        SET m TO LENGTH OF pizza  
        SET n TO LENGTH OF pizza AT INDEX 0  
        INITIALIZE s AS TWO-DIMENSIONAL LIST OF ZEROS WITH DIMENSIONS (m PLUS 1) BY (n PLUS 1)  
        FOR i FROM 1 TO m  
            FOR j FROM 1 TO n  
                SET s[i][j] TO s[i MINUS 1][j] PLUS s[i][j MINUS 1] MINUS s[i MINUS 1][j MINUS 1] PLUS integer value of (character at pizza[i MINUS 1][j MINUS 1] EQUALS 'A')  
        RETURN CALL dfs WITH arguments 0, 0, k MINUS 1  
    END FUNCTION  
END CLASS