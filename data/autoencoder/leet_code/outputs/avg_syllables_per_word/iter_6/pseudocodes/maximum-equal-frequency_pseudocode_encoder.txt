CLASS Solution  
    FUNCTION maxEqualFreq(nums)  
        SET count TO empty frequency counter  
        SET freq TO empty frequency counter  
        SET max_len TO 0  
        
        FOR i FROM 0 TO LENGTH OF nums MINUS 1  
            SET num TO element AT index i IN nums  
            INCREMENT count OF num BY 1  
            
            IF count OF num IS GREATER THAN 1  
                DECREMENT freq OF (count OF num MINUS 1) BY 1  
                IF freq OF (count OF num MINUS 1) EQUALS 0  
                    REMOVE freq ENTRY FOR (count OF num MINUS 1)  
            
            INCREMENT freq OF (count OF num) BY 1  
            
            IF LENGTH OF freq EQUALS 1 AND (freq HAS KEY 1 OR THE ONLY VALUE IN freq EQUALS 1)  
                SET max_len TO i PLUS 1  
            ELSE IF LENGTH OF freq EQUALS 2 AND ((freq HAS KEY 1 AND freq OF 1 EQUALS 1) OR ((MAXIMUM KEY IN freq MINUS MINIMUM KEY IN freq) EQUALS 1 AND freq OF MAXIMUM KEY IN freq EQUALS 1))  
                SET max_len TO i PLUS 1  
        
        RETURN max_len  
    END FUNCTION  
END CLASS