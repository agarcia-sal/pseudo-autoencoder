CLASS Solution  
    FUNCTION maximumMinutes(grid)  
        SET m TO LENGTH OF grid  
        SET n TO LENGTH OF FIRST ELEMENT IN grid  
        SET directions TO list containing (1, 0), (-1, 0), (0, 1), (0, -1)  
        
        FUNCTION can_escape(wait)  
            SET fire_times TO two-dimensional list of size m BY n FILLED WITH infinity  
            SET queue TO empty double-ended queue  
            
            FOR i FROM 0 TO m MINUS 1  
                FOR j FROM 0 TO n MINUS 1  
                    IF grid AT i AND j EQUALS 1 THEN  
                        ADD tuple (i, j, 0) TO queue  
                        SET fire_times AT i AND j TO 0  
                    END IF  
                END FOR  
            END FOR  
            
            WHILE queue IS NOT EMPTY  
                SET x, y, t TO REMOVE FIRST ELEMENT FROM queue  
                FOR each dx, dy IN directions  
                    SET nx TO x PLUS dx  
                    SET ny TO y PLUS dy  
                    IF nx GREATER THAN OR EQUAL TO 0 AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO 0 AND ny LESS THAN n AND grid AT nx AND ny EQUALS 0 AND fire_times AT nx AND ny EQUALS infinity THEN  
                        SET fire_times AT nx AND ny TO t PLUS 1  
                        ADD tuple (nx, ny, t PLUS 1) TO queue  
                    END IF  
                END FOR  
            END WHILE  
            
            SET queue TO double-ended queue CONTAINING tuple (0, 0, wait)  
            SET visited TO set CONTAINING tuple (0, 0)  
            
            WHILE queue IS NOT EMPTY  
                SET x, y, t TO REMOVE FIRST ELEMENT FROM queue  
                FOR each dx, dy IN directions  
                    SET nx TO x PLUS dx  
                    SET ny TO y PLUS dy  
                    IF nx GREATER THAN OR EQUAL TO 0 AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO 0 AND ny LESS THAN n AND tuple (nx, ny) NOT IN visited AND grid AT nx AND ny EQUALS 0 THEN  
                        IF nx EQUALS m MINUS 1 AND ny EQUALS n MINUS 1 THEN  
                            IF fire_times AT nx AND ny GREATER THAN OR EQUAL TO t PLUS 1 THEN  
                                RETURN True  
                            ELSE  
                                RETURN False  
                            END IF  
                        END IF  
                        IF fire_times AT nx AND ny GREATER THAN t PLUS 1 THEN  
                            ADD tuple (nx, ny) TO visited  
                            ADD tuple (nx, ny, t PLUS 1) TO queue  
                        END IF  
                    END IF  
                END FOR  
            END WHILE  
            
            RETURN False  
        END FUNCTION  
        
        SET left TO 0  
        SET right TO m MULTIPLIED BY n  
        SET result TO -1  
        WHILE left LESS THAN OR EQUAL TO right  
            SET mid TO left PLUS right DIVIDED BY 2  
            IF CALL can_escape WITH mid IS True THEN  
                SET result TO mid  
                SET left TO mid PLUS 1  
            ELSE  
                SET right TO mid MINUS 1  
            END IF  
        END WHILE  
        
        IF result NOT EQUAL TO m MULTIPLIED BY n THEN  
            RETURN result  
        ELSE  
            RETURN 1 MULTIPLIED BY 10 RAISED TO THE POWER OF 9  
        END IF  
    END FUNCTION  
END CLASS