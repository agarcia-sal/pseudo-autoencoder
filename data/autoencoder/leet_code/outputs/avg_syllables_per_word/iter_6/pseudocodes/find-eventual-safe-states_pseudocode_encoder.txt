CLASS Solution  
    FUNCTION eventualSafeNodes(graph)  
        FUNCTION is_safe(node)  
            IF visited[node] EQUALS 1  
                RETURN False  
            IF visited[node] EQUALS 2  
                RETURN True  
            SET visited[node] TO 1  
            FOR each neighbor IN graph[node]  
                IF CALL is_safe WITH neighbor IS False  
                    RETURN False  
            SET visited[node] TO 2  
            RETURN True  
        END FUNCTION  
        
        SET n TO LENGTH OF graph  
        SET visited TO list of size n with all elements 0  
        SET safe_nodes TO empty list  
        
        FOR node FROM 0 TO n MINUS 1  
            IF CALL is_safe WITH node IS True  
                APPEND node TO safe_nodes  
        RETURN safe_nodes  
    END FUNCTION  
END CLASS