CLASS Solution  
    FUNCTION pacificAtlantic(heights)  
        FUNCTION bfs(q, vis)  
            WHILE q IS NOT EMPTY  
                FOR count FROM 1 TO LENGTH OF q  
                    CALL q REMOVE FIRST ELEMENT AND SET TO i, j  
                    FOR each pair a, b IN [(0, MINUS 1), (0, 1), (1, 0), (MINUS 1, 0)]  
                        SET x TO i PLUS a  
                        SET y TO j PLUS b  
                        IF x GREATER THAN OR EQUAL TO 0 AND x LESS THAN m AND y GREATER THAN OR EQUAL TO 0 AND y LESS THAN n AND (x, y) NOT IN vis AND heights[x][y] GREATER THAN OR EQUAL TO heights[i][j]  
                            ADD (x, y) TO vis  
                            APPEND (x, y) TO q  
        END FUNCTION  

        SET m TO LENGTH OF heights  
        SET n TO LENGTH OF heights AT POSITION 0  
        INITIALIZE vis1 AS EMPTY SET  
        INITIALIZE vis2 AS EMPTY SET  
        INITIALIZE q1 AS EMPTY QUEUE  
        INITIALIZE q2 AS EMPTY QUEUE  
        
        FOR i FROM 0 TO m MINUS 1  
            FOR j FROM 0 TO n MINUS 1  
                IF i EQUALS 0 OR j EQUALS 0  
                    ADD (i, j) TO vis1  
                    APPEND (i, j) TO q1  
                IF i EQUALS m MINUS 1 OR j EQUALS n MINUS 1  
                    ADD (i, j) TO vis2  
                    APPEND (i, j) TO q2  
        
        CALL bfs WITH q1, vis1  
        CALL bfs WITH q2, vis2  
        
        INITIALIZE result AS EMPTY LIST  
        FOR i FROM 0 TO m MINUS 1  
            FOR j FROM 0 TO n MINUS 1  
                IF (i, j) IN vis1 AND (i, j) IN vis2  
                    APPEND (i, j) TO result  
        RETURN result  
    END FUNCTION  
END CLASS