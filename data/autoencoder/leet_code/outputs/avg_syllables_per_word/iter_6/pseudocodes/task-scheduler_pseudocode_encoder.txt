CLASS Solution  
    FUNCTION leastInterval(tasks, n)  
        SET task_counts TO CALL Counter WITH tasks  
        SET max_heap TO EMPTY LIST  
        FOR each count IN VALUES OF task_counts  
            APPEND negative of count TO max_heap  
        CALL heapify ON max_heap  
        
        SET time TO 0  
        SET queue TO EMPTY LIST  
        
        WHILE max_heap IS NOT EMPTY OR queue IS NOT EMPTY  
            WHILE queue IS NOT EMPTY AND FIRST ELEMENT OF queue HAS TIME EQUALS time  
                SET _, count TO REMOVE FIRST ELEMENT FROM queue  
                IF count LESS THAN 0  
                    CALL heappush ON max_heap WITH count  
            
            IF max_heap IS NOT EMPTY  
                SET count TO CALL heappop ON max_heap  
                INCREMENT count BY 1  
                IF count LESS THAN 0  
                    APPEND tuple of (time PLUS n PLUS 1, count) TO queue  
            
            INCREMENT time BY 1  
        
        RETURN time  
    END FUNCTION  
END CLASS