CLASS Solution  
    FUNCTION numWays(words, target)  
        SET MOD TO 10 raised to the power of 9 PLUS 7  
        SET n TO LENGTH OF first element in words  
        SET m TO LENGTH OF target  
        
        SET freq TO list of n elements EACH initialized as empty character-to-integer map  
        FOR each word IN words  
            FOR each index j FROM 0 TO n MINUS 1  
                INCREMENT freq at position j for character at position j in word BY 1  
        
        SET dp TO two-dimensional list with (m PLUS 1) rows and (n PLUS 1) columns EACH initialized TO 0  
        
        FOR each index j FROM 0 TO n  
            SET dp at row 0 and column j TO 1  
        
        FOR each index i FROM 1 TO m  
            FOR each index j FROM 1 TO n  
                SET dp at position (i, j) TO value of dp at position (i, j MINUS 1)  
                IF freq at position (j MINUS 1) for character at position (i MINUS 1) in target GREATER THAN 0  
                    INCREMENT dp at position (i, j) BY product of dp at position (i MINUS 1, j MINUS 1) MULTIPLIED BY freq at position (j MINUS 1) for character at position (i MINUS 1) in target  
                    SET dp at position (i, j) TO dp at position (i, j) MODULO MOD  
        
        RETURN dp at position (m, n)  
    END FUNCTION  
END CLASS