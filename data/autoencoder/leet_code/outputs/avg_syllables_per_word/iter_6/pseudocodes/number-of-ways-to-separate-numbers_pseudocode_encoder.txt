CLASS Solution  
    FUNCTION numberOfCombinations(num)  
        SET MOD TO 1 followed by 9 zeros PLUS 7  
        SET n TO LENGTH OF num  
        SET memo TO empty dictionary  
        
        FUNCTION dp(index, prev_len)  
            IF index EQUALS n THEN  
                RETURN 1  
            IF memo CONTAINS key (index, prev_len) THEN  
                RETURN memo VALUE FOR key (index, prev_len)  
            
            SET count TO 0  
            FOR length FROM 1 TO n MINUS index DO  
                IF character AT num[index] EQUALS '0' THEN  
                    BREAK loop  
                
                SET current_num TO substring OF num FROM index TO index PLUS length  
                
                IF prev_len EQUALS 0 OR current_num GREATER THAN OR EQUAL TO substring OF num FROM index MINUS prev_len TO index THEN  
                    SET count TO count PLUS CALL dp WITH arguments (index PLUS length, length) MODULO MOD  
            
            SET memo VALUE FOR key (index, prev_len) TO count  
            RETURN count  
        END FUNCTION  
        
        RETURN CALL dp WITH arguments (0, 0)  
    END FUNCTION  
END CLASS