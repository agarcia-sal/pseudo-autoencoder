CLASS Solution  
    FUNCTION kthSmallestProduct(nums1, nums2, k)  
        FUNCTION count(p)  
            SET cnt TO 0  
            SET n TO length of nums2  
            FOR each x IN nums1  
                IF x GREATER THAN 0  
                    INCREMENT cnt BY number of elements in nums2 less than or equal to p DIVIDED BY x  
                ELSE IF x LESS THAN 0  
                    INCREMENT cnt BY n MINUS number of elements in nums2 less than p DIVIDED BY x  
                ELSE  
                    INCREMENT cnt BY n MULTIPLIED BY 1 IF p GREATER THAN OR EQUAL TO 0 OTHERWISE 0  
            RETURN cnt  
        END FUNCTION  

        SET mx TO maximum of absolute value of first element in nums1 AND absolute value of last element in nums1  
        MULTIPLIED BY maximum of absolute value of first element in nums2 AND absolute value of last element in nums2  
        RETURN smallest number v in range from negative mx TO mx PLUS 1 such that count(v) GREATER THAN OR EQUAL TO k MINUS mx  
    END FUNCTION  
END CLASS