CLASS Solution  
    FUNCTION maxNumOfSubstrings(s)  
        SET first TO empty map  
        SET last TO empty map  
        FOR index FROM 0 TO LENGTH OF s MINUS 1  
            SET character TO character AT position index IN s  
            IF character NOT IN first THEN  
                SET first AT character TO index  
            SET last AT character TO index  
        
        SET intervals TO empty list  
        FOR each character IN first  
            SET start TO first AT character  
            SET end TO last AT character  
            SET i TO start  
            WHILE i LESS THAN OR EQUAL TO end  
                IF first AT character AT position i IN s LESS THAN start THEN  
                    BREAK  
                SET end TO maximum OF end AND last AT character AT position i IN s  
                INCREMENT i BY 1  
            ELSE  
                APPEND pair (start, end) TO intervals  
        
        SORT intervals BY second element of each pair (interval end) IN ascending order  
        
        SET result TO empty list  
        SET prev_end TO minus one  
        FOR each pair (start, end) IN intervals  
            IF start GREATER THAN prev_end THEN  
                APPEND substring OF s from start TO end inclusive TO result  
                SET prev_end TO end  
        
        RETURN result  
    END FUNCTION  
END CLASS