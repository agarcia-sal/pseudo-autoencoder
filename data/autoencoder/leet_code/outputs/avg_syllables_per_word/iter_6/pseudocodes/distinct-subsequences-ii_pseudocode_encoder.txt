CLASS Solution  
    FUNCTION distinctSubseqII(s)  
        SET MOD TO 10 raised to the power 9 PLUS 7  
        SET n TO LENGTH OF s  
        INITIALIZE dp AS list of zeros WITH length n PLUS 1  
        SET dp at position 0 TO 1  
        INITIALIZE last AS empty dictionary  
        
        FOR i FROM 1 TO n  
            SET char TO character at position i MINUS 1 IN s  
            SET dp at position i TO dp at position i MINUS 1 MULTIPLIED BY 2 MODULO MOD  
            
            IF char IS IN last  
                SET dp at position i TO dp at position i MINUS dp at position last[char] MINUS 1 PLUS MOD MODULO MOD  
            END IF  
            
            SET last at key char TO i  
        END FOR  
        
        RETURN dp at position n MINUS 1 MODULO MOD  
    END FUNCTION  
END CLASS