CLASS Solution  
    FUNCTION maxValueOfCoins(piles, k)  
        SET n TO LENGTH OF piles  
        CREATE dp AS two-dimensional list with n PLUS 1 rows and k PLUS 1 columns initialized to 0  
        
        FOR i FROM 1 TO n  
            FOR j FROM 1 TO k  
                SET current_pile TO element at position i MINUS 1 in piles  
                SET current_value TO 0  
                FOR l FROM 0 TO MINIMUM OF j AND LENGTH OF current_pile  
                    IF l GREATER THAN 0  
                        INCREMENT current_value BY element at position l MINUS 1 in current_pile  
                    SET dp[i][j] TO MAXIMUM OF dp[i][j] AND dp[i MINUS 1][j MINUS l] PLUS current_value  
        RETURN dp[n][k]  
    END FUNCTION  
END CLASS