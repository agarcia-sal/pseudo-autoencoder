CLASS Solution  
    FUNCTION nthMagicalNumber(n, a, b)  
        SET MOD TO ten raised to the power of nine PLUS seven  
        
        FUNCTION gcd(x, y)  
            WHILE y IS NOT EQUALS zero  
                SET temp TO y  
                SET y TO x MODULO y  
                SET x TO temp  
            RETURN x  
        END FUNCTION  
        
        FUNCTION lcm(x, y)  
            RETURN x MULTIPLIED BY y DIVIDED BY CALL gcd WITH x, y  
        END FUNCTION  
        
        SET L TO CALL lcm WITH a, b  
        
        SET left TO one  
        SET right TO n MULTIPLIED BY minimum of a and b  
        
        WHILE left IS LESS THAN right  
            SET mid TO (left PLUS right) DIVIDED BY two  
            SET count TO mid DIVIDED BY a PLUS mid DIVIDED BY b MINUS mid DIVIDED BY L  
            
            IF count IS LESS THAN n  
                SET left TO mid PLUS one  
            ELSE  
                SET right TO mid  
        
        RETURN left MODULO MOD  
    END FUNCTION  
END CLASS