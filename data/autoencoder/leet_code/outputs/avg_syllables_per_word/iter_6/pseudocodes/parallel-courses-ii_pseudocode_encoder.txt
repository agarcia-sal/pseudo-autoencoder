CLASS Solution  
    FUNCTION minNumberOfSemesters(n, relations, k)  
        INITIALIZE graph AS mapping from element to list  
        INITIALIZE in_degree AS list of zeros with length n PLUS 1  
        
        FOR each prevCourse, nextCourse IN relations  
            APPEND nextCourse TO graph AT prevCourse  
            INCREMENT in_degree AT nextCourse BY 1  
        
        INITIALIZE queue AS empty double-ended collection  
        FOR course FROM 1 TO n  
            IF in_degree AT course EQUALS 0  
                APPEND course TO queue  
        
        SET semesters TO 0  
        
        WHILE queue IS NOT EMPTY  
            SET number_to_take TO minimum BETWEEN k AND length of queue  
            FOR count FROM 1 TO number_to_take  
                REMOVE element from front of queue AS current_course  
                FOR each next_course IN graph AT current_course  
                    DECREMENT in_degree AT next_course BY 1  
                    IF in_degree AT next_course EQUALS 0  
                        APPEND next_course TO queue  
            INCREMENT semesters BY 1  
        
        RETURN semesters  
    END FUNCTION  
END CLASS