CLASS Solution  
    FUNCTION countSmaller(nums)  
        SET sorted_nums TO sorted unique values from nums  
        SET rank TO empty dictionary  
        FOR index FROM 0 TO length of sorted_nums MINUS 1  
            SET value TO element at index in sorted_nums  
            SET rank at value TO index PLUS 1  
        
        SET bit TO list of zeros with length equal to length of sorted_nums PLUS 1  
        
        FUNCTION get_sum(idx)  
            SET res TO 0  
            WHILE idx GREATER THAN 0  
                INCREMENT res BY element at idx in bit  
                DECREMENT idx BY the value of idx AND negative idx  
            RETURN res  
        END FUNCTION  
        
        FUNCTION update(idx, delta)  
            WHILE idx LESS THAN length of bit  
                INCREMENT element at idx in bit BY delta  
                INCREMENT idx BY the value of idx AND negative idx  
            END WHILE  
        END FUNCTION  
        
        SET counts TO empty list  
        FOR each num IN reversed nums  
            SET r TO value at num in rank  
            APPEND call get_sum WITH argument r MINUS 1 TO counts  
            CALL update WITH arguments r AND 1  
        END FOR  
        
        RETURN counts reversed  
    END FUNCTION  
END CLASS