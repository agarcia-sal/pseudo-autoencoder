CLASS Solution  
    FUNCTION leastBricks(wall)  
        SET gap_counts TO an empty mapping from number TO count with default zero  
        
        FOR each row IN wall  
            SET total TO 0  
            FOR each brick IN all elements of row except the last one  
                INCREMENT total BY brick  
                INCREMENT gap_counts[total] BY 1  
        
        SET max_gaps TO the maximum value in gap_counts or zero if gap_counts is empty  
        
        RETURN the length of wall MINUS max_gaps  
    END FUNCTION  
END CLASS