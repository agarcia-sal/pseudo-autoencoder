CLASS Solution  
    FUNCTION pathsWithMaxScore(board)  
        SET MOD TO 10 RAISED TO POWER 9 PLUS 7  
        SET n TO LENGTH OF board  
        
        INITIALIZE dp AS TWO-DIMENSIONAL ARRAY OF SIZE n BY n  
        FOR i FROM 0 TO n MINUS 1  
            FOR j FROM 0 TO n MINUS 1  
                SET dp[i][j] TO LIST OF TWO ELEMENTS: NEGATIVE infinity AND 0  
        
        SET dp[n MINUS 1][n MINUS 1] TO LIST OF TWO ELEMENTS: 0 AND 1  
        
        FOR i FROM n MINUS 1 DOWN TO 0  
            FOR j FROM n MINUS 1 DOWN TO 0  
                IF VALUE OF board AT POSITION i, j IS EQUALS TO 'X' OR 'S' THEN  
                    CONTINUE TO NEXT ITERATION  
                
                IF VALUE OF board AT POSITION i, j IS NOT EQUALS TO 'E' THEN  
                    SET value TO INTEGER CONVERSION OF board AT POSITION i, j  
                ELSE  
                    SET value TO 0  
                
                FOR EACH (x, y) IN LIST OF TRIPLES: (1, 0), (0, 1), (1, 1)  
                    SET ni TO i PLUS x  
                    SET nj TO j PLUS y  
                    
                    IF ni GREATER THAN OR EQUAL TO 0 AND ni LESS THAN n AND nj GREATER THAN OR EQUAL TO 0 AND nj LESS THAN n THEN  
                        IF FIRST ELEMENT OF dp[ni][nj] GREATER THAN FIRST ELEMENT OF dp[i][j] THEN  
                            SET dp[i][j] TO LIST OF TWO ELEMENTS: FIRST ELEMENT OF dp[ni][nj] PLUS value AND SECOND ELEMENT OF dp[ni][nj]  
                        ELSE IF FIRST ELEMENT OF dp[ni][nj] EQUALS FIRST ELEMENT OF dp[i][j] THEN  
                            SET SECOND ELEMENT OF dp[i][j] TO (SECOND ELEMENT OF dp[i][j] PLUS SECOND ELEMENT OF dp[ni][nj]) MODULO MOD  
        
        IF FIRST ELEMENT OF dp[0][0] EQUALS NEGATIVE infinity THEN  
            RETURN LIST OF TWO ELEMENTS: 0 AND 0  
        
        RETURN LIST OF TWO ELEMENTS: FIRST ELEMENT OF dp[0][0] AND SECOND ELEMENT OF dp[0][0]  
    END FUNCTION  
END CLASS