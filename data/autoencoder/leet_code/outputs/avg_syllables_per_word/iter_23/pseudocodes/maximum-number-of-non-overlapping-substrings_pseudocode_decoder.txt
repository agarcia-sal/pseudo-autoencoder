CLASS Solution  
    FUNCTION maxNumOfSubstrings(s)  
        SET first TO an empty collection that maps characters to their first occurrence position  
        SET last TO an empty collection that maps characters to their last occurrence position  
        FOR each position i and character c IN the sequence of characters of s  
            IF character c is not contained in first  
                SET the first occurrence position of character c TO i  
            END IF  
            SET the last occurrence position of character c TO i  
        END FOR  
  
        SET intervals TO an empty list  
        FOR each character c IN the collection of keys of first  
            SET start TO the first occurrence position of character c  
            SET end TO the last occurrence position of character c  
            SET i TO start  
            WHILE i IS LESS THAN OR EQUAL TO end  
                IF the first occurrence position of the character at position i of s IS LESS THAN start  
                    BREAK the WHILE loop  
                END IF  
                SET end TO the greater value between current end and the last occurrence position of the character at position i of s  
                INCREMENT i BY one  
            END WHILE  
            IF the WHILE loop did not break prematurely  
                APPEND the pair of start and end positions TO intervals  
            END IF  
        END FOR  
  
        SORT intervals in ascending order based on the second element of each pair representing the end position  
  
        SET result TO an empty list  
        SET prev_end TO a position value less than any possible valid start  
        FOR each pair of start and end positions IN intervals  
            IF start IS GREATER THAN prev_end  
                APPEND the substring of s starting at position start AND ending at position end inclusive TO result  
                SET prev_end TO end  
            END IF  
        END FOR  
  
        RETURN result  
    END FUNCTION  
END CLASS