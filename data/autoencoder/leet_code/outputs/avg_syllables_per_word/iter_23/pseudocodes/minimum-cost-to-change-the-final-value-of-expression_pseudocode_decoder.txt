CLASS Solution  
    FUNCTION minOperationsToFlip(expression)  
        SET stack TO empty list  
        FOR each element e IN expression  
            IF element e corresponds to open parenthesis OR element e corresponds to ampersand OR element e corresponds to vertical bar  
                APPEND tuple containing element e AND zero TO stack  
                CONTINUE to next iteration  
            ELSE IF element e corresponds to closing parenthesis  
                SET lastPair TO element popped from stack  
                POP element from stack  
            ELSE  
                SET lastPair TO tuple containing element e AND one  
            END IF  
            IF stack is not empty AND element at position negative one of stack with position zero of that element corresponds to ampersand OR vertical bar  
                SET operator op TO element popped from stack with position zero  
                SET a and costA TO element popped from stack  
                SET b and costB TO lastPair  
                IF operator op corresponds to ampersand  
                    IF a corresponds to zero AND b corresponds to zero  
                        SET lastPair TO tuple containing zero AND one PLUS minimum of costA AND costB  
                    ELSE IF a corresponds to zero AND b corresponds to one  
                        SET lastPair TO tuple containing zero AND one  
                    ELSE IF a corresponds to one AND b corresponds to zero  
                        SET lastPair TO tuple containing zero AND one  
                    ELSE  
                        SET lastPair TO tuple containing one AND minimum of costA AND costB  
                    END IF  
                ELSE  
                    IF a corresponds to zero AND b corresponds to zero  
                        SET lastPair TO tuple containing zero AND minimum of costA AND costB  
                    ELSE IF a corresponds to zero AND b corresponds to one  
                        SET lastPair TO tuple containing one AND one  
                    ELSE IF a corresponds to one AND b corresponds to zero  
                        SET lastPair TO tuple containing one AND one  
                    ELSE  
                        SET lastPair TO tuple containing one AND one PLUS minimum of costA AND costB  
                    END IF  
                END IF  
            END IF  
            APPEND lastPair TO stack  
        END FOR  
        RETURN element at position one of element at position negative one of stack  
    END FUNCTION  
END CLASS