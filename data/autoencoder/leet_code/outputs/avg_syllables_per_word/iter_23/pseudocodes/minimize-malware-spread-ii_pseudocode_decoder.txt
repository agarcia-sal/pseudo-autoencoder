CLASS Solution  
    FUNCTION minMalwareSpread(graph, initial)  
        SET number_of_nodes TO the LENGTH OF graph  
        SET adjacency_list TO a new mapping from elements to empty lists  
        FOR index_i FROM zero TO number_of_nodes MINUS one  
            FOR index_j FROM index_i PLUS one TO number_of_nodes MINUS one  
                IF element at position index_i of graph AND element at position index_j of that is EQUALS one  
                    APPEND index_j TO element at position index_i of adjacency_list  
                    APPEND index_i TO element at position index_j of adjacency_list  
                END IF  
            END FOR  
        END FOR  

        FUNCTION dfs(node, visited)  
            IF node IS IN visited  
                RETURN zero  
            END IF  
            ADD node TO visited  
            SET component_size TO one  
            FOR each neighbor IN element at position node of adjacency_list  
                INCREMENT component_size BY dfs(neighbor, visited)  
            END FOR  
            RETURN component_size  
        END FUNCTION  

        SET infected_nodes TO a new set containing all elements from initial  
        SET component_sizes TO an empty list  
        SET visited TO an empty set  
        SET component_index TO a new mapping from elements to undefined  

        FOR node FROM zero TO number_of_nodes MINUS one  
            IF node NOT IN visited AND node NOT IN infected_nodes  
                SET size_of_component TO dfs(node, visited)  
                APPEND size_of_component TO component_sizes  
                SET last_component_position TO the LENGTH OF component_sizes MINUS one  
                FOR each neighbor IN element at position node of adjacency_list  
                    SET element at position neighbor of component_index TO last_component_position  
                END FOR  
            END IF  
        END FOR  

        SET infected_count_in_component TO a new mapping from elements to zero  
        FOR each node IN infected_nodes  
            IF node IS IN component_index  
                INCREMENT element at position node of component_index in infected_count_in_component BY one  
            END IF  
        END FOR  

        SET maximum_size TO zero  
        SET node_to_remove TO the minimum element of initial  
        FOR each node IN infected_nodes  
            IF node IS IN component_index  
                SET comp_idx TO element at position node of component_index  
                IF element at position comp_idx of infected_count_in_component EQUALS one  
                    IF element at position comp_idx of component_sizes GREATER THAN maximum_size  
                        SET maximum_size TO element at position comp_idx of component_sizes  
                        SET node_to_remove TO node  
                    ELSE IF element at position comp_idx of component_sizes EQUALS maximum_size  
                        IF node LESS THAN node_to_remove  
                            SET node_to_remove TO node  
                        END IF  
                    END IF  
                END IF  
            END IF  
        END FOR  

        RETURN node_to_remove  
    END FUNCTION  
END CLASS