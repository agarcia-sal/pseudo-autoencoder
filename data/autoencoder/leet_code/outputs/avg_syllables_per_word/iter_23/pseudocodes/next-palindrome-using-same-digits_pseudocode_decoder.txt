CLASS Solution  
    FUNCTION nextPalindrome(num)  
        SET n TO the LENGTH OF num  
        SET half TO the SUBSTRING from POSITION zero TO POSITION n DIVIDED BY two of num  
        SET half_list TO the LIST of ELEMENTS IN half  
        SET k TO minus one  
        SET l TO minus one  
        FOR i FROM the LENGTH OF half_list MINUS two DOWN TO zero  
            IF the ELEMENT at POSITION i of half_list IS LESS THAN the ELEMENT at POSITION i PLUS one of half_list  
                SET k TO i  
                BREAK  
            END IF  
        END FOR  
        IF k EQUALS minus one  
            RETURN an empty string  
        END IF  
        FOR i FROM the LENGTH OF half_list MINUS one DOWN TO k PLUS one  
            IF the ELEMENT at POSITION i of half_list IS GREATER THAN the ELEMENT at POSITION k of half_list  
                SET l TO i  
                BREAK  
            END IF  
        END FOR  
        SET the ELEMENT at POSITION k of half_list TO the ELEMENT at POSITION l of half_list AND SET the ELEMENT at POSITION l of half_list TO the ELEMENT at POSITION k of half_list IN A SWAP  
        SET half_list TO the CONCATENATION OF the SUBLIST of half_list FROM POSITION zero TO POSITION k PLUS one AND THE SORTED SUBLIST of half_list FROM POSITION k PLUS one TO THE END  
        SET new_half TO the CONCATENATION OF ALL ELEMENTS IN half_list INTO A STRING  
        IF n MODULO two EQUALS zero  
            RETURN new_half FOLLOWED BY new_half IN REVERSE ORDER  
        ELSE  
            RETURN new_half FOLLOWED BY the ELEMENT at POSITION n DIVIDED BY two of num FOLLOWED BY new_half IN REVERSE ORDER  
        END IF  
    END FUNCTION  
END CLASS