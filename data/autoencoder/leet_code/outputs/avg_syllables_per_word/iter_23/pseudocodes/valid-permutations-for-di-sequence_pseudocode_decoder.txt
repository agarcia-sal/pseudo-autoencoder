CLASS Solution  
    FUNCTION numPermsDISequence(s)  
        SET MODULO TO one billion PLUS seven  
        SET length_of_s TO the LENGTH OF s  
        INITIALIZE dp AS a two dimensional list of zero VALUES with dimensions length_of_s PLUS one BY length_of_s PLUS one  
        
        FOR index_j FROM zero TO length_of_s  
            SET the element at position index_j IN the first list of dp TO one  
        END FOR  
        
        FOR index_i FROM one TO length_of_s  
            SET prefix_sum TO zero  
            IF the element at position index_i MINUS one IN s EQUALS the character I THEN  
                FOR index_j FROM zero TO length_of_s MINUS index_i  
                    SET prefix_sum TO prefix_sum PLUS the element at position index_j IN the list at position index_i MINUS one IN dp  
                    SET prefix_sum TO prefix_sum MODULO MODULO  
                    SET the element at position index_j IN the list at position index_i IN dp TO prefix_sum  
                END FOR  
            ELSE  
                FOR index_j FROM length_of_s MINUS index_i DOWN TO zero STEP negative one  
                    SET prefix_sum TO prefix_sum PLUS the element at position index_j PLUS one IN the list at position index_i MINUS one IN dp  
                    SET prefix_sum TO prefix_sum MODULO MODULO  
                    SET the element at position index_j IN the list at position index_i IN dp TO prefix_sum  
                END FOR  
            END IF  
        END FOR  
        
        SET total_valid_permutations TO zero  
        FOR each element IN the list at position length_of_s IN dp  
            INCREMENT total_valid_permutations BY element  
        END FOR  
        SET total_valid_permutations TO total_valid_permutations MODULO MODULO  
        
        RETURN total_valid_permutations  
    END FUNCTION  
END CLASS