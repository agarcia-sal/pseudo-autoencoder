CLASS Solution  
    FUNCTION spiralMatrixIII(rows r, cols c, rStart rs, cStart cs) RETURNS list of list of integer  
        SET directions TO list of pairs representing zero and one and zero and one, one and zero and zero and minus one, zero and minus one and zero and zero minus one, minus one and zero and zero and zero  
        SET direction_index TO zero  
        SET steps TO zero  
        SET increment TO zero  
        SET visited TO empty list  
        SET x TO rs  
        SET y TO cs  
        
        WHILE the LENGTH OF visited LESS THAN r MULTIPLIED BY c holds  
            IF increment MODULO two EQUALS zero THEN  
                INCREMENT steps BY one  
            END IF  
            FOR each element FROM one TO steps  
                IF zero LESS THAN OR EQUAL TO x AND x LESS THAN r AND zero LESS THAN OR EQUAL TO y AND y LESS THAN c THEN  
                    APPEND list containing x and y TO visited  
                END IF  
                SET dx TO the element at position direction_index of directions at position zero  
                SET dy TO the element at position direction_index of directions at position one  
                INCREMENT x BY dx  
                INCREMENT y BY dy  
            END FOR  
            SET direction_index TO the remainder of direction_index PLUS one DIVIDED BY four  
            INCREMENT increment BY one  
        END WHILE  
        
        RETURN visited  
    END FUNCTION  
END CLASS