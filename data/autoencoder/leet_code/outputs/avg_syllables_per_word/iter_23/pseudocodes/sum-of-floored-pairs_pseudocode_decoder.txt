CLASS Solution  
    FUNCTION sumOfFlooredPairs(nums)  
        SET MOD TO the number one billion PLUS seven  
        SET max_num TO the maximum element IN nums  
        SET count TO the frequency mapping OF elements IN nums  
        INITIALIZE prefix_sum AS a list WITH max_num PLUS one elements EACH SET TO zero  
        
        FOR each num IN the keys OF count  
            INCREMENT element at position num OF prefix_sum BY the value mapped TO num IN count  
        END FOR  
        
        FOR i FROM one TO max_num  
            INCREMENT element at position i OF prefix_sum BY element at position i MINUS one OF prefix_sum  
        END FOR  
        
        SET result TO zero  
        
        FOR each num IN the keys OF count  
            FOR multiple FROM one TO the integer division RESULT OF max_num DIVIDED BY num  
                SET start TO num MULTIPLIED BY multiple  
                SET end TO the lesser OF the value RESULT OF num MULTIPLIED BY multiple PLUS one THEN MINUS one AND max_num  
                SET multiples_count TO element at position end OF prefix_sum MINUS element at position start MINUS one OF prefix_sum  
                INCREMENT result BY multiples_count MULTIPLIED BY multiple MULTIPLIED BY the value mapped TO num IN count  
                SET result TO the remainder OF result DIVIDED BY MOD  
            END FOR  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS