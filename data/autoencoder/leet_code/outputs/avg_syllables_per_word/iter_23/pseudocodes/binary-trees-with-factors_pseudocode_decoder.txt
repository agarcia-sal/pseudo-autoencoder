CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MOD TO the number one billion PLUS seven  
        SORT arr IN ascending order  
        SET dp TO a mapping FROM each number in arr TO the value one  
        
        FOR each index i AND number num IN arr  
            FOR each index j FROM zero TO i MINUS one  
                IF the remainder of num DIVIDED BY the element at position j of arr EQUALS zero  
                    SET right_child TO num DIVIDED BY the element at position j of arr  
                    IF right_child EXISTS IN dp  
                        SET dp at key num TO the sum of dp at key num PLUS the product of dp at key of element at position j of arr AND dp at key right_child MODULO MOD  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        
        SET total TO the sum of all values in dp  
        RETURN total MODULO MOD  
    END FUNCTION  
END CLASS