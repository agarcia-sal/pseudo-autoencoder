CLASS UnionFind  
    FUNCTION __init__(self, n)  
        SET self.parent TO a list of integers from zero TO n MINUS one  
        SET self.rank TO a list containing zero repeated n times  
    END FUNCTION  
  
    FUNCTION find(self, x)  
        IF the element at position x of self.parent NOT EQUALS x THEN  
            SET the element at position x of self.parent TO the result of calling find with the argument the element at position x of self.parent  
        END IF  
        RETURN the element at position x of self.parent  
    END FUNCTION  
  
    FUNCTION union(self, x, y)  
        SET rootX TO the result of calling find with argument x  
        SET rootY TO the result of calling find with argument y  
        IF rootX NOT EQUALS rootY THEN  
            IF the element at position rootX of self.rank GREATER THAN the element at position rootY of self.rank THEN  
                SET the element at position rootY of self.parent TO rootX  
            ELSE IF the element at position rootX of self.rank LESS THAN the element at position rootY of self.rank THEN  
                SET the element at position rootX of self.parent TO rootY  
            ELSE  
                SET the element at position rootY of self.parent TO rootX  
                INCREMENT the element at position rootX of self.rank BY one  
            END IF  
        END IF  
    END FUNCTION  
END CLASS  
  
CLASS Solution  
    FUNCTION latestDayToCross(self, row, col, cells)  
        SET grid TO a list containing row elements each of which is a list containing col elements each set to one  
        SET uf TO a new instance of UnionFind with argument row MULTIPLIED BY col PLUS two  
        SET TOP TO row MULTIPLIED BY col  
        SET BOTTOM TO row MULTIPLIED BY col PLUS one  
        SET directions TO a list containing four elements each of which is a tuple consisting of the pair negative one and zero one and zero zero and negative one zero and one  
  
        FOR day FROM the length of cells MINUS one DOWN TO zero  
            SET r TO the first element of the element at position day of cells  
            SET c TO the second element of the element at position day of cells  
            DECREMENT r BY one  
            DECREMENT c BY one  
            SET the element at position r of grid TO the element at position r of grid with the element at position c replaced by zero  
  
            FOR each pair dr and dc IN directions  
                SET nr TO r PLUS dr  
                SET nc TO c PLUS dc  
                IF nr GREATER THAN OR EQUAL TO zero AND nr LESS THAN row AND nc GREATER THAN OR EQUAL TO zero AND nc LESS THAN col AND the element at position nr of grid and position nc EQUALS zero THEN  
                    CALL the method union of uf with arguments r MULTIPLIED BY col PLUS c and nr MULTIPLIED BY col PLUS nc  
                END IF  
            END FOR  
  
            IF r EQUALS zero THEN  
                CALL the method union of uf with arguments r MULTIPLIED BY col PLUS c and TOP  
            END IF  
  
            IF r EQUALS row MINUS one THEN  
                CALL the method union of uf with arguments r MULTIPLIED BY col PLUS c and BOTTOM  
            END IF  
  
            IF the result of calling find of uf with argument TOP EQUALS the result of calling find of uf with argument BOTTOM THEN  
                RETURN day  
            END IF  
        END FOR  
  
        RETURN zero  
    END FUNCTION  
END CLASS