CLASS Solution  
    FUNCTION maxEqualFreq(nums)  
        SET count TO a new Counter object  
        SET freq TO a new Counter object  
        SET max_len TO zero  
        
        FOR index FROM zero TO the LENGTH OF nums MINUS one  
            SET num TO element at position index of nums  
            INCREMENT the count corresponding to num BY one  
            
            IF the count corresponding to num IS GREATER THAN one THEN  
                DECREMENT the frequency corresponding to the count corresponding to num MINUS one BY one  
                IF the frequency corresponding to the count corresponding to num MINUS one IS EQUALS TO zero THEN  
                    REMOVE the frequency entry for the count corresponding to num MINUS one FROM freq  
                END IF  
            END IF  
            
            INCREMENT the frequency corresponding to the count corresponding to num BY one  
            
            IF the NUMBER OF DISTINCT FREQUENCIES IN freq IS EQUALS TO one AND (freq CONTAINS KEY one OR the SOLE VALUE IN freq IS EQUALS TO one) THEN  
                SET max_len TO index PLUS one  
            ELSE IF the NUMBER OF DISTINCT FREQUENCIES IN freq IS EQUALS TO two AND ((freq CONTAINS KEY one AND the frequency corresponding to one IS EQUALS TO one) OR ((THE HIGHEST FREQUENCY KEY MINUS THE LOWEST FREQUENCY KEY) IS EQUALS TO one AND the frequency corresponding to the HIGHEST FREQUENCY KEY IS EQUALS TO one)) THEN  
                SET max_len TO index PLUS one  
            END IF  
        END FOR  
        
        RETURN max_len  
    END FUNCTION  
END CLASS