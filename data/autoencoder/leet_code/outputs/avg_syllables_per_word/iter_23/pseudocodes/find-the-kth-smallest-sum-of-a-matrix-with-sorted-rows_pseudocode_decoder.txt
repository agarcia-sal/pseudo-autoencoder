CLASS Solution  
    FUNCTION kthSmallest(mat PARAMETER, k PARAMETER)  
        SET m TO the LENGTH OF mat  
        SET n TO the LENGTH OF element at position zero of mat  
        SET initial_sum TO zero  
        FOR each row IN mat  
            INCREMENT initial_sum BY element at position zero of row  
        END FOR  
        SET initial_indices TO a tuple of zero repeated m times  
        SET min_heap TO a list containing a tuple of initial_sum and initial_indices  
        SET visited TO a set containing initial_indices  
        
        WHILE k GREATER THAN zero holds  
            SET current_tuple TO the removal of the smallest element from min_heap  
            SET current_sum TO the first element of current_tuple  
            SET indices TO the second element of current_tuple  
            DECREMENT k BY one  
            
            IF k EQUALS zero THEN  
                RETURN current_sum  
            END IF  
            
            FOR i FROM zero TO m MINUS one  
                SET current_index TO element at position i of indices  
                IF current_index PLUS one LESS THAN n THEN  
                    SET new_indices_list TO a list copy of indices  
                    INCREMENT element at position i of new_indices_list BY one  
                    SET new_indices_tuple TO a tuple converted from new_indices_list  
                    SET old_value TO element at position i of mat AND element at position current_index of that row  
                    SET new_value TO element at position i of mat AND element at position current_index PLUS one of that row  
                    SET new_sum TO current_sum MINUS old_value PLUS new_value  
                    
                    IF new_indices_tuple NOT IN visited THEN  
                        ADD new_indices_tuple TO visited  
                        INSERT a tuple of new_sum and new_indices_tuple INTO min_heap preserving heap property  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN the integer negative one  
    END FUNCTION  
END CLASS