CLASS Solution  
    FUNCTION nthMagicalNumber WITH PARAMETERS n a b  
        SET MOD TO one billion PLUS seven  
        
        FUNCTION gcd WITH PARAMETERS x y  
            WHILE y NOT EQUALS zero  
                SET temporary_x TO y  
                SET temporary_y TO the remainder of x DIVIDED BY y  
                SET x TO temporary_x  
                SET y TO temporary_y  
            END WHILE  
            RETURN x  
        END FUNCTION  
        
        FUNCTION lcm WITH PARAMETERS x y  
            RETURN x MULTIPLIED BY y DIVIDED BY gcd OF x y  
        END FUNCTION  
        
        SET L TO lcm OF a b  
        
        SET left TO one  
        SET right TO n MULTIPLIED BY the smaller of a and b  
        
        WHILE left LESS THAN right  
            SET mid TO the integer part of the sum of left and right DIVIDED BY two  
            SET count TO the integer part of mid DIVIDED BY a PLUS the integer part of mid DIVIDED BY b MINUS the integer part of mid DIVIDED BY L  
            
            IF count LESS THAN n  
                SET left TO mid PLUS one  
            ELSE  
                SET right TO mid  
            END IF  
        END WHILE  
        
        RETURN the remainder of left DIVIDED BY MOD  
    END FUNCTION  
END CLASS