CLASS Solution  
    FUNCTION calculate(s)  
        FUNCTION helper(s)  
            SET stack TO an empty list  
            SET num TO zero  
            SET sign TO the character plus  
            WHILE the LENGTH OF s GREATER THAN zero holds  
                SET char TO the element at position zero of s  
                REMOVE the element at position zero FROM s  
                IF the character char IS a digit THEN  
                    SET num TO num MULTIPLIED BY ten PLUS the integer value of char  
                END IF  
                IF the character char EQUALS the opening parenthesis THEN  
                    SET num TO the result of calling helper with s as argument  
                END IF  
                IF the character char EQUALS the character plus OR the character char EQUALS the character minus OR the character char EQUALS the character multiplied BY OR the character char EQUALS the character divided BY OR the character char EQUALS the opening parenthesis OR the LENGTH OF s EQUALS zero THEN  
                    IF the variable sign EQUALS the character plus THEN  
                        APPEND num TO stack  
                    ELSE IF the variable sign EQUALS the character minus THEN  
                        APPEND minus num TO stack  
                    ELSE IF the variable sign EQUALS the character multiplied BY THEN  
                        SET the element at the last position of stack TO the element at the last position of stack MULTIPLIED BY num  
                    ELSE IF the variable sign EQUALS the character divided BY THEN  
                        SET the element at the last position of stack TO the integer part of the element at the last position of stack DIVIDED BY num  
                    END IF  
                    SET sign TO char  
                    SET num TO zero  
                END IF  
                IF the character char EQUALS the closing parenthesis THEN  
                    BREAK the WHILE loop  
                END IF  
            END WHILE  
            RETURN the result of summing all elements in stack  
        END FUNCTION  
        SET s TO the list of characters in s  
        RETURN the result of calling helper with s as argument  
    END FUNCTION  
END CLASS