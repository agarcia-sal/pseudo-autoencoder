CLASS Solution  
    FUNCTION movesToStamp(stamp stamp PARAMETER target target PARAMETER) RETURNS list of integer  
        SET length_of_stamp TO the LENGTH OF stamp  
        SET length_of_target TO the LENGTH OF target  
        SET indeg TO a list containing length_of_stamp repeated length_of_target MINUS length_of_stamp PLUS one times  
        SET queue TO an empty double ended queue  
        SET graph TO a list containing empty lists repeated length_of_target times  
        FOR index_i FROM zero TO length_of_target MINUS length_of_stamp  
            FOR each pair of index_j AND character_c IN stamp with their positions  
                IF the element at position index_i PLUS index_j of target EQUALS character_c  
                    DECREMENT the element at position index_i of indeg BY one  
                    IF the element at position index_i of indeg EQUALS zero  
                        APPEND index_i TO queue  
                ELSE  
                    APPEND index_i TO the list at position index_i PLUS index_j of graph  
                END IF  
            END FOR  
        END FOR  
        SET answer TO an empty list  
        SET visited TO a list containing False repeated length_of_target times  
        WHILE the LENGTH OF queue IS GREATER THAN zero  
            REMOVE and RETURN the leftmost element FROM queue INTO index_i  
            APPEND index_i TO answer  
            FOR index_j FROM zero TO length_of_stamp MINUS one  
                IF the element at position index_i PLUS index_j of visited EQUALS False  
                    SET the element at position index_i PLUS index_j of visited TO True  
                    FOR each element index_k IN the list at position index_i PLUS index_j of graph  
                        DECREMENT the element at position index_k of indeg BY one  
                        IF the element at position index_k of indeg EQUALS zero  
                            APPEND index_k TO queue  
                        END IF  
                    END FOR  
                END IF  
            END FOR  
        END WHILE  
        IF all elements of visited ARE True  
            RETURN the reverse of answer  
        ELSE  
            RETURN an empty list  
        END IF  
    END FUNCTION  
END CLASS