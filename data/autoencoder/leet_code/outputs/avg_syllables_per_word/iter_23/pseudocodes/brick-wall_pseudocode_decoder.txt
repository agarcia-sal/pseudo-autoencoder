CLASS Solution  
    FUNCTION leastBricks WITH wall AS list of list of integers  
        ASSIGN reference TO a new empty mapping from number to number named gap_counts  
        
        FOR each row IN wall  
            SET total TO zero  
            FOR each brick IN all elements of row EXCEPT the last element  
                INCREMENT total BY brick  
                IF total IS NOT a key in gap_counts THEN  
                    SET value at key total in gap_counts TO zero  
                END IF  
                INCREMENT value at key total in gap_counts BY one  
            END FOR  
        END FOR  
        
        SET max_gaps TO the maximum value among all values in gap_counts IF gap_counts IS NOT empty OTHERWISE zero  
        
        SET result TO the length of wall MINUS max_gaps  
        RETURN result  
    END FUNCTION  
END CLASS