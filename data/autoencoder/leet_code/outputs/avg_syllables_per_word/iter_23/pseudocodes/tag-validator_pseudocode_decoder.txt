CLASS Solution  
    FUNCTION isValid(code)  
        SET cdata_pattern TO the pattern indicating the sequence less than exclamation mark left square bracket CDATA left square bracket followed by minimal characters followed by right square bracket right square bracket greater than  
        SET code TO the result of replacing all sequences matching cdata_pattern in code with the empty sequence  
        SET stack TO an empty list  
        SET i TO zero  
        WHILE i LESS THAN the length of code  
            IF the element at position i of code EQUALS the character less than  
                SET j TO the position of the character greater than found in code starting from the element after position i  
                IF j EQUALS negative one  
                    RETURN false  
                END IF  
                SET tag_content TO the sequence of characters from the element after position i up to but not including position j of code  
                IF tag_content is empty  
                    RETURN false  
                END IF  
                IF the first character of tag_content EQUALS the character slash  
                    SET tag_name TO the sequence of characters of tag_content from position two to the end  
                    IF stack is empty OR the element at the last position of stack NOT EQUALS tag_name  
                        RETURN false  
                    END IF  
                    REMOVE the element at the last position from stack  
                ELSE IF the first character of tag_content EQUALS the character exclamation mark  
                    RETURN false  
                ELSE  
                    IF the length of tag_content LESS THAN one OR length of tag_content GREATER THAN nine OR tag_content converted to uppercase NOT EQUALS tag_content  
                        RETURN false  
                    END IF  
                    APPEND tag_content TO stack  
                END IF  
                SET i TO j PLUS one  
            ELSE  
                INCREMENT i BY one  
            END IF  
        END WHILE  
        SET pattern_check TO the result of finding all sequences matching the pattern less than followed by one or more uppercase letters followed by greater than followed by any characters followed by less than slash followed by one or more uppercase letters followed by greater than in code  
        RETURN stack is empty AND the length of pattern_check GREATER THAN zero  
    END FUNCTION  
END CLASS