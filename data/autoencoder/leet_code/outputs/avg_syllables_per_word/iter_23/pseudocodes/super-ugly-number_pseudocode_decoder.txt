CLASS Solution  
    FUNCTION nthSuperUglyNumber(n, primes)  
        SET ugly_numbers TO a list containing the number one  
        SET heap TO a list of pairs each containing an element of primes and its position index in primes  
        APPLY heapify operation to heap  
        SET indices TO a list of zeros with length equal to the length of primes  
        
        WHILE the length of ugly_numbers is less than n  
            REMOVE the smallest element from heap and ASSIGN the first element to next_ugly and the second element to prime_index  
            
            IF next_ugly NOT EQUALS the element at the last position of ugly_numbers  
                APPEND next_ugly TO ugly_numbers  
            END IF  
            
            INCREMENT the element at position prime_index of indices BY one  
            SET next_multiple TO the element at position prime_index of primes MULTIPLIED BY the element at the position indicated by the element at position prime_index of indices in ugly_numbers  
            PUSH a pair consisting of next_multiple and prime_index INTO heap  
        END WHILE  
        
        RETURN the element at the last position of ugly_numbers  
    END FUNCTION  
END CLASS