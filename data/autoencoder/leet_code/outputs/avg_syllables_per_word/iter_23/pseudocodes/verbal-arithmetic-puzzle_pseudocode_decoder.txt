CLASS Solution  
    FUNCTION isSolvable(words  
                        result)  
        SET unique_chars TO the set of all characters in all elements of words PLUS all characters in result  
        IF the number of unique_chars IS GREATER THAN ten  
            RETURN False  
        END IF  
          
        SET non_zero_chars TO the set of first character of each element in words IF the length of that element IS GREATER THAN one PLUS the first character of result IF the length of result IS GREATER THAN one OTHERWISE the empty string  
          
        SET char_to_digit TO empty mapping  
        SET digit_to_char TO empty mapping  
          
        FUNCTION can_assign(char  
                            digit)  
            RETURN char is NOT IN keys of char_to_digit AND (digit is NOT IN keys of digit_to_char OR the value at key digit in digit_to_char EQUALS char)  
        END FUNCTION  
          
        FUNCTION assign(char  
                        digit)  
            SET the value at key char in char_to_digit TO digit  
            SET the value at key digit in digit_to_char TO char  
        END FUNCTION  
          
        FUNCTION unassign(char  
                          digit)  
            REMOVE the element at key char FROM char_to_digit  
            REMOVE the element at key digit FROM digit_to_char  
        END FUNCTION  
          
        FUNCTION word_value(word)  
            SET total_value TO zero  
            FOR each pair of index FROM zero TO length of word MINUS one AND char AS element at position index of the reverse of word  
                INCREMENT total_value BY the value at key char in char_to_digit MULTIPLIED BY ten RAISED TO THE power of index  
            END FOR  
            RETURN total_value  
        END FUNCTION  
          
        FUNCTION backtrack(index  
                           col  
                           sum_col)  
            IF col IS GREATER THAN OR EQUAL TO the maximum length among all elements in words AND col IS GREATER THAN OR EQUAL TO the length of result  
                RETURN sum_col EQUALS zero  
            END IF  
              
            IF index IS EQUAL TO the length of words  
                IF col IS LESS THAN the length of result  
                    SET digit TO the element at position length of result MINUS one MINUS col of result  
                    IF digit IS IN keys of char_to_digit  
                        IF the value at key digit in char_to_digit EQUALS sum_col MODULO ten  
                            RETURN backtrack(zero  
                                             col PLUS one  
                                             sum_col DIVIDED BY ten)  
                        ELSE  
                            RETURN False  
                        END IF  
                    ELSE IF can_assign(digit  
                                       sum_col MODULO ten) AND (sum_col MODULO ten IS NOT EQUAL TO zero OR digit IS NOT IN non_zero_chars)  
                        CALL assign(digit  
                                    sum_col MODULO ten)  
                        IF backtrack(zero  
                                     col PLUS one  
                                     sum_col DIVIDED BY ten)  
                            RETURN True  
                        END IF  
                        CALL unassign(digit  
                                       sum_col MODULO ten)  
                    END IF  
                ELSE  
                    RETURN sum_col EQUALS zero  
                END IF  
                RETURN False  
            END IF  
              
            SET word TO element at position index of words  
            IF col IS GREATER THAN OR EQUAL TO the length of word  
                RETURN backtrack(index PLUS one  
                                 col  
                                 sum_col)  
            END IF  
              
            SET char TO element at position length of word MINUS one MINUS col of word  
            IF char IS IN keys of char_to_digit  
                RETURN backtrack(index PLUS one  
                                 col  
                                 sum_col PLUS the value at key char in char_to_digit)  
            END IF  
              
            FOR digit FROM zero TO nine  
                IF can_assign(char  
                              digit) AND (digit IS NOT EQUAL TO zero OR char IS NOT IN non_zero_chars)  
                    CALL assign(char  
                                digit)  
                    IF backtrack(index PLUS one  
                                 col  
                                 sum_col PLUS digit)  
                        RETURN True  
                    END IF  
                    CALL unassign(char  
                                   digit)  
                END IF  
            END FOR  
              
            RETURN False  
        END FUNCTION  
          
        RETURN backtrack(zero  
                         zero  
                         zero)  
    END FUNCTION  
END CLASS