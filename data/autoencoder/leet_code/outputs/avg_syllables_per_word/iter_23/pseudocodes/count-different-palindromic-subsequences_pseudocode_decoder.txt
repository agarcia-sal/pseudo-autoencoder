CLASS Solution  
    FUNCTION countPalindromicSubsequences(s)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF s  
        
        SET next_occurrence TO a two dimensional list with four rows and n columns EACH FILLED WITH minus one  
        SET prev_occurrence TO a two dimensional list with four rows and n columns EACH FILLED WITH minus one  
        
        FOR c FROM zero TO three  
            SET char TO the character at position equal to the Unicode code point of letter a PLUS c in the Unicode sequence  
            SET last TO minus one  
            FOR i FROM zero TO n MINUS one  
                IF the element at position i of s EQUALS char  
                    SET last TO i  
                END IF  
                SET element at position i of the list at row c in prev_occurrence TO last  
            END FOR  
            
            SET last TO minus one  
            FOR i FROM n MINUS one TO zero STEP minus one  
                IF the element at position i of s EQUALS char  
                    SET last TO i  
                END IF  
                SET element at position i of the list at row c in next_occurrence TO last  
            END FOR  
        END FOR  
        
        SET dp TO a two dimensional list with n rows and n columns EACH FILLED WITH zero  
        
        FOR i FROM zero TO n MINUS one  
            SET element at row i column i of dp TO one  
        END FOR  
        
        FOR length FROM two TO n  
            FOR i FROM zero TO n MINUS length  
                SET j TO i PLUS length MINUS one  
                FOR c FROM zero TO three  
                    SET char TO the character at position equal to the Unicode code point of letter a PLUS c in the Unicode sequence  
                    SET left TO the element at position i of the list at row c in next_occurrence  
                    SET right TO the element at position j of the list at row c in prev_occurrence  
                    
                    IF left GREATER THAN j OR right LESS THAN i  
                        CONTINUE TO the next iteration of the innermost loop  
                    ELSE IF left EQUALS right  
                        SET element at row i column j of dp TO the element at row i column j of dp PLUS one MODULO MOD  
                    ELSE  
                        SET element at row i column j of dp TO the element at row i column j of dp PLUS the element at row left PLUS one column right MINUS one of dp PLUS two MODULO MOD  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        RETURN the element at row zero column n MINUS one of dp  
    END FUNCTION  
END CLASS