CLASS Solution  
    FUNCTION connectTwoGroups(cost)  
        SET size1 TO the LENGTH OF cost  
        SET size2 TO the LENGTH OF element at position zero of cost  
        SET dp TO a list of lists where the outer list has size size1 plus one and each inner list has size two RAISED TO size2  
        FOR each inner list IN dp  
            SET each element TO infinity  
        END FOR  
        SET element at position zero of element at position zero of dp TO zero  
        
        FOR i FROM zero TO size1 MINUS one  
            FOR mask FROM zero TO two RAISED TO size2 MINUS one  
                
                FOR j FROM zero TO size2 MINUS one  
                    SET index1 TO i PLUS one  
                    SET index2 TO mask OR two RAISED TO j  
                    SET cost_candidate TO element at position mask of element at position i of dp PLUS element at position i of element at position j of cost  
                    IF element at position index2 of element at position index1 of dp GREATER THAN cost_candidate  
                        SET element at position index2 of element at position index1 of dp TO cost_candidate  
                    END IF  
                END FOR  
                
                FOR j FROM zero TO size2 MINUS one  
                    IF mask AND two RAISED TO j NOT EQUALS zero  
                        SET index1 TO i PLUS one  
                        SET cost_candidate TO element at position mask of element at position index1 of dp  
                        SET cost_reduce TO element at position index1 of element at position mask XOR two RAISED TO j of dp PLUS element at position i of element at position j of cost  
                        IF cost_candidate GREATER THAN cost_reduce  
                            SET element at position mask of element at position index1 of dp TO cost_reduce  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        RETURN element at position two RAISED TO size2 MINUS one of element at position size1 of dp  
    END FUNCTION  
END CLASS