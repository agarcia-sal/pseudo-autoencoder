CLASS Solution  
    FUNCTION ways(pizza, k)  
        FUNCTION dfs(i, j, k)  
            IF k EQUALS zero  
                RETURN the integer value of the expression the element at position m of the list s at position n MINUS the element at position i of the list s at position n MINUS the element at position m of the list s at position j PLUS the element at position i of the list s at position j GREATER THAN zero  
            END IF  
            SET ans TO zero  
            FOR x FROM i PLUS one TO m MINUS one  
                IF the element at position x of the list s at position n MINUS the element at position i of the list s at position n MINUS the element at position x of the list s at position j PLUS the element at position i of the list s at position j GREATER THAN zero  
                    INCREMENT ans BY the result of dfs called with arguments x, j, k MINUS one  
                END IF  
            END FOR  
            FOR y FROM j PLUS one TO n MINUS one  
                IF the element at position m of the list s at position y MINUS the element at position i of the list s at position y MINUS the element at position m of the list s at position j PLUS the element at position i of the list s at position j GREATER THAN zero  
                    INCREMENT ans BY the result of dfs called with arguments i, y, k MINUS one  
                END IF  
            END FOR  
            RETURN ans MODULO mod  
        END FUNCTION  

        SET mod TO ten raised to the power of nine PLUS seven  
        SET m TO the length of pizza  
        SET n TO the length of the element at position zero of pizza  
        INITIALIZE s AS a list containing m PLUS one elements each of which is a list containing n PLUS one zeros  
        FOR i, row IN the enumeration of pizza starting from one  
            FOR j, c IN the enumeration of row starting from one  
                SET the element at position i of the list s at position j TO the sum of the element at position i MINUS one of the list s at position j PLUS the element at position i of the list s at position j MINUS one MINUS the element at position i MINUS one of the list s at position j MINUS one PLUS the integer value of the predicate c EQUALS the character A  
            END FOR  
        END FOR  
        RETURN the result of dfs called with arguments zero, zero, k MINUS one  
    END FUNCTION  
END CLASS