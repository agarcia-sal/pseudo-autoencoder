CLASS Solution  
    FUNCTION tilingRectangle WITH PARAMETERS n m  
        FUNCTION backtrack WITH PARAMETERS heights moves  
            IF for each height IN heights height EQUALS n holds for all heights  
                SET min_moves TO the smaller value BETWEEN min_moves AND moves  
                RETURN  
            END IF  
            
            IF moves GREATER THAN OR EQUAL TO min_moves  
                RETURN  
            END IF  
            
            SET min_height TO the smallest value IN heights  
            SET left TO the position of min_height IN heights  
            SET right TO left  
            WHILE right LESS THAN m AND the element at position right of heights EQUALS min_height  
                INCREMENT right BY one  
            END WHILE  
            
            FOR size FROM right MINUS left DOWN TO one  
                IF for each index FROM zero TO size MINUS one the element at position left PLUS index of heights PLUS size LESS THAN OR EQUAL TO n holds for all indices  
                    SET new_heights TO a copy of heights  
                    FOR i FROM zero TO size MINUS one  
                        INCREMENT the element at position left PLUS i of new_heights BY size  
                    END FOR  
                    CALL backtrack WITH PARAMETERS new_heights moves PLUS one  
                END IF  
            END FOR  
        END FUNCTION  
        
        SET min_moves TO positive infinity  
        CALL backtrack WITH PARAMETERS a list of zeros of length m zero  
        RETURN min_moves  
    END FUNCTION  
END CLASS