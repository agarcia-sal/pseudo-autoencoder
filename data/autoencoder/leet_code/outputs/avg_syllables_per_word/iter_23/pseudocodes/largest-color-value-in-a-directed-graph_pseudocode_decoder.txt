CLASS Solution  
    FUNCTION largestPathValue(colors, edges)  
        SET n TO the LENGTH OF colors  
        ASSIGN reference graph TO a new mapping from keys to empty lists  
        SET in_degree TO a list of zero ELEMENTS repeated n TIMES  
        
        FOR each u AND v IN edges  
            APPEND v TO the list corresponding TO key u IN graph  
            INCREMENT the element at position v OF in_degree BY one  
        END FOR  
        
        ASSIGN reference queue TO a new double-ended queue containing each i IN the RANGE FROM zero TO n MINUS one WHERE the element at position i OF in_degree EQUALS zero  
        SET dp TO a list containing n TIMES a list of zero ELEMENTS repeated twenty-six TIMES  
        SET visited TO zero  
        SET max_color_value TO zero  
        
        WHILE the LENGTH OF queue IS GREATER THAN zero  
            REMOVE the element from the FRONT OF queue AND ASSIGN it TO node  
            INCREMENT the element at position corresponding TO the position of the character at position node OF colors MINUS the position of the character a OF dp at position node BY one  
            SET max_color_value TO the GREATER THAN value BETWEEN max_color_value AND the element at position corresponding TO the position of the character at position node OF colors MINUS the position of the character a OF dp at position node  
            INCREMENT visited BY one  
            
            FOR each neighbor IN the list corresponding TO key node IN graph  
                FOR c FROM zero TO twenty-five  
                    SET the element at position c OF dp at position neighbor TO the GREATER THAN value BETWEEN the element at position c OF dp at position neighbor AND the element at position c OF dp at position node  
                END FOR  
                DECREMENT the element at position neighbor OF in_degree BY one  
                IF the element at position neighbor OF in_degree EQUALS zero  
                    APPEND neighbor TO queue  
                END IF  
            END FOR  
        END WHILE  
        
        IF visited EQUALS n  
            RETURN max_color_value  
        ELSE  
            RETURN negative one  
        END IF  
    END FUNCTION  
END CLASS