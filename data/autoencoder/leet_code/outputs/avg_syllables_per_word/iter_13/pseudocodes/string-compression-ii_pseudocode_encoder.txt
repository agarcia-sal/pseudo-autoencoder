CLASS Solution  
    FUNCTION getLengthOfOptimalCompression(s, k)  
        DEFINE FUNCTION dp(i, k_remaining, previous_character, previous_count)  
            IF k_remaining LESS THAN zero THEN  
                RETURN infinity value  
            END IF  
            IF position i EQUALS the LENGTH OF string s THEN  
                RETURN zero  
            END IF  
            IF character at position i of string s EQUALS previous_character THEN  
                SET increment_value TO one IF previous_count EQUALS one OR previous_count EQUALS nine OR previous_count EQUALS ninety nine OTHERWISE zero  
                RETURN increment_value PLUS dp WITH parameters position i PLUS one k_remaining previous_character previous_count PLUS one  
            ELSE  
                SET keep_option TO one PLUS dp WITH parameters position i PLUS one k_remaining character at position i of string s one  
                SET delete_option TO dp WITH parameters position i PLUS one k_remaining MINUS one previous_character previous_count  
                RETURN the MINIMUM OF keep_option AND delete_option  
            END IF  
        END FUNCTION  
        RETURN dp WITH parameters zero k empty string zero  
    END FUNCTION  
END CLASS