CLASS Solution  
    FUNCTION braceExpansionII(expression)  
        FUNCTION parse_expression(index)  
            SET current_set TO an empty set  
            SET current_product TO a list containing an empty string  
            WHILE index IS LESS THAN the LENGTH OF expression  
                SET char TO the element at position index of expression  
                IF char EQUALS the open curly brace symbol  
                    SET inner_set AND index TO the result of calling parse_expression with the value index PLUS one  
                    SET current_product TO a list formed by concatenating each element a in current_product with each element b in inner_set  
                ELSE IF char EQUALS the close curly brace symbol  
                    ADD to current_set all strings formed by concatenating elements of current_product without separators  
                    RETURN current_set AND index  
                ELSE IF char EQUALS the comma symbol  
                    ADD to current_set all strings formed by concatenating elements of current_product without separators  
                    SET current_product TO a list containing an empty string  
                ELSE  
                    SET current_product TO a list formed by concatenating each element a in current_product with the character char  
                END IF  
                INCREMENT index BY one  
            END WHILE  
            ADD to current_set all strings formed by concatenating elements of current_product without separators  
            RETURN current_set AND index  
        END FUNCTION  
        SET result_set AND discard_value TO the result of calling parse_expression with zero  
        RETURN a sorted list of the elements in result_set  
    END FUNCTION  
END CLASS