CLASS Solution  
    FUNCTION minOperationsToFlip(expression)  
        SET stack TO an empty list  
        FOR each element IN expression  
            IF the element IS one of the characters open parenthesis OR ampersand OR vertical bar  
                APPEND the tuple consisting of the element AND zero to the stack  
                CONTINUE to the next iteration  
            ELSE IF the element IS a closing parenthesis  
                SET lastPair TO the result of removing the last item from the stack  
                REMOVE the last item from the stack which corresponds to the open parenthesis  
            ELSE  
                SET lastPair TO the tuple consisting of the element AND one  
            END IF  
            
            IF the stack IS NOT empty AND the first item of the last tuple in the stack IS one of ampersand OR vertical bar  
                SET op TO the first item of the last tuple removed from the stack  
                SET a AND costA TO the first AND second items of the last tuple removed from the stack  
                SET b AND costB TO the first AND second items of lastPair  
                
                IF op IS ampersand  
                    IF a IS zero AND b IS zero  
                        SET lastPair TO the tuple of zero AND one PLUS the minimum of costA AND costB  
                    ELSE IF a IS zero AND b IS one  
                        SET lastPair TO the tuple of zero AND one  
                    ELSE IF a IS one AND b IS zero  
                        SET lastPair TO the tuple of zero AND one  
                    ELSE  
                        SET lastPair TO the tuple of one AND the minimum of costA AND costB  
                    END IF  
                ELSE  
                    IF a IS zero AND b IS zero  
                        SET lastPair TO the tuple of zero AND the minimum of costA AND costB  
                    ELSE IF a IS zero AND b IS one  
                        SET lastPair TO the tuple of one AND one  
                    ELSE IF a IS one AND b IS zero  
                        SET lastPair TO the tuple of one AND one  
                    ELSE  
                        SET lastPair TO the tuple of one AND one PLUS the minimum of costA AND costB  
                    END IF  
                END IF  
            END IF  
            
            APPEND lastPair TO the stack  
        END FOR  
        
        RETURN the second item of the last tuple in the stack  
    END FUNCTION  
END CLASS