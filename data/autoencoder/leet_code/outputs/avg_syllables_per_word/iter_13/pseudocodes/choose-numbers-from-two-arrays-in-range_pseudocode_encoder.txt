CLASS Solution  
    FUNCTION countSubranges(nums1 WITH TYPE List OF integer, nums2 WITH TYPE List OF integer) RETURNS integer  
        SET n TO the LENGTH OF nums1  
        SET count TO zero  
        SET dp TO a LIST OF n ELEMENTS each BEING a DEFAULT DICTIONARY OF integer TO integer  
        
        FOR i FROM zero TO n MINUS one  
            INCREMENT the VALUE ASSOCIATED WITH element at position nums1 at index i OF dp at index i BY one  
            INCREMENT the VALUE ASSOCIATED WITH element at position NEGATIVE element at position nums2 at index i OF dp at index i BY one  
            
            IF i GREATER THAN zero  
                FOR each balance WITH ASSOCIATED frequency freq IN the ITEMS OF dp at index i MINUS one  
                    SET the VALUE ASSOCIATED WITH element at position balance PLUS element at position nums1 at index i OF dp at index i TO the CURRENT VALUE ASSOCIATED WITH THAT element PLUS freq MODULO ten RAISED TO THE POWER OF nine PLUS seven  
                    SET the VALUE ASSOCIATED WITH element at position balance MINUS element at position nums2 at index i OF dp at index i TO the CURRENT VALUE ASSOCIATED WITH THAT element PLUS freq MODULO ten RAISED TO THE POWER OF nine PLUS seven  
                END FOR  
            END IF  
            
            SET count TO count PLUS the VALUE ASSOCIATED WITH element at position zero OF dp at index i MODULO ten RAISED TO THE POWER OF nine PLUS seven  
        END FOR  
        
        RETURN count  
    END FUNCTION  
END CLASS