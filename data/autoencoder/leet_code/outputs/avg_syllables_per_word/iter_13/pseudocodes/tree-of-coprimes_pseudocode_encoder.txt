CLASS Solution  
    FUNCTION getCoprimes(nums, edges)  
        SET n TO the LENGTH OF nums  
        SET tree TO an empty mapping with default value as empty list  
        FOR each pair of elements u and v IN edges  
            APPEND v TO the element at position u of tree  
            APPEND u TO the element at position v of tree  
        END FOR  
        
        SET coprime TO a two dimensional collection of size fifty by fifty each initialized to false  
        FOR each integer i FROM one TO fifty  
            FOR each integer j FROM one TO fifty  
                SET element at position i and j of coprime TO the condition that greatest common divisor of i and j EQUALS one  
            END FOR  
        END FOR  
        
        SET result TO a list of length n each element set to negative one  
        SET ancestor_stack TO a list of length fifty one each element initialized to none  
        
        FUNCTION dfs(node, parent, depth)  
            SET closest_ancestor TO negative one  
            SET max_depth TO negative one  
            FOR each integer value FROM one TO fifty  
                IF element at position nums at the position node AND value of coprime IS true AND the element at position value of ancestor_stack IS NOT none THEN  
                    ASSIGN anc_node AND anc_depth TO the elements of the element at position value of ancestor_stack  
                    IF anc_depth GREATER THAN max_depth THEN  
                        SET max_depth TO anc_depth  
                        SET closest_ancestor TO anc_node  
                    END IF  
                END IF  
            END FOR  
            SET element at position node of result TO closest_ancestor  
            
            ASSIGN original_ancestor TO the element at position nums at the position node of ancestor_stack  
            SET element at position nums at the position node of ancestor_stack TO the pair consisting of node AND depth  
            
            FOR each child IN the element at position node of tree  
                IF child IS NOT EQUAL TO parent THEN  
                    CALL dfs WITH arguments child, node, depth PLUS one  
                END IF  
            END FOR  
            
            SET element at position nums at the position node of ancestor_stack TO original_ancestor  
        END FUNCTION  
        
        CALL dfs WITH arguments zero, negative one, zero  
        
        RETURN result  
    END FUNCTION  
END CLASS