CLASS Solution  
    FUNCTION solve(nums AS list of integers, queries AS list of list of integers) RETURNS list of integers  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF nums  
        SET max_y TO the LARGEST second element IN each pair OF queries  
        SET prefix_sums TO a list CONTAINING max_y PLUS one ELEMENTS EACH BEING a list OF zeros WITH LENGTH n  
        
        FOR y FROM one TO max_y  
            FOR i FROM n MINUS one DOWN TO zero  
                IF the SUM OF i PLUS y IS LESS THAN n  
                    SET the element at position i OF the element at position y OF prefix_sums TO the element at position i OF nums PLUS the element at position i PLUS y OF the element at position y OF prefix_sums  
                ELSE  
                    SET the element at position i OF the element at position y OF prefix_sums TO the element at position i OF nums  
                END IF  
            END FOR  
        END FOR  
        
        SET answer TO an empty list  
        FOR each pair x AND y IN queries  
            APPEND the remainder OF the element at position x OF the element at position y OF prefix_sums DIVIDED BY MOD TO answer  
        END FOR  
        
        RETURN answer  
    END FUNCTION  
END CLASS