CLASS Solution  
    FUNCTION kthSmallestProduct(nums1 AS List of integers, nums2 AS List of integers, k AS integer) RETURNS integer  
        FUNCTION count(p AS integer) RETURNS integer  
            SET cnt TO zero  
            SET n TO the LENGTH OF nums2  
            FOR each x IN nums1  
                IF x GREATER THAN zero THEN  
                    INCREMENT cnt BY the POSITION AFTER the LAST ELEMENT LESS THAN OR EQUAL TO p DIVIDED BY x IN nums2  
                ELSE IF x LESS THAN zero THEN  
                    INCREMENT cnt BY n MINUS the POSITION OF THE FIRST ELEMENT GREATER THAN OR EQUAL TO p DIVIDED BY x IN nums2  
                ELSE  
                    INCREMENT cnt BY n MULTIPLIED BY one IF p GREATER THAN OR EQUAL TO zero OTHERWISE zero  
                END IF  
            END FOR  
            RETURN cnt  
        END FUNCTION  

        SET mx TO the MAXIMUM OF the ABSOLUTE VALUE OF the FIRST element OF nums1 AND the ABSOLUTE VALUE OF the LAST element OF nums1 MULTIPLIED BY the MAXIMUM OF the ABSOLUTE VALUE OF the FIRST element OF nums2 AND the ABSOLUTE VALUE OF the LAST element OF nums2  
        SET result TO the POSITION OF THE FIRST ELEMENT GREATER THAN OR EQUAL TO k IN the RANGE OF INTEGERS FROM NEGATIVE mx TO mx PLUS one USING count AS THE CONDITION FUNCTION MINUS mx  
        RETURN result  
    END FUNCTION  
END CLASS