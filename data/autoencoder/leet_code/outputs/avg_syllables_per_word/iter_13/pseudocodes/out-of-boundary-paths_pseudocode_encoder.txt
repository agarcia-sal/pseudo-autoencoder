CLASS Solution  
    FUNCTION findPaths(m, n, maxMove, startRow, startColumn)  
        SET MOD TO one billion PLUS seven  
        
        SET directions TO list containing pairs zero and one zero and negative one one and zero negative one and zero representing movements right left down up respectively  
        
        SET dp TO three dimensional list with dimensions m by n by maxMove plus one where each element is initialized to zero representing number of ways to reach each cell with a certain number of moves  
        
        FOR each number k FROM one TO maxMove  
            FOR each number i FROM zero TO m minus one  
                FOR each number j FROM zero TO n minus one  
                    FOR each pair (di, dj) IN directions  
                        SET ni TO i PLUS di  
                        SET nj TO j PLUS dj  
                        IF ni LESS THAN zero OR ni GREATER THAN OR EQUAL TO m OR nj LESS THAN zero OR nj GREATER THAN OR EQUAL TO n  
                            SET dp at position i j k TO remainder after division of dp at position i j k PLUS one BY MOD  
                        ELSE  
                            SET dp at position i j k TO remainder after division of dp at position i j k PLUS dp at position ni nj k minus one BY MOD  
                        END IF  
                    END FOR  
                END FOR  
            END FOR  
        END FOR  
        
        RETURN dp at position startRow startColumn maxMove  
    END FUNCTION  
END CLASS