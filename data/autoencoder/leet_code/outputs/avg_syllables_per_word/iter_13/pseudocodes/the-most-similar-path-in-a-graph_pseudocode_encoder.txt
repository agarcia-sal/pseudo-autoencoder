CLASS Solution  
    FUNCTION mostSimilar(n, roads, names, targetPath)  
        SET graph TO a new mapping with default empty list for each key  
        FOR each pair u AND v IN roads  
            APPEND v TO the element at position u of graph  
            APPEND u TO the element at position v of graph  
        END FOR  
        SET m TO the LENGTH OF targetPath  
        FUNCTION dp(i, j) WITH MEMOIZATION  
            IF i EQUALS zero THEN  
                SET cost TO one IF the element at position j of names DOES NOT EQUAL the element at position i of targetPath OTHERWISE zero  
                RETURN cost AND a list CONTAINING j  
            END IF  
            SET min_cost TO positive infinity  
            SET min_path TO an empty list  
            FOR each k IN the element at position j of graph  
                SET cost AND path TO the result of calling dp WITH parameters i MINUS one AND k  
                IF cost LESS THAN min_cost THEN  
                    SET min_cost TO cost  
                    SET min_path TO path  
                END IF  
            END FOR  
            SET current_cost TO min_cost PLUS one IF the element at position j of names DOES NOT EQUAL the element at position i of targetPath OTHERWISE zero  
            RETURN current_cost AND the concatenation of min_path AND a list CONTAINING j  
        END FUNCTION  
        SET min_cost TO positive infinity  
        SET min_path TO an empty list  
        FOR j FROM zero TO n MINUS one  
            SET cost AND path TO the result of calling dp WITH parameters m MINUS one AND j  
            IF cost LESS THAN min_cost THEN  
                SET min_cost TO cost  
                SET min_path TO path  
            END IF  
        END FOR  
        RETURN min_path  
    END FUNCTION  
END CLASS