CLASS Solution  
    FUNCTION pathsWithMaxScore WITH PARAMETER board  
        SET MOD TO ten POWERED BY nine PLUS one  
        SET n TO the LENGTH OF board  
        SET dp TO a two-dimensional collection of size n BY n WHERE each element IS a pair OF negative infinity AND zero  
        SET the element at position n MINUS one COMMA n MINUS one OF dp TO a pair OF zero AND one  
        FOR i FROM n MINUS one DOWN TO zero  
            FOR j FROM n MINUS one DOWN TO zero  
                IF the element at position i of board AT position j IS EQUAL TO the character X OR EQUAL TO the character S  
                    CONTINUE TO the next iteration  
                END IF  
                IF the element at position i of board AT position j IS NOT EQUAL TO the character E  
                    SET value TO the integer representation OF the element at position i of board AT position j  
                ELSE  
                    SET value TO zero  
                END IF  
                FOR each pair x COMMA y IN the collection containing pairs one COMMA zero AND zero COMMA one AND one COMMA one  
                    SET ni TO i PLUS x  
                    SET nj TO j PLUS y  
                    IF ni IS GREATER THAN OR EQUAL TO zero AND ni IS LESS THAN n AND nj IS GREATER THAN OR EQUAL TO zero AND nj IS LESS THAN n  
                        IF the first element OF the pair at position ni COMMA nj OF dp IS GREATER THAN the first element OF the pair at position i COMMA j OF dp  
                            SET the element at position i COMMA j OF dp TO a pair WHERE the first element IS the first element OF the pair at position ni COMMA nj OF dp PLUS value AND the second element IS the second element OF the pair at position ni COMMA nj OF dp  
                        ELSE IF the first element OF the pair at position ni COMMA nj OF dp IS EQUAL TO the first element OF the pair at position i COMMA j OF dp  
                            SET the second element OF the pair at position i COMMA j OF dp TO the sum OF the current second element OF the pair at position i COMMA j OF dp AND the second element OF the pair at position ni COMMA nj OF dp MODULO MOD  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        IF the first element OF the pair at position zero COMMA zero OF dp IS EQUAL TO negative infinity  
            RETURN a pair OF zero AND zero  
        END IF  
        RETURN the pair at position zero COMMA zero OF dp  
    END FUNCTION  
END CLASS