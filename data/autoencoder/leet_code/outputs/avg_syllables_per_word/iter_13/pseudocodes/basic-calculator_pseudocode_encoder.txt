CLASS Solution  
    FUNCTION calculate WITH parameter s  
        FUNCTION helper WITH parameter s  
            SET stack TO empty list  
            SET sign TO character plus  
            SET num TO zero  
            
            WHILE the LENGTH OF s GREATER THAN zero holds  
                SET char TO element at position zero of s  
                REMOVE element at position zero FROM s  
                
                IF char IS a digit character  
                    SET num TO num MULTIPLIED BY ten PLUS the integer value of char  
                END IF  
                
                IF char IS the opening parenthesis character  
                    SET num TO helper WITH parameter s  
                END IF  
                
                IF char IS NOT a digit character AND char IS NOT a whitespace character OR the LENGTH OF s EQUALS zero  
                    IF sign EQUALS character plus  
                        APPEND num TO stack  
                    ELSE IF sign EQUALS character minus  
                        APPEND negative num TO stack  
                    ELSE IF sign EQUALS character multiplied sign  
                        SET element at last position of stack TO element at last position of stack MULTIPLIED BY num  
                    ELSE IF sign EQUALS character division sign  
                        SET element at last position of stack TO the integer part of element at last position of stack DIVIDED BY num  
                    END IF  
                    
                    SET sign TO char  
                    SET num TO zero  
                END IF  
                
                IF char IS the closing parenthesis character  
                    BREAK the loop  
                END IF  
            END WHILE  
            
            RETURN the sum of elements in stack  
        END FUNCTION  
        
        RETURN helper WITH parameter the list formed by characters of s  
    END FUNCTION  
END CLASS