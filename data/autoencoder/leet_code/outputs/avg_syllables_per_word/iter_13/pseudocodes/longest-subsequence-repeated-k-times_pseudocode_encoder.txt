CLASS Solution  
    FUNCTION longestSubsequenceRepeatedK(s string, k integer) RETURNS string  
        ASSIGN ASCII characters counted in string s TO frequency_map  
        SET valid_chars TO list of characters IN frequency_map WHERE frequency_map value FOR character IS GREATER THAN OR EQUAL TO k  
        SORT valid_chars IN REVERSE LEXICOGRAPHICAL ORDER  
        
        FUNCTION is_valid_subsequence(candidate string) RETURNS boolean  
            SET count TO zero  
            SET index TO zero  
            FOR each character IN string s  
                IF character EQUALS character at position index of candidate THEN  
                    INCREMENT index BY one  
                    IF index EQUALS LENGTH OF candidate THEN  
                        INCREMENT count BY one  
                        SET index TO zero  
                        IF count EQUALS k THEN  
                            RETURN true  
                        END IF  
                    END IF  
                END IF  
            END FOR  
            RETURN false  
        END FUNCTION  
        
        SET max_length TO INTEGER PART OF LENGTH OF valid_chars DIVIDED BY k  
        SET best_candidate TO empty string  
        
        FUNCTION backtrack(candidate string)  
            IF LENGTH OF candidate GREATER THAN LENGTH OF best_candidate THEN  
                SET best_candidate TO candidate  
            END IF  
            FOR each character IN valid_chars  
                SET new_candidate TO candidate CONCATENATED WITH character  
                IF is_valid_subsequence(new_candidate) IS true THEN  
                    CALL backtrack WITH new_candidate  
                END IF  
            END FOR  
        END FUNCTION  
        
        CALL backtrack WITH empty string  
        RETURN best_candidate  
    END FUNCTION  
END CLASS