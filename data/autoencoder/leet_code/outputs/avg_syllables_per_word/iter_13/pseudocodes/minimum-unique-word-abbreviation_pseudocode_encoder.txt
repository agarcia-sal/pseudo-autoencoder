CLASS Solution  
    FUNCTION minAbbreviation WITH PARAMETERS target AND dictionary  
        FUNCTION is_valid_abbr WITH PARAMETERS s AND abbr  
            SET variable i TO zero  
            SET variable j TO zero  
            WHILE i IS LESS THAN the LENGTH OF s AND j IS LESS THAN the LENGTH OF abbr  
                IF the element at position j of abbr IS A DIGIT  
                    IF the element at position j of abbr EQUALS zero  
                        RETURN false  
                    END IF  
                    SET variable shift TO zero  
                    WHILE j IS LESS THAN the LENGTH OF abbr AND the element at position j of abbr IS A DIGIT  
                        SET shift TO shift MULTIPLIED BY ten PLUS the integer value of the element at position j of abbr  
                        INCREMENT j BY one  
                    END WHILE  
                    INCREMENT i BY shift  
                ELSE  
                    IF the element at position i of s IS NOT EQUAL TO the element at position j of abbr  
                        RETURN false  
                    END IF  
                    INCREMENT i BY one  
                    INCREMENT j BY one  
                END IF  
            END WHILE  
            RETURN i EQUALS the LENGTH OF s AND j EQUALS the LENGTH OF abbr  
        END FUNCTION  
        
        FUNCTION generate_abbrs WITH PARAMETERS word AND length AND OPTIONAL abbr DEFAULT TO empty string AND index DEFAULT TO zero AND skip_count DEFAULT TO zero  
            IF index EQUALS length  
                IF skip_count IS GREATER THAN zero  
                    SET abbr TO abbr CONCATENATED WITH the string representation of skip_count  
                END IF  
                APPEND abbr TO the list abbrs  
                RETURN  
            END IF  
            CALL generate_abbrs WITH PARAMETERS word length abbr index PLUS one skip_count PLUS one  
            IF skip_count IS GREATER THAN zero  
                SET abbr TO abbr CONCATENATED WITH the string representation of skip_count  
            END IF  
            CALL generate_abbrs WITH PARAMETERS word length abbr concatenated WITH the element at position index of word index PLUS one zero  
        END FUNCTION  
        
        FUNCTION find_unique_abbr WITH NO PARAMETERS  
            FOR each length FROM one TO the LENGTH OF target  
                CLEAR the list abbrs  
                CALL generate_abbrs WITH PARAMETERS target LENGTH OF target  
                SET variable min_abbr TO none  
                SET variable min_length TO positive infinity  
                FOR each abbr IN abbrs  
                    IF for all word IN filtered_dict the function is_valid_abbr WITH PARAMETERS word abbr RETURNS false  
                        IF the LENGTH OF abbr IS LESS THAN min_length  
                            SET min_length TO the LENGTH OF abbr  
                            SET min_abbr TO abbr  
                        END IF  
                    END IF  
                END FOR  
                IF min_abbr IS NOT none  
                    RETURN min_abbr  
                END IF  
            END FOR  
        END FUNCTION  
        
        SET filtered_dict TO a new list containing each word IN dictionary WHERE the LENGTH OF word EQUALS the LENGTH OF target  
        SET abbrs TO an empty list  
        RETURN the RESULT OF calling find_unique_abbr with no parameters  
    END FUNCTION  
END CLASS