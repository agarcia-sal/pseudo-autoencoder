CLASS Solution  
    FUNCTION maxProfit WITH PARAMETERS k AND prices  
        IF the collection prices is empty OR k EQUALS zero  
            RETURN zero  
        END IF  
        
        SET n TO the LENGTH OF the collection prices  
        
        IF k IS GREATER THAN OR EQUAL TO the INTEGER DIVISION OF n BY two  
            SET profit TO zero  
            FOR index FROM one TO n MINUS one  
                IF the element at position index of prices IS GREATER THAN the element at position index MINUS one of prices  
                    INCREMENT profit BY the element at position index of prices MINUS the element at position index MINUS one of prices  
                END IF  
            END FOR  
            RETURN profit  
        END IF  
        
        CALL FUNCTION initialize_list WITH PARAMETERS negative infinity AND k PLUS one AND ASSIGN RESULT TO hold  
        CALL FUNCTION initialize_list WITH PARAMETERS zero AND k PLUS one AND ASSIGN RESULT TO release  
        
        FOR each price IN prices  
            FOR i FROM one TO k  
                SET hold AT position i TO THE GREATER OF hold AT position i AND release AT position i MINUS one MINUS price  
                SET release AT position i TO THE GREATER OF release AT position i AND hold AT position i PLUS price  
            END FOR  
        END FOR  
        
        RETURN release AT position k  
    END FUNCTION  
    
    FUNCTION initialize_list WITH PARAMETERS value AND length  
        RETURN a list containing value repeated length times  
    END FUNCTION  
END CLASS