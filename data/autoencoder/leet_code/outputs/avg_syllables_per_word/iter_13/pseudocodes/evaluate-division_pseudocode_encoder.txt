CLASS Solution  
    FUNCTION calcEquation(equations AS list of list of strings, values AS list of floating point numbers, queries AS list of list of strings) RETURNS list of floating point numbers  
        SET graph TO an empty mapping where each key maps to a mapping of strings to floating point numbers  
        
        FOR each pair of variables named a and b in equations AND corresponding value in values simultaneously  
            SET the element at position b of the element at position a of graph TO value  
            SET the element at position a of the element at position b of graph TO one DIVIDED BY value  
        END FOR  
        
        FUNCTION dfs(start AS string, end AS string, visited AS set of strings) RETURNS floating point number  
            IF start IS NOT an element of graph OR end IS NOT an element of graph  
                RETURN negative one floating point number  
            END IF  
            IF start EQUALS end  
                RETURN one floating point number  
            END IF  
            ADD start TO visited  
            FOR each neighbor and corresponding weight in the elements of graph at position start  
                IF neighbor IS NOT an element of visited  
                    SET result TO dfs(neighbor, end, visited)  
                    IF result IS NOT equal to negative one floating point number  
                        RETURN weight MULTIPLIED BY result  
                    END IF  
                END IF  
            END FOR  
            REMOVE start FROM visited  
            RETURN negative one floating point number  
        END FUNCTION  
        
        SET results TO an empty list  
        FOR each query IN queries  
            SET start TO element at position zero of query  
            SET end TO element at position one of query  
            SET visited TO an empty set  
            SET result TO dfs(start, end, visited)  
            APPEND result TO results  
        END FOR  
        
        RETURN results  
    END FUNCTION  
END CLASS