CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MOD TO one billion PLUS seven  
        SORT the elements of arr in ascending order  
        CREATE dp AS a mapping from each number IN arr TO one representing the tree count for single element  
        
        FOR each index i AND corresponding number num IN arr  
            FOR each index j FROM zero TO one LESS THAN i  
                IF the remainder of num DIVIDED BY element at position j of arr EQUALS zero THEN  
                    SET right_child TO num DIVIDED BY element at position j of arr  
                    IF right_child EXISTS AS a key IN dp THEN  
                        SET dp at key num TO dp at key num PLUS dp at key element at position j of arr MULTIPLIED BY dp at key right_child THEN MODULO MOD  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        
        RETURN the sum of all values IN dp MAPPED modulo MOD  
    END FUNCTION  
END CLASS