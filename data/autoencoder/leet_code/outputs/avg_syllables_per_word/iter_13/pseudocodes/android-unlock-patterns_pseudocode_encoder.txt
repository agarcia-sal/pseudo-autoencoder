CLASS Solution  
    FUNCTION numberOfPatterns(m, n)  
        SET jumps TO mapping of pairs to integer where the key and value pairs are the following  
            pair of one and three mapped to two  
            pair of one and seven mapped to four  
            pair of one and nine mapped to five  
            pair of two and eight mapped to five  
            pair of three and one mapped to two  
            pair of three and seven mapped to five  
            pair of three and nine mapped to six  
            pair of four and six mapped to five  
            pair of five and five mapped to five  
            pair of six and four mapped to five  
            pair of seven and one mapped to four  
            pair of seven and three mapped to five  
            pair of seven and nine mapped to eight  
            pair of eight and two mapped to five  
            pair of nine and one mapped to five  
            pair of nine and three mapped to six  
            pair of nine and seven mapped to eight  
        
        FUNCTION countPatternsFromDot(current, visited, length)  
            IF length EQUALS n THEN  
                RETURN one  
            END IF  
            SET count TO one IF length IS GREATER THAN OR EQUAL TO m OTHERWISE zero  
            FOR each next_dot FROM one TO nine  
                IF element at position next_dot of visited IS false THEN  
                    SET jump TO value at key pair of current and next_dot in jumps IF PRESENT OTHERWISE null  
                    IF jump IS null OR element at position jump of visited IS true THEN  
                        SET element at position next_dot of visited TO true  
                        INCREMENT count BY countPatternsFromDot(next_dot, visited, length PLUS one)  
                        SET element at position next_dot of visited TO false  
                    END IF  
                END IF  
            END FOR  
            RETURN count  
        END FUNCTION  
        
        SET visited TO list of ten elements all set to false  
        SET result TO zero  
        FOR i FROM one TO nine  
            SET element at position i of visited TO true  
            INCREMENT result BY countPatternsFromDot(i, visited, one)  
            SET element at position i of visited TO false  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS