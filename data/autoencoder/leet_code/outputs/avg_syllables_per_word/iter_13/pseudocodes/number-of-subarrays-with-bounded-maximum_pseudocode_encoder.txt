CLASS Solution  
    FUNCTION numSubarrayBoundedMax(nums list OF integers left integer right integer) RETURNS integer  
        FUNCTION count(max_value integer) RETURNS integer  
            SET count TO zero  
            SET current_length TO zero  
            FOR each num IN nums  
                IF num IS LESS THAN OR EQUAL TO max_value  
                    INCREMENT current_length BY one  
                    INCREMENT count BY current_length  
                ELSE  
                    SET current_length TO zero  
                END IF  
            END FOR  
            RETURN count  
        END FUNCTION  
        SET result TO the value returned by count called with right MINUS the value returned by count called with the result of left MINUS one  
        RETURN result  
    END FUNCTION  
END CLASS