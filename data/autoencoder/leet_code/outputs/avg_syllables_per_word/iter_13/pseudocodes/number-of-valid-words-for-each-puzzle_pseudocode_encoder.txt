CLASS Solution  
    FUNCTION findNumOfValidWords(words WITH TYPE List OF string, puzzles WITH TYPE List OF string) RETURNS List OF integer  
        FUNCTION to_mask(s WITH TYPE string) RETURNS integer  
            SET mask TO zero  
            FOR each char IN s  
                SET mask TO mask BITWISE OR WITH one LEFT SHIFTED BY the numerical Unicode code of char MINUS the numerical Unicode code of letter a  
            END FOR  
            RETURN mask  
        END FUNCTION  
        
        SET word_count TO a new default dictionary mapping integers TO integers defaulting TO zero  
        
        FOR each word IN words  
            SET mask TO to_mask CALLED WITH word  
            IF the number of bits set TO one in mask IS LESS THAN OR EQUAL TO seven THEN  
                INCREMENT the integer at key mask in word_count BY one  
            END IF  
        END FOR  
        
        SET result TO an empty list  
        
        FOR each puzzle IN puzzles  
            SET first_char_mask TO one LEFT SHIFTED BY the numerical Unicode code of the element at position zero of puzzle MINUS the numerical Unicode code of letter a  
            SET puzzle_mask TO to_mask CALLED WITH the substring of puzzle from position one TO the end of puzzle  
            SET count TO the integer at key first_char_mask in word_count  
            
            SET subset TO puzzle_mask  
            WHILE subset IS NOT zero  
                INCREMENT count BY the integer at key the bitwise OR of subset AND first_char_mask in word_count  
                SET subset TO the bitwise AND of the result of subset MINUS one AND puzzle_mask  
            END WHILE  
            
            APPEND count TO result  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS