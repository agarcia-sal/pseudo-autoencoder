CLASS Solution  
    FUNCTION validTicTacToe(board)  
        SET countX TO zero  
        FOR each row IN board  
            INCREMENT countX BY the NUMBER OF OCCURRENCES OF character X IN row  
        END FOR  
        SET countO TO zero  
        FOR each row IN board  
            INCREMENT countO BY the NUMBER OF OCCURRENCES OF character O IN row  
        END FOR  

        IF countX IS LESS THAN countO OR countX IS GREATER THAN countO PLUS one  
            RETURN false  
        END IF  

        FUNCTION check_win(player)  
            FOR each row IN board  
                IF the WHOLE row EQUALS player REPEATED three TIMES  
                    RETURN true  
                END IF  
            END FOR  

            FOR col FROM zero TO two  
                IF the element at position col of the element at position zero of board EQUALS player AND  
                   the element at position col of the element at position one of board EQUALS player AND  
                   the element at position col of the element at position two of board EQUALS player  
                    RETURN true  
                END IF  
            END FOR  

            IF the element at position zero of the element at position zero of board EQUALS player AND  
               the element at position one of the element at position one of board EQUALS player AND  
               the element at position two of the element at position two of board EQUALS player  
                RETURN true  
            END IF  

            IF the element at position two of the element at position zero of board EQUALS player AND  
               the element at position one of the element at position one of board EQUALS player AND  
               the element at position zero of the element at position two of board EQUALS player  
                RETURN true  
            END IF  

            RETURN false  
        END FUNCTION  

        SET winX TO the RESULT OF check_win WITH parameter character X  
        SET winO TO the RESULT OF check_win WITH parameter character O  

        IF winX AND winO  
            RETURN false  
        END IF  

        IF winX AND countX EQUALS countO  
            RETURN false  
        END IF  

        IF winO AND countX DOES NOT EQUAL countO  
            RETURN false  
        END IF  

        RETURN true  
    END FUNCTION  
END CLASS