CLASS Solution  
    FUNCTION checkRecord(n)  
        SET MOD TO one billion PLUS seven  
        
        FUNCTION initialize_three_dimensional_list WITH parameters length limit one AND limit two  
            CREATE a list named result  
            FOR index FROM zero TO n INCLUSIVE  
                CREATE a two dimensional list layer  
                FOR first_dimension FROM zero TO limit one MINUS one  
                    CREATE a one dimensional list of zeros with size limit two  
                    APPEND this one dimensional list TO layer  
                END FOR  
                APPEND layer TO result  
            END FOR  
            RETURN result  
        END FUNCTION  
        
        SET dp TO the result of initialize_three_dimensional_list WITH n PLUS one AND two AND three  
        
        SET element at position zero of the element at position zero of the element at position zero of dp TO one  
        
        FOR i FROM one TO n INCLUSIVE  
            FOR j FROM zero TO one INCLUSIVE  
                FOR k FROM zero TO two INCLUSIVE  
                    SET element at position zero of the element at position j of the element at position i of dp TO the value of the element at position zero of the element at position j of the element at position i of dp PLUS the value of the element at position zero of the element at position j of the element at position i MINUS one of dp  
                    SET this sum TO MODULO MOD  
                    
                    IF j EQUALS zero THEN  
                        SET element at position zero of the element at position one of the element at position i of dp TO the value of the element at position zero of the element at position one of the element at position i of dp PLUS the value of the element at position zero of the element at position zero of the element at position i MINUS one of dp  
                        SET this sum TO MODULO MOD  
                    END IF  
                    
                    IF k LESS THAN two THEN  
                        SET element at position k PLUS one of the element at position j of the element at position i of dp TO the value of the element at position k PLUS one of the element at position j of the element at position i of dp PLUS the value of the element at position k of the element at position j of the element at position i MINUS one of dp  
                        SET this sum TO MODULO MOD  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        SET result TO zero  
        FOR j FROM zero TO one INCLUSIVE  
            FOR k FROM zero TO two INCLUSIVE  
                SET result TO the value of result PLUS the value of the element at position k of the element at position j of the element at position n of dp  
                SET result TO result MODULO MOD  
            END FOR  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS