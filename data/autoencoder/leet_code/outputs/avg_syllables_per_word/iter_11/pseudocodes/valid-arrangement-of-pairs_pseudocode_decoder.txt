CLASS Solution  
    FUNCTION validArrangement(pairs)  
        SET graph TO a new default dictionary of lists  
        SET out_degree TO a new counter  
        SET in_degree TO a new counter  
        
        FOR each u, v IN pairs  
            APPEND v TO the list at graph[u]  
            INCREMENT out_degree[u] BY one  
            INCREMENT in_degree[v] BY one  
        END FOR  
        
        SET start_node TO None  
        FOR each node IN graph  
            IF out_degree[node] EQUALS in_degree[node] PLUS one  
                SET start_node TO node  
                BREAK  
            END IF  
        END FOR  
        
        IF start_node IS None  
            SET start_node TO the first element obtained from graph  
        END IF  
        
        SET path TO an empty list  
        SET stack TO a list containing start_node  
        
        WHILE stack IS NOT empty  
            SET u TO the last element of stack  
            IF graph[u] IS NOT empty  
                REMOVE last element FROM graph[u] AND SET it TO v  
                APPEND v TO stack  
            ELSE  
                REMOVE last element FROM stack AND APPEND it TO path  
            END IF  
        END WHILE  
        
        REVERSE path  
        
        SET result TO an empty list  
        FOR i FROM zero TO the length of path MINUS one MINUS one  
            APPEND a list containing the element at position i of path AND the element at position i PLUS one of path TO result  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS