CLASS Solution  
    FUNCTION nthSuperUglyNumber(n, primes)  
        SET ugly_numbers TO list containing one  
        SET heap TO list of pairs where each pair is element p at position i of primes  
        CALL heapify ON heap  
        SET indices TO list with LENGTH OF primes elements each set to zero  

        WHILE LENGTH OF ugly_numbers LESS THAN n  
            SET next_ugly_and_prime_index TO result of removing the smallest element FROM heap  
            SET next_ugly TO first element of next_ugly_and_prime_index  
            SET prime_index TO second element of next_ugly_and_prime_index  

            IF next_ugly NOT EQUALS last element of ugly_numbers  
                APPEND next_ugly TO ugly_numbers  
            END IF  

            INCREMENT element at position prime_index of indices BY one  
            SET next_multiple TO element at position prime_index of primes MULTIPLIED BY element at position element at position prime_index of indices of ugly_numbers  
            PUSH pair of next_multiple and prime_index INTO heap  
        END WHILE  

        RETURN last element of ugly_numbers  
    END FUNCTION  
END CLASS