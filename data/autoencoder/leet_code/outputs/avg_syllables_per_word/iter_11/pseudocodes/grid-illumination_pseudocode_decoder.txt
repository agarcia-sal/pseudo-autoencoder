CLASS Solution  
    FUNCTION gridIllumination(n, lamps, queries)  
        CALL initialize_defaultdict FOR row_count  
        CALL initialize_defaultdict FOR col_count  
        CALL initialize_defaultdict FOR diag_count  
        CALL initialize_defaultdict FOR anti_diag_count  
        SET lamp_positions TO empty set  
        
        FOR each pair r, c IN lamps  
            IF pair r, c NOT IN lamp_positions  
                ADD pair r, c TO lamp_positions  
                INCREMENT value at r IN row_count BY one  
                INCREMENT value at c IN col_count BY one  
                INCREMENT value at r MINUS c IN diag_count BY one  
                INCREMENT value at r PLUS c IN anti_diag_count BY one  
            END IF  
        END FOR  
        
        SET directions TO list of pairs: minus one MINUS one, minus one zero, minus one one, zero MINUS one, zero zero, zero one, one MINUS one, one zero, one one  
        
        SET result TO empty list  
        
        FOR each pair r, c IN queries  
            IF value at r IN row_count GREATER THAN zero OR value at c IN col_count GREATER THAN zero OR value at r MINUS c IN diag_count GREATER THAN zero OR value at r PLUS c IN anti_diag_count GREATER THAN zero  
                APPEND one TO result  
            ELSE  
                APPEND zero TO result  
            END IF  
            
            FOR each pair dr, dc IN directions  
                SET nr TO r PLUS dr  
                SET nc TO c PLUS dc  
                IF pair nr, nc IN lamp_positions  
                    REMOVE pair nr, nc FROM lamp_positions  
                    DECREMENT value at nr IN row_count BY one  
                    DECREMENT value at nc IN col_count BY one  
                    DECREMENT value at nr MINUS nc IN diag_count BY one  
                    DECREMENT value at nr PLUS nc IN anti_diag_count BY one  
                END IF  
            END FOR  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS