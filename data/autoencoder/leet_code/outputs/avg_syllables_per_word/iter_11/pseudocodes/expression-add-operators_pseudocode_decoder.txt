CLASS Solution  
    FUNCTION addOperators(num, target)  
        FUNCTION dfs(index, path, value, prev)  
            IF index EQUALS the LENGTH OF num  
                IF value EQUALS target  
                    APPEND path TO result  
                END IF  
                RETURN  
            END IF  
  
            FOR i FROM index PLUS one TO the LENGTH OF num PLUS one  
                SET operand TO the SUBSTRING OF num FROM index TO i  
                IF the LENGTH OF operand GREATER THAN one AND the first element OF operand EQUALS zero as string  
                    CONTINUE  
                END IF  
  
                IF index EQUALS zero  
                    CALL dfs WITH PARAMETERS i, operand, the INTEGER VALUE OF operand, the INTEGER VALUE OF operand  
                ELSE  
                    CALL dfs WITH PARAMETERS i, the CONCATENATION OF path PLUS literal PLUS operand, value PLUS the INTEGER VALUE OF operand, the INTEGER VALUE OF operand  
                    CALL dfs WITH PARAMETERS i, the CONCATENATION OF path MINUS literal MINUS operand, value MINUS the INTEGER VALUE OF operand, NEGATIVE the INTEGER VALUE OF operand  
                    CALL dfs WITH PARAMETERS i, the CONCATENATION OF path MULTIPLIED BY literal MULTIPLIED BY operand, value MINUS prev PLUS prev MULTIPLIED BY the INTEGER VALUE OF operand, prev MULTIPLIED BY the INTEGER VALUE OF operand  
                END IF  
            END FOR  
        END FUNCTION  
  
        SET result TO an empty list  
        CALL dfs WITH PARAMETERS zero, empty string, zero, zero  
        RETURN result  
    END FUNCTION  
END CLASS