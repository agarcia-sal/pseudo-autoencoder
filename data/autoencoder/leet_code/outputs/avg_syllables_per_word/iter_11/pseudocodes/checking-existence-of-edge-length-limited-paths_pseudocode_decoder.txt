CLASS UnionFind
    FUNCTION __init__(self, size)
        SET self.parent TO list of integers from zero TO size MINUS one
        SET self.rank TO list of the integer one repeated size times
    END FUNCTION

    FUNCTION find(self, p)
        IF element at position p of self.parent NOT EQUALS p
            SET element at position p of self.parent TO self.find(element at position p of self.parent)
        END IF
        RETURN element at position p of self.parent
    END FUNCTION

    FUNCTION union(self, p, q)
        SET rootP TO self.find(p)
        SET rootQ TO self.find(q)
        IF rootP EQUALS rootQ
            RETURN False
        END IF
        IF element at position rootP of self.rank GREATER THAN element at position rootQ of self.rank
            SET element at position rootQ of self.parent TO rootP
        ELSE IF element at position rootP of self.rank LESS THAN element at position rootQ of self.rank
            SET element at position rootP of self.parent TO rootQ
        ELSE
            SET element at position rootQ of self.parent TO rootP
            INCREMENT element at position rootP of self.rank BY one
        END IF
        RETURN True
    END FUNCTION
END CLASS

CLASS Solution
    FUNCTION distanceLimitedPathsExist(self, n, edgeList, queries)
        CALL edgeList.sort with key as function that returns element at position two of input argument
        
        SET indexedQueries TO empty list
        FOR each index i FROM zero TO length of queries MINUS one
            SET p TO element at position zero of element at position i of queries
            SET q TO element at position one of element at position i of queries
            SET limit TO element at position two of element at position i of queries
            APPEND tuple of limit, p, q, i TO indexedQueries
        END FOR
        CALL indexedQueries.sort
        
        SET uf TO new UnionFind with parameter n
        
        SET edgeIndex TO zero
        SET numEdges TO length of edgeList
        SET results TO list of False repeated length of queries times
        
        FOR each tuple of limit, p, q, originalIndex IN indexedQueries
            WHILE edgeIndex LESS THAN numEdges AND element at position two of element at position edgeIndex of edgeList LESS THAN limit
                SET u TO element at position zero of element at position edgeIndex of edgeList
                SET v TO element at position one of element at position edgeIndex of edgeList
                CALL uf.union with arguments u and v
                INCREMENT edgeIndex BY one
            END WHILE
            IF uf.find(p) EQUALS uf.find(q)
                SET element at position originalIndex of results TO True
            END IF
        END FOR
        
        RETURN results
    END FUNCTION
END CLASS