CLASS Solution  
    FUNCTION findRotateSteps(ring, key)  
        SET char_positions TO dictionary mapping characters TO empty lists  
        FOR index FROM zero TO the LENGTH OF ring MINUS one  
            SET character_at_index TO element at position index of ring  
            APPEND index TO the list corresponding to character_at_index in char_positions  
        END FOR  
        
        SET n TO the LENGTH OF ring  
        
        FUNCTION dp(i, prev_pos)  
            IF i EQUALS the LENGTH OF key  
                RETURN zero  
            END IF  
            
            SET min_steps TO infinity  
            FOR each pos IN the list corresponding to the element at position i of key in char_positions  
                SET clockwise TO the result of pos MINUS prev_pos MODULO n  
                SET anticlockwise TO the result of prev_pos MINUS pos MODULO n  
                SET steps TO the minimum of clockwise AND anticlockwise PLUS one PLUS the result of dp(i PLUS one, pos)  
                IF steps LESS THAN min_steps  
                    SET min_steps TO steps  
                END IF  
            END FOR  
            
            RETURN min_steps  
        END FUNCTION  
        
        RETURN the result of dp(zero, zero)  
    END FUNCTION  
END CLASS