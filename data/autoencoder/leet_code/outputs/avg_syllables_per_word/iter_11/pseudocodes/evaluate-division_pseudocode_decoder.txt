CLASS Solution  
    FUNCTION calcEquation(equations, values, queries)  
        SET graph TO a new mapping from keys to empty mappings  
        FOR each pair_of_variables and corresponding value IN equations and values zipped together  
            SET variable_a TO the first element of pair_of_variables  
            SET variable_b TO the second element of pair_of_variables  
            SET the mapping of variable_b in graph at variable_a TO value  
            SET the mapping of variable_a in graph at variable_b TO one DIVIDED BY value  
        END FOR  
        
        FUNCTION dfs(start, end, visited)  
            IF start NOT IN graph OR end NOT IN graph  
                RETURN negative one point zero  
            END IF  
            IF start EQUALS end  
                RETURN one point zero  
            END IF  
            ADD start TO visited  
            FOR each neighbor and weight IN the items of graph at start  
                IF neighbor NOT IN visited  
                    SET result TO dfs(neighbor, end, visited)  
                    IF result NOT EQUALS negative one point zero  
                        RETURN weight MULTIPLIED BY result  
                    END IF  
                END IF  
            END FOR  
            REMOVE start FROM visited  
            RETURN negative one point zero  
        END FUNCTION  
        
        SET results TO a new empty list  
        FOR each query IN queries  
            SET start TO the first element of query  
            SET end TO the second element of query  
            SET visited TO a new empty set  
            SET result TO dfs(start, end, visited)  
            APPEND result TO results  
        END FOR  
        
        RETURN results  
    END FUNCTION  
END CLASS