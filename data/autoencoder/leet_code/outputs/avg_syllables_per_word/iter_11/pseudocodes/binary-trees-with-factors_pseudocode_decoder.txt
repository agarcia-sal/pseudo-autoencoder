CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MOD TO one billion PLUS seven  
        SORT arr IN ascending order  
        SET dp TO an empty dictionary mapping each number in arr TO one  
        
        FOR index i FROM zero TO the LENGTH OF arr MINUS one  
            SET num TO element at position i of arr  
            FOR index j FROM zero TO i MINUS one  
                SET factor_candidate TO element at position j of arr  
                IF num MODULO factor_candidate EQUALS zero  
                    SET right_child TO num DIVIDED BY factor_candidate  
                    IF right_child IS IN dp  
                        SET dp at num TO the remainder after dividing the SUM of dp at num PLUS the PRODUCT of dp at factor_candidate AND dp at right_child BY MOD  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        
        SET total_trees TO zero  
        FOR each value IN the VALUES of dp  
            INCREMENT total_trees BY value  
        END FOR  
        SET total_trees TO the remainder after dividing total_trees BY MOD  
        RETURN total_trees  
    END FUNCTION  
END CLASS