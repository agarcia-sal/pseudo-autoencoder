CLASS Solution  
    FUNCTION solve(nums, queries)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF nums  
          
        SET max_y TO the MAXIMUM y FOR each pair underscore comma y IN queries  
        CALL init_prefix_sums WITH max_y PLUS one AND n  
        STORE RESULT IN prefix_sums  
          
        FOR y FROM one TO max_y  
            FOR i FROM n MINUS one DOWN TO zero  
                IF i PLUS y LESS THAN n  
                    SET element at position i of prefix_sums at position y TO element at position i of nums PLUS element at position i PLUS y of prefix_sums at position y  
                ELSE  
                    SET element at position i of prefix_sums at position y TO element at position i of nums  
                END IF  
            END FOR  
        END FOR  
          
        SET answer TO an empty list  
        FOR each pair x comma y IN queries  
            APPEND element at position x of prefix_sums at position y MODULO MOD TO answer  
        END FOR  
          
        RETURN answer  
    END FUNCTION  
      
    FUNCTION init_prefix_sums(rows, cols)  
        SET prefix_sums TO an empty list  
        FOR each index FROM zero TO rows MINUS one  
            SET current_row TO a list of zero repeated cols times  
            APPEND current_row TO prefix_sums  
        END FOR  
        RETURN prefix_sums  
    END FUNCTION  
END CLASS