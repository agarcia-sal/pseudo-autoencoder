CLASS Solution  
    FUNCTION numWays(words, target)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF the element at position zero of words  
        SET m TO the LENGTH OF target  
        
        SET freq TO a list of size n where each element is a new dictionary mapping characters to zero  
        FOR each word IN words  
            FOR each character with index j IN word  
                INCREMENT the value at key character in freq at position j BY one  
            END FOR  
        END FOR  
        
        SET dp TO a two-dimensional list of size (m PLUS one) by (n PLUS one) filled with zeros  
        
        FOR each j FROM zero TO n  
            SET the element at position zero and j of dp TO one  
        END FOR  
        
        FOR each i FROM one TO m  
            FOR each j FROM one TO n  
                SET the element at position i and j of dp TO the element at position i and (j MINUS one) of dp  
                IF the value at key character at position (i MINUS one) of target in freq at position (j MINUS one) IS GREATER THAN zero  
                    INCREMENT the element at position i and j of dp BY the product of the element at position (i MINUS one) and (j MINUS one) of dp AND the value at key character at position (i MINUS one) of target in freq at position (j MINUS one)  
                    SET the element at position i and j of dp TO the remainder when divided by MOD  
                END IF  
            END FOR  
        END FOR  
        
        RETURN the element at position m and n of dp  
    END FUNCTION  
END CLASS