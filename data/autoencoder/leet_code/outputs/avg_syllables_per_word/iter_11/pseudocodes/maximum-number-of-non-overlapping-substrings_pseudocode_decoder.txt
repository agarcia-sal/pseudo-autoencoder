CLASS Solution  
    FUNCTION maxNumOfSubstrings(s)  
        SET first TO empty dictionary  
        SET last TO empty dictionary  
        FOR each index i AND character c IN s  
            IF c NOT IN first  
                SET first at key c TO i  
            END IF  
            SET last at key c TO i  
        END FOR  

        SET intervals TO empty list  
        FOR each character c IN keys of first  
            SET start TO value at first key c  
            SET end TO value at last key c  
            SET i TO start  
            WHILE i LESS THAN OR EQUAL TO end  
                IF value at first key character at position i of s LESS THAN start  
                    BREAK the WHILE loop  
                END IF  
                SET end TO the GREATER OF end AND value at last key character at position i of s  
                INCREMENT i BY one  
            END WHILE  
            IF the WHILE loop completed WITHOUT BREAK  
                APPEND the pair of start AND end TO intervals  
            END IF  
        END FOR  

        SORT intervals BY second element of each pair in ascending order  

        SET result TO empty list  
        SET prev_end TO negative one  
        FOR each pair start AND end IN intervals  
            IF start GREATER THAN prev_end  
                APPEND substring of s from start TO end INCLUSIVE TO result  
                SET prev_end TO end  
            END IF  
        END FOR  

        RETURN result  
    END FUNCTION  
END CLASS