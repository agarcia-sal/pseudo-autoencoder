CLASS Solution  
    FUNCTION ways(pizza, k)  
        SET mod TO one billion PLUS seven  
        SET m TO the LENGTH OF pizza  
        SET n TO the LENGTH OF the element at position zero of pizza  
        CALL FUNCTION initialize_prefix_sum WITH PARAMETERS m, n, pizza AND SET RESULT TO s  
  
        FUNCTION dfs(i, j, k)  
            IF k EQUALS zero  
                IF s at position m and n MINUS s at position i and n MINUS s at position m and j PLUS s at position i and j GREATER THAN zero  
                    RETURN one  
                ELSE  
                    RETURN zero  
                END IF  
            END IF  
  
            SET ans TO zero  
  
            FOR x FROM i PLUS one TO m MINUS one  
                IF s at position x and n MINUS s at position i and n MINUS s at position x and j PLUS s at position i and j GREATER THAN zero  
                    INCREMENT ans BY dfs(x, j, k MINUS one)  
                END IF  
            END FOR  
  
            FOR y FROM j PLUS one TO n MINUS one  
                IF s at position m and y MINUS s at position i and y MINUS s at position m and j PLUS s at position i and j GREATER THAN zero  
                    INCREMENT ans BY dfs(i, y, k MINUS one)  
                END IF  
            END FOR  
  
            RETURN ans MODULO mod  
        END FUNCTION  
  
        RETURN dfs(zero, zero, k MINUS one)  
    END FUNCTION  
  
    FUNCTION initialize_prefix_sum(m, n, pizza)  
        CREATE s AS list of lists with m PLUS one rows and n PLUS one columns FILLED WITH zero  
  
        FOR each i and row IN pizza STARTING FROM one  
            FOR each j and c IN row STARTING FROM one  
                SET s at position i and j TO s at position i MINUS one and j PLUS s at position i and j MINUS one MINUS s at position i MINUS one and j MINUS one PLUS one IF c EQUALS 'A' OTHERWISE zero  
            END FOR  
        END FOR  
  
        RETURN s  
    END FUNCTION  
END CLASS