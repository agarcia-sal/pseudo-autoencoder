CLASS Solution  
    FUNCTION pathsWithMaxScore(board)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF board  
        
        CALL initialize_dp_array WITH n RETURNING dp
        SET element at position n MINUS one of dp AT position n MINUS one TO list containing zero AND one  
        
        FOR i FROM n MINUS one DOWN TO zero  
            FOR j FROM n MINUS one DOWN TO zero  
                IF element at position i of board AT position j IS EQUALS TO 'X' OR IS EQUALS TO 'S'  
                    CONTINUE to next iteration of inner loop  
                END IF  
                
                IF element at position i of board AT position j IS EQUALS TO 'E'  
                    SET value TO zero  
                ELSE  
                    SET value TO integer VALUE OF element at position i of board AT position j  
                END IF  
                
                FOR each pair x, y IN list containing pairs one AND zero, zero AND one, one AND one  
                    SET ni TO i PLUS x  
                    SET nj TO j PLUS y  
                    IF ni IS GREATER THAN OR EQUAL TO zero AND ni IS LESS THAN n AND nj IS GREATER THAN OR EQUAL TO zero AND nj IS LESS THAN n  
                        IF element at position ni of dp AT position nj AT position zero IS GREATER THAN element at position i of dp AT position j AT position zero  
                            SET element at position i of dp AT position j TO list containing element at position ni of dp AT position nj AT position zero PLUS value AND element at position ni of dp AT position nj AT position one  
                        ELSE IF element at position ni of dp AT position nj AT position zero IS EQUALS TO element at position i of dp AT position j AT position zero  
                            SET element at position i of dp AT position j AT position one TO the SUM of element at position i of dp AT position j AT position one AND element at position ni of dp AT position nj AT position one MODULO MOD  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        IF element at position zero of dp AT position zero AT position zero IS EQUALS TO NEGATIVE infinity  
            RETURN list containing zero AND zero  
        END IF  
        
        RETURN list containing element at position zero of dp AT position zero AT position zero AND element at position zero of dp AT position zero AT position one  
    END FUNCTION  
      
    FUNCTION initialize_dp_array(n)  
        SET dp TO empty list  
        FOR i FROM zero TO n MINUS one  
            SET row TO empty list  
            FOR j FROM zero TO n MINUS one  
                APPEND list containing NEGATIVE infinity AND zero TO row  
            END FOR  
            APPEND row TO dp  
        END FOR  
        RETURN dp  
    END FUNCTION  
END CLASS