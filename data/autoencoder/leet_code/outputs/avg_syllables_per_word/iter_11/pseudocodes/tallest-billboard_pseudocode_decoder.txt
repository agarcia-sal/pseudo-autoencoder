CLASS Solution  
    FUNCTION tallestBillboard(rods)  
        SET dp TO a dictionary with a key zero and value zero  
        
        FOR each rod IN rods  
            SET new_dp TO a copy of dp  
            FOR each key d and value y IN dp items  
                SET key_for_taller_support TO d PLUS rod  
                SET current_value_for_taller_support TO the value at key key_for_taller_support in new_dp or zero if it does not exist  
                SET value_for_taller_support TO the maximum of current_value_for_taller_support and y  
                SET new_dp at key key_for_taller_support TO value_for_taller_support  
                
                SET difference TO the absolute value of d MINUS rod  
                SET current_value_for_shorter_support TO the value at key difference in new_dp or zero if it does not exist  
                SET smaller_height TO the minimum of d and rod  
                SET value_for_shorter_support TO the maximum of current_value_for_shorter_support and y PLUS smaller_height  
                SET new_dp at key difference TO value_for_shorter_support  
            END FOR  
            SET dp TO new_dp  
        END FOR  
        
        RETURN the value at key zero in dp  
    END FUNCTION  
END CLASS