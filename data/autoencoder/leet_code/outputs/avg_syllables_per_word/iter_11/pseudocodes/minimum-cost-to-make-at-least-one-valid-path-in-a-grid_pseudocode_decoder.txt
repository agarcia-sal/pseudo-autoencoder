CLASS Solution  
    FUNCTION minCost(grid)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero of grid  
        SET directions TO list of tuples zero AND one, zero AND MINUS one, one AND zero, MINUS one AND zero  
        SET costs TO a list of m elements each being a list of n elements each SET TO infinity  
        SET element at position zero, zero of costs TO zero  
        SET pq TO list containing tuple zero, zero, zero  
        SET visited TO empty set  
        
        WHILE pq is not empty  
            REMOVE element from pq with smallest first element AND ASSIGN to cost, i, j  
            IF pair of i AND j IS IN visited  
                CONTINUE to next iteration  
            END IF  
            ADD pair of i AND j TO visited  
            
            IF i EQUALS m MINUS one AND j EQUALS n MINUS one  
                RETURN cost  
            END IF  
            
            FOR each k, di, dj IN enumeration of directions  
                SET ni TO i PLUS di  
                SET nj TO j PLUS dj  
                IF ni GREATER THAN OR EQUAL TO zero AND ni LESS THAN m AND nj GREATER THAN OR EQUAL TO zero AND nj LESS THAN n  
                    IF k PLUS one NOT EQUALS element at position i, j of grid  
                        SET new_cost TO cost PLUS one  
                    ELSE  
                        SET new_cost TO cost  
                    END IF  
                    IF new_cost LESS THAN element at position ni, nj of costs  
                        SET element at position ni, nj of costs TO new_cost  
                        ADD tuple of new_cost, ni, nj TO pq  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN MINUS one  
    END FUNCTION  
END CLASS