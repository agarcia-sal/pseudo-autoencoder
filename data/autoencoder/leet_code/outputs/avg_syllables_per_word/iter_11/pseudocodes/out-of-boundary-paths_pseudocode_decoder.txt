CLASS Solution  
    FUNCTION findPaths(m, n, maxMove, startRow, startColumn)  
        SET MOD TO one billion PLUS seven  
        
        SET directions TO list containing (zero, one), (zero, negative one), (one, zero), (negative one, zero)  
        
        CALL initialize_dp WITH m, n, maxMove  
        SET dp TO the result of initialize_dp  
        
        FOR k FROM one TO maxMove  
            FOR i FROM zero TO m MINUS one  
                FOR j FROM zero TO n MINUS one  
                    FOR each pair di, dj IN directions  
                        SET ni TO i PLUS di  
                        SET nj TO j PLUS dj  
                        IF ni LESS THAN zero OR ni GREATER THAN OR EQUAL TO m OR nj LESS THAN zero OR nj GREATER THAN OR EQUAL TO n  
                            SET dp at position i, j, k TO dp at position i, j, k PLUS one  
                            SET dp at position i, j, k TO dp at position i, j, k MODULO MOD  
                        ELSE  
                            SET dp at position i, j, k TO dp at position i, j, k PLUS value at dp position ni, nj, k MINUS one  
                            SET dp at position i, j, k TO dp at position i, j, k MODULO MOD  
                        END IF  
                    END FOR  
                END FOR  
            END FOR  
        END FOR  
        
        RETURN value at dp position startRow, startColumn, maxMove  
    END FUNCTION  
    
    FUNCTION initialize_dp(m, n, maxMove)  
        SET result TO new three dimensional list of zeroes with dimensions m by n by maxMove PLUS one  
        RETURN result  
    END FUNCTION  
END CLASS