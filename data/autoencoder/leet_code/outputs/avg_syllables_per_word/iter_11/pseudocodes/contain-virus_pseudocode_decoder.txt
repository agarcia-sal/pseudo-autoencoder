CLASS Solution  
    FUNCTION containVirus(isInfected)  
        FUNCTION neighbors(r, c)  
            RETURN list containing tuple of r PLUS one and c, tuple of r MINUS one and c, tuple of r and c PLUS one, tuple of r and c MINUS one  
        END FUNCTION

        FUNCTION bfs(r, c)  
            SET infected TO empty set  
            SET threatened TO empty set  
            SET queue TO list containing tuple of r and c  
            SET visited TO set containing tuple of r and c  
            WHILE queue is not empty  
                SET x, y TO first element of queue  
                REMOVE first element FROM queue  
                ADD tuple of x and y TO infected  
                FOR each nx, ny IN neighbors(x, y)  
                    IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n AND tuple of nx and ny NOT IN visited  
                        ADD tuple of nx and ny TO visited  
                        IF element at position nx of isInfected AND position ny EQUALS one  
                            APPEND tuple of nx and ny TO queue  
                        ELSE IF element at position nx of isInfected AND position ny EQUALS zero  
                            ADD tuple of nx and ny TO threatened  
                        END IF  
                    END IF  
                END FOR  
            END WHILE  
            RETURN tuple of infected and threatened  
        END FUNCTION

        FUNCTION build_walls(infected)  
            SET walls TO zero  
            FOR each x, y IN infected  
                FOR each nx, ny IN neighbors(x, y)  
                    IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n AND element at position nx of isInfected AND position ny EQUALS zero  
                        INCREMENT walls BY one  
                    END IF  
                END FOR  
            END FOR  
            RETURN walls  
        END FUNCTION

        FUNCTION spread_virus(threatened)  
            FOR each x, y IN threatened  
                SET element at position x of isInfected AND position y TO one  
            END FOR  
        END FUNCTION

        SET m TO LENGTH OF isInfected  
        SET n TO LENGTH OF element at position zero of isInfected  
        SET total_walls TO zero

        WHILE true  
            SET regions TO empty list  
            SET visited TO empty set  
            FOR r FROM zero TO m MINUS one  
                FOR c FROM zero TO n MINUS one  
                    IF element at position r of isInfected AND position c EQUALS one AND tuple of r and c NOT IN visited  
                        SET infected, threatened TO RESULT OF bfs(r, c)  
                        APPEND tuple of infected and threatened TO regions  
                        SET visited TO UNION OF visited AND infected  
                    END IF  
                END FOR  
            END FOR

            IF LENGTH OF regions EQUALS zero  
                BREAK  
            END IF

            SORT regions IN DESCENDING ORDER BY LENGTH OF second element of each item in regions  

            SET total_walls TO total_walls PLUS RESULT OF build_walls(first element of first tuple in regions)  
            FOR each x, y IN first element of first tuple in regions  
                SET element at position x of isInfected AND position y TO minus one  
            END FOR

            FOR i FROM one TO LENGTH OF regions MINUS one  
                CALL spread_virus(second element of tuple at position i of regions)  
            END FOR  
        END WHILE

        RETURN total_walls  
    END FUNCTION  
END CLASS