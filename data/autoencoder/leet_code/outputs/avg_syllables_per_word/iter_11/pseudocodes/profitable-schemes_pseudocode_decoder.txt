CLASS Solution  
    FUNCTION profitableSchemes(n, minProfit, group, profit)  
        SET MOD TO one billion PLUS seven  
        SET dp TO a list with length n PLUS one where each element is a list with length minProfit PLUS one filled with zero  
        FOR i FROM zero TO n  
            SET element at position zero of element at position i of dp TO one  
        END FOR  
        FOR each pair of elements p and g IN profit and group zipped together  
            FOR i FROM n DOWN TO g  
                FOR j FROM minProfit DOWN TO zero  
                    SET element at position j of element at position i of dp TO the sum of element at position j of element at position i of dp AND element at position maximum of zero AND j MINUS p of element at position i MINUS g of dp  
                    SET element at position j of element at position i of dp TO element at position j of element at position i of dp MODULO MOD  
                END FOR  
            END FOR  
        END FOR  
        RETURN element at position minProfit of element at position n of dp  
    END FUNCTION  
END CLASS