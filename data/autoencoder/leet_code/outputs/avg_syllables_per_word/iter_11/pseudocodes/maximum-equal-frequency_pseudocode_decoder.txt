CLASS Solution  
    FUNCTION maxEqualFreq(nums)  
        SET count TO empty mapping from number to integer  
        SET freq TO empty mapping from integer to integer  
        SET max_len TO zero  
        
        FOR each index i, element num IN nums with index  
            INCREMENT the value of count at key num BY one  
            
            IF the value of count at key num IS GREATER THAN one  
                DECREMENT the value of freq at key the value of count at key num MINUS one BY one  
                IF the value of freq at key the value of count at key num MINUS one EQUALS zero  
                    REMOVE the key the value of count at key num MINUS one FROM freq  
                END IF  
            END IF  
            
            INCREMENT the value of freq at key the value of count at key num BY one  
            
            IF the number of keys in freq EQUALS one AND (freq HAS key one OR the only value in freq EQUALS one)  
                SET max_len TO i PLUS one  
            ELSE IF the number of keys in freq EQUALS two AND ((freq HAS key one AND the value of freq at key one EQUALS one) OR (the difference BETWEEN the maximum key in freq AND the minimum key in freq EQUALS one AND the value of freq at the maximum key EQUALS one))  
                SET max_len TO i PLUS one  
            END IF  
        END FOR  
        
        RETURN max_len  
    END FUNCTION  
END CLASS