CLASS Solution  
    FUNCTION numberOfCombinations(num)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF num  
        INITIALIZE memo AS empty dictionary  
  
        FUNCTION dp(index, prev_len)  
            IF index EQUALS n  
                RETURN one  
            END IF  
  
            IF the TUPLE of index AND prev_len IS IN memo  
                RETURN the ELEMENT at the TUPLE of index AND prev_len IN memo  
            END IF  
  
            SET count TO zero  
            FOR length FROM one TO n MINUS index  
                IF the CHARACTER at position index of num EQUALS zero AS character  
                    BREAK  
                END IF  
  
                SET current_num TO the SUBSTRING of num FROM position index TO position index PLUS length  
  
                IF prev_len EQUALS zero OR current_num IS GREATER THAN OR EQUAL TO the SUBSTRING of num FROM position index MINUS prev_len TO position index  
                    SET count TO count PLUS the RESULT OF dp WITH index PLUS length AND length  
                    SET count TO count MODULO MOD  
                END IF  
            END FOR  
  
            SET the ELEMENT at the TUPLE of index AND prev_len IN memo TO count  
            RETURN count  
        END FUNCTION  
  
        RETURN the RESULT OF dp WITH zero AND zero  
    END FUNCTION  
END CLASS