CLASS Solution  
    FUNCTION parseBoolExpr(expression)  
        SET stk TO empty list  
        FOR each c IN expression  
            IF c EQUALS t OR c EQUALS f OR c EQUALS exclamation mark OR c EQUALS ampersand OR c EQUALS vertical bar  
                APPEND c TO stk  
            ELSE IF c EQUALS closing parenthesis  
                SET t TO zero  
                SET f TO zero  
                WHILE element at last position of stk EQUALS t OR element at last position of stk EQUALS f  
                    IF element at last position of stk EQUALS t  
                        INCREMENT t BY one  
                    END IF  
                    IF element at last position of stk EQUALS f  
                        INCREMENT f BY one  
                    END IF  
                    REMOVE last element FROM stk  
                END WHILE  
                SET op TO element at last position of stk  
                REMOVE last element FROM stk  
                IF op EQUALS exclamation mark  
                    IF f GREATER THAN zero  
                        SET c TO t  
                    ELSE  
                        SET c TO f  
                    END IF  
                ELSE IF op EQUALS ampersand  
                    IF f GREATER THAN zero  
                        SET c TO f  
                    ELSE  
                        SET c TO t  
                    END IF  
                ELSE IF op EQUALS vertical bar  
                    IF t GREATER THAN zero  
                        SET c TO t  
                    ELSE  
                        SET c TO f  
                    END IF  
                END IF  
                APPEND c TO stk  
            END IF  
        END FOR  
        RETURN element at position zero of stk EQUALS t  
    END FUNCTION  
END CLASS