CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MOD TO ten raised to the power of nine plus one  
        SORT arr IN ascending order  
        SET dp TO a mapping FROM each number IN arr TO one  
        FOR index i FROM zero TO the length of arr MINUS one  
            SET num TO element at position i OF arr  
            FOR index j FROM zero TO i MINUS one  
                SET factor_candidate TO element at position j OF arr  
                IF num MODULO factor_candidate EQUALS zero  
                    SET right_child TO num DIVIDED BY factor_candidate  
                    IF right_child IS IN dp  
                        SET dp[num] TO dp[num] PLUS dp[factor_candidate] MULTIPLIED BY dp[right_child]  
                        SET dp[num] TO dp[num] MODULO MOD  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        SET total_trees TO the SUM OF all VALUES IN dp  
        SET result TO total_trees MODULO MOD  
        RETURN result  
    END FUNCTION  
END CLASS