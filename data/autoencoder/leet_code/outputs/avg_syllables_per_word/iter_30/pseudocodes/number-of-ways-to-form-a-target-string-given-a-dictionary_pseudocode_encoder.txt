CLASS Solution  
    FUNCTION numWays(words, target)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF the element at position zero OF words  
        SET m TO the LENGTH OF target  
        SET freq TO a list of dictionaries mapping characters to integers FOR each position FROM zero TO n MINUS one  
        FOR each word IN words  
            FOR index j FROM zero TO the LENGTH OF word MINUS one  
                INCREMENT the count of the character at position j OF word IN freq at position j BY one  
            END FOR  
        END FOR  
        SET dp TO a two dimensional list OF zeroes WITH m PLUS one rows AND n PLUS one columns  
        FOR index j FROM zero TO n  
            SET the element at row zero AND column j OF dp TO one  
        END FOR  
        FOR index i FROM one TO m  
            FOR index j FROM one TO n  
                SET the element at row i AND column j OF dp TO the element at row i AND column j MINUS one OF dp  
                IF the frequency of the character at position i MINUS one OF target IN freq at position j MINUS one IS GREATER THAN zero  
                    INCREMENT the element at row i AND column j OF dp BY the product OF the element at row i MINUS one AND column j MINUS one OF dp AND the frequency of the character at position i MINUS one OF target IN freq at position j MINUS one  
                    SET the element at row i AND column j OF dp TO the element at row i AND column j OF dp MODULO MOD  
                END IF  
            END FOR  
        END FOR  
        RETURN the element at row m AND column n OF dp  
    END FUNCTION  
END CLASS