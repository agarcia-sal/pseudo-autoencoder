CLASS Solution  
    FUNCTION minOperationsToFlip(expression)  
        ASSIGN reference TO an empty collection named stack  
        
        FOR each element e IN expression  
            IF e EQUALS open parenthesis OR e EQUALS ampersand OR e EQUALS vertical bar  
                APPEND a pair consisting of e AND zero TO stack  
                CONTINUE to next iteration  
            END IF  
            
            IF e EQUALS close parenthesis  
                SET lastPair TO the last element removed FROM stack  
                REMOVE the last element FROM stack  
            ELSE  
                SET lastPair TO a pair consisting of e AND one  
            END IF  
            
            IF stack is not empty AND the first element of the last element OF stack EQUALS ampersand OR vertical bar  
                SET op TO the first element removed FROM stack  
                SET a TO the first element of the pair removed FROM stack  
                SET costA TO the second element of the pair removed FROM stack  
                SET b TO the first element of lastPair  
                SET costB TO the second element of lastPair  
                
                IF op EQUALS ampersand  
                    IF a EQUALS zero AND b EQUALS zero  
                        SET lastPair TO a pair consisting of zero AND one PLUS the minimum OF costA AND costB  
                    ELSE IF a EQUALS zero AND b EQUALS one  
                        SET lastPair TO a pair consisting of zero AND one  
                    ELSE IF a EQUALS one AND b EQUALS zero  
                        SET lastPair TO a pair consisting of zero AND one  
                    ELSE  
                        SET lastPair TO a pair consisting of one AND the minimum OF costA AND costB  
                    END IF  
                ELSE  
                    IF a EQUALS zero AND b EQUALS zero  
                        SET lastPair TO a pair consisting of zero AND the minimum OF costA AND costB  
                    ELSE IF a EQUALS zero AND b EQUALS one  
                        SET lastPair TO a pair consisting of one AND one  
                    ELSE IF a EQUALS one AND b EQUALS zero  
                        SET lastPair TO a pair consisting of one AND one  
                    ELSE  
                        SET lastPair TO a pair consisting of one AND one PLUS the minimum OF costA AND costB  
                    END IF  
                END IF  
            END IF  
            
            APPEND lastPair TO stack  
        END FOR  
        
        RETURN the second element of the last element OF stack  
    END FUNCTION  
END CLASS