CLASS Solution  
    FUNCTION braceExpansionII(expression)  
        FUNCTION parse_expression(index)  
            SET current_set TO empty set  
            SET current_product TO list containing empty string  
            WHILE index LESS THAN the LENGTH OF expression  
                SET char TO element at position index OF expression  
                IF char EQUALS left curly brace  
                    SET inner_set AND index TO parse_expression index PLUS one  
                    SET current_product TO list of concatenation of each element a in current_product PLUS each element b in inner_set  
                ELSE IF char EQUALS right curly brace  
                    ADD all elements formed by joining each element of current_product AS a string TO current_set  
                    RETURN current_set AND index  
                ELSE IF char EQUALS comma  
                    ADD all elements formed by joining each element of current_product AS a string TO current_set  
                    SET current_product TO list containing empty string  
                ELSE  
                    SET current_product TO list of concatenation of each element a in current_product PLUS char  
                END IF  
                INCREMENT index BY one  
            END WHILE  
            ADD all elements formed by joining each element of current_product AS a string TO current_set  
            RETURN current_set AND index  
        END FUNCTION  
        SET result_set AND unused TO parse_expression zero  
        RETURN sorted list of result_set  
    END FUNCTION  
END CLASS