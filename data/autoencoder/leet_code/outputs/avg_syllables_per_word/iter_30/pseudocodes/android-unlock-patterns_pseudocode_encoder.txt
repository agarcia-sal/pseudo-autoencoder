CLASS Solution  
    FUNCTION numberOfPatterns(m, n)  
        SET jumps TO mapping of pairs of dots TO intermediate dot as follows  
            pair one three TO two  
            pair one seven TO four  
            pair one nine TO five  
            pair two eight TO five  
            pair three one TO two  
            pair three seven TO five  
            pair three nine TO six  
            pair four six TO five  
            pair five five TO five  
            pair six four TO five  
            pair seven one TO four  
            pair seven three TO five  
            pair seven nine TO eight  
            pair eight two TO five  
            pair nine one TO five  
            pair nine three TO six  
            pair nine seven TO eight  
        
        FUNCTION countPatternsFromDot(current, visited, length)  
            IF length EQUALS n THEN  
                RETURN one  
            END IF  
            SET count TO one IF length GREATER THAN OR EQUAL TO m ELSE zero  
            FOR next_dot FROM one TO nine  
                IF visited at position next_dot IS false THEN  
                    SET jump TO the value in jumps for pair current next_dot  
                    IF jump IS not present OR visited at position jump IS true THEN  
                        SET visited at position next_dot TO true  
                        INCREMENT count BY countPatternsFromDot(next_dot, visited, length PLUS one)  
                        SET visited at position next_dot TO false  
                    END IF  
                END IF  
            END FOR  
            RETURN count  
        END FUNCTION  
        
        SET visited TO list of boolean false values of length ten  
        SET result TO zero  
        FOR i FROM one TO nine  
            SET visited at position i TO true  
            INCREMENT result BY countPatternsFromDot(i, visited, one)  
            SET visited at position i TO false  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS