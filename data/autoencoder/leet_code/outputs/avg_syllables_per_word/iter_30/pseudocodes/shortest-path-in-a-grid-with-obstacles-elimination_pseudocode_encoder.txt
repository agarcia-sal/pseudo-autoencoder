CLASS Solution  
    FUNCTION shortestPath(grid, k)  
        IF grid EQUALS nothing OR element at position zero OF grid EQUALS nothing  
            RETURN negative one  
        END IF  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero OF grid  
        IF k GREATER THAN OR EQUAL TO m PLUS n MINUS two  
            RETURN m PLUS n MINUS two  
        END IF  
        SET directions TO a collection of pairs of zero and one, one and zero, zero and negative one, negative one and zero  
        INITIALIZE queue AS a deque containing a tuple of zero, zero, k, zero  
        INITIALIZE visited AS a set containing a tuple of zero, zero, k  
        WHILE queue is not empty  
            REMOVE the element from the front of queue AND UNPACK INTO x, y, remaining_k, steps  
            IF x EQUALS m MINUS one AND y EQUALS n MINUS one  
                RETURN steps  
            END IF  
            FOR each pair dx, dy IN directions  
                SET nx TO x PLUS dx  
                SET ny TO y PLUS dy  
                IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n  
                    SET new_k TO remaining_k MINUS element at position nx OF element at position ny OF grid  
                    IF new_k GREATER THAN OR EQUAL TO zero AND tuple of nx, ny, new_k NOT IN visited  
                        ADD tuple of nx, ny, new_k TO visited  
                        APPEND tuple of nx, ny, new_k, steps PLUS one TO queue  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        RETURN negative one  
    END FUNCTION  
END CLASS