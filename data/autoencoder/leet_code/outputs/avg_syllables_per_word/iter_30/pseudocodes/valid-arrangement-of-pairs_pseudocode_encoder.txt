CLASS Solution  
    FUNCTION validArrangement(pairs)  
        SET graph TO empty mapping from keys to empty lists  
        SET out_degree TO empty mapping with default zero  
        SET in_degree TO empty mapping with default zero  
        FOR each element pair WITH elements u and v IN pairs  
            APPEND v TO the list at key u of graph  
            INCREMENT the value at key u of out_degree BY one  
            INCREMENT the value at key v of in_degree BY one  
        END FOR  
        SET start_node TO none  
        FOR each node IN keys of graph  
            IF the value at key node of out_degree EQUALS the value at key node of in_degree PLUS one  
                SET start_node TO node  
                BREAK  
            END IF  
        END FOR  
        IF start_node IS none  
            SET start_node TO the first key in graph  
        END IF  
        SET path TO empty list  
        SET stack TO list containing start_node  
        WHILE stack is not empty  
            SET u TO last element of stack  
            IF the list at key u of graph is not empty  
                SET v TO the last element of the list at key u of graph  
                REMOVE the last element from the list at key u of graph  
                APPEND v TO stack  
            ELSE  
                APPEND the last element of stack TO path  
                REMOVE the last element from stack  
            END IF  
        END WHILE  
        REVERSE the order of elements in path  
        SET result TO empty list  
        FOR index FROM zero TO the length of path MINUS one  
            IF index is less than the length of path MINUS one  
                APPEND list containing element at position index of path and element at position index PLUS one of path TO result  
            END IF  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS