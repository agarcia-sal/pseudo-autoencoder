CLASS Solution  
    FUNCTION constrainedSubsetSum(nums, k)  
        SET n TO the LENGTH OF nums  
        SET dp TO a list of zeroes of length n  
        SET dp at position zero TO element at position zero OF nums  
        SET max_sum TO element at position zero OF nums  
        ASSIGN reference TO a new empty double ended queue q  
        APPEND zero TO q  
        FOR i FROM one TO n MINUS one  
            IF dp at position at front element of q is GREATER THAN zero  
                SET dp at position i TO element at position i OF nums PLUS dp at position at front element of q  
            ELSE  
                SET dp at position i TO element at position i OF nums  
            END IF  
            IF dp at position i is GREATER THAN max_sum  
                SET max_sum TO dp at position i  
            END IF  
            WHILE q is NOT empty AND dp at position i is GREATER THAN OR EQUAL TO dp at position at last element of q  
                REMOVE last element FROM q  
            END WHILE  
            APPEND i TO q  
            IF element at position zero OF q EQUALS i MINUS k  
                REMOVE first element FROM q  
            END IF  
        END FOR  
        RETURN max_sum  
    END FUNCTION  
END CLASS