CLASS Solution  
    FUNCTION maximizeXor(nums, queries)  
        SORT nums IN ascending order  
        SET sorted_queries TO enumeration of queries SORTED BY second element of each query  
        SET result TO list of negative one REPEATED the LENGTH OF queries times  
        SET trie TO empty collection  
        SET num_index TO zero  
        FOR each query_index, pair OF sorted_queries  
            SET xi TO first element of pair  
            SET mi TO second element of pair  
            WHILE num_index LESS THAN the LENGTH OF nums AND element at position num_index OF nums LESS THAN OR EQUAL TO mi  
                SET num TO element at position num_index OF nums  
                SET node TO trie  
                FOR i FROM thirty one DOWN TO zero  
                    SET bit TO integer division of num BY two RAISED TO THE power i MODULO two  
                    IF bit NOT IN node  
                        ASSIGN reference at bit IN node TO empty collection  
                    END IF  
                    ASSIGN node TO reference at bit IN node  
                END FOR  
                INCREMENT num_index BY one  
            END WHILE  
            IF trie IS empty  
                CONTINUE  
            END IF  
            SET node TO trie  
            SET max_xor TO zero  
            FOR i FROM thirty one DOWN TO zero  
                SET bit TO integer division of xi BY two RAISED TO THE power i MODULO two  
                SET toggle_bit TO one MINUS bit  
                IF toggle_bit IN node  
                    SET max_xor TO max_xor PLUS two RAISED TO THE power i  
                    ASSIGN node TO reference at toggle_bit IN node  
                ELSE  
                    ASSIGN node TO reference at bit IN node  
                END IF  
            END FOR  
            SET element at position query_index OF result TO max_xor  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS