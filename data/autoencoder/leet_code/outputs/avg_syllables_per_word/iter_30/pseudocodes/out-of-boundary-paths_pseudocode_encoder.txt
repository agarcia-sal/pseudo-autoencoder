CLASS Solution  
    FUNCTION findPaths(m, n, maxMove, startRow, startColumn)  
        SET MODULO constant TO ten raised to the power of nine PLUS one  
        SET directions TO list of pairs zero comma one; zero comma negative one; one comma zero; negative one comma zero  
        SET dp TO three dimensional list of zeroes of size m by n by maxMove PLUS one  
        FOR each k FROM one TO maxMove  
            FOR each i FROM zero TO m MINUS one  
                FOR each j FROM zero TO n MINUS one  
                    FOR each pair di comma dj IN directions  
                        SET ni TO i PLUS di  
                        SET nj TO j PLUS dj  
                        IF ni LESS THAN zero OR ni GREATER THAN OR EQUAL TO m OR nj LESS THAN zero OR nj GREATER THAN OR EQUAL TO n  
                            SET dp at position i comma j comma k TO dp at position i comma j comma k PLUS one MODULO MODULO constant  
                        ELSE  
                            SET dp at position i comma j comma k TO dp at position i comma j comma k PLUS dp at position ni comma nj comma k MINUS one MODULO MODULO constant  
                        END IF  
                    END FOR  
                END FOR  
            END FOR  
        END FOR  
        RETURN dp at position startRow comma startColumn comma maxMove  
    END FUNCTION  
END CLASS