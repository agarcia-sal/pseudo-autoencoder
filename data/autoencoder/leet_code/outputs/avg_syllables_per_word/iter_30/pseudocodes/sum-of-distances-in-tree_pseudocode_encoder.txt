CLASS Solution  
    FUNCTION sumOfDistancesInTree(n, edges)  
        ASSIGN reference TO a new default dictionary of lists called graph  
        FOR each pair of elements a and b IN edges  
            APPEND element b TO the list at key a OF graph  
            APPEND element a TO the list at key b OF graph  
        END FOR  

        SET count TO a list of length n with all values set to one  
        SET dist TO a list of length n with all values set to zero  

        FUNCTION dfs1(u, p)  
            FOR each element v IN the list at key u OF graph  
                IF v NOT EQUALS p THEN  
                    CALL dfs1 with arguments v and u  
                    INCREMENT count at position u BY count at position v  
                    INCREMENT dist at position u BY dist at position v PLUS count at position v  
                END IF  
            END FOR  
        END FUNCTION  

        CALL dfs1 with arguments zero and negative one  

        FUNCTION dfs2(u, p)  
            FOR each element v IN the list at key u OF graph  
                IF v NOT EQUALS p THEN  
                    SET dist at position v TO dist at position u MINUS count at position v PLUS n MINUS count at position v  
                    CALL dfs2 with arguments v and u  
                END IF  
            END FOR  
        END FUNCTION  

        CALL dfs2 with arguments zero and negative one  

        RETURN dist  
    END FUNCTION  
END CLASS