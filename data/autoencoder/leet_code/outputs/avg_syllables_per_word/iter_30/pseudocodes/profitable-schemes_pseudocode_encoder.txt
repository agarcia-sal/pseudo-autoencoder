CLASS Solution  
    FUNCTION profitableSchemes(n, minProfit, group, profit)  
        SET MODULO TO ten raised to the power of nine PLUS one  
        SET dp TO a two dimensional list of zero with the length of n PLUS one rows and minProfit PLUS one columns  
        FOR i FROM zero TO n  
            SET element at position zero OF dp at position i TO one  
        END FOR  
        FOR each element p WITH corresponding element g IN profit WITH group  
            FOR i FROM n DOWN TO g  
                FOR j FROM minProfit DOWN TO zero  
                    SET element at position j OF dp at position i TO the sum of element at position j OF dp at position i AND element at position maximum of zero AND the difference of j MINUS p OF dp at position i MINUS g taken modulo MODULO  
                END FOR  
            END FOR  
        END FOR  
        RETURN element at position minProfit OF dp at position n  
    END FUNCTION  
END CLASS