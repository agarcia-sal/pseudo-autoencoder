CLASS Solution  
    FUNCTION maximumBeauty(flowers)  
        DEFINE indices AS a dictionary with default value as empty list  
        SET prefix_sum TO a list with LENGTH of flowers PLUS one with all elements zero  
        FOR i FROM zero TO the LENGTH OF flowers MINUS one  
            SET element at position i PLUS one OF prefix_sum TO element at position i OF prefix_sum PLUS the GREATER OF element at position i OF flowers AND zero  
            APPEND i TO indices at key element at position i OF flowers  
        END FOR  
        SET max_beauty TO negative infinity  
        FOR each beauty IN keys of indices  
            IF LENGTH OF indices at key beauty IS GREATER THAN OR EQUAL TO two  
                SET first TO element at position zero OF indices at key beauty  
                SET last TO element at position LENGTH OF indices at key beauty MINUS one OF indices at key beauty  
                SET current_beauty TO two MULTIPLIED BY beauty PLUS the difference BETWEEN element at position last OF prefix_sum AND element at position first PLUS one OF prefix_sum  
                IF current_beauty IS GREATER THAN max_beauty  
                    SET max_beauty TO current_beauty  
                END IF  
            END IF  
        END FOR  
        RETURN max_beauty  
    END FUNCTION  
END CLASS