CLASS Solution  
    FUNCTION pathsWithMaxScore(board)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF board  
        SET dp TO a two dimensional array of size n BY n where each element is a pair of negative infinity AND zero  
        SET the element at position n MINUS one, n MINUS one OF dp TO zero AND one  
        FOR i FROM n MINUS one DOWN TO zero  
            FOR j FROM n MINUS one DOWN TO zero  
                IF the element at position i OF board at position j EQUALS 'X' OR EQUALS 'S'  
                    CONTINUE  
                END IF  
                IF the element at position i OF board at position j NOT EQUALS 'E'  
                    SET value TO the integer conversion of the element at position i OF board at position j  
                ELSE  
                    SET value TO zero  
                END IF  
                FOR each pair x AND y IN the list containing one and zero, zero and one, one and one  
                    SET ni TO i PLUS x  
                    SET nj TO j PLUS y  
                    IF ni GREATER THAN OR EQUAL TO zero AND LESS THAN n AND nj GREATER THAN OR EQUAL TO zero AND LESS THAN n  
                        IF the first element of dp at position ni, nj GREATER THAN the first element of dp at position i, j  
                            SET the element at position i, j OF dp TO the first element of dp at position ni, nj PLUS value AND the second element of dp at position ni, nj  
                        ELSE IF the first element of dp at position ni, nj EQUALS the first element of dp at position i, j  
                            SET the second element of dp at position i, j TO the sum of the second element of dp at position i, j AND the second element of dp at position ni, nj MODULO MOD  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        IF the first element of dp at position zero, zero EQUALS negative infinity  
            RETURN a list containing zero AND zero  
        END IF  
        RETURN a list containing the first element of dp at position zero, zero AND the second element of dp at position zero, zero  
    END FUNCTION  
END CLASS