CLASS Solution  
    FUNCTION solve(nums, queries)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF nums  
        SET max_y TO the maximum value of the second element in each pair of queries  
        SET prefix_sums TO a collection of collections with max_y PLUS one rows and n columns filled with zero  
        FOR y FROM one TO max_y  
            FOR i FROM n MINUS one DOWNTO zero  
                IF i PLUS y LESS THAN n  
                    SET the element at position i OF the collection at position y OF prefix_sums TO the element at position i OF nums PLUS the element at position i PLUS y OF the collection at position y OF prefix_sums  
                ELSE  
                    SET the element at position i OF the collection at position y OF prefix_sums TO the element at position i OF nums  
                END IF  
            END FOR  
        END FOR  
        SET answer TO an empty collection  
        FOR each pair (x, y) IN queries  
            APPEND the element at position x OF the collection at position y OF prefix_sums modulo MOD TO answer  
        END FOR  
        RETURN answer  
    END FUNCTION  
END CLASS