CLASS Solution  
    FUNCTION numberOfCombinations(num)  
        SET MOD TO ten RAISED TO the power of nine PLUS one  
        SET n TO the LENGTH OF num  
        ASSIGN reference TO an EMPTY COLLECTION memo  
        
        FUNCTION dp(index, prev_len)  
            IF index EQUALS n  
                RETURN one  
            END IF  
            IF memo CONTAINS the key composed of index AND prev_len  
                RETURN the value AT key composed of index AND prev_len IN memo  
            END IF  
            
            SET count TO zero  
            FOR each length FROM one TO n MINUS index  
                IF character at position index OF num EQUALS zero  
                    BREAK  
                END IF  
                
                DEFINE current_num AS the substring from position index TO position index PLUS length OF num  
                
                IF prev_len EQUALS zero OR current_num IS GREATER THAN OR EQUAL TO the substring from position index MINUS prev_len TO position index OF num  
                    SET count TO count PLUS dp(index PLUS length, length) MODULO MOD  
                END IF  
            END FOR  
            
            SET memo AT key composed of index AND prev_len TO count  
            RETURN count  
        END FUNCTION  
        
        RETURN dp(zero, zero)  
    END FUNCTION  
END CLASS