CLASS Solution  
    FUNCTION maxNumOfSubstrings WITH PARAMETER s  
        SET first TO empty mapping  
        SET last TO empty mapping  
        FOR each index and character IN s with index enumeration  
            IF character is NOT IN first  
                SET first at character TO index  
            END IF  
            SET last at character TO index  
        END FOR  
        SET intervals TO empty list  
        FOR each character IN first keys  
            SET start TO first at character  
            SET end TO last at character  
            SET i TO start  
            WHILE i LESS THAN OR EQUAL TO end  
                IF first at character at position i OF s LESS THAN start  
                    BREAK  
                END IF  
                SET end TO the GREATER value BETWEEN end AND last at character at position i OF s  
                INCREMENT i BY one  
            END WHILE  
            IF i GREATER THAN end  
                APPEND tuple of start and end TO intervals  
            END IF  
        END FOR  
        SORT intervals BY the SECOND element OF each tuple  
        SET result TO empty list  
        SET prev_end TO minus one  
        FOR each tuple of start and end IN intervals  
            IF start GREATER THAN prev_end  
                APPEND substring from position start TO position end OF s TO result  
                SET prev_end TO end  
            END IF  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS