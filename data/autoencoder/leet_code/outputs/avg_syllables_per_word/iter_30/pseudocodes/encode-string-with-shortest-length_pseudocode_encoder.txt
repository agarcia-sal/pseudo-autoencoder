CLASS Solution  
    FUNCTION encode(s)  
        FUNCTION get_encoded_length(count, substring)  
            SET length_of_count TO the LENGTH OF the string representation of count  
            SET length_of_substring TO the LENGTH OF substring  
            RETURN length_of_count PLUS length_of_substring PLUS two  
        END FUNCTION

        FUNCTION dp(i, j)  
            SET substring TO the substring from position i TO position j OF s  
            SET n TO j MINUS i PLUS one  
            IF n LESS THAN five  
                RETURN substring  
            END IF
            
            SET shortest TO substring  
            
            FOR k FROM one TO the INTEGER DIVISION OF n BY two PLUS one  
                IF n MODULO k EQUALS zero  
                    SET repeat_count TO the INTEGER DIVISION OF n BY k  
                    IF substring EQUALS the substring from position zero TO position k MINUS one MULTIPLIED BY repeat_count  
                        SET encoded_candidate TO the string representation of repeat_count CONCATENATED WITH the bracketed result of dp called with arguments i AND i PLUS k MINUS one  
                        IF the LENGTH OF encoded_candidate LESS THAN the LENGTH OF shortest  
                            SET shortest TO encoded_candidate  
                        END IF  
                    END IF  
                END IF  
            END FOR
            
            FOR k FROM i TO j MINUS one  
                SET left_encoded TO dp called with arguments i AND k  
                SET right_encoded TO dp called with arguments k PLUS one AND j  
                SET combined TO left_encoded CONCATENATED WITH right_encoded  
                IF the LENGTH OF combined LESS THAN the LENGTH OF shortest  
                    SET shortest TO combined  
                END IF  
            END FOR  
            
            RETURN shortest  
        END FUNCTION
        
        RETURN dp called with arguments zero AND the LENGTH OF s MINUS one  
    END FUNCTION  
END CLASS