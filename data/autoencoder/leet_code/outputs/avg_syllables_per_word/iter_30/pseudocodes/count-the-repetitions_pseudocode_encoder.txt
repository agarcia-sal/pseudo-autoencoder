CLASS Solution  
    FUNCTION getMaxRepetitions(s1, n1, s2, n2)  
        IF n1 EQUALS zero  
            RETURN zero  
        END IF

        SET list s2_count TO a new list of zero repeated for the LENGTH OF s2 PLUS one  
        SET list index_map TO a new list of zero repeated for the LENGTH OF s2 PLUS one  

        SET current_index_s2 TO zero  
        SET s1_count TO zero  

        WHILE s1_count LESS THAN n1  
            INCREMENT s1_count BY one  
            FOR each character char IN s1  
                IF char EQUALS character at position current_index_s2 OF s2  
                    INCREMENT current_index_s2 BY one  
                    IF current_index_s2 EQUALS the LENGTH OF s2  
                        SET element at position s1_count OF s2_count TO element at position s1_count MINUS one OF s2_count PLUS one  
                        SET current_index_s2 TO zero  
                    END IF
                END IF
                SET element at position s1_count OF index_map TO current_index_s2  
            END FOR

            IF current_index_s2 IS IN the SUBLIST of index_map FROM zero TO s1_count MINUS one  
                SET start TO the position of current_index_s2 IN index_map  
                SET cycle_length TO s1_count MINUS start  
                SET cycles_fit TO the INTEGER DIVISION of the DIFFERENCE of n1 MINUS start BY cycle_length  
                SET remainder TO the MODULO of the DIFFERENCE of n1 MINUS start BY cycle_length  
                SET total_s2_count TO element at position start OF s2_count PLUS cycles_fit MULTIPLIED BY the DIFFERENCE of element at position start PLUS cycle_length OF s2_count MINUS element at position start OF s2_count PLUS element at position start PLUS remainder OF s2_count MINUS element at position start OF s2_count  
                RETURN the INTEGER DIVISION of total_s2_count BY n2  
            END IF
        END WHILE

        RETURN the INTEGER DIVISION of element at position s1_count OF s2_count BY n2  
    END FUNCTION  
END CLASS