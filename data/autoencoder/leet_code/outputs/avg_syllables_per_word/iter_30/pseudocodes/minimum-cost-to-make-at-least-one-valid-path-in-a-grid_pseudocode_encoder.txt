CLASS Solution  
    FUNCTION minCost(grid)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero OF grid  
        SET directions TO the LIST of pairs consisting of zero and one, zero and negative one, one and zero, negative one and zero  
        SET costs TO a LIST of m elements each being a LIST of n elements each set to positive infinity  
        SET element at position zero zero OF costs TO zero  
        SET pq TO a LIST containing a single tuple of zero zero zero  
        SET visited TO an empty SET  
        
        WHILE pq is not empty  
            SET cost i j TO the result of removing and returning the smallest element from pq  
            
            IF the pair of i and j is in visited  
                CONTINUE  
            END IF  
            ADD the pair of i and j TO visited  
            
            IF i EQUALS m MINUS one AND j EQUALS n MINUS one  
                RETURN cost  
            END IF  
            
            FOR k FROM zero TO the LENGTH OF directions MINUS one  
                SET di dj TO element at position k OF directions  
                SET ni TO i PLUS di  
                SET nj TO j PLUS dj  
                IF ni GREATER THAN OR EQUAL TO zero AND ni LESS THAN m AND nj GREATER THAN OR EQUAL TO zero AND nj LESS THAN n  
                    IF k PLUS one NOT EQUALS element at position i j OF grid  
                        SET increment_cost TO one  
                    ELSE  
                        SET increment_cost TO zero  
                    END IF  
                    SET new_cost TO cost PLUS increment_cost  
                    IF new_cost LESS THAN element at position ni nj OF costs  
                        SET element at position ni nj OF costs TO new_cost  
                        ADD the tuple of new_cost ni nj TO pq  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN negative one  
    END FUNCTION  
END CLASS