CLASS Solution  
    FUNCTION leastBricks WITH PARAMETERS wall AS list of lists of integers  
        SET gap_counts TO a new default dictionary with default integer zero  
        
        FOR each row IN wall  
            SET total TO zero  
            FOR each brick EXCEPT the last element IN row  
                INCREMENT total BY brick  
                INCREMENT the element at position total in gap_counts BY one  
            END FOR  
        END FOR  
        
        SET max_gaps TO the maximum value among all elements in gap_counts WITH default zero if empty  
        
        SET result TO the length of wall MINUS max_gaps  
        RETURN result  
    END FUNCTION  
END CLASS