CLASS Solution  
    FUNCTION maxSubArrayLen(nums AS List OF integers, k AS integer)  
        SET cumulative_sum_index TO a data structure mapping zero TO negative one representing the first occurrence index of cumulative sums  
        SET cumulative_sum TO zero  
        SET max_length TO zero  
        
        FOR each index i AND each number num IN nums with their position  
            INCREMENT cumulative_sum BY num  
            
            IF the value of cumulative_sum MINUS k EXISTS as a key in cumulative_sum_index  
                SET max_length TO the greater value BETWEEN max_length AND the difference BETWEEN i AND the value at key cumulative_sum MINUS k IN cumulative_sum_index  
            END IF  
            
            IF cumulative_sum DOES NOT EXIST as a key in cumulative_sum_index  
                ASSIGN key cumulative_sum TO value i IN cumulative_sum_index  
            END IF  
        END FOR  
        
        RETURN max_length  
    END FUNCTION  
END CLASS