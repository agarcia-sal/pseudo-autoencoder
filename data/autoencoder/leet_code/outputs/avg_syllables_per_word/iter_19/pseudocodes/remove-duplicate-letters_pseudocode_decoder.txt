CLASS Solution  
    FUNCTION removeDuplicateLetters WITH PARAMETERS s  
        SET last_occurrence TO an empty dictionary  
        FOR each index AND character IN enumeration of s  
            SET in dictionary last_occurrence the character TO the index  
        END FOR  
        
        SET stack TO an empty list  
        SET in_stack TO an empty set  
        
        FOR each index AND character IN enumeration of s  
            IF character EXISTS IN in_stack  
                CONTINUE to next iteration  
            END IF  
            
            WHILE the LENGTH OF stack IS greater than zero AND character COMES BEFORE the element at position LENGTH OF stack MINUS one of stack IN alphabetical order AND index IS LESS THAN last_occurrence of the element at position LENGTH OF stack MINUS one of stack  
                SET removed_char TO the last element REMOVED FROM stack  
                REMOVE removed_char FROM in_stack  
            END WHILE  
            
            APPEND character TO stack  
            ADD character TO in_stack  
        END FOR  
        
        SET result_string TO the concatenation of all elements in stack in order  
        RETURN result_string  
    END FUNCTION  
END CLASS