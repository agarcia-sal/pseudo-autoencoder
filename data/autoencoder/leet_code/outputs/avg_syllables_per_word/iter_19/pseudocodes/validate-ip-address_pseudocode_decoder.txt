CLASS Solution  
    FUNCTION validIPAddress(queryIP)  
        FUNCTION is_valid_ipv4_block(block)  
            IF block CONSISTS ONLY OF DIGITS  
                SET num TO block CONVERTED TO INTEGER  
                RETURN num IS LESS THAN OR EQUAL TO two hundred fifty five AND  
                       block AS STRING IS EQUAL TO block  // ensuring no leading zeros  
            END IF  
            RETURN false  
        END FUNCTION  

        FUNCTION is_valid_ipv6_block(block)  
            IF LENGTH OF block IS GREATER THAN OR EQUAL TO one AND LENGTH OF block IS LESS THAN OR EQUAL TO four  
                TRY  
                    SET ignored TO block CONVERTED TO INTEGER USING BASE sixteen  
                    RETURN true  
                ELSE  
                    RETURN false  
                END TRY  
            END IF  
            RETURN false  
        END FUNCTION  

        SET parts_ipv4 TO queryIP SPLIT BY period  
        SET parts_ipv6 TO queryIP SPLIT BY colon  

        IF LENGTH OF parts_ipv4 IS EQUAL TO four AND all blocks in parts_ipv4 SATISFY is_valid_ipv4_block  
            RETURN IPv four  
        ELSE IF LENGTH OF parts_ipv6 IS EQUAL TO eight AND all blocks in parts_ipv6 SATISFY is_valid_ipv6_block  
            RETURN IPv six  
        ELSE  
            RETURN Neither  
        END IF  
    END FUNCTION  
END CLASS