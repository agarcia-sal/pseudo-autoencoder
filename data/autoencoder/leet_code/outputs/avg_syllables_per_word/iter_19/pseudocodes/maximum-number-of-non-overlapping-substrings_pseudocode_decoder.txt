CLASS Solution  
    FUNCTION maxNumOfSubstrings(s)  
        SET first TO empty mapping  
        SET last TO empty mapping  
        FOR each index AND character IN enumeration of s  
            IF character NOT IN first  
                SET element at key character of first TO index  
            END IF  
            SET element at key character of last TO index  
        END FOR  
      
        SET intervals TO empty list  
        FOR each character IN keys of first  
            SET start TO element at key character of first  
            SET end TO element at key character of last  
            SET i TO start  
            WHILE i IS LESS THAN OR EQUAL TO end  
                IF element at key element at position i of s of first IS LESS THAN start  
                    BREAK loop  
                END IF  
                SET end TO the GREATER of end AND element at key element at position i of s of last  
                INCREMENT i BY one  
            END WHILE  
            IF loop completed without break  
                APPEND tuple of start AND end TO intervals  
            END IF  
        END FOR  
      
        SORT intervals BY the element at position two of each tuple in ascending order  
      
        SET result TO empty list  
        SET prev_end TO negative one  
        FOR each tuple of start AND end IN intervals  
            IF start IS GREATER THAN prev_end  
                APPEND substring from position start TO end inclusive of s TO result  
                SET prev_end TO end  
            END IF  
        END FOR  
      
        RETURN result  
    END FUNCTION  
END CLASS