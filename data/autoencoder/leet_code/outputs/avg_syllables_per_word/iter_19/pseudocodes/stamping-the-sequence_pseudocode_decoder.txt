CLASS Solution  
    FUNCTION movesToStamp WITH PARAMETERS stamp AND target  
        SET m TO the LENGTH OF stamp  
        SET n TO the LENGTH OF target  
        SET indeg TO a LIST where each element is m with the LENGTH of n MINUS m PLUS one  
        ASSIGN pointer TO an EMPTY double ended queue NAMED q  
        SET g TO a LIST of EMPTY LISTS for each POSITION FROM zero TO n MINUS one  
        FOR each i FROM zero TO n MINUS m  
            FOR each j AND c AS the POSITION AND CHARACTER in stamp  
                IF the CHARACTER at POSITION i PLUS j of target EQUALS c THEN  
                    DECREMENT the element AT POSITION i of indeg BY one  
                    IF the element AT POSITION i of indeg EQUALS zero THEN  
                        APPEND i TO q  
                    END IF  
                ELSE  
                    APPEND i TO the LIST AT POSITION i PLUS j of g  
                END IF  
            END FOR  
        END FOR  
        SET ans TO an EMPTY LIST  
        SET vis TO a LIST of boolean FALSE with the LENGTH n  
        WHILE q IS NOT EMPTY  
            SET i TO the ELEMENT REMOVED FROM THE LEFT OF q  
            APPEND i TO ans  
            FOR each j FROM zero TO m MINUS one  
                IF the ELEMENT AT POSITION i PLUS j of vis IS FALSE THEN  
                    SET the ELEMENT AT POSITION i PLUS j of vis TO TRUE  
                    FOR each k IN the LIST AT POSITION i PLUS j of g  
                        DECREMENT the element AT POSITION k of indeg BY one  
                        IF the element AT POSITION k of indeg EQUALS zero THEN  
                            APPEND k TO q  
                        END IF  
                    END FOR  
                END IF  
            END FOR  
        END WHILE  
        IF all ELEMENTS in vis ARE TRUE THEN  
            RETURN ans IN REVERSED ORDER  
        ELSE  
            RETURN an EMPTY LIST  
        END IF  
    END FUNCTION  
END CLASS