CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MODULO TO one billion PLUS seven  
        SORT arr IN ASCENDING ORDER  
        INITIALIZE dp AS A MAPPING FROM each element num OF arr TO one  
        FOR index i FROM zero TO the LENGTH OF arr MINUS one  
            SET num TO element at position i of arr  
            FOR index j FROM zero TO i MINUS one  
                SET factor_candidate TO element at position j of arr  
                IF num MODULO factor_candidate EQUALS zero  
                    SET right_child TO num DIVIDED BY factor_candidate  
                    IF right_child EXISTS AS A KEY IN dp  
                        SET dp at key num TO dp at key num PLUS dp at key factor_candidate MULTIPLIED BY dp at key right_child  
                        SET dp at key num TO dp at key num MODULO MODULO  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        SET total_trees TO the SUM OF all VALUES IN dp  
        SET total_trees TO total_trees MODULO MODULO  
        RETURN total_trees  
    END FUNCTION  
END CLASS