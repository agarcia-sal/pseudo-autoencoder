CLASS Solution  
    FUNCTION getCoprimes(nums AS List OF Integer, edges AS List OF List OF Integer) RETURNS List OF Integer  
        SET n TO the LENGTH OF nums  
        INITIALIZE tree AS a mapping from integer to list of integers WITH DEFAULT empty list  
        FOR each u AND v IN edges  
            APPEND v TO the list AT position u of tree  
            APPEND u TO the list AT position v of tree  
        END FOR  

        INITIALIZE coprime AS two dimensional list of boolean values sized fifty by fifty  
        FOR i FROM one TO fifty  
            FOR j FROM one TO fifty  
                SET gcd_value TO the greatest common divisor of i AND j  
                SET coprime value at position i AND j TO whether gcd_value EQUALS one  
            END FOR  
        END FOR  

        INITIALIZE result AS list of n elements all SET TO negative one  
        INITIALIZE ancestor_stack AS list of fifty elements all SET TO none  

        FUNCTION dfs(node AS Integer, parent AS Integer, depth AS Integer)  
            SET closest_ancestor TO negative one  
            SET max_depth TO negative one  
            FOR value FROM one TO fifty  
                IF coprime at position nums at position node AND value IS true AND ancestor_stack at position value IS NOT none  
                    ASSIGN anc_node AND anc_depth TO the contents at ancestor_stack at position value  
                    IF anc_depth GREATER THAN max_depth  
                        SET max_depth TO anc_depth  
                        SET closest_ancestor TO anc_node  
                    END IF  
                END IF  
            END FOR  
            SET result at position node TO closest_ancestor  

            SET original_ancestor TO ancestor_stack at position nums at position node  
            SET ancestor_stack at position nums at position node TO tuple OF node AND depth  

            FOR each child IN the list at position node of tree  
                IF child NOT EQUALS parent  
                    CALL dfs WITH child, node, depth PLUS one  
                END IF  
            END FOR  

            SET ancestor_stack at position nums at position node TO original_ancestor  
        END FUNCTION  

        CALL dfs WITH zero, negative one, zero  

        RETURN result  
    END FUNCTION  
END CLASS