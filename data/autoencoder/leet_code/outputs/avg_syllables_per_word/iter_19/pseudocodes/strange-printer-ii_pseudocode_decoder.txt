CLASS Solution  
    FUNCTION isPrintable(targetGrid)  
        SET color_bounds TO an empty default dictionary that returns a list consisting of positive infinity value negative infinity value negative infinity value negative infinity value  
        FOR each row_index FROM zero TO the LENGTH OF targetGrid MINUS one  
            FOR each column_index FROM zero TO the LENGTH OF element at position zero of targetGrid MINUS one  
                SET color TO element at position row_index of targetGrid at position column_index  
                SET element at position zero of element at position color of color_bounds TO the MINIMUM OF element at position zero of element at position color of color_bounds AND row_index  
                SET element at position one of element at position color of color_bounds TO the MINIMUM OF element at position one of element at position color of color_bounds AND column_index  
                SET element at position two of element at position color of color_bounds TO the MAXIMUM OF element at position two of element at position color of color_bounds AND row_index  
                SET element at position three of element at position color of color_bounds TO the MAXIMUM OF element at position three of element at position color of color_bounds AND column_index  
            END FOR  
        END FOR  
        
        SET graph TO an empty default dictionary that returns an empty list  
        SET in_degree TO an empty default dictionary that returns zero  
        
        FOR each color AND its bounds consisting of minimum_row minimum_column maximum_row maximum_column IN the items of color_bounds  
            FOR each row FROM minimum_row TO maximum_row  
                FOR each column FROM minimum_column TO maximum_column  
                    IF element at position row of targetGrid at position column IS NOT EQUAL TO color THEN  
                        SET other_color TO element at position row of targetGrid at position column  
                        APPEND color TO element at position other_color of graph  
                        INCREMENT element at position color of in_degree BY one  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        SET queue TO a double ended queue initialized with each color in color_bounds where element at position color of in_degree EQUALS zero  
        SET visited_colors TO zero  
        
        WHILE queue IS NOT empty  
            SET color TO the element removed from the left of queue  
            INCREMENT visited_colors BY one  
            FOR each next_color IN element at position color of graph  
                DECREMENT element at position next_color of in_degree BY one  
                IF element at position next_color of in_degree EQUALS zero THEN  
                    APPEND next_color TO queue  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN visited_colors EQUALS the LENGTH OF color_bounds  
    END FUNCTION  
END CLASS