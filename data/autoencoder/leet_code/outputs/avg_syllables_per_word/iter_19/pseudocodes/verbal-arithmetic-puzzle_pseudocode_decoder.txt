CLASS Solution  
    FUNCTION isSolvable(words AS List OF string, result AS string) RETURNS boolean  
        SET unique_chars TO SET OF ALL CHARACTERS IN THE CONCATENATION OF all elements IN words AND result  
        IF THE SIZE OF unique_chars IS GREATER THAN ten  
            RETURN false  
        END IF  
        
        SET non_zero_chars TO SET OF first character of each word IN words WHERE LENGTH OF word IS GREATER THAN one UNIONED WITH first character of result IF LENGTH OF result IS GREATER THAN one OTHERWISE EMPTY STRING  
        
        SET char_to_digit TO EMPTY MAPPING OF character TO digit  
        SET digit_to_char TO EMPTY MAPPING OF digit TO character  
        
        FUNCTION can_assign(char AS character, digit AS integer) RETURNS boolean  
            RETURN char NOT IN char_to_digit AND (digit NOT IN digit_to_char OR digit_to_char AT digit EQUALS char)  
        END FUNCTION  
        
        FUNCTION assign(char AS character, digit AS integer)  
            SET char_to_digit AT char TO digit  
            SET digit_to_char AT digit TO char  
        END FUNCTION  
        
        FUNCTION unassign(char AS character, digit AS integer)  
            REMOVE char FROM char_to_digit  
            REMOVE digit FROM digit_to_char  
        END FUNCTION  
        
        FUNCTION word_value(word AS string) RETURNS integer  
            SET value TO zero  
            FOR each position FROM zero TO LENGTH OF word MINUS one  
                SET character AT position TO element at position LENGTH OF word MINUS one MINUS position OF word  
                INCREMENT value BY char_to_digit AT character MULTIPLIED BY TEN RAISED TO THE POWER OF position  
            END FOR  
            RETURN value  
        END FUNCTION  
        
        FUNCTION backtrack(index AS integer, col AS integer, sum_col AS integer) RETURNS boolean  
            SET max_word_length TO MAXIMUM LENGTH AMONG all words IN words  
            IF col IS GREATER THAN OR EQUAL TO max_word_length AND col IS GREATER THAN OR EQUAL TO LENGTH OF result  
                RETURN sum_col EQUALS zero  
            END IF  
            
            IF index IS EQUAL TO LENGTH OF words  
                IF col IS LESS THAN LENGTH OF result  
                    SET digit_char TO element at position LENGTH OF result MINUS one MINUS col OF result  
                    IF digit_char IS IN char_to_digit  
                        IF char_to_digit AT digit_char EQUALS sum_col MODULO ten  
                            RETURN backtrack WITH PARAMETERS zero, col PLUS one, sum_col DIVIDED BY ten  
                        ELSE  
                            RETURN false  
                        END IF  
                    ELSE IF can_assign WITH PARAMETERS digit_char, sum_col MODULO ten AND sum_col MODULO ten IS NOT zero OR digit_char NOT IN non_zero_chars  
                        CALL assign WITH PARAMETERS digit_char, sum_col MODULO ten  
                        IF backtrack WITH PARAMETERS zero, col PLUS one, sum_col DIVIDED BY ten RETURNS true  
                            RETURN true  
                        END IF  
                        CALL unassign WITH PARAMETERS digit_char, sum_col MODULO ten  
                    END IF  
                ELSE  
                    RETURN sum_col EQUALS zero  
                END IF  
                RETURN false  
            END IF  
            
            SET current_word TO element at position index OF words  
            IF col IS GREATER THAN OR EQUAL TO LENGTH OF current_word  
                RETURN backtrack WITH PARAMETERS index PLUS one, col, sum_col  
            END IF  
            
            SET current_char TO element at position LENGTH OF current_word MINUS one MINUS col OF current_word  
            IF current_char IS IN char_to_digit  
                RETURN backtrack WITH PARAMETERS index PLUS one, col, sum_col PLUS char_to_digit AT current_char  
            END IF  
            
            FOR digit FROM zero TO nine  
                IF can_assign WITH PARAMETERS current_char, digit AND digit IS NOT zero OR current_char NOT IN non_zero_chars  
                    CALL assign WITH PARAMETERS current_char, digit  
                    IF backtrack WITH PARAMETERS index PLUS one, col, sum_col PLUS digit RETURNS true  
                        RETURN true  
                    END IF  
                    CALL unassign WITH PARAMETERS current_char, digit  
                END IF  
            END FOR  
            
            RETURN false  
        END FUNCTION  
        
        RETURN backtrack WITH PARAMETERS zero, zero, zero  
    END FUNCTION  
END CLASS