CLASS Solution  
    FUNCTION kthSmallest(mat AS List OF List OF integer, k AS integer) RETURNS integer  
        SET m TO the LENGTH OF mat  
        SET n TO the LENGTH OF element at position zero of mat  
        SET min_heap TO a LIST containing a single ELEMENT which is a TUPLE consisting of the sum of element at position zero of each row in mat AND a TUPLE containing zero repeated m times  
        SET visited TO a SET containing the second ELEMENT of the single ELEMENT in min_heap  
        
        WHILE k IS GREATER THAN zero  
            SET current_sum AND indices TO the result of REMOVING the SMALLEST ELEMENT FROM min_heap  
            DECREMENT k BY one  
            
            IF k EQUALS zero  
                RETURN current_sum  
            END IF  
            
            FOR i FROM zero TO m MINUS one  
                IF the element at position i of indices PLUS one IS LESS THAN n  
                    SET new_indices TO a LIST COPY OF indices  
                    INCREMENT element at position i of new_indices BY one  
                    SET new_indices_tuple TO a TUPLE OF new_indices  
                    SET new_sum TO current_sum MINUS element at position i of mat AT position element at position i of indices PLUS element at position i of mat AT position element at position i of new_indices  
                    
                    IF new_indices_tuple IS NOT IN visited  
                        ADD new_indices_tuple TO visited  
                        ADD the TUPLE consisting of new_sum AND new_indices_tuple TO min_heap maintaining heap order  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN negative one  
    END FUNCTION  
END CLASS