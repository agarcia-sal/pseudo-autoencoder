CLASS Solution  
    FUNCTION findPaths(m, n, maxMove, startRow, startColumn)  
        SET MOD TO one billion PLUS seven  
        SET directions TO a list containing tuples zero and one, zero and minus one, one and zero, minus one and zero  
  
        INITIALIZE three dimensional list dp WITH zero for each position from zero TO maxMove PLUS one for each of m rows and n columns  
  
        FOR each number k FROM one TO maxMove  
            FOR each number i FROM zero TO m MINUS one  
                FOR each number j FROM zero TO n MINUS one  
                    FOR each pair di and dj IN directions  
                        SET ni TO i PLUS di  
                        SET nj TO j PLUS dj  
                        IF ni IS LESS THAN zero OR ni IS GREATER THAN OR EQUAL TO m OR nj IS LESS THAN zero OR nj IS GREATER THAN OR EQUAL TO n  
                            SET element at position k of element at position j of element at position i of dp TO the sum of element at position k of element at position j of element at position i of dp PLUS one MODULO MOD  
                        ELSE  
                            SET element at position k of element at position j of element at position i of dp TO the sum of element at position k of element at position j of element at position i of dp PLUS element at position k MINUS one of element at position nj of element at position ni of dp MODULO MOD  
                        END IF  
                    END FOR  
                END FOR  
            END FOR  
        END FOR  
  
        RETURN element at position maxMove of element at position startColumn of element at position startRow of dp  
    END FUNCTION  
END CLASS