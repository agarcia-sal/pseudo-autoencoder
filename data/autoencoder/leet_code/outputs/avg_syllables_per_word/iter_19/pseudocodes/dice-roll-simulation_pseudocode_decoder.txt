CLASS Solution  
    FUNCTION dieSimulator(n, rollMax)  
        SET MOD TO one billion PLUS seven  
        
        SET dp TO a three dimensional list with length n PLUS one for the first dimension  
        EACH element of the first dimension is a list with length six for the second dimension  
        EACH element of the second dimension is a list of zeroes with length equal to the maximum value in rollMax PLUS one for the third dimension  
        
        FOR each number j FROM zero TO five  
            SET element at position one of element at position j of element at position one of dp TO one  
        END FOR  
        
        FOR each index i FROM two TO n  
            FOR each number j FROM zero TO five  
                FOR each count k FROM one TO element at position j of rollMax  
                    IF count k is greater than one THEN  
                        SET element at position k of element at position j of element at position i of dp TO element at position k minus one of element at position j of element at position i minus one of dp  
                    ELSE  
                        SET element at position k of element at position j of element at position i of dp TO the sum of all elements at position y of element at position x of element at position i minus one of dp FOR each x FROM zero TO five and each y FROM one TO element at position x of rollMax WHERE x is not equal to j  
                        APPLY modulo operation by MOD TO this sum  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        SET result TO the sum of all elements at position k of element at position j of element at position n of dp FOR each j FROM zero TO five and each k FROM one TO element at position j of rollMax  
        APPLY modulo operation by MOD TO result  
        RETURN result  
    END FUNCTION  
END CLASS