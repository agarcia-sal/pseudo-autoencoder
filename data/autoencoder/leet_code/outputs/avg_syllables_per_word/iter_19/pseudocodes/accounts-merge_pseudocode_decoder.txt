CLASS UnionFind  
    FUNCTION __init__(self, size)  
        SET self dot root TO an empty list  
        FOR each integer i FROM zero TO size MINUS one  
            APPEND i TO self dot root  
        END FOR  
        SET self dot rank TO an empty list  
        FOR each integer i FROM zero TO size MINUS one  
            APPEND one TO self dot rank  
        END FOR  
    END FUNCTION  

    FUNCTION find(self, x)  
        IF the element at position x of self dot root EQUALS x  
            RETURN x  
        END IF  
        SET the element at position x of self dot root TO the result of calling self dot find with the element at position x of self dot root  
        RETURN the element at position x of self dot root  
    END FUNCTION  

    FUNCTION union(self, x, y)  
        SET rootX TO the result of calling self dot find with x  
        SET rootY TO the result of calling self dot find with y  
        IF rootX NOT EQUALS rootY  
            IF the element at position rootX of self dot rank GREATER THAN the element at position rootY of self dot rank  
                SET the element at position rootY of self dot root TO rootX  
            ELSE IF the element at position rootX of self dot rank LESS THAN the element at position rootY of self dot rank  
                SET the element at position rootX of self dot root TO rootY  
            ELSE  
                SET the element at position rootY of self dot root TO rootX  
                INCREMENT the element at position rootX of self dot rank BY one  
            END IF  
        END IF  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION accountsMerge(self, accounts)  
        SET email_to_id TO an empty dictionary  
        SET uf TO a new instance of UnionFind initialized with the length of accounts  
        FOR each index i AND unpacked first element discarded AND the rest of elements AS emails IN accounts  
            FOR each email IN emails  
                IF email NOT IN email_to_id  
                    SET email_to_id at key email TO i  
                ELSE  
                    CALL uf dot union with i AND the value at key email of email_to_id  
                END IF  
            END FOR  
        END FOR  
        SET merged_emails TO a new empty dictionary that returns an empty list for missing keys  
        FOR each email AND account_id IN items of email_to_id  
            SET root_id TO the result of calling uf dot find with account_id  
            APPEND email TO the list at key root_id of merged_emails  
        END FOR  
        SET result TO an empty list  
        FOR each account_id AND emails IN items of merged_emails  
            SET name TO the first element of the element at position account_id of accounts  
            APPEND a new list with name FOLLOWED BY the emails sorted in ascending alphabetical order TO result  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS