CLASS Solution  
    FUNCTION calcEquation(equations AS list of list of string, values AS list of float, queries AS list of list of string) RETURNS list of float  
        SET graph TO a default dictionary mapping each string TO a dictionary mapping string TO float  
        FOR each pair of variables a AND b AND corresponding value IN the zipped list of equations AND values  
            SET the value associated with variable b in the dictionary of variable a in graph TO value  
            SET the value associated with variable a in the dictionary of variable b in graph TO one DIVIDED BY value  
        END FOR  

        FUNCTION dfs(start AS string, end AS string, visited AS set of string) RETURNS float  
            IF start is NOT a key in graph OR end is NOT a key in graph THEN  
                RETURN minus one point zero  
            END IF  
            IF start EQUALS end THEN  
                RETURN one point zero  
            END IF  
            ADD start TO visited  
            FOR each neighbor AND weight IN the items of the dictionary associated with start in graph  
                IF neighbor is NOT IN visited THEN  
                    SET result TO the recursive call of dfs with neighbor, end, AND visited  
                    IF result DOES NOT EQUAL minus one point zero THEN  
                        RETURN weight MULTIPLIED BY result  
                    END IF  
                END IF  
            END FOR  
            REMOVE start FROM visited  
            RETURN minus one point zero  
        END FUNCTION  

        SET results TO an empty list  
        FOR each query IN queries  
            SET start TO the first element at position one of query  
            SET end TO the element at position two of query  
            SET visited TO an empty set  
            SET result TO the call of dfs with start, end, AND visited  
            APPEND result TO results  
        END FOR  
        RETURN results  
    END FUNCTION  
END CLASS