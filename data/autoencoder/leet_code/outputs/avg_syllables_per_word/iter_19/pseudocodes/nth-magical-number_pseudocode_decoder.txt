CLASS Solution  
    FUNCTION nthMagicalNumber WITH PARAMETERS n a b  
        SET MOD TO one billion PLUS seven  
        
        FUNCTION gcd WITH PARAMETERS x y  
            WHILE y IS NOT EQUAL TO zero  
                SET temporary TO y  
                SET y TO the remainder when x IS DIVIDED BY y  
                SET x TO temporary  
            END WHILE  
            RETURN x  
        END FUNCTION  
        
        FUNCTION lcm WITH PARAMETERS x y  
            RETURN x MULTIPLIED BY y DIVIDED BY the result of gcd WITH PARAMETERS x y  
        END FUNCTION  
        
        SET L TO the result of lcm WITH PARAMETERS a b  
        
        SET left TO one  
        SET right TO n MULTIPLIED BY the smaller of a and b  
        
        WHILE left IS LESS THAN right  
            SET mid TO the result of left PLUS right DIVIDED BY two rounded down  
            SET count TO mid DIVIDED BY a PLUS mid DIVIDED BY b MINUS mid DIVIDED BY L  
            
            IF count IS LESS THAN n  
                SET left TO mid PLUS one  
            ELSE  
                SET right TO mid  
            END IF  
        END WHILE  
        
        RETURN remainder when left IS DIVIDED BY MOD  
    END FUNCTION  
END CLASS