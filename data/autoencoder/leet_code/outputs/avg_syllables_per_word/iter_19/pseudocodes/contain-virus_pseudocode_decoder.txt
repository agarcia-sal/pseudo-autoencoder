CLASS Solution  
    FUNCTION containVirus(isInfected)  
        FUNCTION neighbors(r, c)  
            RETURN a list consisting of a pair with row incremented by one and column unchanged, a pair with row decremented by one and column unchanged, a pair with row unchanged and column incremented by one, and a pair with row unchanged and column decremented by one  
        END FUNCTION

        FUNCTION bfs(r, c)  
            SET infected TO an empty set  
            SET threatened TO an empty set  
            SET queue TO a deque initialized with a pair of r and c  
            SET visited TO a set initialized with a pair of r and c  
            WHILE the queue is not empty  
                REMOVE the leftmost pair from the queue and assign it to variables x and y  
                ADD the pair x and y to the infected set  
                FOR each pair nx and ny in the result of neighbors with x and y  
                    IF nx is greater than or equal to zero AND nx is less than m AND ny is greater than or equal to zero AND ny is less than n AND the pair nx and ny is not in visited  
                        ADD the pair nx and ny to visited set  
                        IF the element at position nx of isInfected and element at position ny of that row EQUALS one  
                            APPEND the pair nx and ny to the right end of the queue  
                        ELSE IF the element at position nx of isInfected and element at position ny of that row EQUALS zero  
                            ADD the pair nx and ny to the threatened set  
                        END IF  
                    END IF  
                END FOR  
            END WHILE  
            RETURN infected set AND threatened set  
        END FUNCTION

        FUNCTION build_walls(infected)  
            SET walls TO zero  
            FOR each pair x and y in infected  
                FOR each pair nx and ny in neighbors with x and y  
                    IF nx is greater than or equal to zero AND nx is less than m AND ny is greater than or equal to zero AND ny is less than n AND the element at position nx of isInfected and element at position ny of that row EQUALS zero  
                        INCREMENT walls BY one  
                    END IF  
                END FOR  
            END FOR  
            RETURN walls  
        END FUNCTION

        FUNCTION spread_virus(threatened)  
            FOR each pair x and y in threatened  
                SET the element at position x of isInfected and element at position y of that row TO one  
            END FOR  
        END FUNCTION

        SET m TO the LENGTH OF isInfected  
        SET n TO the LENGTH OF element at position zero of isInfected  
        SET total_walls TO zero

        WHILE TRUE  
            SET regions TO an empty list  
            SET visited TO an empty set  
            FOR r FROM zero TO m MINUS one  
                FOR c FROM zero TO n MINUS one  
                    IF the element at position r of isInfected and element at position c of that row EQUALS one AND the pair r and c is not in visited  
                        SET infected and threatened TO the result of bfs with r and c  
                        APPEND a pair consisting of infected and threatened TO regions  
                        ASSIGN visited TO the UNION of visited and infected sets  
                    END IF  
                END FOR  
            END FOR

            IF regions is empty  
                BREAK the loop  
            END IF

            SORT regions in descending order by the LENGTH OF the threatened set in each pair

            INCREMENT total_walls BY the result of build_walls with the infected set of the first pair in regions  
            FOR each pair x and y in the infected set of the first pair in regions  
                SET the element at position x of isInfected and element at position y of that row TO negative one  
            END FOR

            FOR i FROM one TO the LENGTH OF regions MINUS one  
                CALL spread_virus with the threatened set of the element at position i of regions  
            END FOR  
        END WHILE

        RETURN total_walls  
    END FUNCTION  
END CLASS