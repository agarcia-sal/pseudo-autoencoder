CLASS Solution  
    FUNCTION numWays(words AS List of string, target AS string) RETURNS integer  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF the element at position zero of words  
        SET m TO the LENGTH OF target  
        
        SET freq TO a LIST OF default mapping FROM character TO integer INITIALIZED FOR each position FROM zero TO n MINUS one  
        
        FOR each word IN words  
            FOR each character with index j IN word  
                INCREMENT the value at key character in freq at position j BY one  
            END FOR  
        END FOR  
        
        SET dp TO a two dimensional LIST OF integers WITH m PLUS one ROWS AND n PLUS one COLUMNS ALL SET TO zero  
        
        FOR each index j FROM zero TO n  
            SET the element at row zero column j of dp TO one  
        END FOR  
        
        FOR each index i FROM one TO m  
            FOR each index j FROM one TO n  
                SET the element at row i column j of dp TO the element at row i column j MINUS one of dp  
                IF the value at key element at position i MINUS one of target in freq at position j MINUS one GREATER THAN zero  
                    INCREMENT the element at row i column j of dp BY the element at row i MINUS one column j MINUS one of dp MULTIPLIED BY the value at key element at position i MINUS one of target in freq at position j MINUS one  
                    SET the element at row i column j of dp TO itself MODULO MOD  
                END IF  
            END FOR  
        END FOR  
        
        RETURN the element at row m column n of dp  
    END FUNCTION  
END CLASS