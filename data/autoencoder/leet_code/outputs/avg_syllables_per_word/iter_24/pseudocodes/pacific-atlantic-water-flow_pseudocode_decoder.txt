CLASS Solution  
    FUNCTION pacificAtlantic WITH PARAMETER heights  
        FUNCTION bfs WITH PARAMETERS q vis  
            WHILE q IS NOT empty  
                FOR repetition FROM zero TO LENGTH OF q MINUS one  
                    SET i j TO element AT the FRONT OF q REMOVED FROM q  
                    FOR a b IN list OF pairs zero MINUS one zero one one zero MINUS one zero  
                        SET x TO i PLUS a  
                        SET y TO j PLUS b  
                        IF x GREATER THAN OR EQUAL TO zero AND x LESS THAN m AND y GREATER THAN OR EQUAL TO zero AND y LESS THAN n AND tuple OF x y NOT IN vis AND element AT position x OF heights GREATER THAN OR EQUAL TO element AT position i OF heights AT position y j  
                            ADD tuple OF x y TO vis  
                            APPEND tuple OF x y TO q  
                        END IF  
                    END FOR  
                END FOR  
            END WHILE  
        END FUNCTION  
        SET m TO LENGTH OF heights  
        SET n TO LENGTH OF element AT position zero OF heights  
        SET vis1 TO empty set  
        SET vis2 TO empty set  
        SET q1 TO empty double ended queue  
        SET q2 TO empty double ended queue  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF i EQUALS zero OR j EQUALS zero  
                    ADD tuple OF i j TO vis1  
                    APPEND tuple OF i j TO q1  
                END IF  
                IF i EQUALS m MINUS one OR j EQUALS n MINUS one  
                    ADD tuple OF i j TO vis2  
                    APPEND tuple OF i j TO q2  
                END IF  
            END FOR  
        END FOR  
        CALL bfs WITH PARAMETERS q1 vis1  
        CALL bfs WITH PARAMETERS q2 vis2  
        SET result TO empty list  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF tuple OF i j IN vis1 AND tuple OF i j IN vis2  
                    APPEND tuple OF i j TO result  
                END IF  
            END FOR  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS