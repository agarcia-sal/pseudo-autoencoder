CLASS Solution  
    FUNCTION expressiveWords(s, words)  
        FUNCTION compress(word)  
            IF word EQUALS empty string THEN  
                RETURN empty list  
            END IF  
            SET count TO one  
            SET compressed TO empty list  
            FOR index FROM two TO the LENGTH OF word  
                IF element at position index of word EQUALS element at position index MINUS one of word THEN  
                    INCREMENT count BY one  
                ELSE  
                    APPEND pair of element at position index MINUS one of word AND count TO compressed  
                    SET count TO one  
                END IF  
            END FOR  
            APPEND pair of last element of word AND count TO compressed  
            RETURN compressed  
        END FUNCTION  
        FUNCTION is_stretchy(s_compressed, word_compressed)  
            IF LENGTH OF s_compressed NOT EQUALS LENGTH OF word_compressed THEN  
                RETURN false  
            END IF  
            FOR each pair of pairs (sc AND sc_count), (wc AND wc_count) IN parallel iteration of s_compressed AND word_compressed  
                IF sc NOT EQUALS wc THEN  
                    RETURN false  
                END IF  
                IF sc_count NOT EQUALS wc_count AND (sc_count LESS THAN three OR sc_count LESS THAN wc_count) THEN  
                    RETURN false  
                END IF  
            END FOR  
            RETURN true  
        END FUNCTION  
        SET s_compressed TO result of calling compress with argument s  
        SET stretchy_count TO zero  
        FOR each word IN words  
            SET word_compressed TO result of calling compress with argument word  
            IF result of calling is_stretchy with arguments s_compressed AND word_compressed THEN  
                INCREMENT stretchy_count BY one  
            END IF  
        END FOR  
        RETURN stretchy_count  
    END FUNCTION  
END CLASS