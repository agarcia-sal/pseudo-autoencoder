CLASS Solution  
    FUNCTION validArrangement(pairs)  
        SET graph TO empty mapping from keys to lists  
        SET out_degree TO empty counting mapping  
        SET in_degree TO empty counting mapping  
        
        FOR each element u AND v IN pairs  
            APPEND v TO the list at key u in graph  
            INCREMENT out_degree at key u BY one  
            INCREMENT in_degree at key v BY one  
        END FOR  
        
        SET start_node TO no value  
        FOR each node IN keys of graph  
            IF out_degree at key node EQUALS in_degree at key node PLUS one THEN  
                SET start_node TO node  
                BREAK loop  
            END IF  
        END FOR  
        IF start_node HAS no value THEN  
            SET start_node TO first element obtained from keys of graph  
        END IF  
        
        SET path TO empty list  
        SET stack TO list containing start_node  
        
        WHILE stack is not empty  
            SET u TO last element in stack  
            IF list at key u in graph is not empty THEN  
                REMOVE last element from list at key u in graph AND ASSIGN it TO v  
                APPEND v TO stack  
            ELSE  
                REMOVE last element from stack AND APPEND it TO path  
            END IF  
        END WHILE  
        
        REVERSE the elements in path  
        
        SET result TO empty list  
        FOR index FROM zero TO length of path MINUS one  
            APPEND list containing element at position index of path AND element at position index PLUS one of path TO result  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS