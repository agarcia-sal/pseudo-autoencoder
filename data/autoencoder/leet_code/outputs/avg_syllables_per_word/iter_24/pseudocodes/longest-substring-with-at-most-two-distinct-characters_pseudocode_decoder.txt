CLASS Solution  
    FUNCTION lengthOfLongestSubstringTwoDistinct(s)  
        CREATE mapping FROM characters TO zero  
        SET left TO zero  
        SET max_length TO zero  
        
        FOR right FROM zero TO THE LENGTH OF s MINUS one  
            INCREMENT the count OF character at position right OF s BY one IN mapping  
            
            WHILE the COUNT OF keys IN mapping IS GREATER THAN two  
                DECREMENT the count OF character at position left OF s BY one IN mapping  
                IF the count OF character at position left OF s EQUALS zero  
                    REMOVE the character at position left OF s FROM mapping  
                END IF  
                INCREMENT left BY one  
            END WHILE  
            
            SET current_window_length TO right MINUS left PLUS one  
            IF current_window_length GREATER THAN max_length  
                SET max_length TO current_window_length  
            END IF  
        END FOR  
        
        RETURN max_length  
    END FUNCTION  
END CLASS