CLASS Solution  
    FUNCTION pathsWithMaxScore(board)  
        SET MODULO TO ten RAISED TO THE power OF nine PLUS seven  
        SET n TO the LENGTH OF board  
        SET dp TO a two-dimensional list with n elements each containing n elements each set TO a list of two elements where the first element is NEGATIVE infinity and the second element is zero  
        SET the element at position n MINUS one of the element at position n MINUS one of dp TO a list with zero and one  
        FOR i FROM n MINUS one DOWN TO zero EXCLUSIVE STEPPING BY negative one  
            FOR j FROM n MINUS one DOWN TO zero EXCLUSIVE STEPPING BY negative one  
                IF the element at position j of the element at position i of board EQUALS the character X OR the element at position j of the element at position i of board EQUALS the character S THEN  
                    CONTINUE TO the next iteration of the inner loop  
                END IF  
                IF the element at position j of the element at position i of board EQUALS the character E THEN  
                    SET value TO zero  
                ELSE  
                    SET value TO the INTEGER VALUE OF the element at position j of the element at position i of board  
                END IF  
                FOR each pair x and y IN the list of pairs where the first pair is one and zero, the second pair is zero and one, and the third pair is one and one  
                    SET ni TO i PLUS x  
                    SET nj TO j PLUS y  
                    IF ni IS GREATER THAN OR EQUAL TO zero AND ni IS LESS THAN n AND nj IS GREATER THAN OR EQUAL TO zero AND nj IS LESS THAN n THEN  
                        IF the first element of the element at position nj of the element at position ni of dp IS GREATER THAN the first element of the element at position j of the element at position i of dp THEN  
                            SET the element at position j of the element at position i of dp TO a list where the first element is the first element of the element at position nj of the element at position ni of dp PLUS value and the second element is the second element of the element at position nj of the element at position ni of dp  
                        ELSE IF the first element of the element at position nj of the element at position ni of dp EQUALS the first element of the element at position j of the element at position i of dp THEN  
                            SET the second element of the element at position j of the element at position i of dp TO the second element of the element at position j of the element at position i of dp PLUS the second element of the element at position nj of the element at position ni of dp  
                            SET the second element of the element at position j of the element at position i of dp TO the second element of the element at position j of the element at position i of dp MODULO MODULO  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        IF the first element of the element at position zero of the element at position zero of dp EQUALS NEGATIVE infinity THEN  
            RETURN a list containing zero and zero  
        END IF  
        RETURN a list containing the first element of the element at position zero of the element at position zero of dp and the second element of the element at position zero of the element at position zero of dp  
    END FUNCTION  
END CLASS