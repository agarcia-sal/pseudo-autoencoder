CLASS UnionFind  
    FUNCTION __init__(self, n)  
        SET self parent TO list of integers starting from zero up to n minus one inclusive  
        SET self rank TO list of zeros with length n  
    END FUNCTION  

    FUNCTION find(self, x)  
        IF element at position x of self parent NOT EQUALS x THEN  
            SET element at position x of self parent TO result of calling find on element at position x of self parent  
        END IF  
        RETURN element at position x of self parent  
    END FUNCTION  

    FUNCTION union(self, x, y)  
        SET rootX TO result of calling find on x  
        SET rootY TO result of calling find on y  
        IF rootX NOT EQUALS rootY THEN  
            IF element at position rootX of self rank GREATER THAN element at position rootY of self rank THEN  
                SET element at position rootY of self parent TO rootX  
            ELSE IF element at position rootX of self rank LESS THAN element at position rootY of self rank THEN  
                SET element at position rootX of self parent TO rootY  
            ELSE  
                SET element at position rootY of self parent TO rootX  
                INCREMENT element at position rootX of self rank BY one  
            END IF  
        END IF  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION latestDayToCross(self, row, col, cells)  
        SET grid TO list of lists each containing ones of length col repeated row times  

        SET uf TO new instance of UnionFind initialized with row MULTIPLIED BY col PLUS two  
        SET TOP TO row MULTIPLIED BY col  
        SET BOTTOM TO row MULTIPLIED BY col PLUS one  

        SET directions TO list of pairs each representing moving one step up down left right  

        FOR day FROM length of cells MINUS one DOWN TO zero  
            SET r TO first element of element at position day of cells  
            SET c TO second element of element at position day of cells  

            DECREMENT r BY one to convert to zero-based index  
            DECREMENT c BY one to convert to zero-based index  

            SET element at position r of grid at position c TO zero to mark as land  

            FOR each pair dr dc in directions  
                SET nr TO r PLUS dr  
                SET nc TO c PLUS dc  
                IF nr GREATER THAN OR EQUAL TO zero AND nr LESS THAN row AND nc GREATER THAN OR EQUAL TO zero AND nc LESS THAN col AND element at position nr of grid at position nc EQUALS zero THEN  
                    CALL uf union with arguments r MULTIPLIED BY col PLUS c and nr MULTIPLIED BY col PLUS nc  
                END IF  
            END FOR  

            IF r EQUALS zero THEN  
                CALL uf union with arguments r MULTIPLIED BY col PLUS c and TOP  
            END IF  

            IF r EQUALS row MINUS one THEN  
                CALL uf union with arguments r MULTIPLIED BY col PLUS c and BOTTOM  
            END IF  

            IF result of calling uf find on TOP EQUALS result of calling uf find on BOTTOM THEN  
                RETURN day  
            END IF  
        END FOR  

        RETURN zero  
    END FUNCTION  
END CLASS