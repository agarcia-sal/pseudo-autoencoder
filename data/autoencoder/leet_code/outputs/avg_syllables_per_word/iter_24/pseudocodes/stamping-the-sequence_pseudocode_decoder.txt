CLASS Solution  
    FUNCTION movesToStamp(stamp, target)  
        SET m TO the LENGTH OF stamp  
        SET n TO the LENGTH OF target  
        SET indeg TO a LIST OF the VALUE m REPEATED the VALUE n MINUS m PLUS one TIMES  
        SET q TO an EMPTY double ended queue  
        SET g TO a LIST of EMPTY LISTS with LENGTH n  
        FOR i FROM zero TO the VALUE n MINUS m  
            FOR each index j WITH corresponding character c IN stamp  
                IF the ELEMENT AT POSITION i PLUS j OF target EQUALS c  
                    DECREMENT the ELEMENT AT POSITION i OF indeg BY one  
                    IF the ELEMENT AT POSITION i OF indeg EQUALS zero  
                        APPEND the VALUE i TO q  
                    END IF  
                ELSE  
                    APPEND the VALUE i TO the ELEMENT AT POSITION i PLUS j OF g  
                END IF  
            END FOR  
        END FOR  
        SET ans TO an EMPTY LIST  
        SET vis TO a LIST OF the VALUE FALSE REPEATED n TIMES  
        WHILE q is NOT EMPTY  
            SET i TO the LEFTMOST ELEMENT REMOVED FROM q  
            APPEND the VALUE i TO ans  
            FOR j FROM zero TO the VALUE m MINUS one  
                IF the ELEMENT AT POSITION i PLUS j OF vis EQUALS FALSE  
                    SET the ELEMENT AT POSITION i PLUS j OF vis TO TRUE  
                    FOR each k IN the ELEMENT AT POSITION i PLUS j OF g  
                        DECREMENT the ELEMENT AT POSITION k OF indeg BY one  
                        IF the ELEMENT AT POSITION k OF indeg EQUALS zero  
                            APPEND the VALUE k TO q  
                        END IF  
                    END FOR  
                END IF  
            END FOR  
        END WHILE  
        IF all ELEMENTS OF vis EQUAL TRUE  
            RETURN the REVERSE OF ans  
        ELSE  
            RETURN an EMPTY LIST  
        END IF  
    END FUNCTION  
END CLASS