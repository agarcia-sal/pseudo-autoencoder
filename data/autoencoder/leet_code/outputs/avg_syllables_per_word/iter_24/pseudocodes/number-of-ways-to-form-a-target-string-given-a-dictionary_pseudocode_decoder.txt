CLASS Solution  
    FUNCTION numWays(words LIST OF STRING target STRING) RETURNS INTEGER  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF element at position zero of words  
        SET m TO the LENGTH OF target  
      
        SET freq TO an EMPTY list  
        FOR each index FROM zero TO n MINUS one  
            APPEND a new empty mapping from character to integer TO freq  
        END FOR  
      
        FOR each word IN words  
            FOR each index j AND character char AT position j IN word  
                INCREMENT the value mapped by char in freq AT position j BY one  
            END FOR  
        END FOR  
      
        SET dp TO a two dimensional list with m PLUS one rows and n PLUS one columns FILLED WITH zero  
      
        FOR each j FROM zero TO n  
            SET element at position j in the first row of dp TO one  
        END FOR  
      
        FOR each i FROM one TO m  
            FOR each j FROM one TO n  
                SET element at position j in row i of dp TO the value of element at position j MINUS one in row i of dp  
                IF the value mapped by character at position i MINUS one in target in freq at position j MINUS one IS GREATER THAN zero THEN  
                    INCREMENT element at position j in row i of dp BY the product of element at position j MINUS one in row i MINUS one of dp AND the value mapped by character at position i MINUS one in target in freq at position j MINUS one  
                    SET element at position j in row i of dp TO element at position j in row i of dp MODULO MOD  
                END IF  
            END FOR  
        END FOR  
      
        RETURN element at position n in row m of dp  
    END FUNCTION  
END CLASS