CLASS Solution  
    FUNCTION findPaths(m n maxMove startRow startColumn)  
        SET MOD TO one billion PLUS seven  
        SET directions TO a collection containing the pairs of zero and one zero and minus one one and zero minus one and zero  
        INITIALIZE dp AS a three dimensional collection of zeros with dimensions m by n by maxMove PLUS one  
        
        FOR k FROM one TO maxMove  
            FOR i FROM zero TO m MINUS one  
                FOR j FROM zero TO n MINUS one  
                    FOR each pair di and dj IN directions  
                        SET ni TO i PLUS di  
                        SET nj TO j PLUS dj  
                        IF ni LESS THAN zero OR ni GREATER THAN OR EQUAL TO m OR nj LESS THAN zero OR nj GREATER THAN OR EQUAL TO n THEN  
                            SET dp element at position i then j then k TO dp element at position i then j then k PLUS one MODULO MOD  
                        ELSE  
                            SET dp element at position i then j then k TO dp element at position i then j then k PLUS dp element at position ni then nj then k MINUS one MODULO MOD  
                        END IF  
                    END FOR  
                END FOR  
            END FOR  
        END FOR  
        
        RETURN dp element at position startRow then startColumn then maxMove  
    END FUNCTION  
END CLASS