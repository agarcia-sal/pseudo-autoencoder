CLASS Solution  
    FUNCTION maskPII WITH PARAMETER s  
        IF the character AT symbol at any position IN s EQUALS true  
            SET the substring before the character AT symbol in s TO local  
            SET the substring after the character AT symbol in s TO domain  
            SET the first character of local TO first_character  
            SET the last character of local TO last_character  
            SET a string of five asterisks TO five_asterisks  
            SET concatenation of first_character PLUS five_asterisks PLUS last_character TO masked_local  
            SET the lowercase of masked_local TO lowercase_masked_local  
            SET the lowercase of domain TO lowercase_domain  
            RETURN concatenation of lowercase_masked_local PLUS the character AT symbol PLUS lowercase_domain  
        ELSE  
            SET all characters in s that are digits extracted IN ORDER TO digits  
            SET the last four characters of digits TO last_four_digits  
            SET concatenation of three asterisks PLUS dash PLUS three asterisks PLUS dash PLUS last_four_digits TO local_number  
            IF the length of digits EQUALS ten  
                RETURN local_number  
            ELSE  
                SET the length of digits MINUS ten TO country_code_length  
                SET concatenation of plus symbol PLUS a string of asterisks repeated country_code_length times PLUS dash TO country_code  
                RETURN concatenation of country_code PLUS local_number  
            END IF  
        END IF  
    END FUNCTION  
END CLASS