CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MOD TO one billion PLUS seven  
        CALL sort ON arr  
        SET dp TO a new dictionary WHERE each number IN arr IS MAPPED TO one  
        FOR each index i FROM zero TO the LENGTH OF arr MINUS one  
            SET num TO element at position i of arr  
            FOR each index j FROM zero TO i MINUS one  
                SET factor_candidate TO element at position j of arr  
                IF the remainder of num DIVIDED BY factor_candidate EQUALS zero THEN  
                    SET right_child TO num DIVIDED BY factor_candidate  
                    IF right_child IS a key IN dp THEN  
                        SET dp at key num TO dp at key num PLUS dp at key factor_candidate MULTIPLIED BY dp at key right_child  
                        SET dp at key num TO dp at key num MODULO MOD  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        SET total_trees TO the sum of all values in dp  
        RETURN total_trees MODULO MOD  
    END FUNCTION  
END CLASS