CLASS Solution  
    FUNCTION largestMultipleOfThree(digits)  
        SET count TO frequency count of digits  
        SET total_sum TO sum of all elements in digits  
        SET remainder TO total_sum MODULO three  
        
        IF remainder EQUALS one  
            FOR each digit d IN list one four seven  
                IF count of digit d GREATER THAN zero  
                    DECREMENT count of digit d BY one  
                    EXIT LOOP  
                END IF  
            END FOR  
            IF no digit was decremented in the previous loop  
                FOR each digit d IN list two five eight  
                    IF count of digit d GREATER THAN one  
                        DECREMENT count of digit d BY two  
                        EXIT LOOP  
                    END IF  
                END FOR  
            END IF  
        END IF  
        
        IF remainder EQUALS two  
            FOR each digit d IN list two five eight  
                IF count of digit d GREATER THAN zero  
                    DECREMENT count of digit d BY one  
                    EXIT LOOP  
                END IF  
            END FOR  
            IF no digit was decremented in the previous loop  
                FOR each digit d IN list one four seven  
                    IF count of digit d GREATER THAN one  
                        DECREMENT count of digit d BY two  
                        EXIT LOOP  
                    END IF  
                END FOR  
            END IF  
        END IF  
        
        SET result TO empty list  
        FOR digit d FROM nine DOWN TO zero  
            APPEND string representation of digit d repeated count of digit d times TO result  
        END FOR  
        
        SET final_number TO concatenation of all elements in result  
        
        IF final_number IS an empty string OR first character of final_number EQUALS zero  
            RETURN string zero  
        ELSE  
            RETURN final_number  
        END IF  
    END FUNCTION  
END CLASS