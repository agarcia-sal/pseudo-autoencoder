CLASS Trie  
    FUNCTION __init__()  
        SET children TO a list of length twenty six filled with None  
        SET ref TO minus one  
    END FUNCTION  

    FUNCTION insert(w, ref)  
        ASSIGN reference TO self  
        FOR each character c IN w  
            SET idx TO the Unicode code point of character c MINUS the Unicode code point of lowercase letter a  
            IF element at position idx of reference children EQUALS None  
                ASSIGN reference children at position idx TO a new Trie object  
            END IF  
            ASSIGN reference TO element at position idx of reference children  
        END FOR  
        SET reference ref TO ref  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION findWords(board, words)  
        FUNCTION dfs(node, i, j)  
            SET idx TO the Unicode code point of element at position j of element at position i of board MINUS the Unicode code point of lowercase letter a  
            IF element at position idx of node children EQUALS None  
                RETURN  
            END IF  
            ASSIGN node TO element at position idx of node children  
            IF node ref GREATER THAN OR EQUAL TO zero  
                APPEND element at position node ref of words TO ans  
                SET node ref TO minus one  
            END IF  
            SET c TO element at position j of element at position i of board  
            SET element at position j of element at position i of board TO the character hash symbol  
            FOR each pair a and b FROM consecutive pairs in the sequence minus one zero one zero minus one  
                SET x TO i PLUS a  
                SET y TO j PLUS b  
                IF x GREATER THAN OR EQUAL TO zero AND x LESS THAN m AND y GREATER THAN OR EQUAL TO zero AND y LESS THAN n AND element at position y of element at position x of board NOT EQUALS the character hash symbol  
                    CALL dfs with parameters node x y  
                END IF  
            END FOR  
            SET element at position j of element at position i of board TO c  
        END FUNCTION  

        ASSIGN tree TO a new Trie object  
        FOR each index i and word w IN enumeration of words  
            CALL insert method of tree with parameters w and i  
        END FOR  
        SET m TO the length of board  
        SET n TO the length of element at position zero of board  
        SET ans TO an empty list  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                CALL dfs with parameters tree i j  
            END FOR  
        END FOR  
        RETURN ans  
    END FUNCTION  
END CLASS