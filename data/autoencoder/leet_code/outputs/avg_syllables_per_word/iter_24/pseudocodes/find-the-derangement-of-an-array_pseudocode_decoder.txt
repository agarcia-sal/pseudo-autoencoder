CLASS Solution  
    FUNCTION findDerangement(n)  
        SET MOD TO one billion PLUS seven  
        IF n EQUALS one THEN  
            RETURN zero  
        END IF  
        IF n EQUALS two THEN  
            RETURN one  
        END IF  
        SET prev2 TO one  
        SET prev1 TO zero  
        FOR i FROM three TO n DO  
            SET current TO the product of the quantity i MINUS one AND the sum of prev1 AND prev2  
            SET current TO current MODULO MOD  
            SET prev2 TO prev1  
            SET prev1 TO current  
        END FOR  
        RETURN prev1  
    END FUNCTION  
END CLASS