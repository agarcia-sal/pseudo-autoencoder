CLASS Solution  
    FUNCTION longestSubsequenceRepeatedK(s parameter named s AS string, k parameter named k AS integer) RETURNS string  
        FROM collections IMPORT Counter  
        SET freq TO result of calling Counter with s parameter  
        SET valid_chars TO empty list  
        FOR each character named char AND its count named count IN the items of freq  
            IF count IS GREATER THAN OR EQUAL TO k  
                APPEND char TO valid_chars  
            END IF  
        END FOR  
        SORT valid_chars IN descending lexicographical order  
        
        FUNCTION is_valid_subsequence(candidate parameter named candidate AS string) RETURNS boolean  
            SET count TO zero  
            SET index TO zero  
            FOR each character named char IN s  
                IF char EQUALS element at position index of candidate  
                    INCREMENT index BY one  
                    IF index EQUALS the LENGTH OF candidate  
                        INCREMENT count BY one  
                        SET index TO zero  
                        IF count EQUALS k  
                            RETURN true  
                        END IF  
                    END IF  
                END IF  
            END FOR  
            RETURN false  
        END FUNCTION  
        
        SET max_length TO the INTEGER part of the LENGTH OF valid_chars DIVIDED BY k  
        SET best_candidate TO empty string  
        
        FUNCTION backtrack(candidate parameter named candidate AS string)  
            IF the LENGTH OF candidate IS GREATER THAN the LENGTH OF best_candidate  
                SET best_candidate TO candidate  
            END IF  
            FOR each character named char IN valid_chars  
                SET new_candidate TO concatenation of candidate FOLLOWED BY char  
                IF is_valid_subsequence(new_candidate) IS true  
                    CALL backtrack WITH new_candidate  
                END IF  
            END FOR  
        END FUNCTION  
        
        CALL backtrack WITH empty string  
        RETURN best_candidate  
    END FUNCTION  
END CLASS