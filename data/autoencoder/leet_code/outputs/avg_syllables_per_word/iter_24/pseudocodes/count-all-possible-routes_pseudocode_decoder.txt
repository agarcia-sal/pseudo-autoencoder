CLASS Solution  
    FUNCTION countRoutes(locations parameter LIST OF integers, start parameter integer, finish parameter integer, fuel parameter integer) RETURNS integer  
        SET MOD TO ten TO THE POWER OF nine PLUS seven  
        SET n TO the LENGTH OF locations  
        
        FUNCTION dp(city parameter integer, remaining_fuel parameter integer) RETURNS integer  
            IF remaining_fuel LESS THAN zero THEN  
                RETURN zero  
            END IF  
            SET routes TO zero  
            IF city EQUALS finish THEN  
                SET routes TO one  
            END IF  
            FOR each next_city FROM zero TO n MINUS one  
                IF next_city NOT EQUALS city THEN  
                    SET fuel_cost TO the ABSOLUTE VALUE OF the difference BETWEEN element at position city of locations MINUS element at position next_city of locations  
                    IF remaining_fuel GREATER THAN OR EQUAL TO fuel_cost THEN  
                        SET routes TO the sum of routes PLUS dp called with next_city and remaining_fuel MINUS fuel_cost THEN the REMAINDER OF division BY MOD  
                    END IF  
                END IF  
            END FOR  
            RETURN routes  
        END FUNCTION  
        
        RETURN dp called with start and fuel  
    END FUNCTION  
END CLASS