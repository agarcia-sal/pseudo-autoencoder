CLASS Solution  
    FUNCTION minOperationsToFlip(expression)  
        SET stack TO an empty list  

        FOR each element e IN expression  
            IF element e EQUALS an opening parenthesis OR element e EQUALS ampersand OR element e EQUALS vertical bar  
                APPEND a pair of element e AND zero TO stack  
                CONTINUE to the next iteration  
            END IF  
            IF element e EQUALS a closing parenthesis  
                SET lastPair TO the last element REMOVED FROM stack  
                REMOVE the last element FROM stack  
            ELSE  
                SET lastPair TO a pair of element e AND one  
            END IF  
            IF stack is not empty AND the first part of the last element of stack EQUALS ampersand OR vertical bar  
                SET op TO the first part of the last element REMOVED FROM stack  
                SET variable a TO the first part of the last element REMOVED FROM stack  
                SET variable costA TO the second part of the same element  
                SET variable b TO the first part of lastPair  
                SET variable costB TO the second part of lastPair  

                IF operator op EQUALS ampersand  
                    IF variable a EQUALS character zero AND variable b EQUALS character zero  
                        SET lastPair TO a pair of character zero AND one PLUS the smaller of costA AND costB  
                    ELSE IF variable a EQUALS character zero AND variable b EQUALS character one  
                        SET lastPair TO a pair of character zero AND one  
                    ELSE IF variable a EQUALS character one AND variable b EQUALS character zero  
                        SET lastPair TO a pair of character zero AND one  
                    ELSE  
                        SET lastPair TO a pair of character one AND the smaller of costA AND costB  
                    END IF  
                ELSE  
                    IF variable a EQUALS character zero AND variable b EQUALS character zero  
                        SET lastPair TO a pair of character zero AND the smaller of costA AND costB  
                    ELSE IF variable a EQUALS character zero AND variable b EQUALS character one  
                        SET lastPair TO a pair of character one AND one  
                    ELSE IF variable a EQUALS character one AND variable b EQUALS character zero  
                        SET lastPair TO a pair of character one AND one  
                    ELSE  
                        SET lastPair TO a pair of character one AND one PLUS the smaller of costA AND costB  
                    END IF  
                END IF  
            END IF  
            APPEND lastPair TO stack  
        END FOR  

        RETURN the second part of the last element of stack  
    END FUNCTION  
END CLASS