CLASS Solution  
    FUNCTION kthSmallestProduct(nums1 PARAMETER, nums2 PARAMETER, k PARAMETER)  
        FUNCTION count(p PARAMETER)  
            SET cnt TO zero  
            SET n TO the LENGTH OF nums2  
            FOR each x IN nums1  
                IF x GREATER THAN zero  
                    INCREMENT cnt BY the POSITION to the RIGHT in nums2 of the HIGHEST element LESS THAN OR EQUAL TO the VALUE of p DIVIDED BY x  
                ELSE IF x LESS THAN zero  
                    INCREMENT cnt BY n MINUS the POSITION to the LEFT in nums2 of the LOWEST element GREATER THAN OR EQUAL TO the VALUE of p DIVIDED BY x  
                ELSE  
                    IF p GREATER THAN OR EQUAL TO zero  
                        INCREMENT cnt BY n  
                    ELSE  
                        DO NOTHING  
                    END IF  
                END IF  
            END FOR  
            RETURN cnt  
        END FUNCTION  

        SET mx TO the MAXIMUM of the ABSOLUTE VALUE OF the FIRST element of nums1 AND the ABSOLUTE VALUE OF the LAST element of nums1 MULTIPLIED BY the MAXIMUM of the ABSOLUTE VALUE OF the FIRST element of nums2 AND the ABSOLUTE VALUE OF the LAST element of nums2  
        RETURN the POSITION to the LEFT in the RANGE from NEGATIVE mx TO POSITIVE mx PLUS one WHERE the VALUE of k would be INSERTED ACCORDING TO THE VALUE RETURNED BY count MINUS mx  
    END FUNCTION  
END CLASS