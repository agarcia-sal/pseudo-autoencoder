CLASS UnionFind  
    FUNCTION __init__(self, size)  
        SET parent TO a list of integers from zero TO size MINUS one inclusive  
    END FUNCTION  
  
    FUNCTION find(self, u)  
        IF element at position u of parent NOT EQUALS u THEN  
            SET element at position u of parent TO the result of find called with element at position u of parent  
        END IF  
        RETURN element at position u of parent  
    END FUNCTION  
  
    FUNCTION union(self, u, v)  
        SET root_u TO the result of find called with u  
        SET root_v TO the result of find called with v  
        IF root_u NOT EQUALS root_v THEN  
            SET element at position root_u of parent TO root_v  
        END IF  
    END FUNCTION  
END CLASS  
  
CLASS Solution  
    FUNCTION matrixRankTransform(self, matrix)  
        SET m TO the LENGTH OF matrix  
        SET n TO the LENGTH OF element at position zero of matrix  
        SET value_to_indices TO a default dictionary mapping to empty list  
  
        FOR r FROM zero TO m MINUS one  
            FOR c FROM zero TO n MINUS one  
                APPEND the pair consisting of r and c TO the element at position element at position r of matrix at position c of value_to_indices  
            END FOR  
        END FOR  
  
        SET row_rank TO a list of zeros of length m  
        SET col_rank TO a list of zeros of length n  
        SET result TO a list containing m elements each being a list of zeros of length n  
  
        FOR each value IN the keys of value_to_indices sorted in ascending order  
            SET uf TO a new UnionFind instantiated with the sum of m and n  
            SET rank TO a default dictionary mapping to zero  
  
            FOR each pair consisting of r and c IN the element at position value of value_to_indices  
                CALL uf union with r and sum of c and m  
            END FOR  
  
            FOR each pair consisting of r and c IN the element at position value of value_to_indices  
                SET root TO the result of uf find called with r  
                SET element at position root of rank TO the maximum of element at position root of rank AND the maximum of element at position r of row_rank AND element at position c of col_rank PLUS one  
            END FOR  
  
            FOR each pair consisting of r and c IN the element at position value of value_to_indices  
                SET root TO the result of uf find called with r  
                SET element at position r at position c of result TO element at position root of rank  
                SET element at position r of row_rank TO element at position root of rank  
                SET element at position c of col_rank TO element at position root of rank  
            END FOR  
        END FOR  
  
        RETURN result  
    END FUNCTION  
END CLASS