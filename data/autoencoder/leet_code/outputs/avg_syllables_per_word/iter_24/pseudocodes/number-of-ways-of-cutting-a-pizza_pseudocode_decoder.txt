CLASS Solution  
    FUNCTION ways(pizza, k)  
        FUNCTION dfs(i, j, k)  
            IF k EQUALS zero  
                IF the number of apples in the sub-pizza defined by rows from position i plus one TO position m and columns from position j plus one TO position n is GREATER THAN zero  
                    RETURN one  
                ELSE  
                    RETURN zero  
                END IF  
            END IF  
            SET ans TO zero  
            FOR each x FROM i plus one TO m minus one  
                IF the number of apples in the sub-pizza defined by rows from position x plus one TO position m and columns from position j plus one TO position n is GREATER THAN zero  
                    INCREMENT ans BY dfs(x, j, k MINUS one)  
                END IF  
            END FOR  
            FOR each y FROM j plus one TO n minus one  
                IF the number of apples in the sub-pizza defined by rows from position i plus one TO position m and columns from position y plus one TO position n is GREATER THAN zero  
                    INCREMENT ans BY dfs(i, y, k MINUS one)  
                END IF  
            END FOR  
            RETURN ans MODULO mod  
        END FUNCTION  

        SET mod TO one billion PLUS seven  
        SET m TO the number of elements in pizza  
        SET n TO the number of elements in the first element of pizza  
        INITIALIZE s AS a two dimensional list with m plus one rows and n plus one columns filled with zeros  
        FOR each i and row value in pizza starting counting from one  
            FOR each j and character c in row starting counting from one  
                SET the element at position i and j of s TO the element at position i minus one and j of s PLUS the element at position i and j minus one of s MINUS the element at position i minus one and j minus one of s PLUS one if c EQUALS the capital letter A otherwise zero  
            END FOR  
        END FOR  
        RETURN dfs(zero, zero, k MINUS one)  
    END FUNCTION  
END CLASS