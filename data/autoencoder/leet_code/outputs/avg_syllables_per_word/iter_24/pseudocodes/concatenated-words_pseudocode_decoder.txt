CLASS Trie  
    FUNCTION __init__()  
        SET children TO list of None repeated twenty six times  
        SET is_end TO False  
    END FUNCTION  

    FUNCTION insert(w)  
        SET node TO this object  
        FOR each character c IN w  
            SET idx TO Unicode code of character c MINUS Unicode code of character a  
            IF element at position idx of node children EQUALS None  
                ASSIGN reference at position idx of node children TO new Trie object  
            END IF  
            ASSIGN reference node TO element at position idx of node children  
        END FOR  
        SET node is_end TO True  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION findAllConcatenatedWordsInADict(words)  
        FUNCTION dfs(w, start)  
            IF start EQUALS the LENGTH OF w  
                RETURN True  
            END IF  
            SET node TO reference trie  
            FOR integer i FROM start TO the LENGTH OF w MINUS one  
                SET idx TO Unicode code of element at position i of w MINUS Unicode code of character a  
                IF element at position idx of node children EQUALS None  
                    RETURN False  
                END IF  
                ASSIGN reference node TO element at position idx of node children  
                IF node is_end EQUALS True AND dfs(w, i PLUS one) EQUALS True  
                    RETURN True  
                END IF  
            END FOR  
            RETURN False  
        END FUNCTION  

        ASSIGN reference trie TO new Trie object  
        SET ans TO empty list  
        SORT words BY their LENGTH in ascending order  
        FOR each word w IN words  
            IF w DOES NOT HAVE zero LENGTH  
                IF dfs(w, zero) EQUALS True  
                    APPEND w TO ans  
                ELSE  
                    CALL trie insert with argument w  
                END IF  
            END IF  
        END FOR  
        RETURN ans  
    END FUNCTION  
END CLASS