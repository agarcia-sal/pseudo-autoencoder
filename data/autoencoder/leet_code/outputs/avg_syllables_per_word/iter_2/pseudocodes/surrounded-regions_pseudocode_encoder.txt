CLASS Solution
    FUNCTION solve(board)
        IF board IS empty OR board[0] IS empty
            RETURN

        SET m TO LENGTH OF board
        SET n TO LENGTH OF board[0]

        FUNCTION dfs(x, y)
            IF x < 0 OR x >= m OR y < 0 OR y >= n OR board[x][y] IS NOT 'O'
                RETURN
            SET board[x][y] TO 'S'
            CALL dfs(x + 1, y)
            CALL dfs(x - 1, y)
            CALL dfs(x, y + 1)
            CALL dfs(x, y - 1)
        END FUNCTION

        FOR i FROM 0 TO m - 1
            CALL dfs(i, 0)
            CALL dfs(i, n - 1)

        FOR j FROM 0 TO n - 1
            CALL dfs(0, j)
            CALL dfs(m - 1, j)

        FOR i FROM 0 TO m - 1
            FOR j FROM 0 TO n - 1
                IF board[i][j] IS 'O'
                    SET board[i][j] TO 'X'

        FOR i FROM 0 TO m - 1
            FOR j FROM 0 TO n - 1
                IF board[i][j] IS 'S'
                    SET board[i][j] TO 'O'
    END FUNCTION
END CLASS