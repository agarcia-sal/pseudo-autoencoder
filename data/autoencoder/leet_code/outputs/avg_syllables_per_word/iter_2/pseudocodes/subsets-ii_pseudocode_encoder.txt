CLASS Solution
    FUNCTION subsetsWithDup(nums)
        SORT nums
        SET result TO empty list
        SET subset TO empty list

        FUNCTION dfs(i)
            IF i GREATER THAN OR EQUAL TO LENGTH OF nums THEN
                APPEND COPY OF subset TO result
                RETURN
            END IF

            APPEND nums[i] TO subset
            CALL dfs(i PLUS 1)

            REMOVE last element FROM subset
            WHILE i PLUS 1 LESS THAN LENGTH OF nums AND nums[i] EQUALS nums[i PLUS 1] DO
                INCREMENT i BY 1
            END WHILE
            CALL dfs(i PLUS 1)
        END FUNCTION

        CALL dfs(0)
        RETURN result
    END FUNCTION
END CLASS