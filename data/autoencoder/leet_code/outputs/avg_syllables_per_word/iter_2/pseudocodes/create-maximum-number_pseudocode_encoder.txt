CLASS Solution
    FUNCTION maxNumber(nums1, nums2, k)
        FUNCTION maxSingleArray(nums, k)
            SET drop TO LENGTH OF nums MINUS k
            SET stack TO empty list
            FOR each num IN nums
                WHILE drop GREATER THAN 0 AND stack IS NOT empty AND last element of stack LESS THAN num
                    REMOVE last element FROM stack
                    DECREMENT drop BY 1
                END WHILE
                APPEND num TO stack
            END FOR
            RETURN first k elements OF stack
        END FUNCTION

        FUNCTION merge(arr1, arr2)
            SET merged_list TO empty list
            FOR total length FROM 1 TO LENGTH OF arr1 PLUS LENGTH OF arr2
                IF arr1 IS GREATER THAN arr2
                    APPEND first element OF arr1 TO merged_list
                    REMOVE first element FROM arr1
                ELSE
                    APPEND first element OF arr2 TO merged_list
                    REMOVE first element FROM arr2
                END IF
            END FOR
            RETURN merged_list
        END FUNCTION

        SET max_number TO empty list
        FOR i FROM 0 TO k
            IF i LESS THAN OR EQUAL TO LENGTH OF nums1 AND k MINUS i LESS THAN OR EQUAL TO LENGTH OF nums2
                SET candidate TO merge(maxSingleArray(nums1, i), maxSingleArray(nums2, k MINUS i))
                SET max_number TO maximum BETWEEN max_number AND candidate
            END IF
        END FOR
        RETURN max_number
    END FUNCTION
END CLASS