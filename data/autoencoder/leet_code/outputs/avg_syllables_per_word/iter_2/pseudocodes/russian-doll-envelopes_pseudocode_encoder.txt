CLASS Solution
    FUNCTION maxEnvelopes(envelopes)
        SORT envelopes BY width ASCENDING AND height DESCENDING
        SET dp TO empty list
        FOR EACH envelope IN envelopes
            SET h TO height of envelope
            SET idx TO POSITION TO INSERT h IN dp USING BINARY SEARCH (leftmost)
            IF idx EQUALS LENGTH OF dp THEN
                APPEND h TO dp
            ELSE
                SET dp[idx] TO h
        RETURN LENGTH OF dp
    END FUNCTION
END CLASS