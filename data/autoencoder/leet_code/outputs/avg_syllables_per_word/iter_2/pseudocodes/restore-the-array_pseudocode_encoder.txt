```
CLASS Solution
    FUNCTION numberOfArrays(s, k)
        SET MOD TO 10^9 + 7
        SET n TO LENGTH OF s
        SET dp TO LIST OF ZEROS WITH LENGTH n + 1
        SET dp[0] TO 1

        FOR i FROM 1 TO n
            FOR j FROM 0 TO i - 1
                IF s[j] IS NOT '0' AND VALUE OF s SUBSTRING FROM j TO i IS BETWEEN 1 AND k
                    SET dp[i] TO (dp[i] + dp[j]) MODULO MOD
        RETURN dp[n]
    END FUNCTION
END CLASS
```