CLASS Solution
    FUNCTION lengthOfLongestSubstringTwoDistinct(s)
        SET char_count TO empty dictionary with default integer values
        SET left TO 0
        SET max_length TO 0
        FOR right FROM 0 TO LENGTH OF s MINUS 1
            INCREMENT char_count AT s[right] BY 1
            WHILE NUMBER OF KEYS IN char_count IS GREATER THAN 2
                DECREMENT char_count AT s[left] BY 1
                IF char_count AT s[left] IS 0
                    REMOVE s[left] FROM char_count
                INCREMENT left BY 1
            END WHILE
            SET max_length TO GREATER OF max_length AND (right MINUS left PLUS 1)
        END FOR
        RETURN max_length
    END FUNCTION
END CLASS