CLASS Solution
    FUNCTION tilingRectangle(n, m)
        FUNCTION backtrack(heights, moves)
            IF all heights EQUAL TO n THEN
                SET min_moves TO minimum OF min_moves AND moves
                RETURN
            END IF
            
            IF moves GREATER THAN OR EQUAL TO min_moves THEN
                RETURN
            END IF
            
            SET min_height TO minimum OF heights
            SET left TO index OF min_height IN heights
            SET right TO left
            WHILE right LESS THAN m AND heights[right] EQUAL TO min_height DO
                INCREMENT right BY 1
            END WHILE
            
            FOR size FROM (right MINUS left) DOWN TO 1 DO
                IF for all i IN 0 TO size MINUS 1, heights[left PLUS i] PLUS size LESS THAN OR EQUAL TO n THEN
                    SET new_heights TO copy OF heights
                    FOR i FROM 0 TO size MINUS 1 DO
                        INCREMENT new_heights[left PLUS i] BY size
                    END FOR
                    CALL backtrack(new_heights, moves PLUS 1)
                END IF
            END FOR
        END FUNCTION
        
        SET min_moves TO infinity
        CALL backtrack(list OF zeros WITH length m, 0)
        RETURN min_moves
    END FUNCTION
END CLASS