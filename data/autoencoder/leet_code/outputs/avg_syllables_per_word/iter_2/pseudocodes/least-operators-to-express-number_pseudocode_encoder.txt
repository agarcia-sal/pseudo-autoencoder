CLASS Solution
    FUNCTION leastOpsExpressTarget(x, target)
        FUNCTION dp(target)
            IF target EQUALS 0 THEN
                RETURN -1
            END IF
            IF target LESS THAN x THEN
                RETURN MINIMUM OF (2 TIMES target MINUS 1) AND (2 TIMES (x MINUS target))
            END IF

            SET power TO 1
            WHILE x TO THE POWER OF power LESS THAN OR EQUAL TO target DO
                INCREMENT power BY 1
            END WHILE
            DECREMENT power BY 1

            SET res TO dp(target MINUS x TO THE POWER OF power) PLUS power

            IF (x TO THE POWER OF (power PLUS 1) MINUS target) LESS THAN target THEN
                SET res TO MINIMUM OF res AND dp(x TO THE POWER OF (power PLUS 1) MINUS target) PLUS power PLUS 1
            END IF

            RETURN res
        END FUNCTION

        RETURN dp(target)
    END FUNCTION
END CLASS