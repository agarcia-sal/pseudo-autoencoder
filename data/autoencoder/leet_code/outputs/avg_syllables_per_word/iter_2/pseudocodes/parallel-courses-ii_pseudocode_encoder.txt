```
CLASS Solution
    FUNCTION minNumberOfSemesters(n, relations, k)
        SET graph TO default dictionary of lists
        SET in_degree TO list of zeros with length n + 1
        
        FOR each (prevCourse, nextCourse) IN relations
            APPEND nextCourse TO graph[prevCourse]
            INCREMENT in_degree[nextCourse] BY 1
        
        SET queue TO empty deque
        FOR course FROM 1 TO n
            IF in_degree[course] EQUALS 0
                APPEND course TO queue
        
        SET semesters TO 0
        
        WHILE queue IS NOT empty
            FOR index FROM 1 TO minimum of k and LENGTH OF queue
                SET current_course TO REMOVE first element FROM queue
                FOR each next_course IN graph[current_course]
                    DECREMENT in_degree[next_course] BY 1
                    IF in_degree[next_course] EQUALS 0
                        APPEND next_course TO queue
            INCREMENT semesters BY 1
        
        RETURN semesters
    END FUNCTION
END CLASS
```