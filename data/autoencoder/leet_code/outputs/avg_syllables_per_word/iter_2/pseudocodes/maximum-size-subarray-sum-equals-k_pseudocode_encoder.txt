CLASS Solution
    FUNCTION maxSubArrayLen(nums, k)
        SET cumulative_sum_index TO dictionary with key 0 and value -1
        SET cumulative_sum TO 0
        SET max_length TO 0
        FOR each index i and element num IN nums
            INCREMENT cumulative_sum BY num
            IF cumulative_sum MINUS k EXISTS AS KEY IN cumulative_sum_index THEN
                SET max_length TO maximum OF max_length AND (i MINUS cumulative_sum_index[cumulative_sum MINUS k])
            END IF
            IF cumulative_sum NOT EXISTS AS KEY IN cumulative_sum_index THEN
                SET cumulative_sum_index[cumulative_sum] TO i
            END IF
        END FOR
        RETURN max_length
    END FUNCTION
END CLASS