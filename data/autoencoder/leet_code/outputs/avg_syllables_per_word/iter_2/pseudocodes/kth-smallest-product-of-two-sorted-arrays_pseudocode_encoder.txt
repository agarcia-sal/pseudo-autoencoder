CLASS Solution
    FUNCTION kthSmallestProduct(nums1, nums2, k)
        FUNCTION count(p)
            SET cnt TO 0
            SET n TO LENGTH OF nums2
            FOR each x IN nums1
                IF x > 0 THEN
                    INCREMENT cnt BY bisect_right(nums2, p DIVIDED BY x)
                ELSE IF x < 0 THEN
                    INCREMENT cnt BY n MINUS bisect_left(nums2, p DIVIDED BY x)
                ELSE
                    INCREMENT cnt BY n TIMES (p GREATER THAN OR EQUAL TO 0)
            RETURN cnt
        END FUNCTION

        SET mx TO MAXIMUM OF ABSOLUTE VALUE OF nums1 FIRST ELEMENT AND nums1 LAST ELEMENT
        SET mx TO mx TIMES MAXIMUM OF ABSOLUTE VALUE OF nums2 FIRST ELEMENT AND nums2 LAST ELEMENT
        RETURN bisect_left(range FROM NEGATIVE mx TO POSITIVE mx INCLUSIVE, k, key=count) MINUS mx
    END FUNCTION
END CLASS