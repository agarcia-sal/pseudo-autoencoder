CLASS Solution
    FUNCTION countRoutes(locations, start, finish, fuel)
        SET MOD TO 10 POWER 9 PLUS 7
        SET n TO LENGTH OF locations

        FUNCTION dp(city, remaining_fuel) WITH CACHE
            IF remaining_fuel LESS THAN 0 THEN
                RETURN 0
            SET routes TO 0
            IF city EQUALS finish THEN
                SET routes TO 1
            FOR next_city FROM 0 TO n MINUS 1
                IF next_city NOT EQUALS city THEN
                    SET fuel_cost TO ABSOLUTE VALUE OF (locations AT city MINUS locations AT next_city)
                    IF remaining_fuel GREATER THAN OR EQUAL TO fuel_cost THEN
                        SET routes TO (routes PLUS dp(next_city, remaining_fuel MINUS fuel_cost)) MODULO MOD
            RETURN routes
        END FUNCTION

        RETURN dp(start, fuel)
    END FUNCTION
END CLASS