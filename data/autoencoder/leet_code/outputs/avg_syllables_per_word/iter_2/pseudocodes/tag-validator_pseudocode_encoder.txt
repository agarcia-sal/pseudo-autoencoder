```
CLASS Solution
    FUNCTION isValid(code)
        SET cdata_pattern TO '<!\[CDATA\[.*?\]\]>'
        REMOVE all substrings matching cdata_pattern FROM code
        
        SET stack TO empty list
        SET i TO 0
        
        WHILE i LESS THAN LENGTH OF code
            IF character at code[i] IS '<' THEN
                SET j TO position of next '>' in code after i
                IF j IS -1 THEN
                    RETURN False
                
                SET tag_content TO substring of code from i + 1 TO j - 1
                
                IF tag_content IS empty THEN
                    RETURN False
                
                IF first character of tag_content IS '/' THEN
                    SET tag_name TO substring of tag_content from 1 TO end
                    IF stack IS empty OR last element of stack IS NOT tag_name THEN
                        RETURN False
                    REMOVE last element from stack
                ELSE IF first character of tag_content IS '!' THEN
                    RETURN False
                ELSE
                    IF LENGTH of tag_content IS LESS THAN 1 OR GREATER THAN 9 OR tag_content IS NOT all uppercase THEN
                        RETURN False
                    ADD tag_content TO stack
                
                SET i TO j + 1
            ELSE
                INCREMENT i BY 1
        
        SET has_valid_tag TO whether code contains any substring matching pattern '<[A-Z]+>.*</[A-Z]+>'
        RETURN True IF stack IS empty AND has_valid_tag IS True, OTHERWISE False
    END FUNCTION
END CLASS
```