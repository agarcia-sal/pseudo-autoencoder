CLASS Solution
    FUNCTION candyCrush(board)
        SET R TO LENGTH OF board
        SET C TO LENGTH OF board[0]
        SET stable TO False
        
        WHILE NOT stable
            SET stable TO True
            SET to_crush TO empty set
            
            FOR r FROM 0 TO R - 1
                FOR c FROM 0 TO C - 3
                    IF ABSOLUTE VALUE OF board[r][c] EQUALS ABSOLUTE VALUE OF board[r][c + 1] 
                       AND EQUALS ABSOLUTE VALUE OF board[r][c + 2] 
                       AND board[r][c] IS NOT 0
                        SET stable TO False
                        ADD (r, c), (r, c + 1), (r, c + 2) TO to_crush
            
            FOR r FROM 0 TO R - 3
                FOR c FROM 0 TO C - 1
                    IF ABSOLUTE VALUE OF board[r][c] EQUALS ABSOLUTE VALUE OF board[r + 1][c] 
                       AND EQUALS ABSOLUTE VALUE OF board[r + 2][c] 
                       AND board[r][c] IS NOT 0
                        SET stable TO False
                        ADD (r, c), (r + 1, c), (r + 2, c) TO to_crush
            
            FOR EACH (r, c) IN to_crush
                SET board[r][c] TO 0
            
            FOR c FROM 0 TO C - 1
                SET wr TO R - 1
                FOR r FROM R - 1 DOWNTO 0
                    IF board[r][c] IS NOT 0
                        SET board[wr][c] TO board[r][c]
                        DECREMENT wr BY 1
                FOR wr FROM wr DOWNTO 0
                    SET board[wr][c] TO 0
        
        RETURN board
    END FUNCTION
END CLASS