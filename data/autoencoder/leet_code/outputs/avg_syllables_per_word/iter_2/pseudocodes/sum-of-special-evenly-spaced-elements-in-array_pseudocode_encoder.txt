```
CLASS Solution
    FUNCTION solve(nums: List of Integer, queries: List of List of Integer) RETURNS List of Integer
        SET MOD TO 10^9 + 7
        SET n TO LENGTH OF nums
        
        SET max_y TO MAXIMUM y FROM EACH (_, y) IN queries
        SET prefix_sums TO LIST OF LISTS WITH DIMENSIONS (max_y + 1) BY n FILLED WITH 0
        
        FOR y FROM 1 TO max_y
            FOR i FROM n - 1 DOWN TO 0
                IF i + y LESS THAN n THEN
                    SET prefix_sums[y][i] TO nums[i] PLUS prefix_sums[y][i + y]
                ELSE
                    SET prefix_sums[y][i] TO nums[i]
        
        SET answer TO EMPTY LIST
        FOR EACH (x, y) IN queries
            APPEND prefix_sums[y][x] MODULO MOD TO answer
        
        RETURN answer
    END FUNCTION
END CLASS
```