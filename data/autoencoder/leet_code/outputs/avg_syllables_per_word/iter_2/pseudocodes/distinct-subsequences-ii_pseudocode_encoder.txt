CLASS Solution
    FUNCTION distinctSubseqII(s)
        SET MOD TO 10 TO THE POWER OF 9 PLUS 7
        SET n TO LENGTH OF s
        SET dp TO LIST OF SIZE n PLUS 1 FILLED WITH 0
        SET dp[0] TO 1
        SET last TO EMPTY DICTIONARY

        FOR i FROM 1 TO n
            SET char TO s AT POSITION i MINUS 1
            SET dp[i] TO (2 TIMES dp[i MINUS 1]) MODULO MOD
            
            IF char IS IN last
                SET dp[i] TO (dp[i] MINUS dp[last[char] MINUS 1] PLUS MOD) MODULO MOD
            
            SET last[char] TO i
        
        RETURN (dp[n] MINUS 1) MODULO MOD
    END FUNCTION
END CLASS