CLASS Solution
    FUNCTION shortestWordDistance(wordsDict, word1, word2)
        SET min_distance TO infinity
        SET prev_word1 TO -1
        SET prev_word2 TO -1
        SET same_word TO (word1 EQUALS word2)
        
        FOR index, word IN wordsDict WITH INDEX
            IF word EQUALS word1 THEN
                IF same_word THEN
                    SET prev_word2 TO prev_word1
                END IF
                SET prev_word1 TO index
            END IF
            
            IF word EQUALS word2 THEN
                IF NOT same_word THEN
                    SET prev_word2 TO index
                END IF
            END IF
            
            IF prev_word1 NOT EQUAL TO -1 AND prev_word2 NOT EQUAL TO -1 THEN
                SET distance TO ABSOLUTE VALUE OF (prev_word1 MINUS prev_word2)
                SET min_distance TO MINIMUM OF min_distance AND distance
            END IF
        END FOR
        
        RETURN min_distance
    END FUNCTION
END CLASS