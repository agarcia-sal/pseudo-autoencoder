```
CLASS Solution
    FUNCTION numberOfCombinations(num)
        SET MOD TO 10^9 + 7
        SET n TO LENGTH OF num
        SET memo TO EMPTY DICTIONARY

        FUNCTION dp(index, prev_len)
            IF index EQUALS n THEN
                RETURN 1
            IF (index, prev_len) EXISTS IN memo THEN
                RETURN memo[(index, prev_len)]

            SET count TO 0
            FOR length FROM 1 TO (n - index)
                IF num[index] EQUALS '0' THEN
                    BREAK
                SET current_num TO SUBSTRING OF num FROM index TO (index + length)

                IF prev_len EQUALS 0 OR current_num IS GREATER THAN OR EQUAL TO SUBSTRING OF num FROM (index - prev_len) TO index THEN
                    SET count TO (count + dp(index + length, length)) MODULO MOD

            SET memo[(index, prev_len)] TO count
            RETURN count
        END FUNCTION

        RETURN dp(0, 0)
    END FUNCTION
END CLASS
```