```
CLASS Solution
    FUNCTION containVirus(isInfected)
        FUNCTION neighbors(r, c)
            RETURN list of coordinates [(r+1, c), (r-1, c), (r, c+1), (r, c-1)]
        END FUNCTION

        FUNCTION bfs(r, c)
            SET infected TO empty set
            SET threatened TO empty set
            SET queue TO deque containing (r, c)
            SET visited TO set containing (r, c)
            WHILE queue is not empty
                SET x, y TO queue front element and remove it
                ADD (x, y) TO infected
                FOR each neighbor (nx, ny) IN neighbors(x, y)
                    IF nx within [0, m) AND ny within [0, n) AND (nx, ny) not in visited THEN
                        ADD (nx, ny) TO visited
                        IF isInfected[nx][ny] EQUALS 1 THEN
                            APPEND (nx, ny) TO queue
                        ELSE IF isInfected[nx][ny] EQUALS 0 THEN
                            ADD (nx, ny) TO threatened
            RETURN infected, threatened
        END FUNCTION

        FUNCTION build_walls(infected)
            SET walls TO 0
            FOR each (x, y) IN infected
                FOR each (nx, ny) IN neighbors(x, y)
                    IF nx within [0, m) AND ny within [0, n) AND isInfected[nx][ny] EQUALS 0 THEN
                        INCREMENT walls BY 1
            RETURN walls
        END FUNCTION

        FUNCTION spread_virus(threatened)
            FOR each (x, y) IN threatened
                SET isInfected[x][y] TO 1
        END FUNCTION

        SET m TO number of rows in isInfected
        SET n TO number of columns in isInfected
        SET total_walls TO 0

        WHILE TRUE
            SET regions TO empty list
            SET visited TO empty set
            FOR r FROM 0 TO m - 1
                FOR c FROM 0 TO n - 1
                    IF isInfected[r][c] EQUALS 1 AND (r, c) not in visited THEN
                        SET infected, threatened TO bfs(r, c)
                        APPEND (infected, threatened) TO regions
                        SET visited TO union of visited and infected

            IF regions is empty THEN
                BREAK

            SORT regions by descending size of threatened sets

            INCREMENT total_walls BY build_walls(regions[0].infected)
            FOR each (x, y) IN regions[0].infected
                SET isInfected[x][y] TO -1

            FOR i FROM 1 TO length of regions - 1
                spread_virus(regions[i].threatened)

        RETURN total_walls
    END FUNCTION
END CLASS
```