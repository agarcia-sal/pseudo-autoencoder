CLASS Solution
    FUNCTION maxNumOfSubstrings(s)
        SET first TO empty dictionary
        SET last TO empty dictionary
        FOR i FROM 0 TO LENGTH OF s MINUS 1
            SET c TO s[i]
            IF c NOT IN first
                SET first[c] TO i
            SET last[c] TO i
        END FOR

        SET intervals TO empty list
        FOR each c IN first KEYS
            SET start TO first[c]
            SET end TO last[c]
            SET i TO start
            WHILE i <= end
                IF first[s[i]] < start
                    BREAK WHILE
                SET end TO MAXIMUM OF end AND last[s[i]]
                INCREMENT i BY 1
            ELSE
                APPEND (start, end) TO intervals
            END WHILE
        END FOR

        SORT intervals BY their end value in ascending order

        SET result TO empty list
        SET prev_end TO -1
        FOR each (start, end) IN intervals
            IF start > prev_end
                APPEND SUBSTRING OF s FROM start TO end TO result
                SET prev_end TO end
        END FOR

        RETURN result
    END FUNCTION
END CLASS