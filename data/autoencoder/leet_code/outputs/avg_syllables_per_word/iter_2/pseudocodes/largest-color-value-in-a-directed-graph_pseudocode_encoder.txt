CLASS Solution
    FUNCTION largestPathValue(colors, edges)
        SET n TO LENGTH OF colors
        SET graph TO empty map with default empty list
        SET in_degree TO list of zeros with length n

        FOR each pair u, v IN edges
            APPEND v TO graph[u]
            INCREMENT in_degree[v] BY 1

        SET queue TO list of i for i in range n where in_degree[i] IS 0
        SET dp TO a list of n lists each with 26 zeros
        SET visited TO 0
        SET max_color_value TO 0

        WHILE queue IS NOT empty
            SET node TO REMOVE first element FROM queue
            INCREMENT dp[node][ASCII value of colors[node] MINUS ASCII value of 'a'] BY 1
            SET max_color_value TO maximum of max_color_value AND dp[node][ASCII value of colors[node] MINUS ASCII value of 'a']
            INCREMENT visited BY 1

            FOR each neighbor IN graph[node]
                FOR c FROM 0 TO 25
                    SET dp[neighbor][c] TO maximum of dp[neighbor][c] AND dp[node][c]
                DECREMENT in_degree[neighbor] BY 1
                IF in_degree[neighbor] IS 0
                    APPEND neighbor TO queue

        IF visited EQUALS n
            RETURN max_color_value
        ELSE
            RETURN -1
    END FUNCTION
END CLASS