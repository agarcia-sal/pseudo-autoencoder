CLASS Solution
    FUNCTION numMagicSquaresInside(grid)
        FUNCTION is_magic(i, j)
            IF grid[i][j] NOT EQUAL TO 5 THEN
                RETURN False
            END IF

            SET numbers TO empty set
            FOR x FROM i-1 TO i+1
                FOR y FROM j-1 TO j+1
                    IF grid[x][y] LESS THAN 1 OR grid[x][y] GREATER THAN 9 OR grid[x][y] IN numbers THEN
                        RETURN False
                    END IF
                    ADD grid[x][y] TO numbers
                END FOR
            END FOR

            FOR start FROM i-1 TO i+1
                IF (grid[start][j-1] PLUS grid[start][j] PLUS grid[start][j+1] NOT EQUAL TO 15) OR
                   (grid[i-1][start] PLUS grid[i][start] PLUS grid[i+1][start] NOT EQUAL TO 15) THEN
                    RETURN False
                END IF
            END FOR

            IF (grid[i-1][j-1] PLUS grid[i][j] PLUS grid[i+1][j+1] NOT EQUAL TO 15) OR
               (grid[i-1][j+1] PLUS grid[i][j] PLUS grid[i+1][j-1] NOT EQUAL TO 15) THEN
                RETURN False
            END IF

            RETURN True
        END FUNCTION

        SET count TO 0
        SET rows TO LENGTH OF grid
        SET cols TO LENGTH OF grid[0]

        FOR i FROM 1 TO rows MINUS 2
            FOR j FROM 1 TO cols MINUS 2
                IF is_magic(i, j) THEN
                    INCREMENT count BY 1
                END IF
            END FOR
        END FOR

        RETURN count
    END FUNCTION
END CLASS