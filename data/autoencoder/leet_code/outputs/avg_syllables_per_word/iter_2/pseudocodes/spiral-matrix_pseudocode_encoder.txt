CLASS Solution
    FUNCTION spiralOrder(matrix: List of List of Integer) RETURNS List of Integer
        IF matrix IS EMPTY OR matrix[0] IS EMPTY THEN
            RETURN empty list
        END IF

        SET result TO empty list
        SET top TO 0
        SET bottom TO LENGTH OF matrix MINUS 1
        SET left TO 0
        SET right TO LENGTH OF matrix[0] MINUS 1

        WHILE top <= bottom AND left <= right DO
            FOR i FROM left TO right DO
                APPEND matrix[top][i] TO result
            END FOR
            INCREMENT top BY 1

            FOR i FROM top TO bottom DO
                APPEND matrix[i][right] TO result
            END FOR
            DECREMENT right BY 1

            IF top <= bottom THEN
                FOR i FROM right DOWN TO left DO
                    APPEND matrix[bottom][i] TO result
                END FOR
                DECREMENT bottom BY 1
            END IF

            IF left <= right THEN
                FOR i FROM bottom DOWN TO top DO
                    APPEND matrix[i][left] TO result
                END FOR
                INCREMENT left BY 1
            END IF
        END WHILE

        RETURN result
    END FUNCTION
END CLASS