CLASS Solution
    FUNCTION countSmaller(nums)
        SET sorted_nums TO sorted unique values from nums
        SET rank TO map each value in sorted_nums to its index plus one
        
        SET bit TO list of zeros with length of sorted_nums plus one
        
        FUNCTION get_sum(idx)
            SET res TO 0
            WHILE idx greater than 0
                INCREMENT res BY bit at idx
                DECREMENT idx BY idx AND negative idx
            RETURN res
        END FUNCTION
        
        FUNCTION update(idx, delta)
            WHILE idx less than length of bit
                INCREMENT bit at idx BY delta
                INCREMENT idx BY idx AND negative idx
        END FUNCTION
        
        SET counts TO empty list
        FOR each num IN reverse order of nums
            SET r TO rank at num
            APPEND get_sum(r minus 1) TO counts
            CALL update(r, 1)
        
        RETURN reverse of counts
    END FUNCTION
END CLASS