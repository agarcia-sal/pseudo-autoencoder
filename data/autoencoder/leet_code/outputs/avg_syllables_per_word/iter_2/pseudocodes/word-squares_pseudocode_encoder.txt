CLASS Solution
    FUNCTION wordSquares(words)
        SET prefix_to_words TO empty dictionary with default value as empty list
        FOR each word IN words
            FOR i FROM 0 TO LENGTH OF word MINUS 1
                SET prefix TO first i characters of word
                APPEND word TO prefix_to_words[prefix]
        
        SET results TO empty list
        
        FUNCTION backtrack(square)
            IF LENGTH OF square EQUALS LENGTH OF words[0]
                APPEND square TO results
                RETURN
            
            SET prefix TO concatenation of character at position LENGTH OF square in each word of square
            FOR each candidate IN prefix_to_words[prefix]
                CALL backtrack(square appended with candidate)
        
        FOR each word IN words
            CALL backtrack(list containing word)
        
        RETURN results
    END FUNCTION
END CLASS