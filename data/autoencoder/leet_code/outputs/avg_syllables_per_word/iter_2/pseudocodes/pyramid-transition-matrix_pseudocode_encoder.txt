```
CLASS Solution
    FUNCTION pyramidTransition(bottom, allowed)
        SET allowed_map TO a default dictionary that maps a key to a dictionary mapping to a list

        FOR each rule IN allowed
            SET left TO first character of rule
            SET right TO second character of rule
            SET top TO third character of rule
            APPEND top TO allowed_map[left][right]
        
        FUNCTION can_build_pyramid(current_bottom, current_top)
            IF LENGTH OF current_bottom EQUALS 1
                RETURN True
            IF LENGTH OF current_top EQUALS LENGTH OF current_bottom MINUS 1
                RETURN can_build_pyramid(current_top, empty list)
            
            SET left TO character at position LENGTH OF current_top in current_bottom
            SET right TO character at position LENGTH OF current_top PLUS 1 in current_bottom
            IF left IS IN allowed_map AND right IS IN allowed_map[left]
                FOR each top IN allowed_map[left][right]
                    IF can_build_pyramid(current_bottom, current_top concatenated with top)
                        RETURN True
            RETURN False
        
        RETURN can_build_pyramid(bottom, empty list)
END CLASS
```