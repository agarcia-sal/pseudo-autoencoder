CLASS Solution
    FUNCTION countPairs(nums, k)
        SET gcd_count TO empty map from integer to integer
        
        FOR each num IN nums
            SET current_gcd TO gcd of num AND k
            INCREMENT gcd_count[current_gcd] BY 1
        END FOR
        
        SET total_pairs TO 0
        SET gcd_values TO list of keys in gcd_count
        SET n TO length of gcd_values
        
        FOR i FROM 0 TO n MINUS 1
            FOR j FROM i TO n MINUS 1
                SET gcd1 TO gcd_values[i]
                SET gcd2 TO gcd_values[j]
                IF (gcd1 MULTIPLIED BY gcd2) MODULO k EQUALS 0 THEN
                    IF i EQUALS j THEN
                        SET count TO gcd_count[gcd1]
                        INCREMENT total_pairs BY count MULTIPLIED BY (count MINUS 1) DIVIDED BY 2
                    ELSE
                        INCREMENT total_pairs BY gcd_count[gcd1] MULTIPLIED BY gcd_count[gcd2]
                    END IF
                END IF
            END FOR
        END FOR
        
        RETURN total_pairs
    END FUNCTION
END CLASS