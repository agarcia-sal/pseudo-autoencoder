```
CLASS Solution
    FUNCTION calcEquation(equations: List of List of String, values: List of Float, queries: List of List of String) RETURNS List of Float
        SET graph TO a default dictionary of dictionaries
        
        FOR each (a, b), value IN pairs from equations and values
            SET graph[a][b] TO value
            SET graph[b][a] TO 1.0 DIVIDED BY value
        
        FUNCTION dfs(start, end, visited)
            IF start NOT IN graph OR end NOT IN graph
                RETURN -1.0
            IF start EQUALS end
                RETURN 1.0
            ADD start TO visited
            FOR each neighbor, weight IN graph[start] items
                IF neighbor NOT IN visited
                    SET result TO dfs(neighbor, end, visited)
                    IF result NOT EQUAL TO -1.0
                        RETURN weight MULTIPLIED BY result
            REMOVE start FROM visited
            RETURN -1.0
        
        SET results TO empty list
        FOR each query IN queries
            SET start, end TO query values
            SET visited TO empty set
            SET result TO dfs(start, end, visited)
            APPEND result TO results
        
        RETURN results
    END FUNCTION
END CLASS
```