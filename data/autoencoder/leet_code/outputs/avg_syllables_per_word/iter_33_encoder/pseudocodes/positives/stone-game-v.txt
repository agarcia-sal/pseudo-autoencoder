CLASS Solution  
    FUNCTION stoneGameV(stoneValue)  
        SET prefix_sum TO a new list of zeros with the length equal to the length of stoneValue PLUS one  
        FOR index i FROM zero TO the length of stoneValue MINUS one  
            SET element at position i PLUS one of prefix_sum TO element at position i of prefix_sum PLUS element at position i of stoneValue  
        END FOR  
        
        FUNCTION get_range_sum(left, right)  
            RETURN element at position right PLUS one of prefix_sum MINUS element at position left of prefix_sum  
        END FUNCTION  
        
        FUNCTION dp(left, right)  
            IF left EQUALS right THEN  
                RETURN zero  
            END IF  
            SET max_score TO zero  
            FOR index i FROM left TO right MINUS one  
                SET left_sum TO the result of get_range_sum with parameters left and i  
                SET right_sum TO the result of get_range_sum with parameters i PLUS one and right  
                IF left_sum LESS THAN right_sum THEN  
                    SET max_score TO the maximum of max_score AND left_sum PLUS the result of dp with parameters left and i  
                ELSE IF left_sum GREATER THAN right_sum THEN  
                    SET max_score TO the maximum of max_score AND right_sum PLUS the result of dp with parameters i PLUS one and right  
                ELSE  
                    SET max_score TO the maximum among max_score AND left_sum PLUS the result of dp with parameters left and i AND right_sum PLUS the result of dp with parameters i PLUS one and right  
                END IF  
            END FOR  
            RETURN max_score  
        END FUNCTION  
        
        RETURN the result of dp with parameters zero and the length of stoneValue MINUS one  
    END FUNCTION  
END CLASS