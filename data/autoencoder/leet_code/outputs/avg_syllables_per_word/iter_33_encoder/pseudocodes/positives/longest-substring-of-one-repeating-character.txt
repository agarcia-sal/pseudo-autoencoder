CLASS Solution  
    FUNCTION longestRepeating(s, queryCharacters, queryIndices)  
        FUNCTION merge_intervals()  
            SET i TO zero  
            WHILE i LESS THAN the LENGTH OF intervals MINUS one  
                IF element at position i of intervals at position two EQUALS element at position i plus one of intervals at position two  
                    SET element at position i of intervals TO a tuple with first element as element at position i of intervals at position zero second element as element at position i plus one of intervals at position one third element as element at position i of intervals at position two  
                    REMOVE element at position i plus one FROM intervals  
                ELSE  
                    INCREMENT i BY one  
                END IF  
            END WHILE  
        END FUNCTION  
      
        SET intervals TO empty list  
        SET n TO the LENGTH OF s  
        SET start TO zero  
        FOR i FROM one TO n MINUS one  
            IF element at position i of s NOT EQUALS element at position start of s  
                APPEND a tuple with first element start second element i MINUS one third element element at position start of s TO intervals  
                SET start TO i  
            END IF  
        END FOR  
        APPEND a tuple with first element start second element n MINUS one third element element at position start of s TO intervals  
      
        SET results TO empty list  
        SET longest TO the maximum value of for each tuple in intervals subtract the first element FROM the second element PLUS one  
      
        FOR each pair of char and idx in the parallel elements of queryCharacters and queryIndices  
            SET i TO zero  
            WHILE i LESS THAN the LENGTH OF intervals  
                SET start TO element at position i of intervals at position zero  
                SET end TO element at position i of intervals at position one  
                SET c TO element at position i of intervals at position two  
                IF start LESS THAN OR EQUAL TO idx AND idx LESS THAN OR EQUAL TO end  
                    BREAK the loop  
                END IF  
                INCREMENT i BY one  
            END WHILE  
      
            IF idx GREATER THAN start  
                INSERT at position i a tuple with first element start second element idx MINUS one third element c INTO intervals  
                SET element at position i plus one of intervals TO a tuple with first element idx second element end third element c  
            END IF  
            IF idx LESS THAN end  
                INSERT at position i plus one a tuple with first element idx PLUS one second element end third element c INTO intervals  
                SET element at position i of intervals TO a tuple with first element start second element idx third element c  
            END IF  
      
            SET element at position i of intervals TO a tuple with first element element at position i of intervals at position zero second element element at position i of intervals at position one third element char  
      
            CALL merge_intervals()  
      
            SET longest TO the maximum value of for each tuple in intervals subtract the first element FROM the second element PLUS one  
            APPEND longest TO results  
        END FOR  
      
        RETURN results  
    END FUNCTION  
END CLASS