CLASS Solution  
    FUNCTION outerTrees(trees)  
        FUNCTION dist_sq(p1, p2)  
            SET first element of p1 MINUS first element of p2 TO difference_x  
            SET second element of p1 MINUS second element of p2 TO difference_y  
            RETURN difference_x MULTIPLIED BY difference_x PLUS difference_y MULTIPLIED BY difference_y  
        END FUNCTION  

        FUNCTION circumcenter(p1, p2, p3)  
            SET first element of p1 TO ax  
            SET second element of p1 TO ay  
            SET first element of p2 TO bx  
            SET second element of p2 TO by  
            SET first element of p3 TO cx  
            SET second element of p3 TO cy  
            SET two MULTIPLIED BY (ax MULTIPLIED BY (by MINUS cy) PLUS bx MULTIPLIED BY (cy MINUS ay) PLUS cx MULTIPLIED BY (ay MINUS by)) TO d  
            SET ((ax MULTIPLIED BY ax PLUS ay MULTIPLIED BY ay) MULTIPLIED BY (by MINUS cy) PLUS (bx MULTIPLIED BY bx PLUS by MULTIPLIED BY by) MULTIPLIED BY (cy MINUS ay) PLUS (cx MULTIPLIED BY cx PLUS cy MULTIPLIED BY cy) MULTIPLIED BY (ay MINUS by)) DIVIDED BY d TO ux  
            SET ((ax MULTIPLIED BY ax PLUS ay MULTIPLIED BY ay) MULTIPLIED BY (cx MINUS bx) PLUS (bx MULTIPLIED BY bx PLUS by MULTIPLIED BY by) MULTIPLIED BY (ax MINUS cx) PLUS (cx MULTIPLIED BY cx PLUS cy MULTIPLIED BY cy) MULTIPLIED BY (bx MINUS ax)) DIVIDED BY d TO uy  
            SET list of ux AND uy TO center_point  
            SET square root of ((ux MINUS ax) MULTIPLIED BY (ux MINUS ax) PLUS (uy MINUS ay) MULTIPLIED BY (uy MINUS ay)) TO radius_length  
            RETURN center_point AND radius_length  
        END FUNCTION  

        FUNCTION welzl(points, boundary, n)  
            IF n EQUALS zero OR LENGTH OF boundary EQUALS three  
                IF LENGTH OF boundary EQUALS zero  
                    RETURN list of zero AND zero AND zero FOR radius  
                ELSE IF LENGTH OF boundary EQUALS one  
                    RETURN first element of boundary AND zero FOR radius  
                ELSE IF LENGTH OF boundary EQUALS two  
                    SET list of (first element of first element of boundary PLUS first element of second element of boundary) DIVIDED BY two AND (second element of first element of boundary PLUS second element of second element of boundary) DIVIDED BY two TO center  
                    SET square root of dist_sq(first element of boundary, second element of boundary) DIVIDED BY two TO radius  
                    RETURN center AND radius  
                ELSE  
                    RETURN result of circumcenter WITH unpacked boundary elements  
                END IF  
            END IF  
            
            SET element at position n MINUS one of points TO p  
            SET result of welzl WITH points boundary AND n MINUS one TO center AND radius  
            IF dist_sq(center, p) LESS THAN OR EQUAL TO radius MULTIPLIED BY radius  
                RETURN center AND radius  
            END IF  
            
            RETURN welzl WITH points boundary appended by p AND n MINUS one  
        END FUNCTION  

        RANDOMLY SHUFFLE trees  
        SET result of welzl WITH trees EMPTY list AND LENGTH OF trees TO center AND radius  
        RETURN list of first element of center AND second element of center AND radius  
    END FUNCTION  
END CLASS