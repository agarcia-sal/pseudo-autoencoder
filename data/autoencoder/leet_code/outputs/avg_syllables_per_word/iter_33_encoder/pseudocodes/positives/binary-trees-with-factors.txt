CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MOD TO ten raised to the power of nine PLUS one  
        SORT arr in ascending order  
        SET dp TO a mapping from each number in arr TO one  
        FOR each index i FROM zero TO the length of arr MINUS one  
            SET num TO element at position i of arr  
            FOR each index j FROM zero TO i MINUS one  
                IF the remainder of num DIVIDED BY element at position j of arr EQUALS zero THEN  
                    SET right_child TO the quotient of num DIVIDED BY element at position j of arr  
                    IF right_child IS A key in dp THEN  
                        SET dp[num] TO the sum of dp[num] PLUS the product of dp[element at position j of arr] AND dp[right_child] MODULO MOD  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        SET total_trees TO the sum of all values in dp  
        RETURN the remainder of total_trees DIVIDED BY MOD  
    END FUNCTION  
END CLASS