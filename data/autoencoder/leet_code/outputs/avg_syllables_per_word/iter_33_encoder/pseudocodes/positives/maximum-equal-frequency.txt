CLASS Solution  
    FUNCTION maxEqualFreq(nums)  
        SET count TO a new Counter object that counts each number's frequency  
        SET freq TO a new Counter object that counts frequencies of frequencies  
        SET max_len TO zero  
        
        FOR each index i AND each number num IN enumeration of nums  
            INCREMENT the count of num BY one  
            
            IF the count of num is GREATER THAN one  
                DECREMENT the frequency of the count of num MINUS one BY one  
                IF the frequency of the count of num MINUS one EQUALS zero  
                    REMOVE the frequency entry corresponding to count of num MINUS one from freq  
                END IF  
            END IF  
            
            INCREMENT the frequency of the count of num BY one  
            
            IF the LENGTH OF freq EQUALS one AND (the frequency for one EXISTS IN freq OR the only frequency value EQUALS one)  
                SET max_len TO i PLUS one  
            ELSE IF the LENGTH OF freq EQUALS two AND (the frequency for one EXISTS IN freq AND the frequency for one EQUALS one OR (the DIFFERENCE BETWEEN the maximum key of freq AND the minimum key of freq EQUALS one AND the frequency for the maximum key of freq EQUALS one))  
                SET max_len TO i PLUS one  
            END IF  
        END FOR  
        
        RETURN max_len  
    END FUNCTION  
END CLASS