CLASS Solution  
    FUNCTION getLengthOfOptimalCompression(self, s, k)  
        DEFINE dp(i, k_remaining, previous_character, previous_count)  
            IF k_remaining LESS THAN zero THEN  
                RETURN infinity  
            END IF  
            IF i EQUALS length of s THEN  
                RETURN zero  
            END IF  
            IF character at position i of s EQUALS previous_character THEN  
                IF previous_count EQUALS one OR previous_count EQUALS nine OR previous_count EQUALS ninety nine THEN  
                    SET increment TO one  
                ELSE  
                    SET increment TO zero  
                END IF  
                RETURN increment PLUS dp(i PLUS one, k_remaining, previous_character, previous_count PLUS one)  
            ELSE  
                SET keep_cost TO one PLUS dp(i PLUS one, k_remaining, character at position i of s, one)  
                SET delete_cost TO dp(i PLUS one, k_remaining MINUS one, previous_character, previous_count)  
                RETURN minimum of keep_cost AND delete_cost  
            END IF  
        END FUNCTION  
        RETURN dp(zero, k, empty string, zero)  
    END FUNCTION  
END CLASS