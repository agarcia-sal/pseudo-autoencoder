CLASS Solution  
    FUNCTION pacificAtlantic(self, heights)  
        FUNCTION bfs(q, vis)  
            WHILE q IS NOT empty  
                FOR count FROM zero TO length of q MINUS one  
                    SET i, j TO first element removed FROM q  
                    FOR each pair a, b IN list of pairs (zero, minus one), (zero, one), (one, zero), (minus one, zero)  
                        SET x TO i PLUS a  
                        SET y TO j PLUS b  
                        IF x GREATER THAN OR EQUAL TO zero AND x LESS THAN m AND y GREATER THAN OR EQUAL TO zero AND y LESS THAN n AND pair x, y NOT IN vis AND heights at x, y GREATER THAN OR EQUAL TO heights at i, j THEN  
                            ADD pair x, y TO vis  
                            APPEND pair x, y TO q  
                        END IF  
                    END FOR  
                END FOR  
            END WHILE  
        END FUNCTION  

        SET m TO length of heights  
        SET n TO length of first element of heights  
        SET vis1 TO empty set  
        SET vis2 TO empty set  
        INITIALIZE q1 as an empty deque  
        INITIALIZE q2 as an empty deque  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF i EQUALS zero OR j EQUALS zero THEN  
                    ADD pair i, j TO vis1  
                    APPEND pair i, j TO q1  
                END IF  
                IF i EQUALS m MINUS one OR j EQUALS n MINUS one THEN  
                    ADD pair i, j TO vis2  
                    APPEND pair i, j TO q2  
                END IF  
            END FOR  
        END FOR  
        CALL bfs WITH q1, vis1  
        CALL bfs WITH q2, vis2  
        SET result TO empty list  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF pair i, j IN vis1 AND pair i, j IN vis2 THEN  
                    APPEND pair i, j TO result  
                END IF  
            END FOR  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS