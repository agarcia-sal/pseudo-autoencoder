CLASS Solution  
    FUNCTION minFallingPathSum(self, grid)  
        IF grid IS empty OR first element of grid IS empty THEN  
            RETURN zero  
        END IF  
        
        SET n TO length of grid  
        
        IF n EQUALS one THEN  
            RETURN smallest element IN first row of grid  
        END IF  
        
        SET dp TO copy of first row of grid  
        
        FOR i FROM one TO n MINUS one  
            SET new_dp TO list of zeros with length n  
            
            SET min1 TO positive infinity  
            SET min2 TO positive infinity  
            SET min1_index TO negative one  
            
            FOR j FROM zero TO n MINUS one  
                IF dp at j LESS THAN min1 THEN  
                    SET min2 TO min1  
                    SET min1 TO dp at j  
                    SET min1_index TO j  
                ELSE IF dp at j LESS THAN min2 THEN  
                    SET min2 TO dp at j  
                END IF  
            END FOR  
            
            FOR j FROM zero TO n MINUS one  
                IF j EQUALS min1_index THEN  
                    SET new_dp at j TO value at grid row i column j PLUS min2  
                ELSE  
                    SET new_dp at j TO value at grid row i column j PLUS min1  
                END IF  
            END FOR  
            
            SET dp TO copy of new_dp  
        END FOR  
        
        RETURN smallest element IN dp  
    END FUNCTION  
END CLASS