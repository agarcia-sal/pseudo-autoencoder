CLASS Solution  
    FUNCTION longestDupSubstring(self, s)  
        FUNCTION search(length)  
            SET seen TO empty set  
            FOR i FROM zero TO length of s MINUS length PLUS one  
                SET substring TO the portion of s FROM index i TO i PLUS length  
                IF substring IS IN seen THEN  
                    RETURN substring  
                END IF  
                ADD substring TO seen  
            END FOR  
            RETURN empty string  
        END FUNCTION  

        SET left TO one  
        SET right TO length of s MINUS one  
        SET longest TO empty string  

        WHILE left LESS THAN OR EQUAL TO right  
            SET mid TO left PLUS right DIVIDED BY two (integer division)  
            SET candidate TO result of search(mid)  
            IF candidate IS NOT empty string THEN  
                SET longest TO candidate  
                SET left TO mid PLUS one  
            ELSE  
                SET right TO mid MINUS one  
            END IF  
        END WHILE  

        RETURN longest  
    END FUNCTION  
END CLASS