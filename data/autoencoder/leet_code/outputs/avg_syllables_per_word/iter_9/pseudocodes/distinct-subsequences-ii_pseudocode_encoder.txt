CLASS Solution  
    FUNCTION distinctSubseqII(self, s)  
        SET MODULO TO ten raised to the power of nine PLUS one  
        SET length TO the number of characters in s  
        INITIALIZE dp AS a list of length plus one elements all set to zero  
        SET the first element of dp to one  
        INITIALIZE last_occurrence AS an empty dictionary  
        FOR index FROM one TO length  
            SET current_char TO the character in s at position index minus one  
            SET dp at position index TO dp at position index minus one multiplied by two  
            SET dp at position index TO dp at position index modulo MODULO  
            IF current_char EXISTS in last_occurrence THEN  
                SET dp at position index TO dp at position index MINUS dp at position last_occurrence of current_char MINUS one PLUS MODULO  
                SET dp at position index TO dp at position index modulo MODULO  
            END IF  
            SET last_occurrence of current_char TO index  
        END FOR  
        RETURN dp at position length MINUS one modulo MODULO  
    END FUNCTION  
END CLASS