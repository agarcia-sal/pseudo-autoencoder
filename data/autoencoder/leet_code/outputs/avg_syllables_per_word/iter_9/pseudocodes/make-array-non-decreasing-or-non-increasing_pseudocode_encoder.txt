CLASS Solution  
    FUNCTION convertArray(self, nums)  
        FUNCTION min_operations_to_non_decreasing(nums)  
            SET max_heap TO empty list  
            SET operations TO zero  
            FOR each num IN nums  
                IF max_heap IS NOT empty AND negative of first element of max_heap GREATER THAN num THEN  
                    INCREMENT operations BY negative of result of removing first element from max_heap MINUS num  
                    ADD negative of num TO max_heap maintaining heap property  
                END IF  
                ADD negative of num TO max_heap maintaining heap property  
            END FOR  
            RETURN operations  
        END FUNCTION  
        
        FUNCTION min_operations_to_non_increasing(nums)  
            SET min_heap TO empty list  
            SET operations TO zero  
            FOR each num IN nums  
                IF min_heap IS NOT empty AND first element of min_heap LESS THAN num THEN  
                    INCREMENT operations BY num MINUS result of removing first element from min_heap  
                    ADD num TO min_heap maintaining heap property  
                END IF  
                ADD num TO min_heap maintaining heap property  
            END FOR  
            RETURN operations  
        END FUNCTION  
        
        RETURN minimum of result of calling min_operations_to_non_decreasing with nums AND result of calling min_operations_to_non_increasing with nums  
    END FUNCTION  
END CLASS