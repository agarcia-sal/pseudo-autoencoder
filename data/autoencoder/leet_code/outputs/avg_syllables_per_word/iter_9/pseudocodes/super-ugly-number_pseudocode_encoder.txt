CLASS Solution  
    FUNCTION nthSuperUglyNumber(self, n, primes)  
        SET ugly_numbers TO list containing only one  
        SET heap TO list of pairs where each pair contains a prime and its index from primes list  
        TRANSFORM heap into a min-heap structure  
        SET indices TO list of zeros having the same length as primes  
        WHILE length of ugly_numbers LESS THAN n  
            REMOVE smallest pair from heap and SET next_ugly and prime_index accordingly  
            IF next_ugly NOT EQUALS last element in ugly_numbers THEN  
                APPEND next_ugly TO ugly_numbers  
            END IF  
            INCREMENT element in indices at prime_index BY one  
            SET next_multiple TO element in primes at prime_index MULTIPLIED BY element in ugly_numbers at indices at prime_index  
            ADD pair of next_multiple and prime_index TO heap  
        END WHILE  
        RETURN last element in ugly_numbers  
    END FUNCTION  
END CLASS