CLASS Solution  
    FUNCTION constrainedSubsetSum(self, nums, k)  
        SET n TO length of nums  
        SET dp TO list of zeros with length n  
        SET first element of dp TO first element of nums  
        SET max_sum TO first element of nums  

        SET q TO a deque initialized with first index zero  

        FOR i FROM one TO n MINUS one  
            IF dp at front index of q GREATER THAN zero THEN  
                SET dp at i TO nums at i PLUS dp at front index of q  
            ELSE  
                SET dp at i TO nums at i  
            END IF  

            IF dp at i GREATER THAN max_sum THEN  
                SET max_sum TO dp at i  
            END IF  

            WHILE q is not empty AND dp at i GREATER THAN OR EQUAL TO dp at last index of q  
                REMOVE last element FROM q  
            END WHILE  

            APPEND i TO q  

            IF front element of q EQUALS i MINUS k THEN  
                REMOVE first element FROM q  
            END IF  
        END FOR  

        RETURN max_sum  
    END FUNCTION  
END CLASS