CLASS Solution  
    FUNCTION kthSmallest(self, mat, k)  
        SET m TO length of mat  
        SET n TO length of first element in mat  
        SET min_heap TO list containing a tuple of (sum of first elements in each row of mat, tuple of zeros repeated m times)  
        SET visited TO set containing the tuple of zeros repeated m times  
        
        WHILE k GREATER THAN zero  
            SET current_sum, indices TO removal of smallest element from min_heap  
            DECREMENT k BY one  
            
            IF k EQUALS zero THEN  
                RETURN current_sum  
            END IF  
            
            FOR i FROM zero TO m minus one  
                IF indices at position i PLUS one LESS THAN n THEN  
                    SET new_indices TO list copy of indices  
                    INCREMENT element at position i in new_indices BY one  
                    SET new_indices_tuple TO tuple form of new_indices  
                    SET new_sum TO current_sum MINUS element at position indices[i] in row i of mat PLUS element at position new_indices[i] in row i of mat  
                    
                    IF new_indices_tuple NOT IN visited THEN  
                        ADD new_indices_tuple TO visited  
                        ADD tuple of (new_sum, new_indices_tuple) TO min_heap preserving heap property  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN negative one  
    END FUNCTION  
END CLASS