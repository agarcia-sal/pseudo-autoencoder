CLASS Solution  
    FUNCTION countPairs(self, nums, k)  
        SET gcd_count TO empty counter structure  
        
        FOR each num IN nums  
            INCREMENT count of gcd of num AND k BY one IN gcd_count  
        END FOR  
        
        SET total_pairs TO zero  
        
        SET gcd_values TO list of keys in gcd_count  
        SET n TO length of gcd_values  
        
        FOR i FROM zero TO n MINUS one  
            FOR j FROM i TO n MINUS one  
                SET gcd1 TO element at index i in gcd_values  
                SET gcd2 TO element at index j in gcd_values  
                
                IF product of gcd1 AND gcd2 modulo k EQUALS zero THEN  
                    IF i EQUALS j THEN  
                        INCREMENT total_pairs BY product of count of gcd1 AND count of gcd1 MINUS one DIVIDED BY two  
                    ELSE  
                        INCREMENT total_pairs BY product of count of gcd1 AND count of gcd2  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        
        RETURN total_pairs  
    END FUNCTION  
END CLASS