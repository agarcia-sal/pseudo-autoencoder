CLASS Trie  
    FUNCTION __init__(self)  
        SET self.children TO a list of twenty-six None elements  
        SET self.ref TO negative one  
    END FUNCTION  

    FUNCTION insert(self, w, ref)  
        SET node TO self  
        FOR each character c IN w  
            SET idx TO the position of c in the alphabet starting from zero  
            IF node.children at idx IS None THEN  
                SET node.children at idx TO a new Trie instance  
            END IF  
            SET node TO node.children at idx  
        END FOR  
        SET node.ref TO ref  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION findWords(self, board, words)  
        FUNCTION dfs(node, i, j)  
            SET idx TO the position of board at row i and column j in the alphabet starting from zero  
            IF node.children at idx IS None THEN  
                RETURN  
            END IF  
            SET node TO node.children at idx  
            IF node.ref GREATER THAN OR EQUAL TO zero THEN  
                APPEND words at node.ref TO ans  
                SET node.ref TO negative one  
            END IF  
            SET c TO board at row i and column j  
            SET board at row i and column j TO the marker character  
            FOR each pair of consecutive values (a, b) in the sequence: negative one, zero, one, zero, negative one  
                SET x TO i PLUS a  
                SET y TO j PLUS b  
                IF x GREATER THAN OR EQUAL TO zero AND x LESS THAN m AND y GREATER THAN OR EQUAL TO zero AND y LESS THAN n AND board at row x and column y NOT EQUALS the marker character THEN  
                    CALL dfs(node, x, y)  
                END IF  
            END FOR  
            SET board at row i and column j TO c  
        END FUNCTION  

        SET tree TO a new Trie instance  
        FOR each index i and word w IN words  
            CALL tree.insert(w, i)  
        END FOR  
        SET m TO the number of rows in board  
        SET n TO the number of columns in board  
        SET ans TO an empty list  
        FOR each index i FROM zero TO m MINUS one  
            FOR each index j FROM zero TO n MINUS one  
                CALL dfs(tree, i, j)  
            END FOR  
        END FOR  
        RETURN ans  
    END FUNCTION  
END CLASS