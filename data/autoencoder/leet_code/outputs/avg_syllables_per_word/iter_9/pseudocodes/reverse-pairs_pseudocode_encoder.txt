CLASS Solution  
    FUNCTION reversePairs(self, nums)  
        FUNCTION merge_and_count(nums, start, end)  
            IF start GREATER THAN OR EQUAL TO end THEN  
                RETURN zero  
            END IF  
            
            SET mid TO start PLUS end DIVIDED BY two  
            SET count TO merge_and_count(nums, start, mid) PLUS merge_and_count(nums, mid PLUS one, end)  
            
            SET j TO mid PLUS one  
            FOR i FROM start TO mid  
                WHILE j LESS THAN OR EQUAL TO end AND nums AT i GREATER THAN two MULTIPLIED BY nums AT j DO  
                    INCREMENT j BY one  
                END WHILE  
                INCREMENT count BY j MINUS (mid PLUS one)  
            END FOR  
            
            SET merged TO empty list  
            SET left TO start  
            SET right TO mid PLUS one  
            WHILE left LESS THAN OR EQUAL TO mid AND right LESS THAN OR EQUAL TO end DO  
                IF nums AT left LESS THAN OR EQUAL TO nums AT right THEN  
                    APPEND nums AT left TO merged  
                    INCREMENT left BY one  
                ELSE  
                    APPEND nums AT right TO merged  
                    INCREMENT right BY one  
                END IF  
            END WHILE  
            
            FOR each element FROM left TO mid DO  
                APPEND nums AT element TO merged  
            END FOR  
            
            FOR each element FROM right TO end DO  
                APPEND nums AT element TO merged  
            END FOR  
            
            FOR index FROM start TO end DO  
                SET nums AT index TO merged AT (index MINUS start)  
            END FOR  
            
            RETURN count  
        END FUNCTION  
        
        RETURN merge_and_count(nums, zero, LENGTH OF nums MINUS one)  
    END FUNCTION  
END CLASS