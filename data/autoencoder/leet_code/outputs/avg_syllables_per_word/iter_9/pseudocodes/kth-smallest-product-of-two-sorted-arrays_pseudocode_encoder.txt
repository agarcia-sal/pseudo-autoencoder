CLASS Solution  
    FUNCTION kthSmallestProduct(self, nums1, nums2, k)  
        FUNCTION count(p)  
            SET cnt TO zero  
            SET n TO length of nums2  
            FOR each element x IN nums1  
                IF x GREATER THAN zero THEN  
                    INCREMENT cnt BY number of elements in nums2 strictly less than or equal to p DIVIDED BY x  
                ELSE IF x LESS THAN zero THEN  
                    INCREMENT cnt BY n MINUS number of elements in nums2 strictly less than p DIVIDED BY x  
                ELSE  
                    INCREMENT cnt BY n MULTIPLIED BY integer value of (p GREATER THAN OR EQUAL TO zero)  
                END IF  
            END FOR  
            RETURN cnt  
        END FUNCTION  

        SET mx TO maximum of absolute value of first element of nums1 and absolute value of last element of nums1 MULTIPLIED BY maximum of absolute value of first element of nums2 and absolute value of last element of nums2  
        RETURN position of k in range from negative mx to mx inclusive according to ascending order using count as the comparison function MINUS mx  
    END FUNCTION  
END CLASS