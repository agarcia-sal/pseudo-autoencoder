CLASS Solution  
    FUNCTION minMalwareSpread(self, graph, initial)  
        SET n TO length of graph  
        FUNCTION initialize_defaultdict_list()  
            RETURN an empty mapping from key to list  
        END FUNCTION  
        SET adj_list TO initialize_defaultdict_list()  
        
        FOR i FROM zero TO n MINUS one  
            FOR j FROM i PLUS one TO n MINUS one  
                IF graph at position i and j EQUALS one THEN  
                    APPEND j TO adj_list at key i  
                    APPEND i TO adj_list at key j  
                END IF  
            END FOR  
        END FOR  
        
        FUNCTION dfs(node, visited)  
            IF node IS IN visited THEN  
                RETURN zero  
            END IF  
            ADD node TO visited  
            SET size TO one  
            FOR each neighbor IN adj_list at key node  
                SET size TO size PLUS dfs(neighbor, visited)  
            END FOR  
            RETURN size  
        END FUNCTION  
        
        SET infected TO a set containing all elements in initial  
        
        SET component_sizes TO an empty list  
        SET visited TO an empty set  
        FUNCTION initialize_defaultdict_int()  
            RETURN an empty mapping from key to integer defaulting to zero  
        END FUNCTION  
        SET component_index TO initialize_defaultdict_int()  
        
        FOR node FROM zero TO n MINUS one  
            IF node IS NOT IN visited AND node IS NOT IN infected THEN  
                SET size TO dfs(node, visited)  
                APPEND size TO component_sizes  
                
                FOR i FROM length of component_sizes MINUS one DOWN TO zero STEP minus one  
                    IF component_sizes at index i EQUALS size THEN  
                        EXIT loop  
                    END IF  
                END FOR  
                
                FOR each neighbor IN adj_list at key node  
                    SET component_index at key neighbor TO i  
                END FOR  
            END IF  
        END FOR  
        
        SET infected_in_component TO initialize_defaultdict_int()  
        FOR each node IN infected  
            IF node IS IN component_index THEN  
                INCREMENT infected_in_component at key component_index at key node BY one  
            END IF  
        END FOR  
        
        SET max_size TO zero  
        SET node_to_remove TO the smallest element IN initial  
        
        FOR each node IN infected  
            IF node IS IN component_index THEN  
                SET comp_idx TO component_index at key node  
                IF infected_in_component at key comp_idx EQUALS one THEN  
                    IF component_sizes at index comp_idx GREATER THAN max_size THEN  
                        SET max_size TO component_sizes at index comp_idx  
                        SET node_to_remove TO node  
                    ELSE IF component_sizes at index comp_idx EQUALS max_size THEN  
                        SET node_to_remove TO the smaller of node_to_remove AND node  
                    END IF  
                END IF  
            END IF  
        END FOR  
        
        RETURN node_to_remove  
    END FUNCTION  
END CLASS