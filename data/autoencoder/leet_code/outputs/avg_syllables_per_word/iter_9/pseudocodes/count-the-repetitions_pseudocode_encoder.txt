CLASS Solution  
    FUNCTION getMaxRepetitions(self, s1, n1, s2, n2)  
        IF n1 EQUALS zero THEN  
            RETURN zero  
        END IF  

        SET s2_count TO list of zeros with length equal to length of s2 PLUS one  
        SET index_map TO list of zeros with length equal to length of s2 PLUS one  

        SET current_index_s2 TO zero  
        SET s1_count TO zero  

        WHILE s1_count LESS THAN n1  
            INCREMENT s1_count BY one  
            FOR each character IN s1  
                IF character EQUALS s2 at current_index_s2 THEN  
                    INCREMENT current_index_s2 BY one  
                    IF current_index_s2 EQUALS length of s2 THEN  
                        SET s2_count at s1_count TO s2_count at (s1_count MINUS one) PLUS one  
                        SET current_index_s2 TO zero  
                    END IF  
                END IF  
                SET index_map at s1_count TO current_index_s2  
            END FOR  

            IF current_index_s2 IS FOUND IN index_map FROM start TO (s1_count MINUS one) THEN  
                SET start TO position of current_index_s2 in index_map  
                SET cycle_length TO s1_count MINUS start  
                SET cycles_fit TO integer division of (n1 MINUS start) BY cycle_length  
                SET remainder TO modulo of (n1 MINUS start) BY cycle_length  
                SET total_s2_count TO s2_count at start PLUS cycles_fit MULTIPLIED BY (s2_count at (start PLUS cycle_length) MINUS s2_count at start) PLUS s2_count at (start PLUS remainder) MINUS s2_count at start  
                RETURN integer division of total_s2_count BY n2  
            END IF  
        END WHILE  

        RETURN integer division of s2_count at s1_count BY n2  
    END FUNCTION  
END CLASS