CLASS Solution  
    FUNCTION findNumOfValidWords(self, words, puzzles)  
        FUNCTION to_mask(s)  
            SET mask TO zero  
            FOR each character IN s  
                SET mask TO mask OR 1 shifted left by (numeric position of character MINUS numeric position of letter 'a')  
            END FOR  
            RETURN mask  
        END FUNCTION  
        
        SET word_count TO a mapping with default integer zero  
        FOR each word IN words  
            SET mask TO to_mask(word)  
            IF number of set bits in mask LESS THAN OR EQUAL TO seven THEN  
                INCREMENT word_count at key mask BY one  
            END IF  
        END FOR  
        
        SET result TO empty list  
        FOR each puzzle IN puzzles  
            SET first_char_mask TO 1 shifted left by (numeric position of first character of puzzle MINUS numeric position of letter 'a')  
            SET puzzle_mask TO to_mask(all characters of puzzle excluding the first one)  
            SET count TO word_count at key first_char_mask  
            
            SET subset TO puzzle_mask  
            WHILE subset NOT EQUALS zero  
                SET count TO count PLUS word_count at key (subset OR first_char_mask)  
                SET subset TO (subset MINUS one) AND puzzle_mask  
            END WHILE  
            
            APPEND count TO result  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS