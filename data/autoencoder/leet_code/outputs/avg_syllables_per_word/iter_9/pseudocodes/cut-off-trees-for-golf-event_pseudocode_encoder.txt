CLASS Solution  
    FUNCTION cutOffTree(self, forest)  
        IF forest IS empty OR forest at index zero IS empty THEN  
            RETURN minus one  
        END IF  

        SET trees TO empty list  
        FOR each index i FROM zero TO length of forest MINUS one  
            FOR each index j FROM zero TO length of forest at index zero MINUS one  
                IF forest at i, j GREATER THAN one THEN  
                    APPEND tuple of forest at i, j AND i AND j TO trees  
                END IF  
            END FOR  
        END FOR  
        SORT trees in ascending order  

        FUNCTION bfs(start, end)  
            IF start EQUALS end THEN  
                RETURN zero  
            END IF  

            SET m TO length of forest  
            SET n TO length of forest at index zero  
            SET queue TO deque containing start  
            SET visited TO set containing start  
            SET steps TO zero  

            WHILE queue IS NOT empty  
                FOR _ FROM zero TO length of queue MINUS one  
                    SET x, y TO remove first element FROM queue  
                    FOR each dx, dy IN list of tuples (minus one, zero), (one, zero), (zero, minus one), (zero, one)  
                        SET nx TO x PLUS dx  
                        SET ny TO y PLUS dy  
                        IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n AND tuple nx, ny NOT IN visited AND forest at nx, ny NOT EQUAL TO zero THEN  
                            IF tuple nx, ny EQUALS end THEN  
                                RETURN steps PLUS one  
                            END IF  
                            ADD tuple nx, ny TO visited  
                            APPEND tuple nx, ny TO queue  
                        END IF  
                    END FOR  
                END FOR  
                INCREMENT steps BY one  
            END WHILE  

            RETURN minus one  
        END FUNCTION  

        SET x TO zero  
        SET y TO zero  
        SET total_steps TO zero  

        FOR each height, tx, ty IN trees  
            SET steps TO call bfs WITH arguments tuple x, y AND tuple tx, ty  
            IF steps EQUALS minus one THEN  
                RETURN minus one  
            END IF  
            INCREMENT total_steps BY steps  
            SET x TO tx  
            SET y TO ty  
        END FOR  

        RETURN total_steps  
    END FUNCTION  
END CLASS