CLASS Solution  
    FUNCTION maximizeXor(self, nums, queries)  
        CALL sort ON nums  
  
        SET sorted_queries TO enumeration of queries sorted by each query's second element  
  
        SET result TO list of length equal to queries filled with negative one  
  
        SET trie TO empty mapping  
  
        SET num_index TO zero  
  
        FOR each pair of query_index and pair (xi, mi) IN sorted_queries  
            WHILE num_index LESS THAN length of nums AND element at num_index in nums LESS THAN OR EQUALS mi  
                SET num TO element at num_index in nums  
                SET node TO trie  
                FOR i FROM thirty one DOWN TO zero  
                    SET bit TO bit at position i in num  
                    IF bit NOT IN node THEN  
                        SET node at bit TO empty mapping  
                    END IF  
                    SET node TO node at bit  
                END FOR  
                INCREMENT num_index BY one  
            END WHILE  
  
            IF trie IS empty THEN  
                CONTINUE to next iteration of for loop  
            END IF  
  
            SET node TO trie  
            SET max_xor TO zero  
  
            FOR i FROM thirty one DOWN TO zero  
                SET bit TO bit at position i in xi  
                SET toggle_bit TO one MINUS bit  
                IF toggle_bit IN node THEN  
                    INCREMENT max_xor BY one shifted left by i positions  
                    SET node TO node at toggle_bit  
                ELSE  
                    SET node TO node at bit  
                END IF  
            END FOR  
  
            SET element at query_index in result TO max_xor  
        END FOR  
  
        RETURN result  
    END FUNCTION  
END CLASS