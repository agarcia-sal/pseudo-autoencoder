CLASS Solution  
    FUNCTION eventualSafeNodes(self, graph)  
        FUNCTION is_safe(node)  
            IF visited at index node EQUALS 1 THEN  
                RETURN False  
            END IF  
            IF visited at index node EQUALS 2 THEN  
                RETURN True  
            END IF  
            
            SET visited at index node TO 1  
            FOR each neighbor IN graph at index node  
                IF is_safe(neighbor) EQUALS False THEN  
                    RETURN False  
                END IF  
            END FOR  
            
            SET visited at index node TO 2  
            RETURN True  
        END FUNCTION  
        
        SET n TO length of graph  
        SET visited TO list of size n FILLED WITH 0  
        SET safe_nodes TO empty list  
        
        FOR node FROM 0 TO n MINUS 1  
            IF is_safe(node) EQUALS True THEN  
                APPEND node TO safe_nodes  
            END IF  
        END FOR  
        
        RETURN safe_nodes  
    END FUNCTION  
END CLASS