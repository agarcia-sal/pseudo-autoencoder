CLASS Solution  
    FUNCTION largestIsland(grid)  
        IF grid IS empty OR grid at first position IS empty THEN  
            RETURN zero  
        END IF  
        
        SET n TO length of grid  
        SET directions TO list containing (zero, one), (one, zero), (zero, negative one), (negative one, zero)  
        
        FUNCTION is_valid(x, y)  
            RETURN x GREATER THAN OR EQUAL TO zero AND x LESS THAN n AND y GREATER THAN OR EQUAL TO zero AND y LESS THAN n  
        END FUNCTION  
        
        FUNCTION dfs(x, y, index)  
            SET area TO one  
            SET grid at position x and y TO index  
            FOR each dx, dy IN directions  
                SET nx TO x PLUS dx  
                SET ny TO y PLUS dy  
                IF is_valid(nx, ny) AND grid at position nx and ny EQUALS one THEN  
                    INCREMENT area BY dfs(nx, ny, index)  
                END IF  
            END FOR  
            RETURN area  
        END FUNCTION  
        
        SET island_areas TO empty mapping  
        SET index TO two  
        
        FOR i FROM zero TO n MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF grid at position i and j EQUALS one THEN  
                    SET island_areas at key index TO dfs(i, j, index)  
                    INCREMENT index BY one  
                END IF  
            END FOR  
        END FOR  
        
        IF island_areas IS empty THEN  
            RETURN one  
        END IF  
        
        SET max_island_size TO maximum value in island_areas  
        
        FOR i FROM zero TO n MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF grid at position i and j EQUALS zero THEN  
                    SET neighbors TO empty set  
                    FOR each dx, dy IN directions  
                        SET nx TO i PLUS dx  
                        SET ny TO j PLUS dy  
                        IF is_valid(nx, ny) AND grid at position nx and ny GREATER THAN one THEN  
                            ADD grid at position nx and ny TO neighbors  
                        END IF  
                    END FOR  
                    SET current_island_size TO one PLUS sum of island_areas at keys in neighbors  
                    SET max_island_size TO maximum of max_island_size AND current_island_size  
                END IF  
            END FOR  
        END FOR  
        
        RETURN max_island_size  
    END FUNCTION  
END CLASS