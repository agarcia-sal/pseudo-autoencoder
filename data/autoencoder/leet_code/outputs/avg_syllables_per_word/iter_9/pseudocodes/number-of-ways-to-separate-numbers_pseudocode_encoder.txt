CLASS Solution  
    FUNCTION numberOfCombinations(self, num)  
        SET MOD TO one billion PLUS seven  
        SET n TO length of num  
        SET memo TO an empty dictionary  

        FUNCTION dp(index, prev_len)  
            IF index EQUALS n THEN  
                RETURN one  
            END IF  

            IF tuple of index AND prev_len EXISTS IN memo THEN  
                RETURN memo value for tuple of index AND prev_len  
            END IF  

            SET count TO zero  
            FOR length FROM one TO n MINUS index DO  
                IF character at position index in num EQUALS character zero THEN  
                    BREAK loop  
                END IF  

                SET current_num TO substring of num FROM index TO index PLUS length  

                IF prev_len EQUALS zero OR current_num GREATER THAN OR EQUAL TO substring of num FROM index MINUS prev_len TO index THEN  
                    SET count TO count PLUS result of dp called with index PLUS length AND length  
                    SET count TO count MODULO MOD  
                END IF  
            END FOR  

            SET memo at tuple of index AND prev_len TO count  
            RETURN count  
        END FUNCTION  

        RETURN result of dp called with zero AND zero  
    END FUNCTION  
END CLASS