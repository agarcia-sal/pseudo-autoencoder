CLASS Solution  
    FUNCTION nthMagicalNumber(self, n, a, b)  
        SET MOD TO one billion plus seven  
        
        FUNCTION gcd(x, y)  
            WHILE y IS NOT zero  
                SET temporary_x TO y  
                SET temporary_y TO x modulo y  
                SET x TO temporary_x  
                SET y TO temporary_y  
            END WHILE  
            RETURN x  
        END FUNCTION  
        
        FUNCTION lcm(x, y)  
            RETURN x multiplied BY y divided BY gcd(x, y)  
        END FUNCTION  
        
        SET L TO lcm(a, b)  
        
        SET left TO one  
        SET right TO n multiplied BY the lesser of a and b  
        
        WHILE left LESS THAN right  
            SET mid TO left plus right divided BY two (integer division)  
            SET count TO mid divided BY a plus mid divided BY b minus mid divided BY L  
            
            IF count LESS THAN n THEN  
                SET left TO mid plus one  
            ELSE  
                SET right TO mid  
            END IF  
        END WHILE  
        
        RETURN left modulo MOD  
    END FUNCTION  
END CLASS