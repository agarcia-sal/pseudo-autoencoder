CLASS Solution  
    FUNCTION braceExpansionII(self, expression)  
        FUNCTION parse_expression(index)  
            SET current_set TO an empty set  
            SET current_product TO a list containing an empty string  
            
            WHILE index LESS THAN length of expression  
                SET char TO expression at position index  
                
                IF char EQUALS '{' THEN  
                    SET inner_set, index TO parse_expression(index INCREMENTED BY one)  
                    SET current_product TO a new list formed by concatenating each element in current_product WITH each element in inner_set  
                
                ELSE IF char EQUALS '}' THEN  
                    ADD each element formed by joining elements of current_product as a single string TO current_set  
                    RETURN current_set AND index  
                
                ELSE IF char EQUALS ',' THEN  
                    ADD each element formed by joining elements of current_product as a single string TO current_set  
                    SET current_product TO a list containing an empty string  
                
                ELSE  
                    SET current_product TO a new list formed by concatenating each element in current_product WITH char  
                
                END IF  
                
                INCREMENT index BY one  
            END WHILE  
            
            ADD each element formed by joining elements of current_product as a single string TO current_set  
            RETURN current_set AND index  
        END FUNCTION  
        
        SET result_set, ignore_value TO parse_expression(starting at zero)  
        RETURN the sorted list of result_set  
    END FUNCTION  
END CLASS