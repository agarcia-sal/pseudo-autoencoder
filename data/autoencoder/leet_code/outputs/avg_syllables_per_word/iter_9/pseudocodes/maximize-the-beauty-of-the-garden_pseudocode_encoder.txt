CLASS Solution  
    FUNCTION maximumBeauty(self, flowers)  
        DEFINE indices AS dictionary with default of empty list  
        
        SET prefix_sum TO list of zeros with length of length of flowers PLUS one  
        
        FOR index FROM zero TO length of flowers MINUS one  
            SET prefix_sum at index PLUS one TO prefix_sum at index PLUS maximum of flowers at index AND zero  
            APPEND index TO indices at flowers at index  
        END FOR  
        
        SET max_beauty TO negative infinity  
        
        FOR each beauty IN keys of indices  
            IF length of indices at beauty GREATER THAN OR EQUAL TO two THEN  
                SET first TO first element of indices at beauty  
                SET last TO last element of indices at beauty  
                
                SET current_beauty TO two MULTIPLIED BY beauty PLUS prefix_sum at last MINUS prefix_sum at first PLUS one  
                SET max_beauty TO maximum of max_beauty AND current_beauty  
            END IF  
        END FOR  
        
        RETURN max_beauty  
    END FUNCTION  
END CLASS