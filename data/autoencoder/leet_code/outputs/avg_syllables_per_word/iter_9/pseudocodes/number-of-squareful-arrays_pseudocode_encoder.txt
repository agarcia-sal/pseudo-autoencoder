CLASS Solution
    FUNCTION numSquarefulPerms(self, nums)
        FUNCTION is_square(n)
            RETURN integer square root of n MULTIPLIED BY integer square root of n EQUALS n
        END FUNCTION

        FUNCTION backtrack(path, count)
            IF length of path EQUALS length of nums THEN
                RETURN 1
            END IF

            SET ans TO 0
            FOR each x IN count
                IF count at x GREATER THAN 0 AND (path is empty OR is_square(last element of path PLUS x)) THEN
                    DECREMENT count at x BY 1
                    INCREMENT ans BY backtrack(path appended with x, count)
                    INCREMENT count at x BY 1
                END IF
            END FOR
            RETURN ans
        END FUNCTION

        SET count TO frequency count of elements in nums
        RETURN backtrack(empty list, count)
    END FUNCTION
END CLASS