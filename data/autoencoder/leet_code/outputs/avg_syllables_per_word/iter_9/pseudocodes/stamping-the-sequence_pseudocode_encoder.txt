CLASS Solution  
    FUNCTION movesToStamp(self, stamp, target)  
        SET m TO length of stamp  
        SET n TO length of target  
        SET indeg TO list filled with m repeated (n MINUS m PLUS 1) times  
        SET q TO empty deque  
        SET g TO list of empty lists repeated n times  
        FOR i FROM 0 TO (n MINUS m)  
            FOR each index j AND character c IN stamp  
                IF character at position (i PLUS j) in target EQUALS c THEN  
                    DECREMENT indeg at position i BY one  
                    IF indeg at position i EQUALS zero THEN  
                        APPEND i TO q  
                    END IF  
                ELSE  
                    APPEND i TO g at position (i PLUS j)  
                END IF  
            END FOR  
        END FOR  
        SET ans TO empty list  
        SET vis TO list of False repeated n times  
        WHILE q is not empty  
            SET i TO element removed from front of q  
            APPEND i TO ans  
            FOR j FROM zero TO (m MINUS one)  
                IF vis at position (i PLUS j) IS False THEN  
                    SET vis at position (i PLUS j) TO True  
                    FOR each k IN g at position (i PLUS j)  
                        DECREMENT indeg at position k BY one  
                        IF indeg at position k EQUALS zero THEN  
                            APPEND k TO q  
                        END IF  
                    END FOR  
                END IF  
            END FOR  
        END WHILE  
        IF all elements in vis ARE True THEN  
            RETURN reverse of ans  
        ELSE  
            RETURN empty list  
        END IF  
    END FUNCTION  
END CLASS