CLASS Solution  
    FUNCTION profitableSchemes(self, n, minProfit, group, profit)  
        SET MOD TO one billion plus seven  
        INITIALIZE dp AS a two-dimensional list with (n plus one) rows AND (minProfit plus one) columns ALL set TO zero  
        FOR i FROM zero TO n  
            SET dp at row i column zero TO one  
        END FOR  

        FOR each element p, g TAKING elements FROM profit, group RESPECTIVELY  
            FOR i FROM n DOWN TO g  
                FOR j FROM minProfit DOWN TO zero  
                    SET dp at row i column j TO dp at row i column j PLUS dp at row (i MINUS g) column maximum of zero and (j MINUS p)  
                    SET dp at row i column j TO dp at row i column j MODULO MOD  
                END FOR  
            END FOR  
        END FOR  
        
        RETURN dp at row n column minProfit  
    END FUNCTION  
END CLASS