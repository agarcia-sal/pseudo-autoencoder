CLASS Solution  
    FUNCTION validTicTacToe(self, board)  
        SET countX TO zero  
        SET countO TO zero  
        
        FOR each row IN board  
            INCREMENT countX BY number of occurrences of character 'X' in row  
        END FOR  
        
        FOR each row IN board  
            INCREMENT countO BY number of occurrences of character 'O' in row  
        END FOR  
        
        IF countX LESS THAN countO OR countX GREATER THAN countO PLUS one THEN  
            RETURN False  
        END IF  
        
        FUNCTION check_win(player)  
            FOR each row IN board  
                IF row EQUALS player repeated three times THEN  
                    RETURN True  
                END IF  
            END FOR  
            
            FOR column FROM zero TO two  
                IF element at row zero and column EQUALS player AND element at row one and column EQUALS player AND element at row two and column EQUALS player THEN  
                    RETURN True  
                END IF  
            END FOR  
            
            IF element at row zero and column zero EQUALS player AND element at row one and column one EQUALS player AND element at row two and column two EQUALS player THEN  
                RETURN True  
            END IF  
            
            IF element at row zero and column two EQUALS player AND element at row one and column one EQUALS player AND element at row two and column zero EQUALS player THEN  
                RETURN True  
            END IF  
            
            RETURN False  
        END FUNCTION  
        
        SET winX TO result of check_win with argument 'X'  
        SET winO TO result of check_win with argument 'O'  
        
        IF winX AND winO THEN  
            RETURN False  
        END IF  
        
        IF winX AND countX EQUALS countO THEN  
            RETURN False  
        END IF  
        
        IF winO AND countX NOT EQUALS countO THEN  
            RETURN False  
        END IF  
        
        RETURN True  
    END FUNCTION  
END CLASS