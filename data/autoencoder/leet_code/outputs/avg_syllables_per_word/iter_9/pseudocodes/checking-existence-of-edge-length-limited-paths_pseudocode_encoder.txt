CLASS UnionFind  
    FUNCTION __init__(self, size)  
        SET self.parent TO list of integers from zero TO size MINUS one  
        SET self.rank TO list containing size elements each set TO one  
    END FUNCTION  

    FUNCTION find(self, p)  
        IF self.parent at index p NOT EQUALS p THEN  
            SET self.parent at index p TO result of self.find called with self.parent at index p  
        END IF  
        RETURN self.parent at index p  
    END FUNCTION  

    FUNCTION union(self, p, q)  
        SET rootP TO result of self.find called with p  
        SET rootQ TO result of self.find called with q  
        IF rootP EQUALS rootQ THEN  
            RETURN False  
        END IF  
        IF self.rank at index rootP GREATER THAN self.rank at index rootQ THEN  
            SET self.parent at index rootQ TO rootP  
        ELSE IF self.rank at index rootP LESS THAN self.rank at index rootQ THEN  
            SET self.parent at index rootP TO rootQ  
        ELSE  
            SET self.parent at index rootQ TO rootP  
            INCREMENT self.rank at index rootP BY one  
        END IF  
        RETURN True  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION distanceLimitedPathsExist(self, n, edgeList, queries)  
        CALL sort on edgeList using the third element of each edge as key in ascending order  
        
        SET indexedQueries TO list constructed as tuples of (limit, p, q, original index) extracted from queries  
        CALL sort on indexedQueries in ascending order  
        
        SET uf TO new instance of UnionFind constructed with n  
        
        SET edgeIndex TO zero  
        SET numEdges TO length of edgeList  
        SET results TO list of False of length equal to length of queries  
        
        FOR each tuple (limit, p, q, originalIndex) IN indexedQueries DO  
            WHILE edgeIndex LESS THAN numEdges AND third element of edgeList at index edgeIndex LESS THAN limit DO  
                SET u TO first element of edgeList at index edgeIndex  
                SET v TO second element of edgeList at index edgeIndex  
                CALL uf.union with arguments u and v  
                INCREMENT edgeIndex BY one  
            END WHILE  
            
            IF result of uf.find called with p EQUALS result of uf.find called with q THEN  
                SET results at index originalIndex TO True  
            END IF  
        END FOR  
        
        RETURN results  
    END FUNCTION  
END CLASS