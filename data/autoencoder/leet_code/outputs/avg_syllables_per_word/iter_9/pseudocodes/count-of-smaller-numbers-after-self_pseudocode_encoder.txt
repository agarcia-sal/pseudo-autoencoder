CLASS Solution  
    FUNCTION countSmaller(self, nums)  
        SET sorted_nums TO the sorted list of unique elements from nums  
        SET rank TO a mapping from each element in sorted_nums TO its position index PLUS one  
        
        SET bit TO a list of zeros with length equal to the length of sorted_nums PLUS one  
        
        FUNCTION get_sum(idx)  
            SET res TO zero  
            WHILE idx GREATER THAN zero  
                INCREMENT res BY the element of bit at position idx  
                DECREMENT idx BY the bitwise AND of idx and its negation  
            END WHILE  
            RETURN res  
        END FUNCTION  
        
        FUNCTION update(idx, delta)  
            WHILE idx LESS THAN the length of bit  
                INCREMENT the element of bit at position idx BY delta  
                INCREMENT idx BY the bitwise AND of idx and its negation  
            END WHILE  
        END FUNCTION  
        
        SET counts TO an empty list  
        FOR each num IN nums in reverse order  
            SET r TO the rank of num  
            APPEND get_sum(r MINUS one) TO counts  
            CALL update with parameters r and one  
        END FOR  
        
        RETURN counts reversed  
    END FUNCTION  
END CLASS