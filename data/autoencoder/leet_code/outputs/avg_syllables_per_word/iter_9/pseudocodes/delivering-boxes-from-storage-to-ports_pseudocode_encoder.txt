CLASS Solution  
    FUNCTION boxDelivering(self, boxes, portsCount, maxBoxes, maxWeight)  
        SET n TO length of boxes  
        SET dp TO list of size n plus one filled with infinity  
        SET dp at position zero TO zero  
        
        SET left TO zero  
        SET current_weight TO zero  
        SET extra_trips TO zero  
        
        FOR right FROM zero TO n MINUS one  
            INCREMENT current_weight BY second element of boxes at position right  
            IF right GREATER THAN zero AND first element of boxes at position right NOT EQUALS first element of boxes at position right MINUS one THEN  
                INCREMENT extra_trips BY one  
            END IF  
            
            WHILE left LESS THAN OR EQUAL TO right AND (right MINUS left PLUS one GREATER THAN maxBoxes OR current_weight GREATER THAN maxWeight)  
                DECREMENT current_weight BY second element of boxes at position left  
                IF left GREATER THAN zero AND first element of boxes at position left NOT EQUALS first element of boxes at position left MINUS one THEN  
                    DECREMENT extra_trips BY one  
                END IF  
                INCREMENT left BY one  
            END WHILE  
            
            SET dp at position right plus one TO dp at position left PLUS two PLUS extra_trips  
        END FOR  
        
        RETURN dp at position n  
    END FUNCTION  
END CLASS