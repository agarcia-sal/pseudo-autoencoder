CLASS Solution  
    FUNCTION countSubranges(self, nums1, nums2)  
        SET n TO the length of nums1  
        SET count TO zero  
        SET dp TO list of n elements, each element is a dictionary mapping integers to integers initialized empty  
        
        FOR i FROM zero TO n minus one  
            INCREMENT the value in dp at index i for key nums1 at index i BY one  
            INCREMENT the value in dp at index i for key negative nums2 at index i BY one  
            
            IF i GREATER THAN zero THEN  
                FOR each balance and freq IN the items of dp at index i minus one  
                    SET the value in dp at index i for key balance PLUS nums1 at index i TO the sum of its current value and freq, modulo MOD  
                    SET the value in dp at index i for key balance MINUS nums2 at index i TO the sum of its current value and freq, modulo MOD  
                END FOR  
            END IF  
            
            SET count TO the sum of count and the value in dp at index i for key zero, modulo MOD  
        END FOR  
        
        RETURN count  
    END FUNCTION  
END CLASS