CLASS Solution  
    FUNCTION numberOfPatterns(self, m, n)  
        SET jumps TO a mapping with pairs and their middle dots as follows:  
            pair one to three MAPS TO two  
            pair one to seven MAPS TO four  
            pair one to nine MAPS TO five  
            pair two to eight MAPS TO five  
            pair three to one MAPS TO two  
            pair three to seven MAPS TO five  
            pair three to nine MAPS TO six  
            pair four to six MAPS TO five  
            pair five to five MAPS TO five  
            pair six to four MAPS TO five  
            pair seven to one MAPS TO four  
            pair seven to three MAPS TO five  
            pair seven to nine MAPS TO eight  
            pair eight to two MAPS TO five  
            pair nine to one MAPS TO five  
            pair nine to three MAPS TO six  
            pair nine to seven MAPS TO eight  

        FUNCTION countPatternsFromDot(current, visited, length)  
            IF length EQUALS n THEN  
                RETURN one  
            END IF  
            IF length GREATER THAN OR EQUAL TO m THEN  
                SET count TO one  
            ELSE  
                SET count TO zero  
            END IF  
            FOR next_dot FROM one TO nine  
                IF visited at next_dot IS false THEN  
                    SET jump TO jumps at (current, next_dot) IF EXISTS ELSE null  
                    IF jump IS null OR visited at jump IS true THEN  
                        SET visited at next_dot TO true  
                        INCREMENT count BY countPatternsFromDot(next_dot, visited, length PLUS one)  
                        SET visited at next_dot TO false  
                    END IF  
                END IF  
            END FOR  
            RETURN count  
        END FUNCTION  

        SET visited TO a list of false with size ten  
        SET result TO zero  
        FOR i FROM one TO nine  
            SET visited at i TO true  
            INCREMENT result BY countPatternsFromDot(i, visited, one)  
            SET visited at i TO false  
        END FOR  

        RETURN result  
    END FUNCTION  
END CLASS