CLASS Solution  
    FUNCTION containVirus(self, isInfected)  
        FUNCTION neighbors(r, c)  
            RETURN list containing  
                pair of r PLUS one AND c,  
                pair of r MINUS one AND c,  
                pair of r AND c PLUS one,  
                pair of r AND c MINUS one  
        END FUNCTION  

        FUNCTION bfs(r, c)  
            SET infected TO empty set  
            SET threatened TO empty set  
            SET queue TO deque initialized with pair of r AND c  
            SET visited TO set initialized with pair of r AND c  
            WHILE queue is not empty DO  
                REMOVE first element FROM queue AND SET to x, y  
                ADD pair of x AND y TO infected  
                FOR each pair nx, ny IN neighbors(x, y) DO  
                    IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n AND pair of nx AND ny NOT IN visited THEN  
                        ADD pair of nx AND ny TO visited  
                        IF isInfected at position nx AND ny EQUALS one THEN  
                            APPEND pair of nx AND ny TO queue  
                        ELSE IF isInfected at position nx AND ny EQUALS zero THEN  
                            ADD pair of nx AND ny TO threatened  
                        END IF  
                    END IF  
                END FOR  
            END WHILE  
            RETURN infected, threatened  
        END FUNCTION  

        FUNCTION build_walls(infected)  
            SET walls TO zero  
            FOR each pair x, y IN infected DO  
                FOR each pair nx, ny IN neighbors(x, y) DO  
                    IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n AND isInfected at position nx AND ny EQUALS zero THEN  
                        INCREMENT walls BY one  
                    END IF  
                END FOR  
            END FOR  
            RETURN walls  
        END FUNCTION  

        FUNCTION spread_virus(threatened)  
            FOR each pair x, y IN threatened DO  
                SET isInfected at position x AND y TO one  
            END FOR  
        END FUNCTION  

        SET m TO length of isInfected  
        SET n TO length of first element in isInfected  
        SET total_walls TO zero  

        WHILE true DO  
            SET regions TO empty list  
            SET visited TO empty set  
            FOR r FROM zero TO m MINUS one DO  
                FOR c FROM zero TO n MINUS one DO  
                    IF isInfected at position r AND c EQUALS one AND pair of r AND c NOT IN visited THEN  
                        SET infected, threatened TO result of bfs(r, c)  
                        APPEND pair of infected AND threatened TO regions  
                        SET visited TO union of visited AND infected  
                    END IF  
                END FOR  
            END FOR  

            IF regions is empty THEN  
                BREAK  
            END IF  

            SORT regions IN descending order BY length of second element of each region  

            INCREMENT total_walls BY result of build_walls on first element's infected set in regions  
            FOR each pair x, y IN infected set of first element in regions DO  
                SET isInfected at position x AND y TO minus one  
            END FOR  

            FOR i FROM one TO length of regions MINUS one DO  
                CALL spread_virus with threatened set of regions at index i  
            END FOR  
        END WHILE  

        RETURN total_walls  
    END FUNCTION  
END CLASS