CLASS Solution  
    FUNCTION longestCommonSubpath(self, n, paths)  
        FUNCTION hash_subpaths(path, length)  
            SET P TO 113  
            SET MOD TO one billion plus seven  
            SET hash_value TO zero  
            SET power TO one  
            
            FOR index FROM zero TO length MINUS one  
                SET hash_value TO (hash_value MULTIPLIED BY P PLUS element at path index) MODULO MOD  
                SET power TO (power MULTIPLIED BY P) MODULO MOD  
            END FOR  
            
            SET hashes TO a set containing hash_value  
            FOR index FROM length TO length of path MINUS one  
                SET hash_value TO ((hash_value MULTIPLIED BY P PLUS element at path index) MINUS element at path index MINUS length MULTIPLIED BY power) MODULO MOD  
                ADD hash_value TO hashes  
            END FOR  
            
            RETURN hashes  
        END FUNCTION  
        
        FUNCTION check_common_subpath(length)  
            IF length EQUALS zero THEN  
                RETURN True  
            END IF  
            
            SET common_hashes TO result of hash_subpaths on first path with length  
            FOR each path IN paths starting from second element  
                SET current_hashes TO result of hash_subpaths on path with length  
                SET common_hashes TO intersection of common_hashes AND current_hashes  
                IF common_hashes IS empty THEN  
                    RETURN False  
                END IF  
            END FOR  
            
            RETURN boolean value of common_hashes  
        END FUNCTION  
        
        SET left TO zero  
        SET right TO minimum length among all paths  
        WHILE left LESS THAN right  
            SET mid TO integer division result of (left PLUS right PLUS one) DIVIDED BY two  
            IF check_common_subpath(mid) THEN  
                SET left TO mid  
            ELSE  
                SET right TO mid MINUS one  
            END IF  
        END WHILE  
        
        RETURN left  
    END FUNCTION  
END CLASS