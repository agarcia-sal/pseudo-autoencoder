CLASS Solution  
    FUNCTION val(c)  
        RETURN character code of c MINUS character code of letter 'a' PLUS one  
    END FUNCTION  

    FUNCTION subStrHash(s, power, modulo, k, hashValue)  
        SET n TO length of s  
        SET current_hash TO zero  
        SET p_pow TO one  

        FOR each index FROM n MINUS k TO n MINUS one  
            SET current_hash TO remainder of current_hash PLUS val(character at s at index) MULTIPLIED BY p_pow DIVIDED BY modulo  
            IF index LESS THAN n MINUS one THEN  
                SET p_pow TO remainder of p_pow MULTIPLIED BY power DIVIDED BY modulo  
            END IF  
        END FOR  

        SET start_index TO n MINUS k  
        IF current_hash EQUALS hashValue THEN  
            RETURN substring of s FROM start_index TO end  
        END IF  

        SET p_pow_k_minus_1 TO p_pow  
        FOR each index FROM n MINUS k MINUS one DOWN TO zero  
            SET current_hash TO remainder of current_hash MINUS val(character at s at index PLUS k) MULTIPLIED BY p_pow_k_minus_1 DIVIDED BY modulo  
            SET current_hash TO remainder of current_hash MULTIPLIED BY power PLUS val(character at s at index) DIVIDED BY modulo  

            IF current_hash EQUALS hashValue THEN  
                SET start_index TO index  
            END IF  
        END FOR  

        RETURN substring of s FROM start_index TO start_index PLUS k  
    END FUNCTION  
END CLASS