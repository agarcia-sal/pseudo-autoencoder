CLASS Solution  
    FUNCTION leastInterval(self, tasks, n)  
        SET task_counts TO the frequency count of each element in tasks  
        SET max_heap TO empty list  
        FOR each count IN the values of task_counts  
            APPEND the negative of count TO max_heap  
        END FOR  
        TRANSFORM max_heap INTO a heap structure  
        
        SET time TO zero  
        SET queue TO empty list  
        
        WHILE max_heap is not empty OR queue is not empty  
            WHILE queue is not empty AND the first element's first item EQUALS time  
                REMOVE first element FROM queue AND SET to temporary pair  
                SET _, count TO temporary pair  
                IF count LESS THAN zero THEN  
                    INSERT count INTO max_heap maintaining heap property  
                END IF  
            END WHILE  
            
            IF max_heap is not empty THEN  
                REMOVE smallest element FROM max_heap AND SET TO count  
                INCREMENT count BY one  
                IF count LESS THAN zero THEN  
                    APPEND pair of (time PLUS n PLUS one, count) TO queue  
                END IF  
            END IF  
            
            INCREMENT time BY one  
        END WHILE  
        
        RETURN time  
    END FUNCTION  
END CLASS