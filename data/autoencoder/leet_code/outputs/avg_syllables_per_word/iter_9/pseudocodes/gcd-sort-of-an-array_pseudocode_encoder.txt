CLASS UnionFind  
    FUNCTION __init__(self, size)  
        SET self.parent TO list of numbers FROM zero TO size MINUS one  
        SET self.rank TO list of size elements each EQUAL TO one  
    END FUNCTION  

    FUNCTION find(self, p)  
        IF self.parent at position p NOT EQUALS p THEN  
            SET self.parent at position p TO self.find(self.parent at position p)  
        END IF  
        RETURN self.parent at position p  
    END FUNCTION  

    FUNCTION union(self, p, q)  
        SET rootP TO self.find(p)  
        SET rootQ TO self.find(q)  
        IF rootP EQUALS rootQ THEN  
            RETURN False  
        END IF  
        IF self.rank at rootP GREATER THAN self.rank at rootQ THEN  
            SET self.parent at rootQ TO rootP  
        ELSE IF self.rank at rootP LESS THAN self.rank at rootQ THEN  
            SET self.parent at rootP TO rootQ  
        ELSE  
            SET self.parent at rootQ TO rootP  
            INCREMENT self.rank at rootP BY one  
        END IF  
        RETURN True  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION gcdSort(self, nums)  
        SET sorted_nums TO nums sorted in ascending order  
        SET max_val TO maximum value in nums  
        SET uf TO new UnionFind object initialized with max_val PLUS one  
        
        FOR each num IN nums  
            FOR each factor FROM two TO integer part of square root of num PLUS one  
                IF num modulo factor EQUALS zero THEN  
                    CALL uf.union with parameters num and factor  
                    CALL uf.union with parameters num and integer division of num by factor  
                END IF  
            END FOR  
        END FOR  
        
        FOR index FROM zero TO length of nums MINUS one  
            IF uf.find(nums at index) NOT EQUALS uf.find(sorted_nums at index) THEN  
                RETURN False  
            END IF  
        END FOR  
        
        RETURN True  
    END FUNCTION  
END CLASS