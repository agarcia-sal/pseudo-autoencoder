CLASS Solution
    FUNCTION maxEqualFreq(nums)
        SET count TO a new frequency counter mapping numbers to their frequencies
        SET freq TO a new frequency counter mapping frequencies to their counts
        SET max_len TO zero

        FOR each index AND number IN the enumeration of nums
            INCREMENT the frequency count of number in count BY one

            IF the frequency count of number in count IS GREATER THAN one
                DECREMENT the frequency count corresponding to the old frequency WHICH IS the frequency count of number MINUS one in freq BY one
                IF the frequency count corresponding to the old frequency in freq IS EQUAL TO zero
                    REMOVE the old frequency FROM freq
                END IF
            END IF

            INCREMENT the frequency count corresponding to the new frequency WHICH IS the frequency count of number in count in freq BY one

            IF the number of distinct frequencies recorded in freq IS EQUAL TO one AND (the frequency one EXISTS AS a key in freq OR the single count in freq IS EQUAL TO one)
                SET max_len TO index PLUS one
            ELSE IF the number of distinct frequencies recorded in freq IS EQUAL TO two AND ((the frequency one EXISTS AS a key in freq AND the count of that frequency IS EQUAL TO one) OR (the difference BETWEEN the maximum frequency key in freq AND the minimum frequency key in freq IS EQUAL TO one AND the frequency count of the maximum frequency key in freq IS EQUAL TO one))
                SET max_len TO index PLUS one
            END IF
        END FOR

        RETURN max_len
    END FUNCTION
END CLASS