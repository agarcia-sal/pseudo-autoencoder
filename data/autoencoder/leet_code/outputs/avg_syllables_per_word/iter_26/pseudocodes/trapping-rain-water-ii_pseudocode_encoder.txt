CLASS Solution
    FUNCTION trapRainWater(heightMap)
        IF heightMap IS EMPTY OR element at position zero OF heightMap IS EMPTY
            RETURN zero
        END IF

        SET m TO the LENGTH OF heightMap
        SET n TO the LENGTH OF element at position zero OF heightMap
        SET visited TO a two dimensional list of BOOLEAN false repeated n times FOR EACH of m times
        SET min_heap TO an empty list

        FOR index i FROM zero TO m MINUS one INCLUSIVE
            PUSH the TUPLE containing element at position i OF heightMap AT position zero, i, zero INTO min_heap
            PUSH the TUPLE containing element at position i OF heightMap AT position n MINUS one, i, n MINUS one INTO min_heap
            SET element at position i AT position zero OF visited TO true
            SET element at position i AT position n MINUS one OF visited TO true
        END FOR

        FOR index j FROM zero TO n MINUS one INCLUSIVE
            PUSH the TUPLE containing element at position zero OF heightMap AT position j, zero, j INTO min_heap
            PUSH the TUPLE containing element at position m MINUS one OF heightMap AT position j, m MINUS one, j INTO min_heap
            SET element at position zero AT position j OF visited TO true
            SET element at position m MINUS one AT position j OF visited TO true
        END FOR

        SET directions TO the list of TUPLES: first is MINUS one and zero, second is one and zero, third is zero and MINUS one, fourth is zero and one
        SET water_trapped TO zero

        WHILE min_heap HOLDS
            REMOVE and RETURN the smallest element from min_heap INTO the TUPLE containing height, x, y

            FOR each TUPLE dx, dy IN directions
                SET nx TO x PLUS dx
                SET ny TO y PLUS dy

                IF nx IS GREATER THAN OR EQUAL TO zero AND nx IS LESS THAN m AND ny IS GREATER THAN OR EQUAL TO zero AND ny IS LESS THAN n AND element at position nx AT position ny OF visited IS false
                    SET element at position nx AT position ny OF visited TO true
                    INCREMENT water_trapped BY the GREATER OF zero AND height MINUS element at position nx AT position ny OF heightMap
                    PUSH the TUPLE containing the GREATER OF height AND element at position nx AT position ny OF heightMap, nx, ny INTO min_heap
                END IF
            END FOR
        END WHILE

        RETURN water_trapped
    END FUNCTION
END CLASS