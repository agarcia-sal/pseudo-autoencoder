CLASS Solution
    FUNCTION longestDupSubstring(s)
        FUNCTION search(length)
            SET seen TO an empty set
            FOR index FROM zero TO the LENGTH OF s MINUS length PLUS one EXCLUSIVE
                SET substring TO the substring FROM position index TO position index PLUS length EXCLUSIVE OF s
                IF substring IS IN seen
                    RETURN substring
                END IF
                ADD substring TO seen
            END FOR
            RETURN the empty string
        END FUNCTION

        SET left_pointer TO one
        SET right_pointer TO the LENGTH OF s MINUS one
        SET longest_substring TO the empty string

        WHILE left_pointer IS LESS THAN OR EQUAL TO right_pointer HOLDS
            SET middle_value TO the integer division OF left_pointer PLUS right_pointer BY two
            SET candidate_substring TO CALL search WITH middle_value
            IF candidate_substring IS NOT the empty string
                SET longest_substring TO candidate_substring
                SET left_pointer TO middle_value PLUS one
            ELSE
                SET right_pointer TO middle_value MINUS one
            END IF
        END WHILE

        RETURN longest_substring
    END FUNCTION
END CLASS