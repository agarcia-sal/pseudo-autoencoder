CLASS Solution
    FUNCTION longestCommonSubpath(number_of_cities, list_of_paths)
        FUNCTION hash_subpaths(path, length)
            SET base_prime TO one hundred and thirteen
            SET modulus TO one billion plus seven
            SET hash_value TO zero
            SET power TO one
            
            FOR index FROM zero TO length MINUS one INCLUSIVE
                SET hash_value TO hash_value MULTIPLIED BY base_prime PLUS element at position index OF path
                SET hash_value TO hash_value MODULO modulus
                SET power TO power MULTIPLIED BY base_prime
                SET power TO power MODULO modulus
            END FOR
            
            SET hashes TO a new set containing hash_value
            
            FOR index FROM length TO the LENGTH OF path MINUS one INCLUSIVE
                SET hash_value TO hash_value MULTIPLIED BY base_prime PLUS element at position index OF path MINUS element at position index MINUS length OF path MULTIPLIED BY power
                SET hash_value TO hash_value MODULO modulus
                ADD hash_value TO hashes
            END FOR
            
            RETURN hashes
        END FUNCTION
        
        FUNCTION check_common_subpath(length)
            IF length EQUALS zero THEN
                RETURN True
            END IF
            
            SET common_hashes TO hash_subpaths(element at position zero OF list_of_paths, length)
            
            FOR each path IN all elements of list_of_paths EXCLUDING element at position zero
                SET current_hashes TO hash_subpaths(path, length)
                SET common_hashes TO the INTERSECTION of common_hashes AND current_hashes
                IF common_hashes IS empty THEN
                    RETURN False
                END IF
            END FOR
            
            RETURN True IF common_hashes IS NOT empty OTHERWISE False
        END FUNCTION
        
        SET left TO zero
        SET right TO the MINIMUM of the LENGTHS of each path IN list_of_paths
        
        WHILE left IS LESS THAN right
            SET middle TO left PLUS right PLUS one DIVIDED BY two WITH INTEGER DIVISION
            IF check_common_subpath(middle) THEN
                SET left TO middle
            ELSE
                SET right TO right MINUS one
            END IF
        END WHILE
        
        RETURN left
    END FUNCTION
END CLASS