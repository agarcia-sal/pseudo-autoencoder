CLASS Solution
    FUNCTION rearrangeSticks(number_of_sticks, number_of_visible_sticks)
        SET modulus_value TO ten RAISED TO THE power OF nine PLUS one
        
        SET dp_table TO a two dimensional list OF zeros WITH number_of_sticks PLUS one rows AND number_of_visible_sticks PLUS one columns
        
        SET element at position zero OF element at position zero OF dp_table TO one
        
        FOR index_i FROM one TO number_of_sticks INCLUSIVE
            FOR index_j FROM one TO number_of_visible_sticks INCLUSIVE
                SET element at position index_i OF element at position index_j OF dp_table TO element at position index_i MINUS one OF element at position index_j MINUS one OF dp_table PLUS index_i MINUS one MULTIPLIED BY element at position index_i MINUS one OF element at position index_j OF dp_table MODULO modulus_value
            END FOR
        END FOR
        
        RETURN element at position number_of_sticks OF element at position number_of_visible_sticks OF dp_table
    END FUNCTION
END CLASS