CLASS Solution
    FUNCTION minFallingPathSum(grid AS List OF List OF Integer)
        IF grid IS EMPTY OR the LENGTH OF grid IS ZERO OR the LENGTH OF element at position zero OF grid IS ZERO
            RETURN zero
        END IF

        SET n TO the LENGTH OF grid

        IF n EQUALS one
            RETURN the MINIMUM element IN element at position zero OF grid
        END IF

        SET dp TO a NEW list CONTAINING all elements FROM element at position zero OF grid

        FOR i FROM one TO n MINUS one INCLUSIVE
            SET new_dp TO a NEW list WITH n TIMES zero

            SET min1 TO infinity
            SET min2 TO infinity
            SET min1_index TO negative one

            FOR j FROM zero TO n MINUS one INCLUSIVE
                IF element at position j OF dp IS LESS THAN min1
                    SET min2 TO min1
                    SET min1 TO element at position j OF dp
                    SET min1_index TO j
                ELSE IF element at position j OF dp IS LESS THAN min2
                    SET min2 TO element at position j OF dp
                END IF
            END FOR

            FOR j FROM zero TO n MINUS one INCLUSIVE
                IF j EQUALS min1_index
                    SET element at position j OF new_dp TO element at position i THEN position j OF grid PLUS min2
                ELSE
                    SET element at position j OF new_dp TO element at position i THEN position j OF grid PLUS min1
                END IF
            END FOR

            SET dp TO a NEW list CONTAINING all elements FROM new_dp
        END FOR

        RETURN the MINIMUM element IN dp
    END FUNCTION
END CLASS