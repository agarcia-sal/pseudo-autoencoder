CLASS Solution
    FUNCTION maxNumber(nums1, nums2, k)
        FUNCTION maxSingleArray(nums, k)
            SET drop TO the LENGTH OF nums MINUS k
            SET stack TO an empty list
            FOR each num IN nums
                WHILE drop GREATER THAN zero AND stack IS NOT empty AND the ELEMENT at the last POSITION OF stack LESS THAN num
                    REMOVE the ELEMENT at the last POSITION OF stack
                    DECREMENT drop BY one
                END WHILE
                APPEND num TO stack
            END FOR
            RETURN the FIRST k ELEMENTS OF stack
        END FUNCTION

        FUNCTION merge(arr1, arr2)
            SET merged_list TO an empty list
            SET total_length TO the LENGTH OF arr1 PLUS the LENGTH OF arr2
            FOR each iteration IN total_length TIMES
                IF arr1 IS GREATER THAN arr2 IN LEXICOGRAPHICAL ORDER
                    REMOVE the FIRST ELEMENT FROM arr1 AND APPEND it TO merged_list
                ELSE
                    REMOVE the FIRST ELEMENT FROM arr2 AND APPEND it TO merged_list
                END IF
            END FOR
            RETURN merged_list
        END FUNCTION

        SET max_number TO an empty list
        FOR i FROM zero TO k INCLUSIVE
            IF i LESS THAN OR EQUAL TO the LENGTH OF nums1 AND k MINUS i LESS THAN OR EQUAL TO the LENGTH OF nums2
                SET candidate TO merge(maxSingleArray(nums1, i), maxSingleArray(nums2, k MINUS i))
                IF candidate IS GREATER THAN max_number IN LEXICOGRAPHICAL ORDER
                    SET max_number TO candidate
                END IF
            END IF
        END FOR
        RETURN max_number
    END FUNCTION
END CLASS