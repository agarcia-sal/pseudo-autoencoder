CLASS Solution
    FUNCTION minNumberOfSemesters(number_of_courses, list_of_relations, maximum_courses_per_semester)
        SET graph TO a mapping from each course TO an empty list
        SET in_degree TO a list of zeros with length EQUAL TO number_of_courses PLUS one

        FOR each pair previous_course AND next_course IN list_of_relations
            APPEND next_course TO the list associated WITH previous_course IN graph
            INCREMENT the element at position next_course OF in_degree BY one
        END FOR

        SET queue TO an empty double-ended queue

        FOR course FROM one TO number_of_courses INCLUSIVE
            IF the element at position course OF in_degree EQUALS zero THEN
                APPEND course TO queue
            END IF
        END FOR

        SET semesters TO zero

        WHILE queue HOLDS
            SET maximum_courses_this_semester TO the minimum of maximum_courses_per_semester AND the LENGTH OF queue

            FOR counter FROM one TO maximum_courses_this_semester INCLUSIVE
                SET current_course TO the element removed from the front OF queue

                FOR each next_course IN the list associated WITH current_course IN graph
                    DECREMENT the element at position next_course OF in_degree BY one

                    IF the element at position next_course OF in_degree EQUALS zero THEN
                        APPEND next_course TO queue
                    END IF
                END FOR
            END FOR

            INCREMENT semesters BY one
        END WHILE

        RETURN semesters
    END FUNCTION
END CLASS