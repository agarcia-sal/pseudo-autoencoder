CLASS Solution
    FUNCTION longestPath(parent LIST OF integers, s STRING)
        IMPORT a collection type THAT PROVIDES a default value OF an empty list FOR unseen keys
        
        SET tree TO a default dictionary OF lists
        
        FOR each index i AND corresponding element p IN the enumeration OF parent
            IF p IS NOT EQUAL TO negative one
                APPEND i TO the list ASSOCIATED WITH key p IN tree
            END IF
        END FOR
        
        SET self dot result TO one
        
        FUNCTION dfs(node)
            SET max1 TO zero
            SET max2 TO zero
            
            FOR each child IN the list ASSOCIATED WITH node IN tree
                SET child_length TO THE RESULT OF dfs CALLED WITH child
                
                IF the character AT position child OF s IS NOT EQUAL TO the character AT position node OF s
                    IF child_length IS GREATER THAN max1
                        SET max2 TO max1
                        SET max1 TO child_length
                    ELSE IF child_length IS GREATER THAN max2
                        SET max2 TO child_length
                    END IF
                END IF
            END FOR
            
            SET self dot result TO THE GREATER OF self dot result AND max1 PLUS max2 PLUS one
            
            RETURN max1 PLUS one
        END FUNCTION
        
        CALL dfs WITH argument zero
        
        RETURN self dot result
    END FUNCTION
END CLASS