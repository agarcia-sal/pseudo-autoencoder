CLASS Solution
    FUNCTION numDistinctIslands2(grid)
        FUNCTION dfs(x, y, island)
            IF x LESS THAN zero OR x GREATER THAN OR EQUAL TO the LENGTH OF grid OR y LESS THAN zero OR y GREATER THAN OR EQUAL TO the LENGTH OF element at position zero OF grid OR element at position x OF grid AT position y EQUALS zero
                RETURN
            END IF
            SET element at position x OF grid AT position y TO zero
            APPEND tuple of x AND y TO island
            CALL dfs WITH x PLUS one, y, AND island
            CALL dfs WITH x MINUS one, y, AND island
            CALL dfs WITH x, y PLUS one, AND island
            CALL dfs WITH x, y MINUS one, AND island
        END FUNCTION

        FUNCTION normalize(island)
            SET shapes TO empty list
            FOR each pair dx AND dy IN list of pairs consisting of one and one, one and negative one, negative one and one, negative one and negative one
                SET new_island TO empty list
                FOR each pair x AND y IN island
                    APPEND tuple of x MULTIPLIED BY dx AND y MULTIPLIED BY dy TO new_island
                END FOR
                SORT new_island IN ascending order
                SET min_x TO the minimum x value FOR all pairs x AND y IN new_island
                SET min_y TO the minimum y value FOR all pairs x AND y IN new_island
                APPEND tuple of pairs where each pair is x MINUS min_x AND y MINUS min_y FOR each pair x AND y IN new_island TO shapes
            END FOR
            FOR index i FROM zero TO the LENGTH OF shapes MINUS one INCLUSIVE
                APPEND tuple of pairs where each pair is y AND negative x FOR each pair x AND y IN element at position i OF shapes TO shapes
            END FOR
            RETURN the minimum element IN shapes
        END FUNCTION

        SET islands TO empty set
        FOR index i FROM zero TO the LENGTH OF grid MINUS one INCLUSIVE
            FOR index j FROM zero TO the LENGTH OF element at position zero OF grid MINUS one INCLUSIVE
                IF element at position i OF grid AT position j EQUALS one
                    SET island TO empty list
                    CALL dfs WITH i, j, AND island
                    ADD normalize(island) TO islands
                END IF
            END FOR
        END FOR

        RETURN the LENGTH OF islands
    END FUNCTION
END CLASS