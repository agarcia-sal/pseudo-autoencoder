CLASS Solution
    FUNCTION getLengthOfOptimalCompression(s, k)
        FUNCTION dp(i, k_remaining, previous_character, previous_count)
            IF k_remaining LESS THAN zero
                RETURN infinity
            END IF

            IF i EQUALS the LENGTH OF s
                RETURN zero
            END IF

            IF element at position i OF s EQUALS previous_character
                SET increment TO one IF previous_count EQUALS one OR previous_count EQUALS nine OR previous_count EQUALS ninety nine OTHERWISE zero
                RETURN increment PLUS dp(i PLUS one, k_remaining, previous_character, previous_count PLUS one)
            ELSE
                SET keep_length TO one PLUS dp(i PLUS one, k_remaining, element at position i OF s, one)
                SET delete_length TO dp(i PLUS one, k_remaining MINUS one, previous_character, previous_count)
                RETURN the MINIMUM OF keep_length AND delete_length
            END IF
        END FUNCTION

        RETURN dp(zero, k, empty string, zero)
    END FUNCTION
END CLASS