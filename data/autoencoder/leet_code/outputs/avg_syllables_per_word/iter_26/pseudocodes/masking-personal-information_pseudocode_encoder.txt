CLASS Solution
    FUNCTION maskPII(string_input)
        IF the character AT position one OF string_input EQUALS the character AT position one OF the string containing only the character at SIGN
            ASSIGN local_part AND domain_part TO the result of splitting string_input AT the character at SIGN
            SET masked_local_part TO concatenation of the element at position zero OF local_part PLUS the string consisting of the character ASTERISK repeated five times PLUS the element at the last position OF local_part
            RETURN concatenation of masked_local_part converted TO LOWERCASE PLUS the character at SIGN PLUS domain_part converted TO LOWERCASE
        ELSE
            SET digit_characters TO concatenation of all elements filtered from string_input where each element passes the condition of being a digit character
            SET local_phone_number TO concatenation of the string consisting of three ASTERISK characters PLUS the character DASH PLUS three ASTERISK characters PLUS the character DASH PLUS the substring consisting of the last four characters of digit_characters
            IF the LENGTH OF digit_characters EQUALS ten
                RETURN local_phone_number
            ELSE
                SET country_code_length TO the LENGTH OF digit_characters MINUS ten
                SET country_code_mask TO concatenation of the character PLUS PLUS the string consisting of the character ASTERISK repeated country_code_length times PLUS the character DASH
                RETURN concatenation of country_code_mask PLUS local_phone_number
            END IF
        END IF
    END FUNCTION
END CLASS