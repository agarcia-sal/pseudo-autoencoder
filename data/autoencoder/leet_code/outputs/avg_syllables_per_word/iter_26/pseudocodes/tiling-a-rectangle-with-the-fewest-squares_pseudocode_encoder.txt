CLASS Solution
    FUNCTION tilingRectangle(n, m)
        FUNCTION backtrack(heights, moves)
            ACCESS min_moves FROM OUTER SCOPE
            IF the CONDITION that ALL elements h IN heights ARE EQUAL TO n HOLDS
                SET min_moves TO the MINIMUM OF min_moves AND moves
                RETURN
            END IF

            IF moves IS GREATER THAN OR EQUAL TO min_moves
                RETURN
            END IF

            SET min_height TO the MINIMUM value AMONG heights
            SET left TO the POSITION OF min_height WITHIN heights
            SET right TO left
            WHILE right IS LESS THAN m AND the ELEMENT AT POSITION right OF heights IS EQUAL TO min_height
                INCREMENT right BY one
            END WHILE

            FOR size FROM right MINUS left DOWN TO one INCLUSIVE
                IF for ALL i FROM zero TO size MINUS one INCLUSIVE the ELEMENT AT POSITION left PLUS i OF heights PLUS size IS LESS THAN OR EQUAL TO n HOLDS
                    SET new_heights TO a COPY OF heights
                    FOR i FROM zero TO size MINUS one INCLUSIVE
                        INCREMENT the ELEMENT AT POSITION left PLUS i OF new_heights BY size
                    END FOR
                    CALL backtrack WITH new_heights AND moves PLUS one
                END IF
            END FOR
        END FUNCTION

        SET min_moves TO positive infinity
        CALL backtrack WITH a LIST OF zero REPEATED m TIMES AND zero
        RETURN min_moves
    END FUNCTION
END CLASS