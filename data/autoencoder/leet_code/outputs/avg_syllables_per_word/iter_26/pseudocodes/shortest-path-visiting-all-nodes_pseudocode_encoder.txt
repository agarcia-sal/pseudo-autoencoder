CLASS Solution
    FUNCTION shortestPathLength(graph)
        IF graph IS empty
            RETURN zero
        END IF

        SET number_of_nodes TO the LENGTH OF graph

        SET queue TO a double ended queue initialized with each pair of node AND one shifted left BY node positions FOR each node FROM zero TO number_of_nodes MINUS one INCLUSIVE

        SET visited TO a set containing each pair of node AND one shifted left BY node positions FOR each node FROM zero TO number_of_nodes MINUS one INCLUSIVE

        SET steps TO zero

        SET all_nodes_visited TO one shifted left BY number_of_nodes positions MINUS one

        WHILE queue HOLDS
            FOR index FROM zero TO the LENGTH OF queue MINUS one INCLUSIVE
                REMOVE the leftmost element FROM queue AND UNPACK INTO current_node AND visited_nodes

                IF visited_nodes EQUALS all_nodes_visited
                    RETURN steps
                END IF

                FOR each neighbor IN the element at position current_node OF graph
                    SET next_visited_nodes TO visited_nodes OR one shifted left BY neighbor positions
                    SET next_state TO the pair of neighbor AND next_visited_nodes

                    IF next_state IS NOT IN visited
                        ADD next_state TO visited
                        APPEND next_state TO queue
                    END IF
                END FOR
            END FOR

            INCREMENT steps BY one
        END WHILE

        RETURN negative one
    END FUNCTION
END CLASS