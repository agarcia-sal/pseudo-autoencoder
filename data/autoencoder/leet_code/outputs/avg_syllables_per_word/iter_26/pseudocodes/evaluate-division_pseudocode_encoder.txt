CLASS Solution
    FUNCTION calcEquation(equations AS list of list of string, values AS list of floating point numbers, queries AS list of list of string) RETURNS list of floating point numbers
        SET graph TO a default dictionary with default type as dictionary

        FOR each pair of variable names a AND b AND corresponding value IN the pairing of equations AND values simultaneously
            SET the value at key b OF dictionary at key a OF graph TO value
            SET the value at key a OF dictionary at key b OF graph TO one DIVIDED BY value
        END FOR

        FUNCTION dfs(start AS string, end AS string, visited AS set of strings) RETURNS floating point number
            IF start NOT IN keys of graph OR end NOT IN keys of graph THEN
                RETURN negative one point zero
            END IF

            IF start EQUALS end THEN
                RETURN one point zero
            END IF

            ADD start TO visited

            FOR each neighbor AND corresponding weight IN items of dictionary at key start OF graph
                IF neighbor NOT IN visited THEN
                    SET result TO CALL dfs with neighbor, end, visited
                    IF result NOT EQUALS negative one point zero THEN
                        RETURN weight MULTIPLIED BY result
                    END IF
                END IF
            END FOR

            REMOVE start FROM visited

            RETURN negative one point zero
        END FUNCTION

        SET results TO empty list

        FOR each query IN queries
            SET start TO element at position zero OF query
            SET end TO element at position one OF query
            SET visited TO empty set
            SET result TO CALL dfs with arguments start, end, visited
            APPEND result TO results
        END FOR

        RETURN results
    END FUNCTION
END CLASS