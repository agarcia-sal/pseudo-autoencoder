CLASS Solution
    FUNCTION validTicTacToe(board)
        SET countX TO the SUM OF the COUNT OF the character X IN each row OF board
        SET countO TO the SUM OF the COUNT OF the character O IN each row OF board
        
        IF countX LESS THAN countO OR countX GREATER THAN countO PLUS one
            RETURN False
        END IF
        
        FUNCTION check_win(player)
            FOR each row IN board
                IF row EQUALS the concatenation of player repeated three times
                    RETURN True
                END IF
            END FOR
            
            FOR col FROM zero TO two INCLUSIVE
                IF the element at position col OF the element at position zero OF board EQUALS player AND the element at position col OF the element at position one OF board EQUALS player AND the element at position col OF the element at position two OF board EQUALS player
                    RETURN True
                END IF
            END FOR
            
            IF the element at position zero OF the element at position zero OF board EQUALS player AND the element at position one OF the element at position one OF board EQUALS player AND the element at position two OF the element at position two OF board EQUALS player
                RETURN True
            END IF
            
            IF the element at position two OF the element at position zero OF board EQUALS player AND the element at position one OF the element at position one OF board EQUALS player AND the element at position zero OF the element at position two OF board EQUALS player
                RETURN True
            END IF
            
            RETURN False
        END FUNCTION
        
        SET winX TO the result of check_win WITH argument the character X
        SET winO TO the result of check_win WITH argument the character O
        
        IF winX AND winO
            RETURN False
        END IF
        
        IF winX AND countX EQUALS countO
            RETURN False
        END IF
        
        IF winO AND countX NOT EQUALS countO
            RETURN False
        END IF
        
        RETURN True
    END FUNCTION
END CLASS