CLASS Solution
    FUNCTION numBusesToDestination(routes AS LIST OF LIST OF NUMBERS, source AS NUMBER, target AS NUMBER) RETURNS NUMBER
        IF source EQUALS target THEN
            RETURN zero
        END IF

        SET stop_to_buses TO an empty mapping from stop to list of buses
        FOR each bus WITH index bus_index AND route IN routes
            FOR each stop IN route
                APPEND bus_index TO the list associated WITH stop IN stop_to_buses
            END FOR
        END FOR

        SET bus_queue TO an empty double-ended queue
        SET visited_buses TO an empty set
        SET visited_stops TO an empty set

        FOR each bus IN the list associated WITH source IN stop_to_buses
            APPEND a tuple consisting of bus AND one TO bus_queue
            ADD bus TO visited_buses
        END FOR
        ADD source TO visited_stops

        WHILE bus_queue HOLDS
            REMOVE the first element FROM bus_queue ASSIGNING TO current_bus AND bus_count

            FOR each stop IN the list at element current_bus OF routes
                IF stop EQUALS target THEN
                    RETURN bus_count
                END IF

                IF stop NOT IN visited_stops THEN
                    ADD stop TO visited_stops
                    FOR each next_bus IN the list associated WITH stop IN stop_to_buses
                        IF next_bus NOT IN visited_buses THEN
                            ADD next_bus TO visited_buses
                            APPEND a tuple consisting of next_bus AND bus_count PLUS one TO bus_queue
                        END IF
                    END FOR
                END IF
            END FOR
        END WHILE

        RETURN negative one
    END FUNCTION
END CLASS