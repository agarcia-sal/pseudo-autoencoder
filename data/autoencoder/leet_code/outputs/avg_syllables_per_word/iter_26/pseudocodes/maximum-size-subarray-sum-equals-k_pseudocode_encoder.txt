CLASS Solution
    FUNCTION maxSubArrayLen(nums AS list OF integers, k AS integer) RETURNS integer
        SET cumulative_sum_index TO a dictionary with key zero ASSOCIATED WITH value minus one
        SET cumulative_sum TO zero
        SET max_length TO zero
        
        FOR each pair of index i AND number num IN enumeration of nums
            INCREMENT cumulative_sum BY num
            
            IF cumulative_sum MINUS k IS A KEY IN cumulative_sum_index
                SET max_length TO the GREATER OF max_length AND i MINUS the VALUE AT key cumulative_sum MINUS k OF cumulative_sum_index
            END IF
            
            IF cumulative_sum IS NOT A KEY IN cumulative_sum_index
                SET the VALUE AT key cumulative_sum OF cumulative_sum_index TO i
            END IF
        END FOR
        
        RETURN max_length
    END FUNCTION
END CLASS