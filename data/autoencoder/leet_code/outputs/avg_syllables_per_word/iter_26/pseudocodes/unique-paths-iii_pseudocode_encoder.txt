CLASS Solution
    FUNCTION uniquePathsIII(grid)
        FUNCTION dfs(x, y, steps)
            IF the element at position x OF grid EQUALS the integer two
                RETURN steps EQUALS zero
            END IF

            SET original TO the element at position x OF grid at position y
            SET the element at position x OF grid at position y TO integer negative two
            SET count TO zero

            FOR each pair of dx AND dy IN the list of pairs consisting of negative one and zero, positive one and zero, zero and negative one, zero and positive one
                SET nx TO x PLUS dx
                SET ny TO y PLUS dy
                IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n AND the element at position nx OF grid at position ny GREATER THAN OR EQUAL TO zero
                    INCREMENT count BY the result of FUNCTION dfs with arguments nx, ny, steps MINUS one
                END IF
            END FOR

            SET the element at position x OF grid at position y TO original
            RETURN count
        END FUNCTION

        SET m TO the LENGTH OF grid
        SET n TO the LENGTH OF the element at position zero OF grid
        SET start_x TO zero
        SET start_y TO zero
        SET empty_squares TO one

        FOR i FROM zero TO m MINUS one INCLUSIVE
            FOR j FROM zero TO n MINUS one INCLUSIVE
                IF the element at position i OF grid at position j EQUALS one
                    SET start_x TO i
                    SET start_y TO j
                ELSE IF the element at position i OF grid at position j EQUALS zero
                    INCREMENT empty_squares BY one
                END IF
            END FOR
        END FOR

        RETURN the result of FUNCTION dfs with arguments start_x, start_y, empty_squares
    END FUNCTION
END CLASS