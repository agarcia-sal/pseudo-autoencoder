CLASS Solution
    FUNCTION minMalwareSpread(graph, initial)
        FUNCTION dfs(node, component)
            IF node IS IN visited
                RETURN
            END IF
            ADD node TO visited
            ADD node TO component
            FOR neighbor FROM zero TO the LENGTH OF graph MINUS one INCLUSIVE
                IF the element at position neighbor OF the element at position node OF graph EQUALS one AND neighbor IS NOT IN visited
                    CALL dfs WITH neighbor AND component
                END IF
            END FOR
        END FUNCTION

        SET visited TO an empty set
        SET components TO an empty list
        FOR node FROM zero TO the LENGTH OF graph MINUS one INCLUSIVE
            IF node IS NOT IN visited
                SET component TO an empty set
                CALL dfs WITH node AND component
                APPEND component TO components
            END IF
        END FOR

        SET infected_count TO a list OF zeros WITH the LENGTH OF graph
        FOR each node IN initial
            SET the element at position node OF infected_count TO one
        END FOR

        SET component_infected_count TO a list OF zeros WITH the LENGTH OF components
        FOR each node IN initial
            FOR index FROM zero TO the LENGTH OF components MINUS one INCLUSIVE
                IF node IS IN the element at position index OF components
                    INCREMENT the element at position index OF component_infected_count BY one
                END IF
            END FOR
        END FOR

        SET max_saving TO zero
        SET best_node TO the minimum value IN initial
        FOR each node IN initial
            FOR index FROM zero TO the LENGTH OF components MINUS one INCLUSIVE
                IF node IS IN the element at position index OF components AND the element at position index OF component_infected_count EQUALS one
                    SET saving TO the LENGTH OF the element at position index OF components
                    IF saving IS GREATER THAN max_saving OR saving EQUALS max_saving AND node IS LESS THAN best_node
                        SET max_saving TO saving
                        SET best_node TO node
                    END IF
                END IF
            END FOR
        END FOR

        RETURN best_node
    END FUNCTION
END CLASS