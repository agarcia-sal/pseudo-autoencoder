CLASS Solution
    FUNCTION leastOpsExpressTarget(x, target)
        FROM functools IMPORT lru_cache

        DECORATE dp WITH lru_cache OF unspecified_capacity
        FUNCTION dp(target_value)
            IF target_value EQUALS zero
                RETURN negative one
            END IF

            IF target_value LESS THAN x
                SET first_option TO two MULTIPLIED BY target_value MINUS one
                SET second_option TO two MULTIPLIED BY x MINUS target_value
                RETURN the MINIMUM OF first_option AND second_option
            END IF

            SET power TO one
            WHILE x RAISED TO THE power POWER LESS THAN OR EQUAL TO target_value HOLDS
                INCREMENT power BY one
            END WHILE
            DECREMENT power BY one

            SET result TO dp OF target_value MINUS x RAISED TO THE power POWER PLUS power

            IF x RAISED TO THE power PLUS one POWER MINUS target_value LESS THAN target_value
                SET candidate TO dp OF x RAISED TO THE power PLUS one POWER MINUS target_value PLUS power PLUS one
                SET result TO the MINIMUM OF result AND candidate
            END IF

            RETURN result
        END FUNCTION

        RETURN dp OF target
    END FUNCTION
END CLASS