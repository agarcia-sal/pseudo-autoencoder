CLASS Solution
    FUNCTION countRoutes(locations, start, finish, fuel)
        SET MODULO_VALUE TO ten raised to the power of nine PLUS one
        SET number_of_locations TO the LENGTH OF locations

        FUNCTION dp(city, remaining_fuel)
            IF remaining_fuel LESS THAN zero HOLDS
                RETURN zero
            END IF

            SET routes TO zero

            IF city EQUALS finish HOLDS
                SET routes TO one
            END IF

            FOR each next_city FROM zero TO number_of_locations MINUS one INCLUSIVE
                IF next_city NOT EQUALS city HOLDS
                    SET fuel_cost TO the ABSOLUTE VALUE OF the element at position city OF locations MINUS the element at position next_city OF locations
                    IF remaining_fuel GREATER THAN OR EQUAL TO fuel_cost HOLDS
                        SET routes TO the remainder after DIVIDING the SUM OF routes PLUS the RESULT OF dp WITH arguments next_city AND the DIFFERENCE BETWEEN remaining_fuel AND fuel_cost BY MODULO_VALUE
                    END IF
                END IF
            END FOR

            RETURN routes
        END FUNCTION

        RETURN the RESULT OF dp WITH arguments start AND fuel
    END FUNCTION
END CLASS