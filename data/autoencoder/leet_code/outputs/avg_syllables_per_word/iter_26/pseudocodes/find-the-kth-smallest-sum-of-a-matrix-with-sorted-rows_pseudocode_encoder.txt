CLASS Solution
    FUNCTION kthSmallest(mat AS list of list of integers, k AS integer) RETURNS integer
        SET m TO the LENGTH OF mat
        SET n TO the LENGTH OF element at position zero OF mat
        
        SET initial_sum TO zero
        FOR each row IN mat
            INCREMENT initial_sum BY element at position zero OF row
        END FOR
        
        SET initial_indices TO a tuple of zero repeated m times
        SET min_heap TO a list containing a tuple of initial_sum AND initial_indices
        
        SET visited TO a set containing initial_indices
        
        WHILE k GREATER THAN zero HOLDS
            SET current_sum AND indices TO the result of removing the smallest element FROM min_heap
            DECREMENT k BY one
            
            IF k EQUALS zero THEN
                RETURN current_sum
            END IF
            
            FOR i FROM zero TO m MINUS one INCLUSIVE
                IF element at position i OF indices PLUS one LESS THAN n THEN
                    SET new_indices TO a list converted from indices
                    INCREMENT element at position i OF new_indices BY one
                    SET new_indices_tuple TO a tuple converted from new_indices
                    
                    SET old_value TO element at position i OF mat AT element at position i OF indices
                    SET new_value TO element at position i OF mat AT element at position i OF new_indices
                    
                    SET new_sum TO current_sum MINUS old_value PLUS new_value
                    
                    IF new_indices_tuple NOT IN visited THEN
                        ADD new_indices_tuple TO visited
                        ADD the tuple of new_sum AND new_indices_tuple TO min_heap as the smallest element preserving order
                    END IF
                END IF
            END FOR
        END WHILE
        
        RETURN minus one
    END FUNCTION
END CLASS