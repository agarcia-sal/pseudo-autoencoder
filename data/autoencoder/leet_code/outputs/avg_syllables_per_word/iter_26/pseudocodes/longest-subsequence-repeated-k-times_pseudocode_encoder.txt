CLASS Solution
    FUNCTION longestSubsequenceRepeatedK(s AS string, k AS integer) RETURNS string
        IMPORT Counter FROM collections
        
        SET freq TO the result of CALLING Counter WITH s
        
        SET valid_chars TO an empty list
        FOR each character AND its count IN the items OF freq
            IF count GREATER THAN OR EQUAL TO k THEN
                APPEND character TO valid_chars
            END IF
        END FOR
        
        SORT valid_chars IN REVERSE LEXICOGRAPHICAL ORDER
        
        FUNCTION is_valid_subsequence(candidate AS string) RETURNS boolean
            SET count TO zero
            SET index TO zero
            FOR each character IN s
                IF character EQUALS the element AT position index PLUS one OF candidate THEN
                    INCREMENT index BY one
                    IF index EQUALS the LENGTH OF candidate THEN
                        INCREMENT count BY one
                        SET index TO zero
                        IF count EQUALS k THEN
                            RETURN TRUE
                        END IF
                    END IF
                END IF
            END FOR
            RETURN FALSE
        END FUNCTION
        
        SET max_length TO the LENGTH OF valid_chars DIVIDED BY k
        
        SET best_candidate TO the empty string
        
        FUNCTION backtrack(candidate AS string)
            IF the LENGTH OF candidate GREATER THAN the LENGTH OF best_candidate THEN
                SET best_candidate TO candidate
            END IF
            FOR each character IN valid_chars
                SET new_candidate TO the concatenation OF candidate AND character
                IF is_valid_subsequence(new_candidate) THEN
                    CALL backtrack WITH new_candidate
                END IF
            END FOR
        END FUNCTION
        
        CALL backtrack WITH the empty string
        
        RETURN best_candidate
    END FUNCTION
END CLASS