CLASS Solution
    FUNCTION expressiveWords(s, words)
        FUNCTION compress(word)
            IF word EQUALS empty
                RETURN empty list
            END IF
            SET count TO one
            SET compressed TO empty list
            FOR index FROM two TO the LENGTH OF word INCLUSIVE
                IF the element at position index OF word EQUALS the element at position index MINUS one OF word
                    INCREMENT count BY one
                ELSE
                    APPEND the pair of the element at position index MINUS one OF word AND count TO compressed
                    SET count TO one
                END IF
            END FOR
            APPEND the pair of the element at the last position OF word AND count TO compressed
            RETURN compressed
        END FUNCTION

        FUNCTION is_stretchy(s_compressed, word_compressed)
            IF the LENGTH OF s_compressed NOT EQUALS the LENGTH OF word_compressed
                RETURN false
            END IF
            FOR each pair of characters and counts named sc AND sc_count IN s_compressed AND each pair of characters and counts named wc AND wc_count IN word_compressed TAKING THEM TOGETHER IN ORDER
                IF sc NOT EQUALS wc
                    RETURN false
                END IF
                IF sc_count NOT EQUALS wc_count AND ( sc_count LESS THAN three OR sc_count LESS THAN wc_count )
                    RETURN false
                END IF
            END FOR
            RETURN true
        END FUNCTION

        SET s_compressed TO the RESULT OF compress TAKING s AS INPUT
        SET stretchy_count TO zero

        FOR each word IN words
            SET word_compressed TO the RESULT OF compress TAKING word AS INPUT
            IF the RESULT OF is_stretchy TAKING s_compressed AND word_compressed AS INPUT HOLDS true
                INCREMENT stretchy_count BY one
            END IF
        END FOR

        RETURN stretchy_count
    END FUNCTION
END CLASS