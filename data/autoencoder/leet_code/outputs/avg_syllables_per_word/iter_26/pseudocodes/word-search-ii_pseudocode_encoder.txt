CLASS Trie
    FUNCTION __init__(self)
        SET self.children TO a list of twenty six elements each set to None
        SET self.ref TO negative one
    END FUNCTION

    FUNCTION insert(self, w, ref)
        SET node TO self
        FOR each character IN w
            SET idx TO the unicode code point of character MINUS the unicode code point of letter a
            IF the element at position idx OF node.children IS None
                SET the element at position idx OF node.children TO a new Trie object
            END IF
            SET node TO the element at position idx OF node.children
        END FOR
        SET node.ref TO ref
    END FUNCTION
END CLASS

CLASS Solution
    FUNCTION findWords(self, board, words)
        FUNCTION dfs(node, i, j)
            SET idx TO the unicode code point of the element at position i OF board at position j MINUS the unicode code point of letter a
            IF the element at position idx OF node.children IS None
                RETURN
            END IF
            SET node TO the element at position idx OF node.children
            IF node.ref IS GREATER THAN OR EQUAL TO zero
                APPEND the element at position node.ref OF words TO ans
                SET node.ref TO negative one
            END IF
            SET c TO the element at position i OF board at position j
            SET the element at position i OF board at position j TO the character hash
            FOR each pair of consecutive elements a and b IN the sequence consisting of negative one, zero, one, zero, negative one
                SET x TO i PLUS a
                SET y TO j PLUS b
                IF x IS GREATER THAN OR EQUAL TO zero AND x IS LESS THAN the number m AND y IS GREATER THAN OR EQUAL TO zero AND y IS LESS THAN the number n AND the element at position x OF board at position y IS NOT the character hash
                    CALL dfs WITH arguments node, x, y
                END IF
            END FOR
            SET the element at position i OF board at position j TO c
        END FUNCTION

        SET tree TO a new Trie object
        FOR each index i AND element w IN words with enumeration starting at zero
            CALL the insert method OF tree WITH arguments w, i
        END FOR
        SET m TO the length OF board
        SET n TO the length OF the element at position zero OF board
        SET ans TO an empty list
        FOR index i FROM zero TO m MINUS one INCLUSIVE
            FOR index j FROM zero TO n MINUS one INCLUSIVE
                CALL dfs WITH arguments tree, i, j
            END FOR
        END FOR
        RETURN ans
    END FUNCTION
END CLASS