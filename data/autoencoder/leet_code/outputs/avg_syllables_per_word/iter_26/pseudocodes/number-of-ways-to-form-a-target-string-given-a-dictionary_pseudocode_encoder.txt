CLASS Solution
    FUNCTION numWays(words, target)
        SET MOD TO ten POWERED BY nine PLUS seven
        SET n TO the LENGTH OF the element at position zero OF words
        SET m TO the LENGTH OF target
        
        SET freq TO an array OF size n OF empty maps FROM characters TO integers defaulting TO zero
        FOR each word IN words
            FOR each index j AND character char IN word
                INCREMENT the value AT character char IN the map at position j OF freq BY one
            END FOR
        END FOR
        
        SET dp TO a two dimensional array WITH m PLUS one rows AND n PLUS one columns FILLED WITH zero
        FOR each index j FROM zero TO n INCLUSIVE
            SET the element at position zero row AND position j column OF dp TO one
        END FOR
        
        FOR each index i FROM one TO m INCLUSIVE
            FOR each index j FROM one TO n INCLUSIVE
                SET the element at position i row AND position j column OF dp TO the element at position i row AND position j MINUS one column OF dp
                IF the value AT character at position i MINUS one OF target IN the map at position j MINUS one OF freq IS GREATER THAN zero THEN
                    INCREMENT the element at position i row AND position j column OF dp BY the element at position i MINUS one row AND position j MINUS one column OF dp MULTIPLIED BY the value AT character at position i MINUS one OF target IN the map at position j MINUS one OF freq
                    SET the element at position i row AND position j column OF dp TO itself MODULO MOD
                END IF
            END FOR
        END FOR
        
        RETURN the element at position m row AND position n column OF dp
    END FUNCTION
END CLASS