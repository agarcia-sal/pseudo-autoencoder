CLASS Solution
    FUNCTION minWindow(s STRING, t STRING) RETURNS STRING
        IMPORT the class Counter FROM the collection module

        SET t_count TO the result of calling Counter with t as argument
        SET required TO the LENGTH OF the KEYS OF t_count

        SET left TO zero
        SET right TO zero
        SET formed TO zero
        SET window_counts TO a new instance of Counter

        SET min_length TO positive infinity
        SET min_start TO zero

        WHILE right LESS THAN the LENGTH OF s HOLDS
            INCREMENT the count of the element at position right OF s in window_counts BY one

            IF the element at position right OF s IS IN t_count AND the count of that element in window_counts EQUALS the count of that element in t_count THEN
                INCREMENT formed BY one
            END IF

            WHILE left LESS THAN OR EQUAL TO right AND formed EQUALS required HOLDS
                SET char TO the element at position left OF s

                IF the result of right MINUS left PLUS one LESS THAN min_length THEN
                    SET min_length TO the result of right MINUS left PLUS one
                    SET min_start TO left
                END IF

                DECREMENT the count of char in window_counts BY one

                IF char IS IN t_count AND the count of char in window_counts LESS THAN the count of char in t_count THEN
                    DECREMENT formed BY one
                END IF

                INCREMENT left BY one
            END WHILE

            INCREMENT right BY one
        END WHILE

        IF min_length EQUALS positive infinity THEN
            RETURN an empty string
        ELSE
            RETURN the substring FROM position min_start TO position min_start PLUS min_length MINUS one OF s
        END IF
    END FUNCTION
END CLASS