CLASS Solution
    FUNCTION areSentencesSimilarTwo(sentence1 AS list OF strings, sentence2 AS list OF strings, similarPairs AS list OF list OF strings) RETURNS boolean
        IF the LENGTH OF sentence1 NOT EQUALS the LENGTH OF sentence2
            RETURN false
        END IF

        SET parent TO EMPTY dictionary

        FUNCTION find(x)
            IF the element at position x OF parent NOT EQUALS x
                SET the element at position x OF parent TO the RESULT OF find(the element at position x OF parent)
            END IF
            RETURN the element at position x OF parent
        END FUNCTION

        FUNCTION union(x, y)
            SET rootX TO the RESULT OF find(x)
            SET rootY TO the RESULT OF find(y)
            IF rootX NOT EQUALS rootY
                SET the element at position rootY OF parent TO rootX
            END IF
        END FUNCTION

        FOR each pair IN similarPairs
            FOR each word IN pair
                IF word NOT IN parent
                    SET the element at position word OF parent TO word
                END IF
            END FOR
        END FOR

        FOR each element x AND element y IN corresponding positions OF similarPairs
            CALL union WITH x AND y
        END FOR

        FOR each element w1 AND element w2 IN corresponding positions OF sentence1 AND sentence2
            IF w1 NOT IN parent
                SET the element at position w1 OF parent TO w1
            END IF
            IF w2 NOT IN parent
                SET the element at position w2 OF parent TO w2
            END IF
            IF the RESULT OF find(w1) NOT EQUALS the RESULT OF find(w2)
                RETURN false
            END IF
        END FOR

        RETURN true
    END FUNCTION
END CLASS