CLASS UnionFind
    FUNCTION __init__(self, size)
        SET self.parent TO a list containing the elements from zero TO size MINUS one INCLUSIVE
        SET self.rank TO a list containing the value one repeated size times
    END FUNCTION

    FUNCTION find(self, p)
        IF the element at position p OF self.parent IS NOT EQUALS TO p
            SET the element at position p OF self.parent TO the result of CALLING self.find WITH the element at position p OF self.parent AS argument
        END IF
        RETURN the element at position p OF self.parent
    END FUNCTION

    FUNCTION union(self, p, q)
        SET rootP TO the result of CALLING self.find WITH p AS argument
        SET rootQ TO the result of CALLING self.find WITH q AS argument
        IF rootP EQUALS rootQ
            RETURN False
        END IF
        IF the element at position rootP OF self.rank IS GREATER THAN the element at position rootQ OF self.rank
            SET the element at position rootQ OF self.parent TO rootP
        ELSE IF the element at position rootP OF self.rank IS LESS THAN the element at position rootQ OF self.rank
            SET the element at position rootP OF self.parent TO rootQ
        ELSE
            SET the element at position rootQ OF self.parent TO rootP
            INCREMENT the element at position rootP OF self.rank BY one
        END IF
        RETURN True
    END FUNCTION
END CLASS

CLASS Solution
    FUNCTION findRedundantConnection(self, edges)
        SET uf TO a new instance of UnionFind INITIALIZED WITH the LENGTH OF edges PLUS one
        FOR each pair of elements u and v IN edges
            IF NOT the result of CALLING uf.union WITH u AND v AS arguments HOLDS
                RETURN a list containing u and v
            END IF
        END FOR
    END FUNCTION
END CLASS