CLASS Solution
    FUNCTION largestVariance(s)
        IMPORT permutations FROM itertools

        FUNCTION calculate_variance(substring, char_a, char_b)
            SET max_variance TO zero
            SET count_a TO zero
            SET count_b TO zero
            SET has_b TO FALSE
            SET first_b TO FALSE

            FOR each char IN substring
                IF char EQUALS char_a
                    INCREMENT count_a BY one
                ELSE IF char EQUALS char_b
                    INCREMENT count_b BY one
                    SET has_b TO TRUE
                END IF

                IF count_b GREATER THAN zero
                    SET max_variance TO the GREATER OF max_variance AND count_a MINUS count_b
                ELSE IF count_b EQUALS zero AND first_b IS TRUE
                    SET max_variance TO the GREATER OF max_variance AND count_a MINUS one
                END IF

                IF count_b GREATER THAN count_a
                    SET count_a TO zero
                    SET count_b TO zero
                    SET first_b TO has_b
                END IF
            END FOR

            RETURN max_variance
        END FUNCTION

        SET max_variance TO zero
        SET unique_chars TO the SET OF characters IN s

        FOR each pair char_a AND char_b IN all PERMUTATIONS of unique_chars TAKEN two AT A TIME
            IF char_a EQUALS char_b
                CONTINUE to next iteration
            END IF
            SET max_variance TO the GREATER OF max_variance AND calculate_variance WITH arguments s, char_a, char_b
        END FOR

        RETURN max_variance
    END FUNCTION
END CLASS