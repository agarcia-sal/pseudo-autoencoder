CLASS Solution
    FUNCTION cherryPickup(grid)
        SET n TO the LENGTH OF grid
        IF the element at position zero OF the element at position zero OF grid EQUALS negative one OR the element at position n MINUS one OF the element at position n MINUS one OF grid EQUALS negative one
            RETURN zero
        END IF

        INITIALIZE dp AS a three dimensional list with dimensions n BY n BY n FILLED WITH negative one
        SET the element at position zero OF the element at position zero OF the element at position zero OF dp TO the element at position zero OF the element at position zero OF grid

        SET directions TO a list containing the pair zero AND one, AND the pair one AND zero

        FOR t FROM one TO two MULTIPLIED BY n MINUS one MINUS one INCLUSIVE
            FOR i1 FROM the MAXIMUM OF zero AND t MINUS (n MINUS one) TO the MINIMUM OF n AND t PLUS one MINUS one INCLUSIVE
                FOR i2 FROM the MAXIMUM OF zero AND t MINUS (n MINUS one) TO the MINIMUM OF n AND t PLUS one MINUS one INCLUSIVE
                    SET j1 TO t MINUS i1
                    SET j2 TO t MINUS i2

                    IF the element at position i1 OF the element at position j1 OF grid EQUALS negative one OR the element at position i2 OF the element at position j2 OF grid EQUALS negative one
                        CONTINUE to the next iteration
                    END IF

                    SET prev_max TO negative one

                    FOR each pair di1 AND dj1 IN directions
                        FOR each pair di2 AND dj2 IN directions
                            SET pi1 TO i1 MINUS di1
                            SET pj1 TO j1 MINUS dj1
                            SET pi2 TO i2 MINUS di2
                            SET pj2 TO j2 MINUS dj2

                            IF pi1 IS GREATER THAN OR EQUAL TO zero AND pi1 IS LESS THAN n AND pj1 IS GREATER THAN OR EQUAL TO zero AND pj1 IS LESS THAN n AND pi2 IS GREATER THAN OR EQUAL TO zero AND pi2 IS LESS THAN n AND pj2 IS GREATER THAN OR EQUAL TO zero AND pj2 IS LESS THAN n
                                SET prev_max TO the MAXIMUM OF prev_max AND the element at position pi1 OF the element at position pi2 OF the element at position pj1 OF dp
                            END IF
                        END FOR
                    END FOR

                    IF prev_max IS GREATER THAN OR EQUAL TO zero
                        IF i1 EQUALS i2
                            SET cherries TO the element at position i1 OF the element at position j1 OF grid
                        ELSE
                            SET cherries TO the element at position i1 OF the element at position j1 OF grid PLUS the element at position i2 OF the element at position j2 OF grid
                        END IF

                        SET the element at position i1 OF the element at position i2 OF the element at position j1 OF dp TO prev_max PLUS cherries
                    END IF
                END FOR
            END FOR
        END FOR

        RETURN the MAXIMUM of zero AND the element at position n MINUS one OF the element at position n MINUS one OF the element at position n MINUS one OF dp
    END FUNCTION
END CLASS