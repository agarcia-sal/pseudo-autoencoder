CLASS Solution
    FUNCTION distinctSubseqII(s)
        SET MOD TO ten RAISED TO the power of nine PLUS seven
        SET n TO the LENGTH OF s
        SET dp TO a list of zeros with the LENGTH OF n PLUS one
        SET the element at position zero OF dp TO one
        SET last TO an empty mapping
        FOR i FROM one TO n INCLUSIVE
            SET char TO the element at position i MINUS one OF s
            SET the element at position i OF dp TO the element at position i MINUS one OF dp MULTIPLIED BY two MODULO MOD
            IF char EXISTS AS a key IN last
                SET the element at position i OF dp TO the element at position i OF dp MINUS the element at position (the element at position char IN last) MINUS one OF dp PLUS MOD MODULO MOD
            END IF
            SET the element at position char IN last TO i
        END FOR
        RETURN the element at position n OF dp MINUS one MODULO MOD
    END FUNCTION
END CLASS