CLASS Solution
    FUNCTION findPaths(m, n, maxMove, startRow, startColumn)
        SET MOD TO one billion plus seven
        
        SET directions TO the list containing the pairs zero and one, zero and minus one, one and zero, minus one and zero
        
        SET dp TO an m by n by the number of maximum moves plus one three-dimensional array FILLED WITH zeroes
        
        FOR k FROM one TO maxMove INCLUSIVE
            FOR i FROM zero TO m MINUS one INCLUSIVE
                FOR j FROM zero TO n MINUS one INCLUSIVE
                    FOR each pair OF di AND dj IN directions
                        SET ni TO i PLUS di
                        SET nj TO j PLUS dj
                        
                        IF ni LESS THAN zero OR ni GREATER THAN OR EQUAL TO m OR nj LESS THAN zero OR nj GREATER THAN OR EQUAL TO n
                            SET dp at position i, j, k TO dp at position i, j, k PLUS one MODULO MOD
                        ELSE
                            SET dp at position i, j, k TO dp at position i, j, k PLUS dp at position ni, nj, k MINUS one MODULO MOD
                        END IF
                    END FOR
                END FOR
            END FOR
        END FOR
        
        RETURN dp at position startRow, startColumn, maxMove
    END FUNCTION
END CLASS