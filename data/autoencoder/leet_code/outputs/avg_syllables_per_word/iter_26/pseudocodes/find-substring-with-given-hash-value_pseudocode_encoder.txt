CLASS Solution
    FUNCTION subStrHash(s STRING, power INTEGER, modulo INTEGER, k INTEGER, hashValue INTEGER) RETURNS STRING

        FUNCTION val(c CHARACTER) RETURNS INTEGER
            RETURN the UNICODE code POINT OF character c MINUS the UNICODE code POINT OF lowercase letter a PLUS one
        END FUNCTION

        SET n TO the LENGTH OF string s
        SET current_hash TO zero
        SET p_pow TO one

        FOR index FROM n MINUS k TO n MINUS one INCLUSIVE
            SET current_hash TO current_hash PLUS val(element at position index OF string s) MULTIPLIED BY p_pow MODULO modulo
            IF index LESS THAN n MINUS one THEN
                SET p_pow TO p_pow MULTIPLIED BY power MODULO modulo
            END IF
        END FOR

        SET start_index TO n MINUS k

        IF current_hash EQUALS hashValue THEN
            RETURN substring FROM position start_index TO position n MINUS one OF string s
        END IF

        SET p_pow_k_minus_1 TO p_pow

        FOR index FROM n MINUS k MINUS one DOWN TO zero INCLUSIVE
            SET current_hash TO current_hash MINUS val(element at position index PLUS k OF string s) MULTIPLIED BY p_pow_k_minus_1 MODULO modulo
            SET current_hash TO current_hash MULTIPLIED BY power PLUS val(element at position index OF string s) MODULO modulo

            IF current_hash EQUALS hashValue THEN
                SET start_index TO index
            END IF
        END FOR

        RETURN substring FROM position start_index TO position start_index PLUS k MINUS one OF string s

    END FUNCTION
END CLASS