CLASS Solution
    FUNCTION removeDuplicateLetters(string s)
        SET last_occurrence TO an empty dictionary mapping each character TO its last position in string s
        SET stack TO an empty list
        SET in_stack TO an empty set

        FOR each index AND character IN string s WITH index and character AS the position and character at that position
            IF character IS IN in_stack
                CONTINUE TO next iteration
            END IF

            WHILE stack IS NOT empty AND character IS LESS THAN the element at the last position OF stack AND index IS LESS THAN the last occurrence position OF the element at the last position OF stack
                SET removed_char TO the element removed from the last position OF stack
                REMOVE removed_char FROM in_stack
            END WHILE

            APPEND character TO stack
            ADD character TO in_stack
        END FOR

        SET result_string TO the concatenation of all elements IN stack in their existing order
        RETURN result_string
    END FUNCTION
END CLASS