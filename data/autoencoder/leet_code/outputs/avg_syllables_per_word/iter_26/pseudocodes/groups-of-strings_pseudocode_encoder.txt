CLASS UnionFind
    FUNCTION __init__(self, size)
        SET self.parent TO a list of integers from zero TO size MINUS one INCLUSIVE
        SET self.rank TO a list containing size times the integer zero
        SET self.size TO a list containing size times the integer one
    END FUNCTION

    FUNCTION find(self, u)
        IF the element at position u OF self.parent IS NOT EQUAL TO u
            SET the element at position u OF self.parent TO the result of calling find with the argument the element at position u OF self.parent
        END IF
        RETURN the element at position u OF self.parent
    END FUNCTION

    FUNCTION union(self, u, v)
        SET rootU TO the result of calling find with the argument u
        SET rootV TO the result of calling find with the argument v
        IF rootU IS NOT EQUAL TO rootV
            IF the element at position rootU OF self.rank IS GREATER THAN the element at position rootV OF self.rank
                SET the element at position rootV OF self.parent TO rootU
                INCREMENT the element at position rootU OF self.size BY the element at position rootV OF self.size
            ELSE IF the element at position rootU OF self.rank IS LESS THAN the element at position rootV OF self.rank
                SET the element at position rootU OF self.parent TO rootV
                INCREMENT the element at position rootV OF self.size BY the element at position rootU OF self.size
            ELSE
                SET the element at position rootV OF self.parent TO rootU
                INCREMENT the element at position rootU OF self.size BY the element at position rootV OF self.size
                INCREMENT the element at position rootU OF self.rank BY one
            END IF
        END IF
    END FUNCTION
END CLASS

CLASS Solution
    FUNCTION groupStrings(self, words)
        FUNCTION bitmask(word)
            SET mask TO zero
            FOR each character IN word
                SET mask TO mask OR one SHIFTED LEFT BY the difference BETWEEN the Unicode ordinal of character AND the Unicode ordinal of the lowercase character a
            END FOR
            RETURN mask
        END FUNCTION

        SET word_map TO an empty default dictionary mapping keys TO empty lists
        SET n TO the LENGTH OF words
        SET uf TO a new instance of UnionFind initialized with n

        FOR each index i AND word IN the enumeration of words
            SET mask TO the result of calling bitmask with word
            APPEND i TO the list AT key mask IN word_map
        END FOR

        FOR each index i AND word IN the enumeration of words
            SET mask TO the result of calling bitmask with word
            FOR each integer j FROM zero TO twenty five INCLUSIVE
                # Delete one letter
                SET new_mask TO the bitwise XOR of mask AND one SHIFTED LEFT BY j
                IF new_mask IS A KEY IN word_map
                    FOR each element k IN the list at key new_mask IN word_map
                        CALL uf.union WITH arguments i AND k
                    END FOR
                END IF
                # Add one letter
                IF the bitwise AND of mask AND one SHIFTED LEFT BY j IS EQUAL TO zero
                    SET new_mask TO the bitwise OR of mask AND one SHIFTED LEFT BY j
                    IF new_mask IS A KEY IN word_map
                        FOR each element k IN the list at key new_mask IN word_map
                            CALL uf.union WITH arguments i AND k
                        END FOR
                    END IF
                END IF
                # Replace one letter
                IF the bitwise AND of mask AND one SHIFTED LEFT BY j IS NOT EQUAL TO zero
                    FOR each integer k FROM zero TO twenty five INCLUSIVE
                        IF the bitwise AND of mask AND one SHIFTED LEFT BY k IS EQUAL TO zero
                            SET new_mask TO the bitwise OR of the bitwise XOR of mask AND one SHIFTED LEFT BY j AND one SHIFTED LEFT BY k
                            IF new_mask IS A KEY IN word_map
                                FOR each element l IN the list at key new_mask IN word_map
                                    CALL uf.union WITH arguments i AND l
                                END FOR
                            END IF
                        END IF
                    END FOR
                END IF
            END FOR
        END FOR

        SET root_sizes TO an empty default dictionary mapping integers TO zero
        FOR each integer i FROM zero TO n MINUS one INCLUSIVE
            SET root TO the result of calling uf.find WITH argument i
            INCREMENT the value at key root IN root_sizes BY one
        END FOR

        SET max_group_size TO the maximum value AMONG THE values IN root_sizes
        SET num_groups TO the COUNT OF KEYS IN root_sizes

        RETURN a list containing num_groups AND max_group_size
    END FUNCTION
END CLASS