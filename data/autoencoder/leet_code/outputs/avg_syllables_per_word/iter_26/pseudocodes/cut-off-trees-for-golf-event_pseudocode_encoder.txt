CLASS Solution
    FUNCTION cutOffTree(forest)
        IF forest EQUALS empty OR element at position zero OF forest EQUALS empty
            RETURN negative one
        END IF

        SET trees TO an empty list
        FOR index i FROM zero TO the LENGTH OF forest MINUS one INCLUSIVE
            FOR index j FROM zero TO the LENGTH OF element at position i OF forest MINUS one INCLUSIVE
                IF element at position i OF forest AT position j GREATER THAN one
                    APPEND tuple of element at position i OF forest AT position j, i, and j TO trees
                END IF
            END FOR
        END FOR
        SORT trees IN ASCENDING ORDER

        FUNCTION bfs(start, end)
            IF start EQUALS end
                RETURN zero
            END IF

            SET m TO the LENGTH OF forest
            SET n TO the LENGTH OF element at position zero OF forest
            ASSIGN reference TO a deque initialized with start AS queue
            ASSIGN reference TO a set initialized with start AS visited
            SET steps TO zero

            WHILE queue HOLDS
                SET iteration_count TO the LENGTH OF queue
                FOR each iteration FROM one TO iteration_count INCLUSIVE
                    REMOVE and FETCH the FIRST element OF queue AS x and y
                    FOR each pair dx, dy IN the list of minus one and zero, plus one and zero, zero and minus one, zero and plus one
                        SET nx TO x PLUS dx
                        SET ny TO y PLUS dy
                        IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n AND tuple of nx and ny NOT IN visited AND element at position nx OF forest AT position ny NOT EQUALS zero
                            IF tuple of nx and ny EQUALS end
                                RETURN steps PLUS one
                            END IF
                            ADD tuple of nx and ny TO visited
                            APPEND tuple of nx and ny TO queue
                        END IF
                    END FOR
                END FOR
                INCREMENT steps BY one
            END WHILE

            RETURN negative one
        END FUNCTION

        SET x TO zero
        SET y TO zero
        SET total_steps TO zero

        FOR each tuple height, tx, ty IN trees
            SET steps TO bfs with arguments tuple of x and y, and tuple of tx and ty
            IF steps EQUALS negative one
                RETURN negative one
            END IF
            INCREMENT total_steps BY steps
            SET x TO tx
            SET y TO ty
        END FOR

        RETURN total_steps
    END FUNCTION
END CLASS