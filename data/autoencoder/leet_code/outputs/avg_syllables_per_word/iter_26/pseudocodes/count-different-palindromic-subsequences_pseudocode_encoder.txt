CLASS Solution
    FUNCTION countPalindromicSubsequences(s AS string) RETURNS integer
        SET MODULO TO one followed by nine zeros PLUS seven
        SET n TO the LENGTH OF s

        // Declare two dimensional lists for next and previous occurrence for four characters
        CREATE next_occurrence AS list CONTAINING four lists EACH CONTAINING n elements ALL SET TO negative one
        CREATE prev_occurrence AS list CONTAINING four lists EACH CONTAINING n elements ALL SET TO negative one

        FOR character_index FROM zero TO three INCLUSIVE
            SET character TO the character REPRESENTED BY the unicode code point of letter a PLUS character_index
            SET last_occurrence TO negative one

            FOR position FROM zero TO n MINUS one INCLUSIVE
                IF the element at position OF s EQUALS character THEN
                    SET last_occurrence TO position
                END IF
                SET the element at position OF the list at character_index OF prev_occurrence TO last_occurrence
            END FOR

            SET last_occurrence TO negative one

            FOR position FROM n MINUS one DOWN TO zero INCLUSIVE BY negative one
                IF the element at position OF s EQUALS character THEN
                    SET last_occurrence TO position
                END IF
                SET the element at position OF the list at character_index OF next_occurrence TO last_occurrence
            END FOR
        END FOR

        // Create a two dimensional list for dynamic programming with zeros
        CREATE dp AS list CONTAINING n lists EACH CONTAINING n elements ALL SET TO zero

        FOR index FROM zero TO n MINUS one INCLUSIVE
            SET the element at index OF the list at index OF dp TO one
        END FOR

        FOR length FROM two TO n INCLUSIVE
            FOR start_index FROM zero TO n MINUS length INCLUSIVE
                SET end_index TO start_index PLUS length MINUS one

                FOR character_index FROM zero TO three INCLUSIVE
                    SET character TO the character REPRESENTED BY the unicode code point of letter a PLUS character_index
                    SET left_position TO the element at start_index OF the list at character_index OF next_occurrence
                    SET right_position TO the element at end_index OF the list at character_index OF prev_occurrence

                    IF left_position GREATER THAN end_index OR right_position LESS THAN start_index THEN
                        CONTINUE TO the next iteration of the innermost loop
                    ELSE IF left_position EQUALS right_position THEN
                        SET the element at start_index OF the list at end_index OF dp TO 
                            the element at start_index OF the list at end_index OF dp PLUS one MODULO MODULO
                    ELSE
                        SET the element at start_index OF the list at end_index OF dp TO
                            the element at start_index OF the list at end_index OF dp PLUS 
                            the element at left_position PLUS one OF the list at right_position MINUS one OF dp PLUS two MODULO MODULO
                    END IF
                END FOR
            END FOR
        END FOR

        RETURN the element at zero OF the list at n MINUS one OF dp
    END FUNCTION
END CLASS