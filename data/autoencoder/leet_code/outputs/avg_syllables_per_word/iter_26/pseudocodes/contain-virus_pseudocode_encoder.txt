CLASS Solution
    FUNCTION containVirus(isInfected)
        FUNCTION neighbors(r, c)
            RETURN a list consisting of a tuple of r PLUS one AND c, a tuple of r MINUS one AND c, a tuple of r AND c PLUS one, AND a tuple of r AND c MINUS one
        END FUNCTION

        FUNCTION bfs(r, c)
            SET infected TO an empty set
            SET threatened TO an empty set
            SET queue TO a double ended queue initialized with a tuple of r AND c
            SET visited TO a set initialized with a tuple of r AND c
            WHILE queue HOLDS
                REMOVE from the left of queue and ASSIGN to x AND y
                ADD a tuple of x AND y TO infected
                FOR each tuple of nx AND ny IN neighbors(x, y)
                    IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n AND a tuple of nx AND ny NOT IN visited
                        ADD a tuple of nx AND ny TO visited
                        IF the element at position nx OF isInfected AT position ny EQUALS one
                            APPEND a tuple of nx AND ny TO queue
                        ELSE IF the element at position nx OF isInfected AT position ny EQUALS zero
                            ADD a tuple of nx AND ny TO threatened
                        END IF
                    END IF
                END FOR
            END WHILE
            RETURN infected AND threatened
        END FUNCTION

        FUNCTION build_walls(infected)
            SET walls TO zero
            FOR each tuple of x AND y IN infected
                FOR each tuple of nx AND ny IN neighbors(x, y)
                    IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n AND the element at position nx OF isInfected AT position ny EQUALS zero
                        INCREMENT walls BY one
                    END IF
                END FOR
            END FOR
            RETURN walls
        END FUNCTION

        FUNCTION spread_virus(threatened)
            FOR each tuple of x AND y IN threatened
                SET the element at position x OF isInfected AT position y TO one
            END FOR
        END FUNCTION

        SET m TO the LENGTH OF isInfected
        SET n TO the LENGTH OF the element at position zero OF isInfected
        SET total_walls TO zero

        WHILE true HOLDS
            SET regions TO an empty list
            SET visited TO an empty set
            FOR r FROM zero TO m MINUS one INCLUSIVE
                FOR c FROM zero TO n MINUS one INCLUSIVE
                    IF the element at position r OF isInfected AT position c EQUALS one AND a tuple of r AND c NOT IN visited
                        CALL bfs WITH arguments r AND c AND ASSIGN return values TO infected AND threatened
                        APPEND a tuple of infected AND threatened TO regions
                        UNION visited WITH infected
                    END IF
                END FOR
            END FOR

            IF regions IS empty
                BREAK
            END IF

            SORT regions IN descending ORDER BY the LENGTH OF the second element OF each tuple

            INCREMENT total_walls BY build_walls WITH argument the first element OF the first tuple IN regions

            FOR each tuple of x AND y IN the first element OF the first tuple IN regions
                SET the element at position x OF isInfected AT position y TO negative one
            END FOR

            FOR i FROM one TO the LENGTH OF regions MINUS one INCLUSIVE
                CALL spread_virus WITH argument the second element OF the tuple at position i IN regions
            END FOR
        END WHILE

        RETURN total_walls
    END FUNCTION
END CLASS