CLASS Solution
    FUNCTION minimumOperations(grid)
        FUNCTION bfs()
            SET queue TO an empty double ended queue
            FOR u FROM zero TO n MINUS one INCLUSIVE
                IF element at position u OF match EQUALS negative one
                    SET element at position u OF dist TO zero
                    APPEND u TO queue
                ELSE
                    SET element at position u OF dist TO infinity
                END IF
            END FOR
            SET element at position negative one OF dist TO infinity
            WHILE queue HOLDS
                REMOVE and RETURN the element at the left end OF queue INTO u
                IF element at position u OF dist LESS THAN element at position negative one OF dist
                    FOR each element v IN element at position u OF graph
                        IF element at position element at position v OF match OF dist EQUALS infinity
                            SET element at position element at position v OF match OF dist TO element at position u OF dist PLUS one
                            APPEND element at position v OF match TO queue
                        END IF
                    END FOR
                END IF
            END WHILE
            RETURN element at position negative one OF dist LESS THAN infinity
        END FUNCTION

        FUNCTION dfs(u)
            IF u NOT EQUALS negative one
                FOR each element v IN element at position u OF graph
                    IF element at position element at position v OF match OF dist EQUALS element at position u OF dist PLUS one
                        IF dfs(element at position v OF match)
                            SET element at position v OF match TO u
                            SET element at position u OF match TO v
                            RETURN True
                        END IF
                    END IF
                END FOR
                SET element at position u OF dist TO infinity
                RETURN False
            END IF
            RETURN True
        END FUNCTION

        SET rows TO the LENGTH OF grid
        SET cols TO the LENGTH OF element at position zero OF grid
        SET n TO rows MULTIPLIED BY cols
        SET graph TO a list of empty sets with size n PLUS one
        SET match TO a list filled with negative one with size n PLUS one
        SET dist TO a list filled with zero with size n PLUS one

        FOR r FROM zero TO rows MINUS one INCLUSIVE
            FOR c FROM zero TO cols MINUS one INCLUSIVE
                IF element at position r OF grid AT position c EQUALS one
                    SET u TO r MULTIPLIED BY cols PLUS c
                    FOR each pair dr, dc IN the list of pairs consisting of negative one and zero, positive one and zero, zero and negative one, zero and positive one
                        SET nr TO r PLUS dr
                        SET nc TO c PLUS dc
                        IF nr GREATER THAN OR EQUAL TO zero AND nr LESS THAN rows AND nc GREATER THAN OR EQUAL TO zero AND nc LESS THAN cols AND element at position nr OF grid AT position nc EQUALS one
                            SET v TO nr MULTIPLIED BY cols PLUS nc
                            ADD v TO element at position u OF graph
                        END IF
                    END FOR
                END IF
            END FOR
        END FOR

        SET matching TO zero
        WHILE bfs()
            FOR u FROM zero TO n MINUS one INCLUSIVE
                IF element at position u OF match EQUALS negative one AND dfs(u)
                    INCREMENT matching BY one
                END IF
            END FOR
        END WHILE

        RETURN matching
    END FUNCTION
END CLASS