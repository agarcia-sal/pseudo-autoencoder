CLASS Solution
    FUNCTION numberOfCombinations(parameter num OF TYPE string)
        SET MODULO TO ten RAISED TO THE power OF nine PLUS one
        SET n TO the LENGTH OF num
        
        CREATE an EMPTY dictionary CALLED memo
        
        FUNCTION dp(parameter index, parameter previous_length)
            IF index EQUALS n THEN
                RETURN one
            END IF
            
            IF the TUPLE of index AND previous_length IS IN memo THEN
                RETURN the VALUE ASSOCIATED WITH the TUPLE of index AND previous_length IN memo
            END IF
            
            SET count TO zero
            
            FOR length FROM one TO n MINUS index INCLUSIVE
                IF the CHARACTER AT position index OF num EQUALS the CHARACTER zero THEN
                    BREAK the FOR loop
                END IF
                
                SET current_number TO the SUBSTRING FROM position index TO position index PLUS length OF num
                
                IF previous_length EQUALS zero OR current_number GREATER THAN OR EQUAL TO the SUBSTRING FROM position index MINUS previous_length TO position index OF num THEN
                    SET count TO count PLUS dp(index PLUS length, length) TAKEN MODULO MODULO
                END IF
            END FOR
            
            SET the VALUE ASSOCIATED WITH the TUPLE of index AND previous_length IN memo TO count
            RETURN count
        END FUNCTION
        
        RETURN dp(zero, zero)
    END FUNCTION
END CLASS