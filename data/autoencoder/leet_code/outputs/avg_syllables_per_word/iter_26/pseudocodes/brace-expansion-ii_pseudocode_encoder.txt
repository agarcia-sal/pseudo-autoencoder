CLASS Solution
    FUNCTION braceExpansionII(expression)
        FUNCTION parse_expression(index)
            SET current_set TO an empty set
            SET current_product TO a list containing an empty string
            
            WHILE index IS LESS THAN the LENGTH OF expression HOLDS
                SET char TO the element at position index OF expression
                
                IF char EQUALS the opening brace character
                    SET inner_set AND index TO THE RESULT OF parse_expression WITH index incremented BY one
                    SET current_product TO a new list formed by concatenating each string in current_product WITH each string in inner_set
                    
                ELSE IF char EQUALS the closing brace character
                    UPDATE current_set TO INCLUDE EACH joined string formed by concatenating the elements of current_product
                    RETURN current_set AND index
                    
                ELSE IF char EQUALS the comma character
                    UPDATE current_set TO INCLUDE EACH joined string formed by concatenating the elements of current_product
                    SET current_product TO a list containing an empty string
                    
                ELSE
                    SET current_product TO a new list formed by concatenating each string in current_product WITH char
                    
                INCREMENT index BY one
            END WHILE
            
            UPDATE current_set TO INCLUDE EACH joined string formed by concatenating the elements of current_product
            RETURN current_set AND index
        END FUNCTION
        
        SET result_set AND an unused variable TO THE RESULT OF parse_expression STARTING FROM zero
        RETURN the sorted list of elements FROM result_set
    END FUNCTION
END CLASS