CLASS Solution
    FUNCTION getMaxRepetitions(s1, n1, s2, n2)
        IF n1 EQUALS zero THEN
            RETURN zero
        END IF

        SET s2_count TO list OF zeros WITH length EQUAL TO the LENGTH OF s2 PLUS one
        SET index_map TO list OF zeros WITH length EQUAL TO the LENGTH OF s2 PLUS one

        SET current_index_s2 TO zero
        SET s1_count TO zero

        WHILE s1_count LESS THAN n1 HOLDS
            INCREMENT s1_count BY one
            FOR each char IN s1
                IF char EQUALS element at position current_index_s2 OF s2 THEN
                    INCREMENT current_index_s2 BY one
                    IF current_index_s2 EQUALS the LENGTH OF s2 THEN
                        SET element at position s1_count OF s2_count TO element at position s1_count MINUS one OF s2_count PLUS one
                        SET current_index_s2 TO zero
                    END IF
                END IF
                SET element at position s1_count OF index_map TO current_index_s2
            END FOR

            IF current_index_s2 IS IN the slice FROM position zero TO position s1_count MINUS one OF index_map THEN
                SET start TO the position OF current_index_s2 IN index_map
                SET cycle_length TO s1_count MINUS start
                SET cycles_fit TO the INTEGER DIVISION OF n1 MINUS start BY cycle_length
                SET remainder TO the REMAINDER OF n1 MINUS start DIVIDED BY cycle_length
                SET total_s2_count TO element at position start OF s2_count PLUS cycles_fit MULTIPLIED BY (element at position start PLUS cycle_length OF s2_count MINUS element at position start OF s2_count) PLUS element at position start PLUS remainder OF s2_count MINUS element at position start OF s2_count
                RETURN the INTEGER DIVISION OF total_s2_count BY n2
            END IF
        END WHILE

        RETURN the INTEGER DIVISION OF element at position s1_count OF s2_count BY n2
    END FUNCTION
END CLASS