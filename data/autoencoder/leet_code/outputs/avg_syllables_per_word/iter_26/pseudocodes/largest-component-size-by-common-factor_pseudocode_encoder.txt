CLASS UnionFind
    FUNCTION __init__(self, size)
        SET self.parent TO list of all integers FROM zero TO size MINUS one INCLUSIVE
        SET self.rank TO list of the integer one REPEATED size TIMES
        SET self.size TO list of the integer one REPEATED size TIMES
    END FUNCTION

    FUNCTION find(self, u)
        IF element at position u OF self.parent NOT EQUALS u THEN
            SET element at position u OF self.parent TO self.find(element at position u OF self.parent)
        END IF
        RETURN element at position u OF self.parent
    END FUNCTION

    FUNCTION union(self, u, v)
        SET rootU TO self.find(u)
        SET rootV TO self.find(v)
        IF rootU NOT EQUALS rootV THEN
            IF element at position rootU OF self.rank GREATER THAN element at position rootV OF self.rank THEN
                SET element at position rootV OF self.parent TO rootU
                INCREMENT element at position rootU OF self.size BY element at position rootV OF self.size
            ELSE IF element at position rootU OF self.rank LESS THAN element at position rootV OF self.rank THEN
                SET element at position rootU OF self.parent TO rootV
                INCREMENT element at position rootV OF self.size BY element at position rootU OF self.size
            ELSE
                SET element at position rootV OF self.parent TO rootU
                INCREMENT element at position rootU OF self.rank BY one
                INCREMENT element at position rootU OF self.size BY element at position rootV OF self.size
            END IF
        END IF
    END FUNCTION
END CLASS

CLASS Solution
    FUNCTION largestComponentSize(self, nums)
        SET max_num TO the maximum value IN nums
        ASSIGN uf TO a new UnionFind object CREATED WITH parameter max_num PLUS one

        SET prime_to_index TO an empty dictionary

        FOR each num IN nums
            FOR each prime IN self.prime_factors(num)
                IF prime IS IN prime_to_index THEN
                    CALL uf.union(element at key prime OF prime_to_index, num)
                ELSE
                    SET element at key prime OF prime_to_index TO num
                END IF
            END FOR
        END FOR

        SET max_component_size TO zero
        FOR each num IN nums
            SET root TO uf.find(num)
            IF element at position root OF uf.size GREATER THAN max_component_size THEN
                SET max_component_size TO element at position root OF uf.size
            END IF
        END FOR

        RETURN max_component_size
    END FUNCTION

    FUNCTION prime_factors(self, n)
        SET factors TO an empty set

        WHILE n MODULO two EQUALS zero
            ADD two TO factors
            SET n TO n DIVIDED BY two
        END WHILE

        SET i TO three
        WHILE i LESS THAN OR EQUAL TO the integer part of the square root of n
            WHILE n MODULO i EQUALS zero
                ADD i TO factors
                SET n TO n DIVIDED BY i
            END WHILE
            INCREMENT i BY two
        END WHILE

        IF n GREATER THAN two THEN
            ADD n TO factors
        END IF

        RETURN factors
    END FUNCTION
END CLASS