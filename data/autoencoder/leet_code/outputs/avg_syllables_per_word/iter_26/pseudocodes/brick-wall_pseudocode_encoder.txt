CLASS Solution
    FUNCTION leastBricks(wall AS list of lists of integers)
        ASSIGN reference gap_counts TO a new dictionary with default integer zero
        
        FOR each row IN wall
            SET total TO zero
            FOR each brick IN all elements EXCEPT the last element OF row
                INCREMENT total BY brick
                INCREMENT the value at key total IN gap_counts BY one
            END FOR
        END FOR
        
        SET max_gaps TO the maximum value AMONG all values IN gap_counts OR zero IF gap_counts IS empty
        
        SET result TO the LENGTH OF wall MINUS max_gaps
        RETURN result
    END FUNCTION
END CLASS