CLASS Solution
    FUNCTION minMalwareSpread(graph, initial)
        SET total_nodes TO the LENGTH OF graph
        INITIALIZE adjacency_list AS a mapping from each node TO an empty list

        FOR index_i FROM zero TO total_nodes MINUS one INCLUSIVE
            FOR index_j FROM index_i PLUS one TO total_nodes MINUS one INCLUSIVE
                IF the element at position index_i OF graph AT position index_j EQUALS one THEN
                    APPEND index_j TO the list AT adjacency_list FOR index_i
                    APPEND index_i TO the list AT adjacency_list FOR index_j
                END IF
            END FOR
        END FOR

        FUNCTION dfs(node, visited_set)
            IF node IS IN visited_set THEN
                RETURN zero
            END IF
            ADD node TO visited_set
            SET component_size TO one
            FOR each neighbor IN adjacency_list AT node
                INCREMENT component_size BY the RESULT OF dfs(neighbor, visited_set)
            END FOR
            RETURN component_size
        END FUNCTION

        ASSIGN infected_set TO a set created from initial

        INITIALIZE component_sizes AS an empty list
        INITIALIZE visited_nodes AS an empty set
        INITIALIZE component_index_map AS an empty mapping

        FOR current_node FROM zero TO total_nodes MINUS one INCLUSIVE
            IF current_node NOT IN visited_nodes AND current_node NOT IN infected_set THEN
                SET current_size TO the RESULT OF dfs(current_node, visited_nodes)
                APPEND current_size TO component_sizes

                FOR index_i FROM the LENGTH OF component_sizes MINUS one DOWN TO zero INCLUSIVE
                    IF the element at position index_i OF component_sizes EQUALS current_size THEN
                        BREAK the loop
                    END IF
                END FOR

                FOR each neighbor_node IN adjacency_list AT current_node
                    ASSIGN component_index_map AT neighbor_node TO index_i
                END FOR
            END IF
        END FOR

        INITIALIZE infected_count_per_component AS a mapping with default integer zero

        FOR each infected_node IN infected_set
            IF infected_node IS IN component_index_map THEN
                INCREMENT infected_count_per_component AT component_index_map OF infected_node BY one
            END IF
        END FOR

        SET maximum_component_size TO zero
        SET node_to_remove TO the minimum element IN initial

        FOR each infected_node IN infected_set
            IF infected_node IS IN component_index_map THEN
                SET component_id TO component_index_map AT infected_node
                IF infected_count_per_component AT component_id EQUALS one THEN
                    IF component_sizes AT component_id GREATER THAN maximum_component_size THEN
                        SET maximum_component_size TO component_sizes AT component_id
                        SET node_to_remove TO infected_node
                    ELSE IF component_sizes AT component_id EQUALS maximum_component_size THEN
                        SET node_to_remove TO the minimum value BETWEEN node_to_remove AND infected_node
                    END IF
                END IF
            END IF
        END FOR

        RETURN node_to_remove
    END FUNCTION
END CLASS