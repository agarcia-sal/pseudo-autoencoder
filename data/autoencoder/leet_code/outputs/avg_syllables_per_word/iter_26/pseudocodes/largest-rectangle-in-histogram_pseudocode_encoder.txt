CLASS Solution
    FUNCTION largestRectangleArea(heights)
        SET stack TO a list containing negative one as the single element
        SET max_area TO zero
        APPEND zero TO heights to add a zero height bar at the end to process remaining bars in stack
        
        FOR each index i AND height h IN enumeration of heights
            WHILE the element at the last position OF stack NOT EQUALS negative one AND height h LESS THAN the element at the position at the last element OF stack IN heights HOLDS
                SET height TO the element at the position obtained by removing the last element FROM stack IN heights
                SET width TO the difference BETWEEN index i AND the element at the last position OF stack MINUS one
                SET max_area TO the maximum value BETWEEN max_area AND height MULTIPLIED BY width
            END WHILE
            APPEND index i TO stack
        END FOR
        
        RETURN max_area
    END FUNCTION
END CLASS