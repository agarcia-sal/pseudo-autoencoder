CLASS Solution
    FUNCTION subarraysWithKDistinct(nums, k)
        FUNCTION atMostKDistinct(t)
            SET count TO a mapping WITH DEFAULT VALUE zero
            SET left TO zero
            SET result TO zero
            FOR each right FROM zero TO the LENGTH OF nums MINUS one INCLUSIVE
                INCREMENT the count AT element at position right OF nums BY one
                WHILE the NUMBER OF UNIQUE KEYS IN count IS GREATER THAN t HOLDS
                    DECREMENT the count AT element at position left OF nums BY one
                    IF the count AT element at position left OF nums EQUALS zero THEN
                        REMOVE the element at position left OF nums FROM count
                    END IF
                    INCREMENT left BY one
                END WHILE
                INCREMENT result BY right MINUS left PLUS one
            END FOR
            RETURN result
        END FUNCTION

        RETURN the VALUE FROM atMostKDistinct WITH PARAMETER k MINUS the VALUE FROM atMostKDistinct WITH PARAMETER k MINUS one
    END FUNCTION
END CLASS