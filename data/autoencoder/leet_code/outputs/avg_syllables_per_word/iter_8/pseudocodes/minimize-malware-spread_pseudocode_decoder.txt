CLASS Solution  
    FUNCTION minMalwareSpread(graph, initial)  
        FUNCTION dfs(node, component)  
            IF node IN visited THEN  
                RETURN  
            visited ADD node  
            component ADD node  
            FOR neighbor FROM 0 TO LENGTH OF graph MINUS 1  
                IF graph AT node AT neighbor EQUALS 1 AND neighbor NOT IN visited THEN  
                    CALL dfs(neighbor, component)  
        END FUNCTION  
        
        SET visited TO EMPTY SET  
        SET components TO EMPTY LIST  
        FOR node FROM 0 TO LENGTH OF graph MINUS 1  
            IF node NOT IN visited THEN  
                SET component TO EMPTY SET  
                CALL dfs(node, component)  
                APPEND component TO components  
        
        SET infected_count TO LIST OF ZEROS WITH LENGTH EQUAL TO LENGTH OF graph  
        FOR node IN initial  
            SET infected_count AT node TO 1  
        
        SET component_infected_count TO LIST OF ZEROS WITH LENGTH EQUAL TO LENGTH OF components  
        FOR node IN initial  
            FOR EACH i, component IN components WITH INDEX i  
                IF node IN component THEN  
                    INCREMENT component_infected_count AT i BY 1  
        
        SET max_saving TO 0  
        SET best_node TO MINIMUM VALUE IN initial  
        FOR node IN initial  
            FOR EACH i, component IN components WITH INDEX i  
                IF node IN component AND component_infected_count AT i EQUALS 1 THEN  
                    SET saving TO SIZE OF component  
                    IF saving GREATER THAN max_saving OR (saving EQUALS max_saving AND node LESS THAN best_node) THEN  
                        SET max_saving TO saving  
                        SET best_node TO node  
        
        RETURN best_node  
    END FUNCTION  
END CLASS