CLASS Solution  
    FUNCTION expressiveWords(s, words)  
        FUNCTION compress(word)  
            IF word IS empty  
                RETURN empty list  
            SET count TO 1  
            SET compressed TO empty list  
            FOR i FROM 1 TO LENGTH OF word MINUS 1  
                IF character at word position i EQUALS character at word position i MINUS 1  
                    INCREMENT count BY 1  
                ELSE  
                    APPEND pair of character at word position i MINUS 1 AND count TO compressed  
                    SET count TO 1  
            APPEND pair of last character in word AND count TO compressed  
            RETURN compressed  
        END FUNCTION  
        
        FUNCTION is_stretchy(s_compressed, word_compressed)  
            IF LENGTH OF s_compressed NOT EQUAL TO LENGTH OF word_compressed  
                RETURN False  
            FOR each pair (sc, sc_count) AND (wc, wc_count) IN s_compressed AND word_compressed  
                IF sc NOT EQUAL TO wc  
                    RETURN False  
                IF sc_count NOT EQUAL TO wc_count AND (sc_count LESS THAN 3 OR sc_count LESS THAN wc_count)  
                    RETURN False  
            RETURN True  
        END FUNCTION  
        
        SET s_compressed TO compress(s)  
        SET stretchy_count TO 0  
        
        FOR each word IN words  
            SET word_compressed TO compress(word)  
            IF is_stretchy(s_compressed, word_compressed)  
                INCREMENT stretchy_count BY 1  
        RETURN stretchy_count  
    END FUNCTION  
END CLASS