CLASS Solution  
    FUNCTION candyCrush(board)  
        SET R TO LENGTH OF board  
        SET C TO LENGTH OF board AT 0  
        SET stable TO false  
        
        WHILE stable IS false  
            SET stable TO true  
            SET to_crush TO EMPTY SET  
            
            FOR r FROM 0 TO R MINUS 1  
                FOR c FROM 0 TO C MINUS 3  
                    IF absolute value of board AT r AND c EQUALS absolute value of board AT r AND c PLUS 1 EQUALS absolute value of board AT r AND c PLUS 2 AND NOT EQUAL TO 0  
                        SET stable TO false  
                        ADD (r, c), (r, c PLUS 1), (r, c PLUS 2) TO to_crush  
            
            FOR r FROM 0 TO R MINUS 3  
                FOR c FROM 0 TO C MINUS 1  
                    IF absolute value of board AT r AND c EQUALS absolute value of board AT r PLUS 1 AND c EQUALS absolute value of board AT r PLUS 2 AND c AND NOT EQUAL TO 0  
                        SET stable TO false  
                        ADD (r, c), (r PLUS 1, c), (r PLUS 2, c) TO to_crush  
            
            FOR EACH (r, c) IN to_crush  
                SET board AT r AND c TO 0  
            
            FOR c FROM 0 TO C MINUS 1  
                SET wr TO R MINUS 1  
                FOR r FROM R MINUS 1 DOWN TO 0  
                    IF board AT r AND c NOT EQUAL TO 0  
                        SET board AT wr AND c TO board AT r AND c  
                        DECREMENT wr BY 1  
                FOR wr FROM wr DOWN TO 0  
                    SET board AT wr AND c TO 0  
        
        RETURN board  
    END FUNCTION  
END CLASS