CLASS UnionFind  
    FUNCTION __init__(self, size)  
        SET self.parent TO list of integers from 0 up to size minus 1  
        SET self.rank TO list of size elements all set to 1  
    END FUNCTION  
  
    FUNCTION find(self, p)  
        IF self.parent at index p is NOT EQUAL TO p THEN  
            SET self.parent at index p TO self.find(self.parent at index p)  
        END IF  
        RETURN self.parent at index p  
    END FUNCTION  
  
    FUNCTION union(self, p, q)  
        SET rootP TO self.find(p)  
        SET rootQ TO self.find(q)  
        IF rootP IS EQUAL TO rootQ THEN  
            RETURN False  
        END IF  
        IF self.rank at index rootP IS GREATER THAN self.rank at index rootQ THEN  
            SET self.parent at index rootQ TO rootP  
        ELSE IF self.rank at index rootP IS LESS THAN self.rank at index rootQ THEN  
            SET self.parent at index rootP TO rootQ  
        ELSE  
            SET self.parent at index rootQ TO rootP  
            INCREMENT self.rank at index rootP BY 1  
        END IF  
        RETURN True  
    END FUNCTION  
END CLASS  
  
CLASS Solution  
    FUNCTION distanceLimitedPathsExist(self, n, edgeList, queries)  
        SORT edgeList BY the third element of each edge in ascending order  
  
        CREATE indexedQueries AS list of tuples (limit, p, q, i) FOR each index i and elements (p, q, limit) IN queries  
        SORT indexedQueries in ascending order  
  
        INITIALIZE uf AS new UnionFind with size n  
  
        SET edgeIndex TO 0  
        SET numEdges TO LENGTH OF edgeList  
        SET results TO list of False values with length equal to LENGTH OF queries  
  
        FOR each limit, p, q, originalIndex IN indexedQueries DO  
            WHILE edgeIndex IS LESS THAN numEdges AND edgeList at edgeIndex's third element IS LESS THAN limit DO  
                SET u, v, _ TO elements of edgeList at edgeIndex  
                CALL uf.union(u, v)  
                INCREMENT edgeIndex BY 1  
            END WHILE  
  
            IF uf.find(p) IS EQUAL TO uf.find(q) THEN  
                SET results at originalIndex TO True  
            END IF  
        END FOR  
  
        RETURN results  
    END FUNCTION  
END CLASS