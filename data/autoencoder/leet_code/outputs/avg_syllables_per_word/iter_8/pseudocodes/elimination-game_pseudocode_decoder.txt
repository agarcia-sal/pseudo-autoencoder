CLASS Solution  
    FUNCTION lastRemaining(n)  
        SET remaining TO n  
        SET step TO 1  
        SET left_to_right TO true  
        SET head TO 1  

        WHILE remaining GREATER THAN 1  
            IF left_to_right OR remaining MODULO 2 EQUALS 1  
                INCREMENT head BY step  
            END IF  
            MULTIPLY step BY 2  
            DIVIDE remaining BY 2 USING INTEGER DIVISION  
            SET left_to_right TO NOT left_to_right  
        END WHILE  

        RETURN head  
    END FUNCTION  
END CLASS