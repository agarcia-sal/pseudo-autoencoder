CLASS Solution  
    FUNCTION longestCommonSubpath(n, paths)  
        FUNCTION hash_subpaths(path, length)  
            SET P TO 113  
            SET MOD TO 1000000007  
            SET hash_value TO 0  
            SET power TO 1  
            FOR i FROM 0 TO length MINUS 1  
                SET hash_value TO hash_value MULTIPLIED BY P PLUS path AT i, THEN MODULO MOD  
                SET power TO power MULTIPLIED BY P THEN MODULO MOD  
            END FOR  
            SET hashes TO A SET CONTAINING hash_value  
            FOR i FROM length TO LENGTH OF path MINUS 1  
                SET hash_value TO hash_value MULTIPLIED BY P PLUS path AT i MINUS path AT (i MINUS length) MULTIPLIED BY power, THEN MODULO MOD  
                ADD hash_value TO hashes  
            END FOR  
            RETURN hashes  
        END FUNCTION  
        
        FUNCTION check_common_subpath(length)  
            IF length EQUALS 0 THEN  
                RETURN True  
            END IF  
            SET common_hashes TO RESULT OF hash_subpaths ON paths AT INDEX 0 WITH length  
            FOR EACH path IN paths STARTING FROM INDEX 1  
                SET current_hashes TO RESULT OF hash_subpaths ON path WITH length  
                SET common_hashes TO INTERSECTION OF common_hashes AND current_hashes  
                IF common_hashes IS EMPTY THEN  
                    RETURN False  
                END IF  
            END FOR  
            RETURN WHETHER common_hashes IS NOT EMPTY  
        END FUNCTION  
        
        SET left TO 0  
        SET right TO MINIMUM OF LENGTH OF EACH path IN paths  
        WHILE left LESS THAN right  
            SET mid TO (left PLUS right PLUS 1) DIVIDED BY 2  
            IF check_common_subpath(mid) THEN  
                SET left TO mid  
            ELSE  
                SET right TO mid MINUS 1  
            END IF  
        END WHILE  
        
        RETURN left  
    END FUNCTION  
END CLASS