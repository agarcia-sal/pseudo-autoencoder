CLASS Solution  
    FUNCTION largestPathValue(colors, edges)  
        SET n TO LENGTH OF colors  
        SET graph TO empty mapping with default value as empty list  
        SET in_degree TO list of zeros with length n  
        
        FOR each pair u, v IN edges  
            APPEND v TO graph[u]  
            INCREMENT in_degree[v] BY 1  
        
        SET queue TO empty deque containing all indices i from 0 to n MINUS 1 WHERE in_degree[i] EQUALS 0  
        SET dp TO list of n lists each containing 26 zeros  
        SET visited TO 0  
        SET max_color_value TO 0  
        
        WHILE queue is not empty  
            SET node TO element removed from front of queue  
            INCREMENT dp[node][ORDINAL VALUE of colors[node] MINUS ORDINAL VALUE of 'a'] BY 1  
            SET max_color_value TO maximum of max_color_value AND dp[node][ORDINAL VALUE of colors[node] MINUS ORDINAL VALUE of 'a']  
            INCREMENT visited BY 1  
            
            FOR each neighbor IN graph[node]  
                FOR c FROM 0 TO 25  
                    SET dp[neighbor][c] TO maximum of dp[neighbor][c] AND dp[node][c]  
                DECREMENT in_degree[neighbor] BY 1  
                IF in_degree[neighbor] EQUALS 0  
                    APPEND neighbor TO queue  
        
        IF visited EQUALS n  
            RETURN max_color_value  
        ELSE  
            RETURN -1  
    END FUNCTION  
END CLASS