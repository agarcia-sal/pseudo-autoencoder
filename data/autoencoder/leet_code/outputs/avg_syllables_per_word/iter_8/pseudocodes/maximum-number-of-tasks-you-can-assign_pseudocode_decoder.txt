CLASS Solution  
    FUNCTION maxTaskAssign(tasks, workers, pills, strength)  
        SORT tasks IN ascending order  
        SORT workers IN ascending order  
        
        FUNCTION canAssignTasks(k)  
            SET available_workers TO last k elements OF workers  
            SET pills_used TO 0  
            
            FOR i FROM k MINUS 1 DOWNTO 0  
                SET task TO tasks AT index i  
                SET worker_idx TO position TO INSERT task IN available_workers TO MAINTAIN ORDER  
                
                IF worker_idx LESS THAN LENGTH OF available_workers THEN  
                    REMOVE worker AT worker_idx FROM available_workers  
                ELSE IF pills_used LESS THAN pills THEN  
                    SET worker_idx TO position TO INSERT (task MINUS strength) IN available_workers TO MAINTAIN ORDER  
                    
                    IF worker_idx LESS THAN LENGTH OF available_workers THEN  
                        REMOVE worker AT worker_idx FROM available_workers  
                        INCREMENT pills_used BY 1  
                    ELSE  
                        RETURN False  
                ELSE  
                    RETURN False  
            RETURN True  
        
        SET left TO 0  
        SET right TO MINIMUM OF LENGTH OF tasks AND LENGTH OF workers PLUS 1  
        
        WHILE left LESS THAN right  
            SET mid TO left PLUS right DIVIDED BY 2 WITHOUT REMAINDER  
            
            IF canAssignTasks(mid) THEN  
                SET left TO mid PLUS 1  
            ELSE  
                SET right TO mid  
        RETURN left MINUS 1  
    END FUNCTION  
END CLASS