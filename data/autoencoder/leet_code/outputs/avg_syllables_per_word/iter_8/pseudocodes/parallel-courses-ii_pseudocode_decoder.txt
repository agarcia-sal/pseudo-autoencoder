CLASS Solution  
    FUNCTION minNumberOfSemesters(n, relations, k)  
        SET graph TO empty mapping with default empty list  
        SET in_degree TO list of zeros with length n plus 1  
        
        FOR each prevCourse, nextCourse IN relations  
            APPEND nextCourse TO graph value at prevCourse  
            DECREMENT in_degree value at nextCourse BY negative one (i.e., INCREMENT by one)  
        
        SET queue TO empty double-ended queue  
        FOR each course FROM 1 TO n inclusive  
            IF in_degree value at course EQUALS zero  
                APPEND course TO queue  
        
        SET semesters TO zero  
        
        WHILE queue is not empty  
            SET limit TO minimum of k AND length of queue  
            FOR count FROM 1 TO limit inclusive  
                REMOVE first element FROM queue AND SET TO current_course  
                FOR each next_course IN graph value at current_course  
                    DECREMENT in_degree value at next_course BY one  
                    IF in_degree value at next_course EQUALS zero  
                        APPEND next_course TO queue  
            INCREMENT semesters BY one  
        
        RETURN semesters  
    END FUNCTION  
END CLASS