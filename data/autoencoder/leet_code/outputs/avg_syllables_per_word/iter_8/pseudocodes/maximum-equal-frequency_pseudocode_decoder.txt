CLASS Solution  
    FUNCTION maxEqualFreq(nums)  
        SET count TO new frequency counter  
        SET freq TO new frequency counter  
        SET max_len TO 0  
        
        FOR each index i AND element num IN nums  
            INCREMENT count of num BY 1  
            
            IF count of num GREATER THAN 1  
                DECREMENT freq of count of num MINUS 1 BY 1  
                IF freq of count of num MINUS 1 EQUALS 0  
                    REMOVE freq of count of num MINUS 1  
            
            INCREMENT freq of count of num BY 1  
            
            IF length of freq EQUALS 1 AND (freq contains key 1 OR the single value in freq EQUALS 1)  
                SET max_len TO i PLUS 1  
            ELSE IF length of freq EQUALS 2 AND ((freq contains key 1 AND freq at 1 EQUALS 1) OR (difference between maximum key and minimum key EQUALS 1 AND freq at maximum key EQUALS 1))  
                SET max_len TO i PLUS 1  
        
        RETURN max_len  
    END FUNCTION  
END CLASS