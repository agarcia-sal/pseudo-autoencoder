CLASS Solution  
    FUNCTION getLengthOfOptimalCompression(s, k)  
        DEFINE FUNCTION dp(i, k, prev_char, prev_count)  
            IF k IS LESS THAN 0  
                RETURN infinity  
            END IF  
            IF i IS EQUAL TO LENGTH OF s  
                RETURN 0  
            END IF  
            IF CHARACTER AT s POSITION i IS EQUAL TO prev_char  
                IF prev_count IS 1 OR prev_count IS 9 OR prev_count IS 99  
                    SET increment TO 1  
                ELSE  
                    SET increment TO 0  
                END IF  
                RETURN increment PLUS dp(i INCREMENTED BY 1, k, prev_char, prev_count INCREMENTED BY 1)  
            ELSE  
                SET keep TO 1 PLUS dp(i INCREMENTED BY 1, k, CHARACTER AT s POSITION i, 1)  
                SET delete TO dp(i INCREMENTED BY 1, k DECREMENTED BY 1, prev_char, prev_count)  
                RETURN MINIMUM OF keep AND delete  
            END IF  
        END FUNCTION  
        RETURN dp(0, k, EMPTY STRING, 0)  
    END FUNCTION  
END CLASS