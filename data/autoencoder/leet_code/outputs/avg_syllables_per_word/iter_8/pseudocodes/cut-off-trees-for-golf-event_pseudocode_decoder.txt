CLASS Solution  
    FUNCTION cutOffTree(forest)  
        IF forest IS EMPTY OR forest FIRST ELEMENT IS EMPTY  
            RETURN -1  
        
        SET trees TO list of (forest value, row index, column index) FOR EACH row index AND column index WHERE forest value IS GREATER THAN 1  
        SORT trees BY forest value ASCENDING  
        
        FUNCTION bfs(start, end)  
            IF start EQUALS end  
                RETURN 0  
            SET m TO LENGTH OF forest  
            SET n TO LENGTH OF forest FIRST ELEMENT  
            SET queue TO new deque initialized with start  
            SET visited TO set containing start  
            SET steps TO 0  
            
            WHILE queue IS NOT EMPTY  
                FOR counter FROM 1 TO LENGTH OF queue  
                    SET x, y TO queue REMOVE FIRST ELEMENT  
                    FOR each direction dx, dy IN list of [(-1, 0), (1, 0), (0, -1), (0, 1)]  
                        SET nx TO x PLUS dx  
                        SET ny TO y PLUS dy  
                        IF nx IS GREATER THAN OR EQUAL TO 0 AND nx IS LESS THAN m AND ny IS GREATER THAN OR EQUAL TO 0 AND ny IS LESS THAN n AND (nx, ny) NOT IN visited AND forest AT nx, ny IS NOT 0  
                            IF (nx, ny) EQUALS end  
                                RETURN steps PLUS 1  
                            ADD (nx, ny) TO visited  
                            ADD (nx, ny) TO queue  
                INCREMENT steps BY 1  
            
            RETURN -1  
        END FUNCTION  
        
        SET x TO 0  
        SET y TO 0  
        SET total_steps TO 0  
        
        FOR each height, tx, ty IN trees  
            SET steps TO bfs((x, y), (tx, ty))  
            IF steps EQUALS -1  
                RETURN -1  
            INCREMENT total_steps BY steps  
            SET x TO tx  
            SET y TO ty  
        
        RETURN total_steps  
    END FUNCTION  
END CLASS