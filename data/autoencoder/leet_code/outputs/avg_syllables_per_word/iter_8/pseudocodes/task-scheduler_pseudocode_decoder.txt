CLASS Solution  
    FUNCTION leastInterval(tasks, n)  
        SET task_counts TO frequency count of tasks  
        SET max_heap TO list of negative values of task_counts values  
        CONVERT max_heap INTO a heap structure  
        
        SET time TO 0  
        SET queue TO empty list  
        
        WHILE max_heap is not empty OR queue is not empty  
            WHILE queue is not empty AND first element's time EQUALS time  
                REMOVE first element from queue INTO (_, count)  
                IF count is less than 0  
                    ADD count back into max_heap  
            
            IF max_heap is not empty  
                REMOVE top element from max_heap INTO count  
                INCREMENT count BY 1  
                IF count is less than 0  
                    APPEND pair of (time PLUS n PLUS 1, count) TO queue  
            
            INCREMENT time BY 1  
        
        RETURN time  
    END FUNCTION  
END CLASS