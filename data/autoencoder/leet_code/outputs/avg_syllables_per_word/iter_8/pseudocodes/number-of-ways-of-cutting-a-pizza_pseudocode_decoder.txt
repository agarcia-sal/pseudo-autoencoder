CLASS Solution
    FUNCTION ways(pizza, k)
        FUNCTION dfs(i, j, k)
            IF k EQUALS 0 THEN
                RETURN integer_value_of (s[m][n] MINUS s[i][n] MINUS s[m][j] PLUS s[i][j] GREATER THAN 0)
            END IF
            SET ans TO 0
            FOR x FROM i PLUS 1 TO m MINUS 1
                IF s[x][n] MINUS s[i][n] MINUS s[x][j] PLUS s[i][j] GREATER THAN 0 THEN
                    INCREMENT ans BY dfs(x, j, k MINUS 1)
                END IF
            END FOR
            FOR y FROM j PLUS 1 TO n MINUS 1
                IF s[m][y] MINUS s[i][y] MINUS s[m][j] PLUS s[i][j] GREATER THAN 0 THEN
                    INCREMENT ans BY dfs(i, y, k MINUS 1)
                END IF
            END FOR
            RETURN ans MODULO mod
        END FUNCTION

        SET mod TO 10 RAISED TO THE POWER OF 9 PLUS 7
        SET m TO LENGTH OF pizza
        SET n TO LENGTH OF pizza AT INDEX 0
        SET s TO TWO-DIMENSIONAL LIST OF ZEROS WITH DIMENSIONS (m PLUS 1) BY (n PLUS 1)
        FOR i FROM 1 TO m
            FOR j FROM 1 TO n
                SET s[i][j] TO s[i MINUS 1][j] PLUS s[i][j MINUS 1] MINUS s[i MINUS 1][j MINUS 1] PLUS integer_value_of (pizza AT INDEX (i MINUS 1) AT INDEX (j MINUS 1) EQUALS 'A')
            END FOR
        END FOR
        RETURN dfs(0, 0, k MINUS 1)
    END FUNCTION
END CLASS