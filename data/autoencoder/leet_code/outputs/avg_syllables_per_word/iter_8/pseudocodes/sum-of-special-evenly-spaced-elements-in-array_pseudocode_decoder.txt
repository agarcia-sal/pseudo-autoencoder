CLASS Solution  
    FUNCTION solve(nums, queries)  
        SET MOD TO 10 raised to the power of 9 plus 7  
        SET n TO LENGTH OF nums  
        SET max_y TO the maximum y VALUE from each pair in queries  
        INITIALIZE prefix_sums AS a list containing max_y plus 1 lists each of size n filled with zeroes  
        
        FOR y FROM 1 TO max_y  
            FOR i FROM n minus 1 DOWNTO 0  
                IF i plus y LESS THAN n THEN  
                    SET prefix_sums at position y and i TO nums at i PLUS prefix_sums at position y and i plus y  
                ELSE  
                    SET prefix_sums at position y and i TO nums at i  
        
        INITIALIZE answer AS an empty list  
        FOR each pair x, y IN queries  
            APPEND prefix_sums at position y and x MODULO MOD TO answer  
        
        RETURN answer  
    END FUNCTION  
END CLASS