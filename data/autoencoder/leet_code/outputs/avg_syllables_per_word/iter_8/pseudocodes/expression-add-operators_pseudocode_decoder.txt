CLASS Solution  
    FUNCTION addOperators(num, target)  
        FUNCTION dfs(index, path, value, prev)  
            IF index EQUALS LENGTH OF num THEN  
                IF value EQUALS target THEN  
                    APPEND path TO result  
                END IF  
                RETURN  
            END IF  
            
            FOR i FROM index PLUS 1 TO LENGTH OF num PLUS 1 DO  
                SET operand TO SUBSTRING OF num FROM index TO i  
                IF LENGTH OF operand GREATER THAN 1 AND FIRST CHARACTER OF operand EQUALS '0' THEN  
                    CONTINUE  
                END IF  
                
                IF index EQUALS 0 THEN  
                    CALL dfs(i, operand, CONVERT operand TO INTEGER, CONVERT operand TO INTEGER)  
                ELSE  
                    CALL dfs(i, path CONCATENATED WITH '+' CONCATENATED WITH operand, value PLUS CONVERT operand TO INTEGER, CONVERT operand TO INTEGER)  
                    CALL dfs(i, path CONCATENATED WITH '-' CONCATENATED WITH operand, value MINUS CONVERT operand TO INTEGER, NEGATIVE OF CONVERT operand TO INTEGER)  
                    CALL dfs(i, path CONCATENATED WITH '*' CONCATENATED WITH operand, value MINUS prev PLUS prev TIMES CONVERT operand TO INTEGER, prev TIMES CONVERT operand TO INTEGER)  
                END IF  
            END FOR  
        END FUNCTION  
        
        SET result TO EMPTY LIST  
        CALL dfs(0, EMPTY STRING, 0, 0)  
        RETURN result  
    END FUNCTION  
END CLASS