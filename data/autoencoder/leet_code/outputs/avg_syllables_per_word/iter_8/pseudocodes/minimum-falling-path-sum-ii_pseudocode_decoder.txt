CLASS Solution  
    FUNCTION minFallingPathSum(grid)  
        IF grid IS empty OR first row of grid IS empty THEN  
            RETURN 0  
        END IF  
        
        SET n TO LENGTH OF grid  
        
        IF n EQUALS 1 THEN  
            RETURN minimum element IN first row of grid  
        END IF  
        
        SET dp TO copy of first row of grid  
        
        FOR i FROM 1 TO n MINUS 1 DO  
            INITIALIZE new_dp AS list OF size n WITH zeros  
            SET min1 TO infinity  
            SET min2 TO infinity  
            SET min1_index TO negative one  
            
            FOR j FROM 0 TO n MINUS 1 DO  
                IF dp[j] LESS THAN min1 THEN  
                    SET min2 TO min1  
                    SET min1 TO dp[j]  
                    SET min1_index TO j  
                ELSE IF dp[j] LESS THAN min2 THEN  
                    SET min2 TO dp[j]  
                END IF  
            END FOR  
            
            FOR j FROM 0 TO n MINUS 1 DO  
                IF j EQUALS min1_index THEN  
                    SET new_dp[j] TO element AT grid[i][j] PLUS min2  
                ELSE  
                    SET new_dp[j] TO element AT grid[i][j] PLUS min1  
                END IF  
            END FOR  
            
            SET dp TO copy of new_dp  
        END FOR  
        
        RETURN minimum element IN dp  
    END FUNCTION  
END CLASS