CLASS Solution  
    FUNCTION palindromePairs(words)  
        FUNCTION is_palindrome(s)  
            RETURN s EQUALS s REVERSED  
        END FUNCTION  
        
        SET word_dict TO EMPTY DICTIONARY  
        FOR each index i AND word IN words  
            SET word_dict[word] TO i  
        
        SET result TO EMPTY LIST  
        
        FOR each index i AND word IN words  
            IF word IS EMPTY  
                CONTINUE  
            
            IF EMPTY STRING EXISTS IN word_dict AND is_palindrome(word)  
                APPEND [i, word_dict EMPTY STRING] TO result  
                APPEND [word_dict EMPTY STRING, i] TO result  
            
            SET reversed_word TO word REVERSED  
            IF reversed_word EXISTS IN word_dict AND word_dict[reversed_word] IS NOT i  
                APPEND [i, word_dict[reversed_word]] TO result  
            
            FOR each j FROM 1 TO LENGTH OF word MINUS 1  
                SET prefix TO SUBSTRING OF word FROM START TO j  
                SET suffix TO SUBSTRING OF word FROM j TO END  
                SET reversed_prefix TO prefix REVERSED  
                SET reversed_suffix TO suffix REVERSED  
                
                IF is_palindrome(suffix) AND reversed_prefix EXISTS IN word_dict  
                    APPEND [i, word_dict[reversed_prefix]] TO result  
                
                IF is_palindrome(prefix) AND reversed_suffix EXISTS IN word_dict  
                    APPEND [word_dict[reversed_suffix], i] TO result  
        
        RETURN result  
    END FUNCTION  
END CLASS