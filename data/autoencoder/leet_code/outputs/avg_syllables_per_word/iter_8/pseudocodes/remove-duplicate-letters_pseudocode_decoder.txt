CLASS Solution  
    FUNCTION removeDuplicateLetters(s)  
        SET last_occurrence TO DICTIONARY mapping each character in s TO its last index  
        SET stack TO empty list  
        SET in_stack TO empty set  
        
        FOR each index idx and character char IN s  
            IF char IS IN in_stack  
                CONTINUE to next iteration  
            
            WHILE stack IS NOT empty AND char IS lexicographically smaller THAN last character in stack AND idx IS LESS THAN last_occurrence of last character in stack  
                SET removed_char TO remove last character from stack  
                REMOVE removed_char FROM in_stack  
            
            APPEND char TO stack  
            ADD char TO in_stack  
        
        SET result TO concatenation of all characters in stack  
        RETURN result  
    END FUNCTION  
END CLASS