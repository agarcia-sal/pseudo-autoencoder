CLASS Solution  
    FUNCTION minWastedSpace(packages, boxes)  
        SET MOD TO 10 raised to the power 9 plus 7  
        SORT packages IN ascending order  
        SET n TO LENGTH OF packages  
        
        SET prefix_sum TO list of zeros with length n plus 1  
        FOR i FROM 0 TO n minus 1  
            SET prefix_sum at position i plus 1 TO prefix_sum at position i PLUS packages at position i  
        
        SET min_wasted_space TO infinity  
        
        FOR each box IN boxes  
            SORT box IN ascending order  
            IF last element of box LESS THAN last element of packages THEN  
                CONTINUE to next iteration  
            
            SET total_wasted TO 0  
            SET last_index TO 0  
            
            FOR each box_size IN box  
                SET index TO last_index  
                WHILE index LESS THAN n AND packages at position index LESS THAN OR EQUAL TO box_size  
                    INCREMENT index BY 1  
                
                IF index GREATER THAN last_index THEN  
                    INCREMENT total_wasted BY (index MINUS last_index) TIMES box_size MINUS (prefix_sum at position index MINUS prefix_sum at position last_index)  
                    SET last_index TO index  
            
            IF last_index EQUALS n THEN  
                SET min_wasted_space TO minimum OF min_wasted_space AND total_wasted  
        
        IF min_wasted_space NOT EQUAL TO infinity THEN  
            RETURN min_wasted_space MODULO MOD  
        ELSE  
            RETURN -1  
    END FUNCTION  
END CLASS