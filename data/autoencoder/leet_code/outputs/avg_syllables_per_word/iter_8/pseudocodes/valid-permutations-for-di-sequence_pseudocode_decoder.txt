CLASS Solution  
    FUNCTION numPermsDISequence(s)  
        SET MOD TO 10 TO THE POWER OF 9 PLUS 7  
        SET n TO LENGTH OF s  
        INITIALIZE dp AS A TWO-DIMENSIONAL LIST WITH DIMENSIONS (n PLUS 1) BY (n PLUS 1) FILLED WITH 0  
        
        FOR j FROM 0 TO n  
            SET dp AT 0 AND j TO 1  
        
        FOR i FROM 1 TO n  
            SET prefix_sum TO 0  
            IF CHARACTER AT s AT POSITION (i MINUS 1) EQUALS 'I' THEN  
                FOR j FROM 0 TO (n PLUS 1 MINUS i) MINUS 1  
                    SET prefix_sum TO prefix_sum PLUS dp AT (i MINUS 1) AND j MODULO MOD  
                    SET dp AT i AND j TO prefix_sum  
            ELSE  
                FOR j FROM (n MINUS i) DOWN TO 0  
                    SET prefix_sum TO prefix_sum PLUS dp AT (i MINUS 1) AND (j PLUS 1) MODULO MOD  
                    SET dp AT i AND j TO prefix_sum  
        
        SET result TO SUM OF dp AT n  
        RETURN result MODULO MOD  
    END FUNCTION  
END CLASS