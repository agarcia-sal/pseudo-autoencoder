CLASS Solution  
    FUNCTION pathsWithMaxScore(board)  
        SET MOD TO 10 raised to the power 9 plus 7  
        SET n TO LENGTH OF board  
        
        INITIALIZE dp AS n by n list where each element is a list containing negative infinity and zero  
        
        SET dp at position (n minus 1, n minus 1) TO list containing zero and one  
        
        FOR i FROM n minus 1 DOWN TO zero  
            FOR j FROM n minus 1 DOWN TO zero  
                IF board element at position (i, j) IS 'X' OR 'S' THEN  
                    CONTINUE TO next iteration  
                END IF  
                
                IF board element at (i, j) IS NOT 'E' THEN  
                    SET value TO integer conversion of board element at (i, j)  
                ELSE  
                    SET value TO zero  
                END IF  
                
                FOR each pair (x, y) IN list of (1, 0), (0, 1), (1, 1)  
                    SET ni TO i plus x  
                    SET nj TO j plus y  
                    IF ni IS GREATER THAN OR EQUAL TO zero AND LESS THAN n AND nj IS GREATER THAN OR EQUAL TO zero AND LESS THAN n THEN  
                        IF dp element at (ni, nj) zero index IS GREATER THAN dp element at (i, j) zero index THEN  
                            SET dp element at (i, j) TO list containing dp element at (ni, nj) zero index plus value AND dp element at (ni, nj) first index  
                        ELSE IF dp element at (ni, nj) zero index IS EQUAL TO dp element at (i, j) zero index THEN  
                            SET dp element at (i, j) first index TO (dp element at (i, j) first index plus dp element at (ni, nj) first index) MODULO MOD  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        IF dp element at (0, 0) zero index IS EQUAL TO negative infinity THEN  
            RETURN list of zero and zero  
        END IF  
        
        RETURN list of dp element at (0, 0) zero index AND dp element at (0, 0) first index  
    END FUNCTION  
END CLASS