CLASS Solution  
    FUNCTION findDerangement(n)  
        SET MOD TO 10 raised to the power of 9 plus 7  
        
        IF n EQUALS 1  
            RETURN 0  
        END IF  
        
        IF n EQUALS 2  
            RETURN 1  
        END IF  
        
        SET prev2 TO 1  
        SET prev1 TO 0  
        
        FOR i FROM 3 TO n INCLUSIVE  
            SET current TO (i minus 1) multiplied BY (prev1 plus prev2) MODULO MOD  
            SET prev2 TO prev1  
            SET prev1 TO current  
        END FOR  
        
        RETURN prev1  
    END FUNCTION  
END CLASS