CLASS Solution  
    FUNCTION leastBricks(wall)  
        SET gap_counts TO a mapping with default integer value  
        
        FOR each row IN wall  
            SET total TO 0  
            FOR each brick IN all bricks of row except the last one  
                INCREMENT total BY brick  
                INCREMENT gap_counts at total BY 1  
        
        SET max_gaps TO the maximum value in gap_counts or 0 if gap_counts is empty  
        
        RETURN length of wall MINUS max_gaps  
    END FUNCTION  
END CLASS