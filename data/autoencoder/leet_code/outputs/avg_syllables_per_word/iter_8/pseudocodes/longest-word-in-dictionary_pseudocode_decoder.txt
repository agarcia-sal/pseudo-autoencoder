CLASS Solution  
    FUNCTION longestWord(words)  
        SORT words BY (length OF word, word lexicographically)  
        SET valid_words TO empty set  
        SET longest_word TO empty string  
        
        FOR each word IN words  
            IF length OF word EQUALS 1 OR substring OF word WITHOUT last character IS IN valid_words  
                ADD word TO valid_words  
                IF length OF word GREATER THAN length OF longest_word  
                    SET longest_word TO word  
        
        RETURN longest_word  
    END FUNCTION  
END CLASS