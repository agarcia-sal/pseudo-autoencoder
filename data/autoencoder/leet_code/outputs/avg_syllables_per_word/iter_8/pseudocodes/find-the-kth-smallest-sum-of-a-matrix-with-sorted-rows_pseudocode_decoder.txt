CLASS Solution  
    FUNCTION kthSmallest(mat, k)  
        SET m TO LENGTH OF mat  
        SET n TO LENGTH OF mat AT 0  
        SET min_heap TO LIST CONTAINING TUPLE OF (SUM OF FIRST ELEMENT OF EACH ROW IN mat, TUPLE OF ZEROS OF LENGTH m)  
        SET visited TO SET CONTAINING THE TUPLE OF ZEROS  

        WHILE k GREATER THAN 0  
            SET current_sum, indices TO REMOVE SMALLEST ELEMENT FROM min_heap  
            DECREMENT k BY 1  

            IF k EQUALS 0  
                RETURN current_sum  
            END IF  

            FOR i FROM 0 TO m MINUS 1  
                IF indices AT i PLUS 1 LESS THAN n  
                    SET new_indices TO COPY OF indices AS LIST  
                    INCREMENT new_indices AT i BY 1  
                    SET new_indices_tuple TO TUPLE OF new_indices  
                    SET new_sum TO current_sum MINUS mat AT i AND indices AT i PLUS mat AT i AND new_indices AT i  

                    IF new_indices_tuple NOT IN visited  
                        ADD new_indices_tuple TO visited  
                        INSERT (new_sum, new_indices_tuple) INTO min_heap  
                    END IF  
                END IF  
            END FOR  
        END WHILE  

        RETURN -1  
    END FUNCTION  
END CLASS