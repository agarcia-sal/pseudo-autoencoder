CLASS Solution  
    FUNCTION lengthOfLongestSubstringTwoDistinct(s)  
        CREATE char_count AS a mapping from characters to counts with default 0  
        SET left TO 0  
        SET max_length TO 0  
        
        FOR right FROM 0 TO LENGTH OF s MINUS 1  
            INCREMENT count of s at position right IN char_count BY 1  
            
            WHILE number of distinct keys IN char_count GREATER THAN 2  
                DECREMENT count of s at position left IN char_count BY 1  
                IF count of s at position left EQUALS 0  
                    REMOVE s at position left FROM char_count  
                INCREMENT left BY 1  
            
            SET max_length TO the greater value BETWEEN max_length AND (right MINUS left PLUS 1)  
        
        RETURN max_length  
    END FUNCTION  
END CLASS