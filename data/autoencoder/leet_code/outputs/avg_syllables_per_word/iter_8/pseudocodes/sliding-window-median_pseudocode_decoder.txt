CLASS Solution  
    FUNCTION medianSlidingWindow(nums, k)  
        SET lo TO empty list  
        SET hi TO empty list  

        FUNCTION balance_heaps()  
            IF LENGTH OF lo IS GREATER THAN LENGTH OF hi PLUS 1  
                MOVE element FROM lo TO hi WITH VALUE INVERTED  
            ELSE IF LENGTH OF hi IS GREATER THAN LENGTH OF lo  
                MOVE element FROM hi TO lo WITH VALUE INVERTED  
            END IF  
        END FUNCTION  

        FUNCTION add_num(num)  
            IF lo IS empty OR num IS LESS THAN OR EQUAL TO INVERTED FIRST ELEMENT OF lo  
                ADD inverted num TO lo  
            ELSE  
                ADD num TO hi  
            END IF  
            CALL balance_heaps()  
        END FUNCTION  

        FUNCTION remove_num(num)  
            IF num IS LESS THAN OR EQUAL TO INVERTED FIRST ELEMENT OF lo  
                REMOVE inverted num FROM lo  
                IF lo IS NOT empty  
                    REORGANIZE lo AS HEAP  
                END IF  
            ELSE  
                REMOVE num FROM hi  
                IF hi IS NOT empty  
                    REORGANIZE hi AS HEAP  
                END IF  
            END IF  
            CALL balance_heaps()  
        END FUNCTION  

        FUNCTION get_median()  
            IF LENGTH OF lo IS GREATER THAN LENGTH OF hi  
                RETURN INVERTED FIRST ELEMENT OF lo  
            ELSE  
                RETURN AVERAGE OF INVERTED FIRST ELEMENT OF lo AND FIRST ELEMENT OF hi  
            END IF  
        END FUNCTION  

        FOR i FROM 0 TO k MINUS 1  
            CALL add_num WITH nums AT i  
        END FOR  

        SET medians TO LIST CONTAINING get_median() RESULT  

        FOR i FROM k TO LENGTH OF nums MINUS 1  
            CALL add_num WITH nums AT i  
            CALL remove_num WITH nums AT i MINUS k  
            APPEND get_median() RESULT TO medians  
        END FOR  

        RETURN medians  
    END FUNCTION  
END CLASS