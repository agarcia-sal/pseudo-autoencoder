CLASS Solution  
    FUNCTION numberOfCombinations(num)  
        SET MOD TO 1000000007  
        SET n TO LENGTH OF num  
        SET memo TO empty dictionary  
        
        FUNCTION dp(index, prev_len)  
            IF index EQUALS n THEN  
                RETURN 1  
            END IF  
            
            IF memo CONTAINS (index, prev_len) THEN  
                RETURN memo AT (index, prev_len)  
            END IF  
            
            SET count TO 0  
            FOR length FROM 1 TO n MINUS index DO  
                IF CHARACTER AT num AT index EQUALS '0' THEN  
                    BREAK LOOP  
                END IF  
                
                SET current_num TO SUBSTRING OF num FROM index TO index PLUS length  
                
                IF prev_len EQUALS 0 OR current_num GREATER THAN OR EQUAL TO SUBSTRING OF num FROM index MINUS prev_len TO index THEN  
                    SET count TO (count PLUS dp(index PLUS length, length)) MODULO MOD  
                END IF  
            END FOR  
            
            SET memo AT (index, prev_len) TO count  
            RETURN count  
        END FUNCTION  
        
        RETURN dp(0, 0)  
    END FUNCTION  
END CLASS