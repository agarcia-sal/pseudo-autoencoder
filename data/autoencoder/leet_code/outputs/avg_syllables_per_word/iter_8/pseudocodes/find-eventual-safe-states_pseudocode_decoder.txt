CLASS Solution  
    FUNCTION eventualSafeNodes(graph)  
        FUNCTION is_safe(node)  
            IF visited AT node EQUALS 1  
                RETURN False  
            IF visited AT node EQUALS 2  
                RETURN True  
            SET visited AT node TO 1  
            FOR each neighbor IN graph AT node  
                IF is_safe(neighbor) EQUALS False  
                    RETURN False  
            SET visited AT node TO 2  
            RETURN True  
        END FUNCTION  
        
        SET n TO LENGTH OF graph  
        SET visited TO list of n elements all set to 0  
        SET safe_nodes TO empty list  
        
        FOR node FROM 0 TO n MINUS 1  
            IF is_safe(node) EQUALS True  
                APPEND node TO safe_nodes  
        
        RETURN safe_nodes  
    END FUNCTION  
END CLASS