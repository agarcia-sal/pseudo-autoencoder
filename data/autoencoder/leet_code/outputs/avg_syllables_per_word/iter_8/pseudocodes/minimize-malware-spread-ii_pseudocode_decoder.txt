CLASS Solution
    FUNCTION minMalwareSpread(graph, initial)
        SET n TO LENGTH OF graph
        SET adj_list TO new empty mapping with list as default
        
        FOR i FROM 0 TO n MINUS 1
            FOR j FROM i PLUS 1 TO n MINUS 1
                IF graph at i and j EQUALS 1
                    APPEND j TO adj_list at i
                    APPEND i TO adj_list at j
        
        FUNCTION dfs(node, visited)
            IF node IS IN visited
                RETURN 0
            ADD node TO visited
            SET size TO 1
            FOR each neighbor IN adj_list at node
                INCREMENT size BY dfs(neighbor, visited)
            RETURN size
        END FUNCTION
        
        SET infected TO new set from initial
        SET component_sizes TO empty list
        SET visited TO empty set
        SET component_index TO empty mapping
        
        FOR node FROM 0 TO n MINUS 1
            IF node NOT IN visited AND node NOT IN infected
                SET size TO dfs(node, visited)
                APPEND size TO component_sizes
                FOR i FROM LENGTH OF component_sizes MINUS 1 DOWN TO 0
                    IF component_sizes at i EQUALS size
                        BREAK
                FOR each neighbor IN adj_list at node
                    SET component_index at neighbor TO i
        
        SET infected_in_component TO new mapping with integer default zero
        
        FOR each node IN infected
            IF node IN component_index
                INCREMENT infected_in_component at component_index of node BY 1
        
        SET max_size TO 0
        SET node_to_remove TO minimum value IN initial
        
        FOR each node IN infected
            IF node IN component_index
                SET comp_idx TO component_index at node
                IF infected_in_component at comp_idx EQUALS 1
                    IF component_sizes at comp_idx GREATER THAN max_size
                        SET max_size TO component_sizes at comp_idx
                        SET node_to_remove TO node
                    ELSE IF component_sizes at comp_idx EQUALS max_size
                        SET node_to_remove TO minimum of node_to_remove AND node
        
        RETURN node_to_remove
    END FUNCTION
END CLASS