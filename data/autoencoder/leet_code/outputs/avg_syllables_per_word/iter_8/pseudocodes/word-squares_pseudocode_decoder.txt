CLASS Solution  
    FUNCTION wordSquares(words)  
        INITIALIZE prefix_to_words AS dictionary with default value empty list  
        FOR each word IN words  
            FOR i FROM 0 TO LENGTH OF word MINUS 1  
                SET prefix TO substring of word FROM start TO i  
                APPEND word TO prefix_to_words AT prefix  
        
        INITIALIZE results AS empty list  
        
        FUNCTION backtrack(square)  
            IF LENGTH OF square EQUALS LENGTH OF words AT 0 THEN  
                APPEND square TO results  
                RETURN  
            SET prefix TO concatenation of character AT LENGTH OF square FROM each word IN square  
            FOR each candidate IN prefix_to_words AT prefix  
                CALL backtrack WITH square APPENDED BY candidate  
        
        FOR each word IN words  
            CALL backtrack WITH list containing word  
        
        RETURN results  
    END FUNCTION  
END CLASS