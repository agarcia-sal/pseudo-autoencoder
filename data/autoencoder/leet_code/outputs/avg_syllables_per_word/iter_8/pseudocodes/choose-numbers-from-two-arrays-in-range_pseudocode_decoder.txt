CLASS Solution  
    FUNCTION countSubranges(nums1, nums2)  
        SET n TO LENGTH OF nums1  
        SET count TO 0  
        SET dp TO LIST OF LENGTH n WHERE EACH ELEMENT IS A DICTIONARY WITH DEFAULT INTEGER ZERO  
        
        FOR i FROM 0 TO n MINUS 1  
            INCREMENT dp AT i FOR KEY nums1 AT i BY 1  
            INCREMENT dp AT i FOR KEY NEGATIVE nums2 AT i BY 1  
            
            IF i GREATER THAN 0 THEN  
                FOR EACH balance, freq IN dp AT i MINUS 1  
                    SET dp AT i FOR KEY balance PLUS nums1 AT i TO (dp AT i FOR THAT KEY PLUS freq) MODULO MOD  
                    SET dp AT i FOR KEY balance MINUS nums2 AT i TO (dp AT i FOR THAT KEY PLUS freq) MODULO MOD  
            END IF  
            
            SET count TO (count PLUS dp AT i FOR KEY 0) MODULO MOD  
        END FOR  
        
        RETURN count  
    END FUNCTION  
END CLASS