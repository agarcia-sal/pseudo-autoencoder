CLASS Solution  
    FUNCTION isEscapePossible(blocked, source, target)  
        IF blocked IS empty  
            RETURN True  
        
        SET blocked_set TO set of tuples from blocked  
        SET n TO length of blocked  
        SET max_steps TO n multiplied BY (n minus 1) divided BY 2  
        
        FUNCTION bfs(start, end)  
            SET queue TO new deque initialized with tuple of start  
            SET visited TO set initialized with queue  
            
            WHILE queue IS NOT empty  
                SET x, y TO dequeue first element from queue  
                
                IF size of visited GREATER THAN max_steps OR (x EQUALS end at first position AND y EQUALS end at second position)  
                    RETURN True  
                
                FOR each pair dx, dy IN list of (0, 1), (0, -1), (1, 0), (-1, 0)  
                    SET nx TO x plus dx  
                    SET ny TO y plus dy  
                    IF nx GREATER THAN OR EQUAL TO 0 AND nx LESS THAN 10 power 6 AND ny GREATER THAN OR EQUAL TO 0 AND ny LESS THAN 10 power 6 AND (nx, ny) NOT IN blocked_set AND (nx, ny) NOT IN visited  
                        ADD (nx, ny) TO visited  
                        APPEND (nx, ny) TO queue  
            
            RETURN False  
        
        RETURN bfs(source, target) AND bfs(target, source)  
    END FUNCTION  
END CLASS