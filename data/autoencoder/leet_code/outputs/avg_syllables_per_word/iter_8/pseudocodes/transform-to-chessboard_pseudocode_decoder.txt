CLASS Solution  
    FUNCTION movesToChessboard(board)  
        SET N TO LENGTH OF board  
        SET rowSum TO 0  
        SET colSum TO 0  
        SET rowSwap TO 0  
        SET colSwap TO 0  
        
        FOR i FROM 0 TO N MINUS 1  
            FOR j FROM 0 TO N MINUS 1  
                IF board at i and j XOR board at i and 0 XOR board at 0 and j XOR board at 0 and 0 IS TRUE  
                    RETURN -1  
            INCREMENT rowSum BY board at i and 0  
            INCREMENT colSum BY board at 0 and i  
            IF board at i and 0 EQUALS i MODULO 2  
                INCREMENT rowSwap BY 1  
            IF board at 0 and i EQUALS i MODULO 2  
                INCREMENT colSwap BY 1  
        
        IF N DIVIDED BY 2 GREATER THAN rowSum OR rowSum GREATER THAN (N PLUS 1) DIVIDED BY 2  
            RETURN -1  
        IF N DIVIDED BY 2 GREATER THAN colSum OR colSum GREATER THAN (N PLUS 1) DIVIDED BY 2  
            RETURN -1  
        
        IF N MODULO 2 IS NOT EQUAL TO 0  
            IF rowSwap MODULO 2 IS NOT EQUAL TO 0  
                SET rowSwap TO N MINUS rowSwap  
            IF colSwap MODULO 2 IS NOT EQUAL TO 0  
                SET colSwap TO N MINUS colSwap  
        ELSE  
            SET rowSwap TO MINIMUM OF rowSwap AND N MINUS rowSwap  
            SET colSwap TO MINIMUM OF colSwap AND N MINUS colSwap  
        
        RETURN (rowSwap PLUS colSwap) DIVIDED BY 2  
    END FUNCTION  
END CLASS