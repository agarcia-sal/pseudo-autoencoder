CLASS Solution  
    FUNCTION movesToStamp(stamp, target)  
        SET m TO LENGTH OF stamp  
        SET n TO LENGTH OF target  
        SET indeg TO LIST WITH n MINUS m PLUS 1 ELEMENTS EACH SET TO m  
        SET q TO EMPTY DEQUE  
        SET g TO LIST OF n EMPTY LISTS  
        FOR i FROM 0 TO n MINUS m  
            FOR EACH j AND c IN ENUMERATION OF stamp  
                IF CHARACTER AT target AT i PLUS j EQUALS c  
                    DECREMENT indeg AT i BY 1  
                    IF indeg AT i EQUALS 0  
                        APPEND i TO q  
                ELSE  
                    APPEND i TO g AT i PLUS j  
        SET ans TO EMPTY LIST  
        SET vis TO LIST OF n ELEMENTS EACH SET TO False  
        WHILE q IS NOT EMPTY  
            SET i TO REMOVE LEFTMOST ELEMENT FROM q  
            APPEND i TO ans  
            FOR j FROM 0 TO m MINUS 1  
                IF vis AT i PLUS j IS False  
                    SET vis AT i PLUS j TO True  
                    FOR EACH k IN g AT i PLUS j  
                        DECREMENT indeg AT k BY 1  
                        IF indeg AT k EQUALS 0  
                            APPEND k TO q  
        IF ALL ELEMENTS IN vis ARE True  
            RETURN ans REVERSED  
        ELSE  
            RETURN EMPTY LIST  
    END FUNCTION  
END CLASS