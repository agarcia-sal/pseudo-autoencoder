CLASS Solution  
    FUNCTION calculate(s)  
        FUNCTION helper(s)  
            SET stack TO empty list  
            SET sign TO plus  
            SET num TO 0  
              
            WHILE LENGTH OF s GREATER THAN 0  
                SET char TO REMOVE first element FROM s  
                  
                IF char IS DIGIT  
                    SET num TO num MULTIPLIED BY 10 PLUS integer value of char  
                END IF  
                  
                IF char EQUALS '('  
                    SET num TO CALL helper WITH s  
                END IF  
                  
                IF char IS NOT DIGIT AND char IS NOT WHITESPACE OR LENGTH OF s EQUALS 0  
                    IF sign EQUALS plus  
                        APPEND num TO stack  
                    ELSE IF sign EQUALS minus  
                        APPEND negative num TO stack  
                    ELSE IF sign EQUALS multiply  
                        SET last element of stack TO last element MULTIPLIED BY num  
                    ELSE IF sign EQUALS divide  
                        SET last element of stack TO integer division of last element BY num  
                    END IF  
                      
                    SET sign TO char  
                    SET num TO 0  
                END IF  
                  
                IF char EQUALS ')'  
                    BREAK  
                END IF  
            END WHILE  
              
            RETURN SUM OF stack  
        END FUNCTION  
          
        RETURN CALL helper WITH list of characters of s  
    END FUNCTION  
END CLASS