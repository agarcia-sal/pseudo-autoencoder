CLASS Solution  
    FUNCTION countRoutes(locations, start, finish, fuel)  
        SET MOD TO 10 raised to the power of 9 plus 7  
        SET n TO LENGTH OF locations  
  
        FUNCTION dp(city, remaining_fuel) WITH MEMOIZATION  
            IF remaining_fuel LESS THAN 0 THEN  
                RETURN 0  
            END IF  
  
            SET routes TO 0  
            IF city EQUALS finish THEN  
                SET routes TO 1  
            END IF  
  
            FOR each next_city FROM 0 TO n MINUS 1  
                IF next_city NOT EQUALS city THEN  
                    SET fuel_cost TO ABSOLUTE VALUE OF (locations AT city MINUS locations AT next_city)  
                    IF remaining_fuel GREATER THAN OR EQUAL TO fuel_cost THEN  
                        SET routes TO (routes PLUS dp(next_city, remaining_fuel MINUS fuel_cost)) MODULO MOD  
                    END IF  
                END IF  
            END FOR  
  
            RETURN routes  
        END FUNCTION  
  
        RETURN dp(start, fuel)  
    END FUNCTION  
END CLASS