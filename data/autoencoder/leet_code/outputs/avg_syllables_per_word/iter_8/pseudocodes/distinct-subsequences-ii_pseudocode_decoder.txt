CLASS Solution  
    FUNCTION distinctSubseqII(s)  
        SET MOD TO 10 POWER 9 PLUS 7  
        SET n TO LENGTH OF s  
        INITIALIZE dp AS LIST OF ZEROS WITH LENGTH n PLUS 1  
        SET dp AT INDEX 0 TO 1  
        INITIALIZE last AS EMPTY DICTIONARY  
        
        FOR i FROM 1 TO n INCLUSIVE  
            SET char TO CHARACTER AT POSITION i MINUS 1 IN s  
            SET dp AT INDEX i TO (2 MULTIPLIED BY dp AT INDEX i MINUS 1) MODULO MOD  
            
            IF char IS IN last  
                SET dp AT INDEX i TO (dp AT INDEX i MINUS dp AT INDEX last AT char MINUS 1 PLUS MOD) MODULO MOD  
            END IF  
            
            SET last AT char TO i  
        END FOR  
        
        RETURN (dp AT INDEX n MINUS 1) MODULO MOD  
    END FUNCTION  
END CLASS