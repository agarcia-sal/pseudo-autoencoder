CLASS Solution  
    FUNCTION countPairs(n, edges, queries)  
        SET degree TO list of zeroes with length n plus one  
        FOR each pair (u, v) IN edges  
            INCREMENT degree at index u BY one  
            INCREMENT degree at index v BY one  
        
        SET shared TO default dictionary with integer default  
        FOR each pair (u, v) IN edges  
            IF u GREATER THAN v THEN  
                SWAP u and v  
            INCREMENT shared at key (u, v) BY one  
        
        SET sorted_degree TO sorted version of degree  
        
        SET answers TO empty list  
        FOR each q IN queries  
            SET count TO zero  
            SET left TO one  
            SET right TO n  
            WHILE left LESS THAN right DO  
                IF sorted_degree at left PLUS sorted_degree at right GREATER THAN q THEN  
                    INCREMENT count BY right MINUS left  
                    DECREMENT right BY one  
                ELSE  
                    INCREMENT left BY one  
            
            FOR each key (u, v) and value count_uv IN shared  
                SET degree_uv TO degree at u PLUS degree at v  
                IF degree_uv GREATER THAN q AND degree_uv MINUS count_uv LESS THAN OR EQUAL TO q THEN  
                    DECREMENT count BY one  
            
            APPEND count TO answers  
        
        RETURN answers  
    END FUNCTION  
END CLASS