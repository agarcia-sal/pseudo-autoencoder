CLASS Solution  
    FUNCTION largestMultipleOfThree(digits)  
        SET count TO frequency count of digits  
        SET total_sum TO sum of digits  
        SET remainder TO total_sum modulo 3  
        
        IF remainder EQUALS 1 THEN  
            FOR each d IN [1, 4, 7]  
                IF count at d IS GREATER THAN 0 THEN  
                    DECREMENT count at d BY 1  
                    BREAK loop  
            ELSE  
                FOR each d IN [2, 5, 8]  
                    IF count at d IS GREATER THAN 1 THEN  
                        DECREMENT count at d BY 2  
                        BREAK loop  
        
        IF remainder EQUALS 2 THEN  
            FOR each d IN [2, 5, 8]  
                IF count at d IS GREATER THAN 0 THEN  
                    DECREMENT count at d BY 1  
                    BREAK loop  
            ELSE  
                FOR each d IN [1, 4, 7]  
                    IF count at d IS GREATER THAN 1 THEN  
                        DECREMENT count at d BY 2  
                        BREAK loop  
        
        SET result TO empty list  
        FOR d FROM 9 DOWN TO 0  
            APPEND string representation of d repeated count at d times TO result  
        
        SET final_number TO concatenation of all elements in result  
        
        IF final_number is empty OR first character of final_number EQUALS '0' THEN  
            RETURN '0'  
        ELSE  
            RETURN final_number  
    END FUNCTION  
END CLASS