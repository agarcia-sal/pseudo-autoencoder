CLASS Solution  
    FUNCTION minCost(grid)  
        SET m TO LENGTH OF grid  
        SET n TO LENGTH OF grid AT index 0  
        SET directions TO list of tuples: (0, 1), (0, -1), (1, 0), (-1, 0)  
        SET costs TO a matrix of size m by n filled with infinity  
        SET costs AT 0,0 TO 0  
        
        SET pq TO list containing tuple (0, 0, 0)  
        SET visited TO empty set  
        
        WHILE pq is not empty  
            REMOVE from pq the tuple with smallest cost, ASSIGN to cost, i, j  
            
            IF (i, j) is in visited  
                CONTINUE to next iteration  
            ADD (i, j) TO visited  
            
            IF i is equal to m MINUS 1 AND j is equal to n MINUS 1  
                RETURN cost  
            
            FOR each index k and tuple (di, dj) IN directions  
                SET ni TO i PLUS di  
                SET nj TO j PLUS dj  
                IF ni GREATER THAN OR EQUAL TO 0 AND ni LESS THAN m AND nj GREATER THAN OR EQUAL TO 0 AND nj LESS THAN n  
                    IF k PLUS 1 IS NOT EQUAL TO grid AT i, j  
                        SET new_cost TO cost PLUS 1  
                    ELSE  
                        SET new_cost TO cost  
                    IF new_cost LESS THAN costs AT ni, nj  
                        SET costs AT ni, nj TO new_cost  
                        ADD tuple (new_cost, ni, nj) TO pq  
        
        RETURN -1  
    END FUNCTION  
END CLASS