CLASS Solution  
    FUNCTION findPaths(m, n, maxMove, startRow, startColumn)  
        SET MOD TO 10 raised TO THE POWER OF 9 PLUS 7  
        SET directions TO list of pairs (0, 1), (0, -1), (1, 0), (-1, 0)  
        SET dp TO three-dimensional list with dimensions m by n by (maxMove plus 1), initialized to zero  
        
        FOR k FROM 1 TO maxMove INCLUSIVE  
            FOR i FROM 0 TO m MINUS 1  
                FOR j FROM 0 TO n MINUS 1  
                    FOR each pair (di, dj) IN directions  
                        SET ni TO i PLUS di  
                        SET nj TO j PLUS dj  
                        IF ni LESS THAN 0 OR ni GREATER THAN OR EQUAL TO m OR nj LESS THAN 0 OR nj GREATER THAN OR EQUAL TO n THEN  
                            INCREMENT dp[i][j][k] BY 1 MODULO MOD  
                        ELSE  
                            INCREMENT dp[i][j][k] BY dp[ni][nj][k MINUS 1] MODULO MOD  
        RETURN dp[startRow][startColumn][maxMove]  
    END FUNCTION  
END CLASS