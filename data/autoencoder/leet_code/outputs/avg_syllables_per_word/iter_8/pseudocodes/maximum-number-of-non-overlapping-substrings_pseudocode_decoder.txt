CLASS Solution  
    FUNCTION maxNumOfSubstrings(s)  
        SET first TO empty map  
        SET last TO empty map  
        FOR each index i AND character c IN s  
            IF c NOT IN first  
                SET first[c] TO i  
            SET last[c] TO i  
        
        SET intervals TO empty list  
        FOR each character c IN first  
            SET start TO first[c]  
            SET end TO last[c]  
            SET i TO start  
            WHILE i LESS THAN OR EQUAL TO end  
                IF first[s[i]] LESS THAN start  
                    BREAK  
                SET end TO the maximum of end AND last[s[i]]  
                INCREMENT i BY 1  
            ELSE  
                APPEND the pair (start, end) TO intervals  
        
        SORT intervals BY the second element in each pair  
        
        SET result TO empty list  
        SET prev_end TO negative one  
        FOR each pair start, end IN intervals  
            IF start GREATER THAN prev_end  
                APPEND the substring of s FROM start TO end inclusive TO result  
                SET prev_end TO end  
        
        RETURN result  
    END FUNCTION  
END CLASS