CLASS Solution  
    FUNCTION maxTotalFruits(fruits, startPos, k)  
        SET max_fruits TO 0  
        SET total_fruits TO 0  
        SET left TO 0  
        
        FOR right FROM 0 TO LENGTH OF fruits MINUS 1  
            SET position TO fruits[right][0]  
            SET amount TO fruits[right][1]  
            INCREMENT total_fruits BY amount  
            
            WHILE left LESS THAN OR EQUAL TO right AND NOT (startPos MINUS k LESS THAN OR EQUAL TO fruits[left][0] AND fruits[left][0] LESS THAN OR EQUAL TO startPos PLUS k AND  
                                                          startPos MINUS k LESS THAN OR EQUAL TO fruits[right][0] AND fruits[right][0] LESS THAN OR EQUAL TO startPos PLUS k AND  
                                                          MINIMUM OF (ABSOLUTE VALUE OF (fruits[right][0] MINUS startPos), ABSOLUTE VALUE OF (fruits[left][0] MINUS startPos)) PLUS  
                                                          (fruits[right][0] MINUS fruits[left][0]) LESS THAN OR EQUAL TO k)  
                DECREMENT total_fruits BY fruits[left][1]  
                INCREMENT left BY 1  
            
            SET max_fruits TO MAXIMUM OF max_fruits AND total_fruits  
        
        RETURN max_fruits  
    END FUNCTION  
END CLASS