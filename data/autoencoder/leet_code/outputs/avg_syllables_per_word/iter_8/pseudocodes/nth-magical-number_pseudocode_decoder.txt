CLASS Solution  
    FUNCTION nthMagicalNumber(n, a, b)  
        SET MOD TO 10 TO THE POWER OF 9 PLUS 7  
        
        FUNCTION gcd(x, y)  
            WHILE y IS NOT ZERO  
                SET temp_x TO y  
                SET temp_y TO x MODULO y  
                SET x TO temp_x  
                SET y TO temp_y  
            END WHILE  
            RETURN x  
        END FUNCTION  
        
        FUNCTION lcm(x, y)  
            RETURN x MULTIPLIED BY y DIVIDED BY gcd(x, y)  
        END FUNCTION  
        
        SET L TO lcm(a, b)  
        SET left TO 1  
        SET right TO n MULTIPLIED BY MINIMUM OF a AND b  
        
        WHILE left IS LESS THAN right  
            SET mid TO (left PLUS right) DIVIDED BY 2  
            SET count TO (mid DIVIDED BY a) PLUS (mid DIVIDED BY b) MINUS (mid DIVIDED BY L)  
            
            IF count IS LESS THAN n  
                SET left TO mid PLUS 1  
            ELSE  
                SET right TO mid  
            END IF  
        END WHILE  
        
        RETURN left MODULO MOD  
    END FUNCTION  
END CLASS