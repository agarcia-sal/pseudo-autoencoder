CLASS Solution  
    FUNCTION calcEquation(equations, values, queries)  
        SET graph TO a dictionary with default value as dictionary  
        FOR each (a, b) and value in equations and values zipped together  
            SET graph at key a and key b TO value  
            SET graph at key b and key a TO one DIVIDED BY value  

        FUNCTION dfs(start, end, visited)  
            IF start is not in graph OR end is not in graph  
                RETURN negative one point zero  
            IF start EQUALS end  
                RETURN one point zero  
            ADD start TO visited  
            FOR each neighbor and weight in graph at key start items  
                IF neighbor NOT IN visited  
                    SET result TO dfs(neighbor, end, visited)  
                    IF result NOT EQUAL negative one point zero  
                        RETURN weight MULTIPLIED BY result  
            REMOVE start FROM visited  
            RETURN negative one point zero  
        END FUNCTION  

        SET results TO empty list  
        FOR each query in queries  
            UNPACK start and end FROM query  
            SET visited TO empty set  
            SET result TO dfs(start, end, visited)  
            APPEND result TO results  
        RETURN results  
    END FUNCTION  
END CLASS