CLASS Solution  
    FUNCTION uniquePathsIII(grid)  
        FUNCTION dfs(x, y, steps)  
            IF grid AT x AND y EQUALS 2 THEN  
                RETURN steps EQUALS 0  
            END IF  
            
            SET original TO grid AT x AND y  
            SET grid AT x AND y TO -2  
            SET count TO 0  
            
            FOR each (dx, dy) IN list of pairs [(-1, 0), (1, 0), (0, -1), (0, 1)]  
                SET nx TO x PLUS dx  
                SET ny TO y PLUS dy  
                IF nx GREATER THAN OR EQUAL TO 0 AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO 0 AND ny LESS THAN n AND grid AT nx AND ny GREATER THAN OR EQUAL TO 0 THEN  
                    INCREMENT count BY dfs(nx, ny, steps MINUS 1)  
                END IF  
            END FOR  
            
            SET grid AT x AND y TO original  
            RETURN count  
        END FUNCTION  
        
        SET m TO LENGTH OF grid  
        SET n TO LENGTH OF first element in grid  
        SET start_x TO 0  
        SET start_y TO 0  
        SET empty_squares TO 1  
        
        FOR i FROM 0 TO m MINUS 1  
            FOR j FROM 0 TO n MINUS 1  
                IF grid AT i AND j EQUALS 1 THEN  
                    SET start_x TO i  
                    SET start_y TO j  
                ELSE IF grid AT i AND j EQUALS 0 THEN  
                    INCREMENT empty_squares BY 1  
                END IF  
            END FOR  
        END FOR  
        
        RETURN dfs(start_x, start_y, empty_squares)  
    END FUNCTION  
END CLASS