CLASS Solution  
    FUNCTION numWays(words, target)  
        SET MOD TO 10 raised to the power of 9 plus 7  
        SET n TO LENGTH OF words at position 0  
        SET m TO LENGTH OF target  
        
        INITIALIZE freq AS list of n dictionaries mapping characters to integers  
        FOR each word IN words  
            FOR each index j and character char IN word  
                INCREMENT freq at position j for char BY 1  
        
        INITIALIZE dp AS two-dimensional list of zeros with dimensions (m plus 1) by (n plus 1)  
        
        FOR each j FROM 0 TO n inclusive  
            SET dp at row 0 and column j TO 1  
        
        FOR each i FROM 1 TO m inclusive  
            FOR each j FROM 1 TO n inclusive  
                SET dp at position (i, j) TO dp at position (i, j minus 1)  
                IF freq at position (j minus 1) for target character at (i minus 1) IS GREATER THAN 0  
                    INCREMENT dp at position (i, j) BY dp at position (i minus 1, j minus 1) MULTIPLIED BY freq at position (j minus 1) for target character at (i minus 1)  
                    SET dp at position (i, j) TO dp at position (i, j) MODULO MOD  
        
        RETURN dp at position (m, n)  
    END FUNCTION  
END CLASS