CLASS Solution  
    FUNCTION kthSmallestProduct(nums1, nums2, k)  
        FUNCTION count(p)  
            SET cnt TO 0  
            SET n TO LENGTH OF nums2  
            FOR each x IN nums1  
                IF x GREATER THAN 0  
                    INCREMENT cnt BY POSITION WHERE p DIVIDED BY x WOULD BE INSERTED ON RIGHT IN nums2  
                ELSE IF x LESS THAN 0  
                    INCREMENT cnt BY n MINUS POSITION WHERE p DIVIDED BY x WOULD BE INSERTED ON LEFT IN nums2  
                ELSE  
                    INCREMENT cnt BY n MULTIPLIED BY (1 IF p GREATER THAN OR EQUAL TO 0 ELSE 0)  
            RETURN cnt  
        END FUNCTION  

        SET mx TO MAXIMUM OF (ABSOLUTE VALUE OF FIRST ELEMENT OF nums1, ABSOLUTE VALUE OF LAST ELEMENT OF nums1)  
        MULTIPLIED BY MAXIMUM OF (ABSOLUTE VALUE OF FIRST ELEMENT OF nums2, ABSOLUTE VALUE OF LAST ELEMENT OF nums2)  

        RETURN POSITION WHERE k WOULD BE INSERTED ON LEFT IN RANGE FROM NEGATIVE mx TO mx INCLUSIVE USING count AS KEY  
        MINUS mx  
    END FUNCTION  
END CLASS