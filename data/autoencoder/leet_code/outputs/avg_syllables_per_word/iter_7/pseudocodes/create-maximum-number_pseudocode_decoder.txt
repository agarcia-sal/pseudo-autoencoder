CLASS Solution
    FUNCTION maxNumber(nums1, nums2, k)
        
        FUNCTION maxSingleArray(nums, k)
            SET drop TO LENGTH OF nums MINUS k
            SET stack TO empty list
            FOR each num IN nums
                WHILE drop GREATER THAN 0 AND stack NOT empty AND last element of stack LESS THAN num
                    REMOVE last element from stack
                    DECREMENT drop BY 1
                APPEND num TO stack
            RETURN first k elements of stack
        END FUNCTION
        
        FUNCTION merge(arr1, arr2)
            SET result TO empty list
            WHILE arr1 NOT empty OR arr2 NOT empty
                IF arr1 GREATER THAN arr2
                    APPEND first element of arr1 TO result
                    REMOVE first element from arr1
                ELSE
                    APPEND first element of arr2 TO result
                    REMOVE first element from arr2
            RETURN result
        END FUNCTION
        
        SET max_number TO empty list
        FOR i FROM 0 TO k INCLUSIVE
            IF i LESS THAN OR EQUAL TO LENGTH OF nums1 AND k MINUS i LESS THAN OR EQUAL TO LENGTH OF nums2
                SET candidate TO merge(maxSingleArray(nums1, i), maxSingleArray(nums2, k MINUS i))
                SET max_number TO lexicographically greater list BETWEEN max_number AND candidate
        RETURN max_number
    END FUNCTION
END CLASS