CLASS Solution  
    FUNCTION cutOffTree(forest)  
        IF forest IS empty OR first row of forest IS empty  
            RETURN -1  
        
        SET trees TO list of tuples (forest value, row index, column index) for each position in forest where value GREATER THAN 1  
        SORT trees by their first element (height)  
        
        FUNCTION bfs(start, end)  
            IF start EQUALS end  
                RETURN 0  
            SET m TO number of rows in forest  
            SET n TO number of columns in forest  
            INITIALIZE queue WITH start  
            INITIALIZE visited SET WITH start  
            SET steps TO 0  
            
            WHILE queue IS NOT empty  
                FOR each element in queue currently  
                    EXTRACT x, y FROM front of queue  
                    FOR each direction (dx, dy) IN [(-1,0), (1,0), (0,-1), (0,1)]  
                        SET nx TO x PLUS dx  
                        SET ny TO y PLUS dy  
                        IF nx GREATER THAN OR EQUAL TO 0 AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO 0 AND ny LESS THAN n  
                            AND (nx, ny) NOT IN visited  
                            AND forest at (nx, ny) NOT EQUAL TO 0  
                                IF (nx, ny) EQUALS end  
                                    RETURN steps PLUS 1  
                                ADD (nx, ny) TO visited  
                                APPEND (nx, ny) TO queue  
                INCREMENT steps BY 1  
            
            RETURN -1  
        
        SET x TO 0  
        SET y TO 0  
        SET total_steps TO 0  
        
        FOR each height, tx, ty IN trees  
            SET steps TO bfs((x, y), (tx, ty))  
            IF steps EQUALS -1  
                RETURN -1  
            INCREMENT total_steps BY steps  
            SET x TO tx  
            SET y TO ty  
        
        RETURN total_steps  
    END FUNCTION  
END CLASS