CLASS Solution  
    FUNCTION movesToStamp(stamp, target)  
        SET m TO LENGTH OF stamp  
        SET n TO LENGTH OF target  
        SET indeg TO LIST OF m REPEATED (n MINUS m PLUS 1) TIMES  
        SET q TO NEW deque  
        SET g TO LIST OF EMPTY LISTS WITH LENGTH n  
        FOR i FROM 0 TO n MINUS m  
            FOR j, c IN ENUMERATE stamp  
                IF target AT POSITION i PLUS j EQUALS c THEN  
                    DECREMENT indeg AT POSITION i BY 1  
                    IF indeg AT POSITION i EQUALS 0 THEN  
                        APPEND i TO q  
                ELSE  
                    APPEND i TO g AT POSITION i PLUS j  
        SET ans TO EMPTY LIST  
        SET vis TO LIST OF False WITH LENGTH n  
        WHILE q IS NOT EMPTY  
            REMOVE LEFTMOST ELEMENT FROM q AND SET TO i  
            APPEND i TO ans  
            FOR j FROM 0 TO m MINUS 1  
                IF vis AT POSITION i PLUS j IS False THEN  
                    SET vis AT POSITION i PLUS j TO True  
                    FOR k IN g AT POSITION i PLUS j  
                        DECREMENT indeg AT POSITION k BY 1  
                        IF indeg AT POSITION k EQUALS 0 THEN  
                            APPEND k TO q  
        IF ALL ELEMENTS IN vis ARE True THEN  
            RETURN REVERSED ans  
        ELSE  
            RETURN EMPTY LIST  
    END FUNCTION  
END CLASS