CLASS Solution  
    FUNCTION countPalindromicSubsequences(s)  
        SET MOD TO 10 TO THE POWER OF 9 PLUS 7  
        SET n TO LENGTH OF s  
        
        INITIALIZE next_occurrence AS 2D LIST WITH 4 ROWS AND n COLUMNS FILLED WITH -1  
        INITIALIZE prev_occurrence AS 2D LIST WITH 4 ROWS AND n COLUMNS FILLED WITH -1  
        
        FOR c FROM 0 TO 3  
            SET char TO CHARACTER WITH ASCII VALUE OF 'a' PLUS c  
            SET last TO -1  
            FOR i FROM 0 TO n MINUS 1  
                IF CHARACTER AT s POSITION i EQUALS char THEN  
                    SET last TO i  
                END IF  
                SET prev_occurrence AT ROW c COLUMN i TO last  
            END FOR  
            
            SET last TO -1  
            FOR i FROM n MINUS 1 DOWN TO 0  
                IF CHARACTER AT s POSITION i EQUALS char THEN  
                    SET last TO i  
                END IF  
                SET next_occurrence AT ROW c COLUMN i TO last  
            END FOR  
        END FOR  
        
        INITIALIZE dp AS 2D LIST WITH n ROWS AND n COLUMNS FILLED WITH 0  
        
        FOR i FROM 0 TO n MINUS 1  
            SET dp AT ROW i COLUMN i TO 1  
        END FOR  
        
        FOR length FROM 2 TO n  
            FOR i FROM 0 TO n MINUS length  
                SET j TO i PLUS length MINUS 1  
                FOR c FROM 0 TO 3  
                    SET char TO CHARACTER WITH ASCII VALUE OF 'a' PLUS c  
                    SET left TO next_occurrence AT ROW c COLUMN i  
                    SET right TO prev_occurrence AT ROW c COLUMN j  
                    
                    IF left GREATER THAN j OR right LESS THAN i THEN  
                        CONTINUE TO NEXT ITERATION  
                    ELSE IF left EQUALS right THEN  
                        SET dp AT ROW i COLUMN j TO dp AT ROW i COLUMN j PLUS 1 MODULO MOD  
                    ELSE  
                        SET dp AT ROW i COLUMN j TO dp AT ROW i COLUMN j PLUS dp AT ROW left PLUS 1 COLUMN right MINUS 1 PLUS 2 MODULO MOD  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        RETURN dp AT ROW 0 COLUMN n MINUS 1  
    END FUNCTION  
END CLASS