CLASS Solution  
    FUNCTION getLengthOfOptimalCompression(s, k)  
        DEFINE FUNCTION dp(i, k_remaining, prev_char, prev_count)  
            IF k_remaining LESS THAN 0  
                RETURN infinity  
            IF i EQUALS LENGTH OF s  
                RETURN 0  
            IF character AT POSITION i IN s EQUALS prev_char  
                SET increment TO 1 IF prev_count IS 1 OR 9 OR 99 OTHERWISE 0  
                RETURN increment PLUS dp(i PLUS 1, k_remaining, prev_char, prev_count PLUS 1)  
            ELSE  
                SET keep TO 1 PLUS dp(i PLUS 1, k_remaining, character AT POSITION i IN s, 1)  
                SET delete TO dp(i PLUS 1, k_remaining MINUS 1, prev_char, prev_count)  
                RETURN MINIMUM OF keep AND delete  
        END FUNCTION  
        RETURN dp(0, k, EMPTY STRING, 0)  
    END FUNCTION  
END CLASS