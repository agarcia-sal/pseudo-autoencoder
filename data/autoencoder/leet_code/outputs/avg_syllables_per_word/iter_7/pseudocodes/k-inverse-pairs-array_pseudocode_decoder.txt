CLASS Solution  
    FUNCTION kInversePairs(n, k)  
        SET MOD TO 10 RAISED TO THE POWER OF 9 PLUS 7  
        INITIALIZE dp AS LIST OF LISTS WITH SIZE (n PLUS 1) BY (k PLUS 1) FILLED WITH 0  
        SET dp AT INDEX 0 AND 0 TO 1  
        
        FOR i FROM 1 TO n INCLUSIVE  
            SET prefix_sum TO 0  
            FOR j FROM 0 TO k INCLUSIVE  
                SET prefix_sum TO prefix_sum PLUS dp AT INDEX (i MINUS 1) AND j  
                SET prefix_sum TO prefix_sum MODULO MOD  
                IF j IS GREATER THAN OR EQUAL TO i  
                    SET prefix_sum TO prefix_sum MINUS dp AT INDEX (i MINUS 1) AND (j MINUS i) PLUS MOD  
                    SET prefix_sum TO prefix_sum MODULO MOD  
                END IF  
                SET dp AT INDEX i AND j TO prefix_sum  
            END FOR  
        END FOR  
        
        RETURN dp AT INDEX n AND k  
    END FUNCTION  
END CLASS