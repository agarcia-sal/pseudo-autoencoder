CLASS Solution  
    FUNCTION solveNQueens(n)  
        FUNCTION is_not_under_attack(row, col)  
            RETURN NOT (cols AT col PLUS hills AT row MINUS col PLUS dales AT row PLUS col)  
        END FUNCTION  
        
        FUNCTION place_queen(row, col)  
            ADD pair (row, col) TO queens  
            SET cols AT col TO 1  
            SET hills AT row MINUS col TO 1  
            SET dales AT row PLUS col TO 1  
        END FUNCTION  
        
        FUNCTION remove_queen(row, col)  
            REMOVE pair (row, col) FROM queens  
            SET cols AT col TO 0  
            SET hills AT row MINUS col TO 0  
            SET dales AT row PLUS col TO 0  
        END FUNCTION  
        
        FUNCTION add_solution()  
            SET solution TO empty list  
            FOR each pair (_, col) IN queens sorted by row  
                APPEND string of col times '.' PLUS 'Q' PLUS (n MINUS col MINUS 1) times '.' TO solution  
            APPEND solution TO output  
        END FUNCTION  
        
        FUNCTION backtrack(row)  
            FOR col FROM 0 TO n MINUS 1  
                IF is_not_under_attack(row, col) THEN  
                    place_queen(row, col)  
                    IF row PLUS 1 EQUALS n THEN  
                        add_solution()  
                    ELSE  
                        backtrack(row PLUS 1)  
                    END IF  
                    remove_queen(row, col)  
                END IF  
            END FOR  
        END FUNCTION  
        
        SET cols TO list of n zeros  
        SET hills TO list of (2 TIMES n MINUS 1) zeros  
        SET dales TO list of (2 TIMES n MINUS 1) zeros  
        SET queens TO empty set  
        SET output TO empty list  
        CALL backtrack(0)  
        RETURN output  
    END FUNCTION  
END CLASS