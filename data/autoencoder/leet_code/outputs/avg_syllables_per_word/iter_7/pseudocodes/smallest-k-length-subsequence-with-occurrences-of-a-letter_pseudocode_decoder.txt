CLASS Solution  
    FUNCTION smallestSubsequence(s, k, letter, repetition)  
        SET letter_count TO the number of times letter occurs in s  
        SET stack TO empty list  
        FOR each index i and character char IN s  
            WHILE stack is not empty AND char is lexicographically smaller than top of stack AND length of s MINUS i PLUS length of stack MINUS 1 IS GREATER THAN OR EQUAL TO k  
                IF top of stack IS letter  
                    IF letter_count IS GREATER THAN repetition  
                        INCREMENT repetition BY 1  
                        REMOVE top element from stack  
                    ELSE  
                        BREAK the while loop  
                ELSE  
                    REMOVE top element from stack  
            IF length of stack IS LESS THAN k  
                IF char IS letter  
                    ADD char TO stack  
                    DECREMENT repetition BY 1  
                ELSE IF k MINUS length of stack IS GREATER THAN repetition  
                    ADD char TO stack  
                IF char IS letter  
                    DECREMENT letter_count BY 1  
        WHILE length of stack IS LESS THAN k  
            ADD letter TO stack  
        RETURN concatenation of elements in stack as string  
    END FUNCTION  
END CLASS