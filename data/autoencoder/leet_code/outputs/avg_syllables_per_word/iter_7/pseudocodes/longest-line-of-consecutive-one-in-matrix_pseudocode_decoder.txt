CLASS Solution  
    FUNCTION longestLine(mat)  
        IF mat IS empty OR mat at index 0 IS empty  
            RETURN 0  
        SET m TO LENGTH OF mat  
        SET n TO LENGTH OF mat at index 0  
        SET directions TO list of coordinate pairs: (0, 1), (1, 0), (1, 1), (1, -1)  
        SET max_length TO 0  
        
        FUNCTION check(x, y, dx, dy)  
            SET length TO 0  
            WHILE x IS GREATER THAN OR EQUAL TO 0 AND x IS LESS THAN m AND y IS GREATER THAN OR EQUAL TO 0 AND y IS LESS THAN n AND mat at position x, y IS EQUAL TO 1  
                INCREMENT length BY 1  
                INCREMENT x BY dx  
                INCREMENT y BY dy  
            RETURN length  
        END FUNCTION  
        
        FOR i FROM 0 TO m MINUS 1  
            FOR j FROM 0 TO n MINUS 1  
                IF mat at position i, j IS EQUAL TO 1  
                    FOR each direction pair dx, dy IN directions  
                        IF (i MINUS dx IS LESS THAN 0) OR (j MINUS dy IS LESS THAN 0) OR (j MINUS dy IS GREATER THAN OR EQUAL TO n) OR (mat at position i MINUS dx, j MINUS dy IS EQUAL TO 0)  
                            SET max_length TO GREATER OF max_length AND check(i, j, dx, dy)  
        RETURN max_length  
    END FUNCTION  
END CLASS