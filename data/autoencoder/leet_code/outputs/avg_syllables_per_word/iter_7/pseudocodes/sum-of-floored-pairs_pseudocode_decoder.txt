CLASS Solution  
    FUNCTION sumOfFlooredPairs(nums)  
        SET MOD TO 10 TO THE POWER OF 9 PLUS 7  
        SET max_num TO the maximum value in nums  
        SET count TO the frequency count of elements in nums  
        INITIALIZE prefix_sum AS list of zeros of length max_num PLUS 1  
        
        FOR each num IN count  
            INCREMENT prefix_sum AT index num BY count AT num  
        
        FOR i FROM 1 TO max_num  
            INCREMENT prefix_sum AT index i BY prefix_sum AT index i MINUS 1  
        
        SET result TO 0  
        
        FOR each num IN count  
            FOR multiple FROM 1 TO max_num DIVIDED BY num  
                SET start TO num MULTIPLIED BY multiple  
                SET end TO the smaller value between num MULTIPLIED BY (multiple PLUS 1) MINUS 1 AND max_num  
                SET multiples_count TO prefix_sum AT index end MINUS prefix_sum AT index start MINUS 1  
                INCREMENT result BY multiples_count MULTIPLIED BY multiple MULTIPLIED BY count AT num  
                SET result TO result MODULO MOD  
        
        RETURN result  
    END FUNCTION  
END CLASS