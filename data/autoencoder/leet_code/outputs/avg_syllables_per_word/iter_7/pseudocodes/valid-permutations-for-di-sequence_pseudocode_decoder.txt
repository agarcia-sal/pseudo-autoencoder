CLASS Solution  
    FUNCTION numPermsDISequence(s)  
        SET MOD TO ten raised to the power of nine plus seven  
        SET n TO LENGTH OF s  
        INITIALIZE dp AS two-dimensional list of zeros with dimensions (n plus one) by (n plus one)  
        
        FOR j FROM zero TO n DO  
            SET dp at row zero and column j TO one  
        
        FOR i FROM one TO n DO  
            SET prefix_sum TO zero  
            IF character at index i minus one in s IS equal to 'I' THEN  
                FOR j FROM zero TO n plus one minus i DO  
                    SET prefix_sum TO prefix_sum plus dp at row i minus one and column j MODULO MOD  
                    SET dp at row i and column j TO prefix_sum  
            ELSE  
                FOR j FROM n minus i DOWN TO zero DO  
                    SET prefix_sum TO prefix_sum plus dp at row i minus one and column j plus one MODULO MOD  
                    SET dp at row i and column j TO prefix_sum  
        
        RETURN sum of elements in dp at row n MODULO MOD  
    END FUNCTION  
END CLASS