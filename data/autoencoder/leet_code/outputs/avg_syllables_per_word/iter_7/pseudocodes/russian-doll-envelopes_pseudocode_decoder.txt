CLASS Solution  
    FUNCTION maxEnvelopes(envelopes)  
        SORT envelopes BY width IN ASCENDING ORDER AND BY height IN DESCENDING ORDER WHEN widths ARE EQUAL  
        SET dp TO empty list  
        FOR each (_, height) IN envelopes  
            SET idx TO POSITION FOUND BY binary search for height IN dp  
            IF idx IS EQUAL TO LENGTH OF dp THEN  
                APPEND height TO dp  
            ELSE  
                SET dp AT idx TO height  
        RETURN LENGTH OF dp  
    END FUNCTION  
END CLASS