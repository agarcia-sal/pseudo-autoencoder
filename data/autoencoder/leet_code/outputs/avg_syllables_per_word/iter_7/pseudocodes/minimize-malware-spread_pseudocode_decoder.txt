CLASS Solution  
    FUNCTION minMalwareSpread(graph, initial)  
        FUNCTION dfs(node, component)  
            IF node IS IN visited THEN  
                RETURN  
            END IF  
            ADD node TO visited  
            ADD node TO component  
            FOR neighbor FROM 0 TO LENGTH OF graph MINUS 1  
                IF graph AT node AND neighbor IS EQUAL TO 1 AND neighbor IS NOT IN visited THEN  
                    CALL dfs WITH neighbor AND component  
                END IF  
            END FOR  
        END FUNCTION  

        SET visited TO empty set  
        SET components TO empty list  
        FOR node FROM 0 TO LENGTH OF graph MINUS 1  
            IF node IS NOT IN visited THEN  
                SET component TO empty set  
                CALL dfs WITH node AND component  
                APPEND component TO components  
            END IF  
        END FOR  

        SET infected_count TO list OF ZEROS WITH LENGTH OF graph  
        FOR each node IN initial  
            SET infected_count AT node TO 1  
        END FOR  

        SET component_infected_count TO list OF ZEROS WITH LENGTH OF components  
        FOR each node IN initial  
            FOR i FROM 0 TO LENGTH OF components MINUS 1  
                IF node IS IN components AT i THEN  
                    INCREMENT component_infected_count AT i BY 1  
                END IF  
            END FOR  
        END FOR  

        SET max_saving TO 0  
        SET best_node TO MINIMUM VALUE IN initial  
        FOR each node IN initial  
            FOR i FROM 0 TO LENGTH OF components MINUS 1  
                IF node IS IN components AT i AND component_infected_count AT i IS EQUAL TO 1 THEN  
                    SET saving TO LENGTH OF components AT i  
                    IF saving GREATER THAN max_saving OR (saving IS EQUAL TO max_saving AND node IS LESS THAN best_node) THEN  
                        SET max_saving TO saving  
                        SET best_node TO node  
                    END IF  
                END IF  
            END FOR  
        END FOR  

        RETURN best_node  
    END FUNCTION  
END CLASS