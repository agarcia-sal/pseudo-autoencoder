CLASS Solution  
    FUNCTION maxEqualFreq(nums)  
        SET count TO new Counter  
        SET freq TO new Counter  
        SET max_len TO 0  
        
        FOR i AND num IN ENUMERATE nums  
            INCREMENT count at num BY 1  
            
            IF count at num GREATER THAN 1 THEN  
                DECREMENT freq at (count at num MINUS 1) BY 1  
                IF freq at (count at num MINUS 1) EQUAL TO 0 THEN  
                    REMOVE freq entry at (count at num MINUS 1)  
            
            INCREMENT freq at (count at num) BY 1  
            
            IF SIZE OF freq EQUAL TO 1 AND (freq CONTAINS key 1 OR THE ONLY VALUE IN freq EQUALS 1) THEN  
                SET max_len TO i PLUS 1  
            ELSE IF SIZE OF freq EQUAL TO 2 AND ((freq CONTAINS key 1 AND freq at 1 EQUALS 1) OR ((MAXIMUM KEY IN freq MINUS MINIMUM KEY IN freq) EQUALS 1 AND freq at MAXIMUM KEY IN freq EQUALS 1)) THEN  
                SET max_len TO i PLUS 1  
        
        RETURN max_len  
    END FUNCTION  
END CLASS