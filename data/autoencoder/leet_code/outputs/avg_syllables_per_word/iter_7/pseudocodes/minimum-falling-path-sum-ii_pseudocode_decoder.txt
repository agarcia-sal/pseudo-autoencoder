CLASS Solution  
    FUNCTION minFallingPathSum(grid)  
        IF grid IS EMPTY OR grid FIRST ROW IS EMPTY  
            RETURN 0  
        
        SET n TO LENGTH OF grid  
        
        IF n EQUALS 1  
            RETURN MINIMUM ELEMENT IN grid FIRST ROW  
        
        SET dp TO COPY OF grid FIRST ROW  
        
        FOR i FROM 1 TO n MINUS 1  
            SET new_dp TO LIST OF SIZE n FILLED WITH ZERO  
            SET min1 TO INFINITY  
            SET min2 TO INFINITY  
            SET min1_index TO -1  
            
            FOR j FROM 0 TO n MINUS 1  
                IF dp AT j IS LESS THAN min1  
                    SET min2 TO min1  
                    SET min1 TO dp AT j  
                    SET min1_index TO j  
                ELSE IF dp AT j IS LESS THAN min2  
                    SET min2 TO dp AT j  
            
            FOR j FROM 0 TO n MINUS 1  
                IF j EQUALS min1_index  
                    SET new_dp AT j TO grid AT i AND j PLUS min2  
                ELSE  
                    SET new_dp AT j TO grid AT i AND j PLUS min1  
            
            SET dp TO COPY OF new_dp  
        
        RETURN MINIMUM ELEMENT IN dp  
    END FUNCTION  
END CLASS