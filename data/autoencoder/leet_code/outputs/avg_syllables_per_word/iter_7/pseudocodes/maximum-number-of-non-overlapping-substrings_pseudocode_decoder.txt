CLASS Solution  
    FUNCTION maxNumOfSubstrings(s)  
        SET first TO empty dictionary  
        SET last TO empty dictionary  
        FOR each index i AND character c IN s  
            IF c NOT IN first  
                SET first[c] TO i  
            SET last[c] TO i  
        
        SET intervals TO empty list  
        FOR each character c IN first  
            SET start TO first[c]  
            SET end TO last[c]  
            SET i TO start  
            WHILE i LESS THAN OR EQUAL TO end  
                IF first[s[i]] LESS THAN start  
                    BREAK the loop  
                SET end TO the greater value BETWEEN end AND last[s[i]]  
                INCREMENT i BY 1  
            ELSE  
                APPEND the pair (start, end) TO intervals  
        
        SORT intervals BY their second element in ascending order  
        
        SET result TO empty list  
        SET prev_end TO negative one  
        FOR each pair (start, end) IN intervals  
            IF start GREATER THAN prev_end  
                APPEND the substring of s from start TO end inclusive TO result  
                SET prev_end TO end  
        
        RETURN result  
    END FUNCTION  
END CLASS