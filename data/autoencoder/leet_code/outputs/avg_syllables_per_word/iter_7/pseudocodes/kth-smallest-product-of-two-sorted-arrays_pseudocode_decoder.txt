CLASS Solution  
    FUNCTION kthSmallestProduct(nums1, nums2, k)  
        FUNCTION count(p)  
            SET cnt TO 0  
            SET n TO LENGTH OF nums2  
            FOR each x IN nums1  
                IF x GREATER THAN 0 THEN  
                    INCREMENT cnt BY POSITION TO INSERT p DIVIDED BY x ON RIGHT IN nums2  
                ELSE IF x LESS THAN 0 THEN  
                    INCREMENT cnt BY n MINUS POSITION TO INSERT p DIVIDED BY x ON LEFT IN nums2  
                ELSE  
                    INCREMENT cnt BY n TIMES (IF p GREATER THAN OR EQUAL TO 0 THEN 1 ELSE 0)  
            RETURN cnt  
        END FUNCTION  

        SET mx TO MAXIMUM OF ABSOLUTE VALUE OF FIRST ELEMENT OF nums1 AND LAST ELEMENT OF nums1  
        SET mx TO mx TIMES MAXIMUM OF ABSOLUTE VALUE OF FIRST ELEMENT OF nums2 AND LAST ELEMENT OF nums2  
        RETURN POSITION TO INSERT k ON LEFT IN RANGE FROM NEGATIVE mx TO mx PLUS 1 WITH KEY count MINUS mx  
    END FUNCTION  
END CLASS