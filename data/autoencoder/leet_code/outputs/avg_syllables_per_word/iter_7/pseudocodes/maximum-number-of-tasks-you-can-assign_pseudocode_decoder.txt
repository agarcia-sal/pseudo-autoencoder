CLASS Solution  
    FUNCTION maxTaskAssign(tasks, workers, pills, strength)  
        SORT tasks IN ASCENDING ORDER  
        SORT workers IN ASCENDING ORDER  
        
        FUNCTION canAssignTasks(k)  
            SET available_workers TO last k elements OF workers  
            SET pills_used TO 0  
            
            FOR i FROM k MINUS 1 DOWNTO 0  
                SET task TO tasks AT index i  
                SET worker_idx TO position OF smallest worker IN available_workers WHOSE value IS GREATER THAN OR EQUAL TO task  
                IF worker_idx IS WITHIN available_workers  
                    REMOVE worker AT worker_idx FROM available_workers  
                ELSE IF pills_used IS LESS THAN pills  
                    SET worker_idx TO position OF smallest worker IN available_workers WHOSE value IS GREATER THAN OR EQUAL TO task MINUS strength  
                    IF worker_idx IS WITHIN available_workers  
                        REMOVE worker AT worker_idx FROM available_workers  
                        INCREMENT pills_used BY 1  
                    ELSE  
                        RETURN False  
                ELSE  
                    RETURN False  
            RETURN True  
        END FUNCTION  
        
        SET left TO 0  
        SET right TO MINIMUM OF LENGTH OF tasks AND LENGTH OF workers PLUS 1  
        WHILE left IS LESS THAN right  
            SET mid TO left PLUS right DIVIDED BY 2 (INTEGER DIVISION)  
            IF canAssignTasks(mid) IS True  
                SET left TO mid PLUS 1  
            ELSE  
                SET right TO mid  
        RETURN left MINUS 1  
    END FUNCTION  
END CLASS