CLASS Trie  
    FUNCTION __init__()  
        SET children TO list of size 26 filled with None  
        SET ref TO -1  
    END FUNCTION  

    FUNCTION insert(w, ref)  
        SET node TO self  
        FOR each character c IN w  
            SET idx TO numerical position of c in alphabet (c MINUS 'a')  
            IF node.children at idx IS None  
                SET node.children at idx TO new Trie instance  
            SET node TO node.children at idx  
        SET node.ref TO ref  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION findWords(board, words)  
        FUNCTION dfs(node, i, j)  
            SET idx TO numerical position of board at i, j in alphabet (board[i][j] MINUS 'a')  
            IF node.children at idx IS None  
                RETURN  
            SET node TO node.children at idx  
            IF node.ref GREATER THAN OR EQUAL TO 0  
                APPEND words at node.ref TO ans  
                SET node.ref TO -1  
            SET c TO board at i, j  
            SET board at i, j TO '#'  
            FOR each pair (a, b) IN pairs of (-1, 0, 1, 0, -1)  
                SET x TO i PLUS a  
                SET y TO j PLUS b  
                IF x GREATER THAN OR EQUAL TO 0 AND x LESS THAN m AND y GREATER THAN OR EQUAL TO 0 AND y LESS THAN n AND board at x, y IS NOT '#'  
                    CALL dfs(node, x, y)  
            SET board at i, j TO c  
        END FUNCTION  

        SET tree TO new Trie instance  
        FOR each index i AND word w IN words  
            CALL tree.insert(w, i)  
        SET m TO length of board  
        SET n TO length of board at 0  
        SET ans TO empty list  
        FOR i FROM 0 TO m MINUS 1  
            FOR j FROM 0 TO n MINUS 1  
                CALL dfs(tree, i, j)  
        RETURN ans  
    END FUNCTION  
END CLASS