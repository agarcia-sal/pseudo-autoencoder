CLASS Solution  
    FUNCTION minTaps(n, ranges)  
        SET max_range TO list of zeros with length n PLUS 1  
        
        FOR i FROM 0 TO n INCLUSIVE  
            IF ranges AT i GREATER THAN 0  
                SET left TO greater of 0 AND i MINUS ranges AT i  
                SET right TO lesser of n AND i PLUS ranges AT i  
                SET max_range AT left TO greater of max_range AT left AND right  
        
        SET taps TO 0  
        SET current_end TO 0  
        SET farthest TO 0  
        
        FOR i FROM 0 TO n INCLUSIVE  
            IF i GREATER THAN farthest  
                RETURN negative 1  
            IF i GREATER THAN current_end  
                INCREMENT taps BY 1  
                SET current_end TO farthest  
            SET farthest TO greater of farthest AND max_range AT i  
        
        RETURN taps  
    END FUNCTION  
END CLASS