CLASS Solution  
    FUNCTION shortestPath(grid, k)  
        IF grid IS empty OR grid at index 0 IS empty  
            RETURN -1  
        END IF  
        
        SET m TO LENGTH OF grid  
        SET n TO LENGTH OF grid at index 0  
        
        IF k IS GREATER THAN OR EQUAL TO m PLUS n MINUS 2  
            RETURN m PLUS n MINUS 2  
        END IF  
        
        SET directions TO list of tuples (0, 1), (1, 0), (0, -1), (-1, 0)  
        
        SET queue TO a deque containing tuple (0, 0, k, 0)  
        
        SET visited TO a set containing tuple (0, 0, k)  
        
        WHILE queue IS NOT empty  
            SET (x, y, remaining_k, steps) TO dequeued element from queue  
            
            IF x IS EQUAL TO m MINUS 1 AND y IS EQUAL TO n MINUS 1  
                RETURN steps  
            END IF  
            
            FOR each (dx, dy) IN directions  
                SET nx TO x PLUS dx  
                SET ny TO y PLUS dy  
                
                IF nx IS GREATER THAN OR EQUAL TO 0 AND LESS THAN m AND ny IS GREATER THAN OR EQUAL TO 0 AND LESS THAN n  
                    SET new_k TO remaining_k MINUS grid at position (nx, ny)  
                    IF new_k IS GREATER THAN OR EQUAL TO 0 AND tuple (nx, ny, new_k) NOT IN visited  
                        ADD tuple (nx, ny, new_k) TO visited  
                        APPEND tuple (nx, ny, new_k, steps PLUS 1) TO queue  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN -1  
    END FUNCTION  
END CLASS