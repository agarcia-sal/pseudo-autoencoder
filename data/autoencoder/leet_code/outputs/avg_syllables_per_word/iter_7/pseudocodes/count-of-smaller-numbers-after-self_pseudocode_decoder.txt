CLASS Solution  
    FUNCTION countSmaller(nums)  
        SET sorted_nums TO sorted list of unique values from nums  
        SET rank TO dictionary mapping each value in sorted_nums TO its position index plus one  
        SET bit TO list of zeros with length equal to length of sorted_nums plus one  
        
        FUNCTION get_sum(idx)  
            SET res TO 0  
            WHILE idx GREATER THAN 0  
                INCREMENT res BY bit at position idx  
                DECREMENT idx BY idx AND negative idx  
            RETURN res  
        END FUNCTION  
        
        FUNCTION update(idx, delta)  
            WHILE idx LESS THAN length of bit  
                INCREMENT bit at position idx BY delta  
                INCREMENT idx BY idx AND negative idx  
        END FUNCTION  
        
        SET counts TO empty list  
        FOR each num IN nums iterated from end to start  
            SET r TO rank at num  
            APPEND get_sum(r MINUS 1) TO counts  
            CALL update(r, 1)  
        
        RETURN counts reversed  
    END FUNCTION  
END CLASS