CLASS Solution  
    FUNCTION magicalString(n)  
        IF n EQUALS 0  
            RETURN 0  
        IF n LESS THAN OR EQUAL TO 3  
            RETURN 1  
        
        SET s TO LIST CONTAINING 1, 2, 2  
        SET count TO 1  
        SET index TO 2  
        
        WHILE LENGTH OF s LESS THAN n  
            SET next_num TO 3 MINUS LAST ELEMENT OF s  
            EXTEND s BY APPENDING next_num REPEATED s[index] TIMES  
            IF next_num EQUALS 1  
                INCREMENT count BY s[index]  
            INCREMENT index BY 1  
        
        IF LENGTH OF s GREATER THAN n  
            DECREMENT count BY LAST ELEMENT OF s MULTIPLIED BY (LENGTH OF s MINUS n)  
        
        RETURN count  
    END FUNCTION  
END CLASS