CLASS Solution  
    FUNCTION pathsWithMaxScore(board)  
        SET MOD TO 10 TO THE POWER OF 9 PLUS 7  
        SET n TO LENGTH OF board  
        
        INITIALIZE dp AS n BY n ARRAY WITH EACH ELEMENT SET TO [NEGATIVE_INFINITY, 0]  
        
        SET dp AT POSITION [n MINUS 1][n MINUS 1] TO [0, 1]  
        
        FOR i FROM n MINUS 1 DOWNTO 0  
            FOR j FROM n MINUS 1 DOWNTO 0  
                IF board AT POSITION [i][j] EQUALS 'X' OR 'S' THEN  
                    CONTINUE TO NEXT ITERATION  
                
                IF board AT POSITION [i][j] EQUALS 'E' THEN  
                    SET value TO 0  
                ELSE  
                    SET value TO INTEGER CONVERSION OF board AT POSITION [i][j]  
                
                FOR EACH (x, y) IN [(1, 0), (0, 1), (1, 1)]  
                    SET ni TO i PLUS x  
                    SET nj TO j PLUS y  
                    IF ni IS GREATER THAN OR EQUAL TO 0 AND ni IS LESS THAN n AND nj IS GREATER THAN OR EQUAL TO 0 AND nj IS LESS THAN n THEN  
                        IF dp AT POSITION [ni][nj][0] GREATER THAN dp AT POSITION [i][j][0] THEN  
                            SET dp AT POSITION [i][j] TO [dp AT POSITION [ni][nj][0] PLUS value, dp AT POSITION [ni][nj][1]]  
                        ELSE IF dp AT POSITION [ni][nj][0] EQUALS dp AT POSITION [i][j][0] THEN  
                            SET dp AT POSITION [i][j][1] TO (dp AT POSITION [i][j][1] PLUS dp AT POSITION [ni][nj][1]) MODULO MOD  
        
        IF dp AT POSITION [0][0][0] EQUALS NEGATIVE_INFINITY THEN  
            RETURN [0, 0]  
        
        RETURN [dp AT POSITION [0][0][0], dp AT POSITION [0][0][1]]  
    END FUNCTION  
END CLASS