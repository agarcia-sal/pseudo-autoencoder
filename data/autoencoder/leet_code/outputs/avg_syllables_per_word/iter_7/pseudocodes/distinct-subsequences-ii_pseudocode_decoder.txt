CLASS Solution  
    FUNCTION distinctSubseqII(s)  
        SET MOD TO 10 POWER 9 PLUS 7  
        SET n TO LENGTH OF s  
        SET dp TO LIST OF SIZE n PLUS 1 FILLED WITH 0  
        SET dp AT 0 TO 1  
        SET last TO EMPTY MAP  
        
        FOR i FROM 1 TO n INCLUSIVE  
            SET char TO CHARACTER AT POSITION i MINUS 1 IN s  
            SET dp AT i TO (2 TIMES dp AT i MINUS 1) MODULO MOD  
            
            IF char EXISTS IN last  
                SET dp AT i TO (dp AT i MINUS dp AT (last AT char MINUS 1) PLUS MOD) MODULO MOD  
            END IF  
            
            SET last AT char TO i  
        END FOR  
        
        RETURN (dp AT n MINUS 1) MODULO MOD  
    END FUNCTION  
END CLASS