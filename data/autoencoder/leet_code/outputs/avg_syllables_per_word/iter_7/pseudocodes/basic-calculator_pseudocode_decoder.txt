CLASS Solution  
    FUNCTION calculate(s)  
        FUNCTION helper(s)  
            SET stack TO empty list  
            SET sign TO plus  
            SET num TO 0  
            
            WHILE LENGTH OF s GREATER THAN 0  
                SET char TO first element REMOVED FROM s  
                
                IF char IS a digit  
                    SET num TO num MULTIPLIED BY 10 PLUS numeric value of char  
                
                IF char IS open parenthesis  
                    SET num TO CALL helper WITH s  
                
                IF char IS NOT a digit AND char IS NOT whitespace OR LENGTH OF s EQUALS 0  
                    IF sign IS plus  
                        APPEND num TO stack  
                    ELSE IF sign IS minus  
                        APPEND NEGATION of num TO stack  
                    ELSE IF sign IS multiply  
                        SET last element in stack TO last element in stack MULTIPLIED BY num  
                    ELSE IF sign IS divide  
                        SET last element in stack TO integer division of last element in stack BY num  
                    
                    SET sign TO char  
                    SET num TO 0  
                
                IF char IS close parenthesis  
                    BREAK the loop  
            
            RETURN sum of elements in stack  
        
        RETURN CALL helper WITH list of characters from s  
    END FUNCTION  
END CLASS