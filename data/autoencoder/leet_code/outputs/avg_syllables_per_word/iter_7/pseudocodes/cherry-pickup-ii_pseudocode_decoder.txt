CLASS Solution  
    FUNCTION cherryPickup(grid)  
        SET rows TO LENGTH OF grid  
        SET cols TO LENGTH OF grid AT INDEX 0  
        
        FUNCTION dp(r, c1, c2) WITH CACHE  
            IF c1 LESS THAN 0 OR c1 GREATER THAN OR EQUAL TO cols OR c2 LESS THAN 0 OR c2 GREATER THAN OR EQUAL TO cols THEN  
                RETURN 0  
            END IF  
            
            IF c1 EQUALS c2 THEN  
                SET cherries TO grid AT ROW r AND COLUMN c1  
            ELSE  
                SET cherries TO grid AT ROW r AND COLUMN c1 PLUS grid AT ROW r AND COLUMN c2  
            END IF  
            
            IF r EQUALS rows MINUS 1 THEN  
                RETURN cherries  
            END IF  
            
            SET max_cherries TO 0  
            FOR EACH dc1 IN [-1, 0, 1]  
                FOR EACH dc2 IN [-1, 0, 1]  
                    SET current TO dp WITH PARAMETERS (r PLUS 1, c1 PLUS dc1, c2 PLUS dc2)  
                    IF current GREATER THAN max_cherries THEN  
                        SET max_cherries TO current  
                    END IF  
                END FOR  
            END FOR  
            
            RETURN cherries PLUS max_cherries  
        END FUNCTION  
        
        RETURN dp WITH PARAMETERS (0, 0, cols MINUS 1)  
    END FUNCTION  
END CLASS