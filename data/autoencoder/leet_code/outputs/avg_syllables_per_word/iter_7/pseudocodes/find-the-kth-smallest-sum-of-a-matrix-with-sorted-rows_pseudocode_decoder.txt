CLASS Solution  
    FUNCTION kthSmallest(mat, k)  
        SET m TO LENGTH OF mat  
        SET n TO LENGTH OF FIRST ELEMENT IN mat  
        SET initial_sum TO SUM OF FIRST ELEMENT IN EACH ROW OF mat  
        SET initial_indices TO TUPLE OF ZEROS WITH LENGTH m  
        SET min_heap TO LIST CONTAINING TUPLE OF initial_sum AND initial_indices  
        SET visited TO SET CONTAINING initial_indices  
        
        WHILE k GREATER THAN 0  
            SET current_sum, indices TO EXTRACT MINIMUM ELEMENT FROM min_heap  
            DECREMENT k BY 1  
            
            IF k EQUALS 0  
                RETURN current_sum  
            
            FOR i FROM 0 TO m MINUS 1  
                IF indices AT i PLUS 1 LESS THAN n  
                    SET new_indices TO COPY OF indices AS LIST  
                    INCREMENT new_indices AT i BY 1  
                    SET new_indices_tuple TO TUPLE OF new_indices  
                    SET new_sum TO current_sum MINUS mat AT i AND indices AT i PLUS mat AT i AND new_indices AT i  
                    
                    IF new_indices_tuple NOT IN visited  
                        ADD new_indices_tuple TO visited  
                        ADD TUPLE OF new_sum AND new_indices_tuple TO min_heap  
        
        RETURN NEGATIVE 1  
    END FUNCTION  
END CLASS