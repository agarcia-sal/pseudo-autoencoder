CLASS Solution  
    FUNCTION validIPAddress(queryIP)  
        FUNCTION is_valid_ipv4_block(block)  
            IF block consists only of digits THEN  
                SET num TO numeric value of block  
                RETURN num LESS THAN OR EQUAL TO 255 AND string form of num EQUALS block  
            ELSE  
                RETURN False  
        END FUNCTION  

        FUNCTION is_valid_ipv6_block(block)  
            IF length of block GREATER THAN OR EQUAL TO 1 AND LESS THAN OR EQUAL TO 4 THEN  
                TRY  
                    CONVERT block TO integer in base sixteen  
                    RETURN True  
                CATCH conversion error  
                    RETURN False  
            ELSE  
                RETURN False  
        END FUNCTION  

        SET parts_ipv4 TO list of substrings of queryIP separated by '.'  
        SET parts_ipv6 TO list of substrings of queryIP separated by ':'  

        IF number of elements in parts_ipv4 EQUALS 4 AND all is_valid_ipv4_block(part) FOR each part IN parts_ipv4 THEN  
            RETURN "IPv4"  
        ELSE IF number of elements in parts_ipv6 EQUALS 8 AND all is_valid_ipv6_block(part) FOR each part IN parts_ipv6 THEN  
            RETURN "IPv6"  
        ELSE  
            RETURN "Neither"  
    END FUNCTION  
END CLASS