CLASS Solution  
    FUNCTION maxProfit(k, prices)  
        IF prices IS EMPTY OR k EQUALS 0  
            RETURN 0  
        END IF  
        
        SET n TO LENGTH OF prices  
        
        IF k GREATER THAN OR EQUAL TO n DIVIDED BY 2  
            SET profit TO 0  
            FOR i FROM 1 TO n MINUS 1  
                IF prices AT i GREATER THAN prices AT i MINUS 1  
                    INCREMENT profit BY prices AT i MINUS prices AT i MINUS 1  
                END IF  
            END FOR  
            RETURN profit  
        END IF  
        
        INITIALIZE hold AS LIST WITH k PLUS 1 TIMES NEGATIVE_INFINITY  
        INITIALIZE release AS LIST WITH k PLUS 1 TIMES 0  
        
        FOR each price IN prices  
            FOR i FROM 1 TO k  
                SET hold AT i TO MAXIMUM OF hold AT i AND release AT i MINUS 1 MINUS price  
                SET release AT i TO MAXIMUM OF release AT i AND hold AT i PLUS price  
            END FOR  
        END FOR  
        
        RETURN release AT k  
    END FUNCTION  
END CLASS