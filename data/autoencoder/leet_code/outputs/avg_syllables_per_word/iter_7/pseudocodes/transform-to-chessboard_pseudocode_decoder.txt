CLASS Solution  
    FUNCTION movesToChessboard(board)  
        SET N TO LENGTH OF board  
        SET rowSum TO 0  
        SET colSum TO 0  
        SET rowSwap TO 0  
        SET colSwap TO 0  

        FOR i FROM 0 TO N MINUS 1  
            FOR j FROM 0 TO N MINUS 1  
                IF board AT i AT j XOR board AT i AT 0 XOR board AT 0 AT j XOR board AT 0 AT 0 IS TRUE  
                    RETURN MINUS 1  
            END FOR  
            
            SET rowSum TO rowSum PLUS board AT i AT 0  
            SET colSum TO colSum PLUS board AT 0 AT i  
            IF board AT i AT 0 EQUALS i MODULO 2  
                INCREMENT rowSwap BY 1  
            END IF  
            IF board AT 0 AT i EQUALS i MODULO 2  
                INCREMENT colSwap BY 1  
            END IF  
        END FOR  

        IF N DIVIDED BY 2 GREATER THAN rowSum OR rowSum GREATER THAN (N PLUS 1) DIVIDED BY 2  
            RETURN MINUS 1  
        END IF  

        IF N DIVIDED BY 2 GREATER THAN colSum OR colSum GREATER THAN (N PLUS 1) DIVIDED BY 2  
            RETURN MINUS 1  
        END IF  

        IF N MODULO 2 IS 1  
            IF rowSwap MODULO 2 IS 1  
                SET rowSwap TO N MINUS rowSwap  
            END IF  
            IF colSwap MODULO 2 IS 1  
                SET colSwap TO N MINUS colSwap  
            END IF  
        ELSE  
            SET rowSwap TO MINIMUM OF rowSwap AND (N MINUS rowSwap)  
            SET colSwap TO MINIMUM OF colSwap AND (N MINUS colSwap)  
        END IF  

        RETURN (rowSwap PLUS colSwap) DIVIDED BY 2  
    END FUNCTION  
END CLASS