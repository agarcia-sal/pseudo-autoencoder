CLASS Solution  
    FUNCTION candyCrush(board)  
        SET R TO LENGTH OF board  
        SET C TO LENGTH OF board AT INDEX 0  
        SET stable TO False  
        
        WHILE stable IS NOT True  
            SET stable TO True  
            DEFINE to_crush AS EMPTY SET  
            
            FOR r FROM 0 TO R MINUS 1  
                FOR c FROM 0 TO C MINUS 3  
                    IF ABSOLUTE VALUE OF board AT r AND c EQUALS ABSOLUTE VALUE OF board AT r AND c PLUS 1 AND EQUALS ABSOLUTE VALUE OF board AT r AND c PLUS 2 AND DIFFERENT FROM 0  
                        SET stable TO False  
                        ADD (r, c) TO to_crush  
                        ADD (r, c PLUS 1) TO to_crush  
                        ADD (r, c PLUS 2) TO to_crush  
            
            FOR r FROM 0 TO R MINUS 3  
                FOR c FROM 0 TO C MINUS 1  
                    IF ABSOLUTE VALUE OF board AT r AND c EQUALS ABSOLUTE VALUE OF board AT r PLUS 1 AND c AND EQUALS ABSOLUTE VALUE OF board AT r PLUS 2 AND c AND DIFFERENT FROM 0  
                        SET stable TO False  
                        ADD (r, c) TO to_crush  
                        ADD (r PLUS 1, c) TO to_crush  
                        ADD (r PLUS 2, c) TO to_crush  
            
            FOR EACH (r, c) IN to_crush  
                SET board AT r AND c TO 0  
            
            FOR c FROM 0 TO C MINUS 1  
                SET wr TO R MINUS 1  
                FOR r FROM R MINUS 1 DOWN TO 0 STEP MINUS 1  
                    IF board AT r AND c IS NOT 0  
                        SET board AT wr AND c TO board AT r AND c  
                        DECREMENT wr BY 1  
                FOR wr FROM wr DOWN TO 0 STEP MINUS 1  
                    SET board AT wr AND c TO 0  
        
        RETURN board  
    END FUNCTION  
END CLASS