CLASS Solution  
    FUNCTION countSubranges(nums1, nums2)  
        SET n TO LENGTH OF nums1  
        SET count TO 0  
        SET dp TO LIST OF DICTIONARIES WITH DEFAULT VALUE 0 OF SIZE n  
        
        FOR i FROM 0 TO n MINUS 1  
            INCREMENT dp[i] AT KEY nums1 AT i BY 1  
            INCREMENT dp[i] AT KEY NEGATIVE nums2 AT i BY 1  
            
            IF i GREATER THAN 0 THEN  
                FOR EACH balance, freq IN dp AT i MINUS 1  
                    SET dp[i] AT KEY balance PLUS nums1 AT i TO VALUE dp[i] AT KEY balance PLUS nums1 AT i PLUS freq MODULO MOD  
                    SET dp[i] AT KEY balance MINUS nums2 AT i TO VALUE dp[i] AT KEY balance MINUS nums2 AT i PLUS freq MODULO MOD  
            
            SET count TO VALUE count PLUS dp[i] AT KEY 0 MODULO MOD  
        
        RETURN count  
    END FUNCTION  
END CLASS