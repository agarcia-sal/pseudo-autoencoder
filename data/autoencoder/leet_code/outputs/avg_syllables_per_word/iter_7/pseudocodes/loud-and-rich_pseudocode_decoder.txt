CLASS Solution  
    FUNCTION loudAndRich(richer, quiet)  
        SET graph TO new mapping with default empty list  
        FOR each pair a, b IN richer  
            APPEND a TO graph at key b  
        SET n TO LENGTH OF quiet  
        SET answer TO list of size n filled with -1  
        
        FUNCTION dfs(person)  
            IF answer at person EQUALS -1 THEN  
                SET answer at person TO person  
                FOR each neighbor IN graph at person  
                    SET candidate TO dfs(neighbor)  
                    IF quiet at candidate LESS THAN quiet at answer at person THEN  
                        SET answer at person TO candidate  
            RETURN answer at person  
        END FUNCTION  
        
        FOR i FROM 0 TO n MINUS 1  
            CALL dfs(i)  
        
        RETURN answer  
    END FUNCTION  
END CLASS