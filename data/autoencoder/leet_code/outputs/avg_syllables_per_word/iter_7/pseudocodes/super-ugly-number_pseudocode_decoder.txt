CLASS Solution  
    FUNCTION nthSuperUglyNumber(n, primes)  
        SET ugly_numbers TO list containing 1  
        SET heap TO list of pairs (prime, index) for each prime in primes with its index  
        CONVERT heap into a min-heap  
        SET indices TO list of zeros with length equal to number of primes  
        
        WHILE length of ugly_numbers LESS THAN n  
            REMOVE smallest pair from heap and SET TO next_ugly and prime_index  
            
            IF next_ugly IS NOT EQUAL TO last element in ugly_numbers  
                APPEND next_ugly TO ugly_numbers  
            END IF  
            
            INCREMENT indices at prime_index BY 1  
            SET next_multiple TO prime at prime_index MULTIPLIED BY ugly_numbers at indices[prime_index]  
            ADD pair (next_multiple, prime_index) TO heap  
        END WHILE  
        
        RETURN last element in ugly_numbers  
    END FUNCTION  
END CLASS