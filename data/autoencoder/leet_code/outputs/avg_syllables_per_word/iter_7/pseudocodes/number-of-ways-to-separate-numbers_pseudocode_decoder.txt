CLASS Solution  
    FUNCTION numberOfCombinations(num)  
        SET MOD TO 10 RAISED TO THE POWER 9 PLUS 7  
        SET n TO LENGTH OF num  
        SET memo TO EMPTY DICTIONARY  
        
        FUNCTION dp(index, prev_len)  
            IF index EQUALS n THEN  
                RETURN 1  
            IF KEY (index, prev_len) EXISTS IN memo THEN  
                RETURN memo VALUE AT KEY (index, prev_len)  
            
            SET count TO 0  
            FOR length FROM 1 TO n MINUS index INCLUSIVE DO  
                IF CHARACTER AT POSITION index IN num EQUALS '0' THEN  
                    BREAK LOOP  
                
                SET current_num TO SUBSTRING OF num FROM index TO index PLUS length  
                
                IF prev_len EQUALS 0 OR current_num IS GREATER THAN OR EQUAL TO SUBSTRING OF num FROM index MINUS prev_len TO index THEN  
                    SET count TO (count PLUS dp CALLED WITH (index PLUS length, length)) MODULO MOD  
            
            SET memo VALUE AT KEY (index, prev_len) TO count  
            RETURN count  
        
        RETURN dp CALLED WITH (0, 0)  
    END FUNCTION  
END CLASS