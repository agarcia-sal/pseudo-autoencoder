CLASS Solution  
    FUNCTION minCost(grid)  
        SET m TO LENGTH OF grid  
        SET n TO LENGTH OF FIRST ELEMENT OF grid  
        SET directions TO LIST OF (0, 1), (0, -1), (1, 0), (-1, 0)  
        SET costs TO 2D LIST OF INFINITY VALUES WITH DIMENSIONS m BY n  
        SET costs AT 0, 0 TO 0  
        
        SET pq TO LIST CONTAINING TUPLE (0, 0, 0)  
        SET visited TO EMPTY SET  
        
        WHILE pq IS NOT EMPTY  
            SET cost, i, j TO REMOVE SMALLEST ELEMENT FROM pq  
            
            IF (i, j) IS IN visited  
                CONTINUE TO NEXT ITERATION  
            ADD (i, j) TO visited  
            
            IF i EQUALS m MINUS 1 AND j EQUALS n MINUS 1  
                RETURN cost  
            
            FOR EACH k, (di, dj) IN ENUMERATE directions  
                SET ni TO i PLUS di  
                SET nj TO j PLUS dj  
                IF ni IS GREATER THAN OR EQUAL TO 0 AND LESS THAN m AND nj IS GREATER THAN OR EQUAL TO 0 AND LESS THAN n  
                    IF k PLUS 1 IS NOT EQUAL TO grid AT i, j  
                        SET new_cost TO cost PLUS 1  
                    ELSE  
                        SET new_cost TO cost  
                    IF new_cost IS LESS THAN costs AT ni, nj  
                        SET costs AT ni, nj TO new_cost  
                        ADD (new_cost, ni, nj) TO pq  
        
        RETURN MINUS 1  
    END FUNCTION  
END CLASS