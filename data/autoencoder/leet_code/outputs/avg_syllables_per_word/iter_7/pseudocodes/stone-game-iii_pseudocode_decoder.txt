CLASS Solution  
    FUNCTION stoneGameIII(stoneValue)  
        SET n TO LENGTH OF stoneValue  
        SET dp TO list of zeros WITH LENGTH n PLUS 1  
        
        FOR i FROM n MINUS 1 DOWNTO 0  
            SET dp[i] TO stoneValue[i] MINUS dp[i PLUS 1]  
            IF i PLUS 2 LESS THAN OR EQUAL TO n THEN  
                SET dp[i] TO MAXIMUM OF dp[i] AND stoneValue[i] PLUS stoneValue[i PLUS 1] MINUS dp[i PLUS 2]  
            IF i PLUS 3 LESS THAN OR EQUAL TO n THEN  
                SET dp[i] TO MAXIMUM OF dp[i] AND stoneValue[i] PLUS stoneValue[i PLUS 1] PLUS stoneValue[i PLUS 2] MINUS dp[i PLUS 3]  
        
        IF dp[0] GREATER THAN 0 THEN  
            RETURN "Alice"  
        ELSE IF dp[0] LESS THAN 0 THEN  
            RETURN "Bob"  
        ELSE  
            RETURN "Tie"  
    END FUNCTION  
END CLASS