CLASS Solution  
    FUNCTION numSimilarGroups(strs)  
        FUNCTION are_similar(s1, s2)  
            SET diff TO list of positions where characters in s1 and s2 differ  
            RETURN true IF length of diff EQUALS 0 OR (length of diff EQUALS 2 AND characters at diff positions cross-match)  
            OTHERWISE RETURN false  
        END FUNCTION  

        FUNCTION dfs(node, visited)  
            ADD node TO visited  
            FOR each neighbor IN graph at node  
                IF neighbor NOT IN visited  
                    CALL dfs(neighbor, visited)  
        END FUNCTION  

        SET n TO length of strs  
        SET graph TO a mapping from each index in range n TO empty list  

        FOR i FROM 0 TO n MINUS 1  
            FOR j FROM i PLUS 1 TO n MINUS 1  
                IF are_similar(strs at i, strs at j) IS true  
                    APPEND j TO graph at i  
                    APPEND i TO graph at j  

        SET visited TO empty set  
        SET num_groups TO 0  

        FOR i FROM 0 TO n MINUS 1  
            IF i NOT IN visited  
                CALL dfs(i, visited)  
                INCREMENT num_groups BY 1  

        RETURN num_groups  
    END FUNCTION  
END CLASS