CLASS Solution  
    FUNCTION solve(nums, queries)  
        SET MOD TO 10 raised to the power of 9 plus 7  
        SET n TO LENGTH OF nums  
        
        SET max_y TO the maximum y value extracted from each query in queries  
        SET prefix_sums TO a list containing max_y plus 1 lists, each of length n, initialized to zero  
        
        FOR y FROM 1 TO max_y INCLUSIVE  
            FOR i FROM n minus 1 DOWN TO 0  
                IF i plus y LESS THAN n THEN  
                    SET prefix_sums at index y and i TO nums at i PLUS prefix_sums at y and i plus y  
                ELSE  
                    SET prefix_sums at index y and i TO nums at i  
        
        SET answer TO an empty list  
        FOR each pair (x, y) IN queries  
            APPEND prefix_sums at y and x MODULO MOD TO answer  
        
        RETURN answer  
    END FUNCTION  
END CLASS