CLASS Solution  
    FUNCTION subStrHash(s, power, modulo, k, hashValue)  
        FUNCTION val(c)  
            RETURN numerical position of character c starting from 1 for 'a'  
        END FUNCTION  
        
        SET n TO length of s  
        SET current_hash TO 0  
        SET p_pow TO 1  
        
        FOR i FROM n MINUS k TO n MINUS 1  
            SET current_hash TO remainder of current_hash plus val(s at i) multiplied by p_pow divided by modulo  
            IF i LESS THAN n MINUS 1 THEN  
                SET p_pow TO remainder of p_pow multiplied by power divided by modulo  
            END IF  
        END FOR  
        
        SET start_index TO n MINUS k  
        IF current_hash EQUALS hashValue THEN  
            RETURN substring of s from start_index to end  
        END IF  
        
        SET p_pow_k_minus_1 TO p_pow  
        FOR i FROM n MINUS k MINUS 1 DOWN TO 0 STEP MINUS 1  
            SET current_hash TO remainder of current_hash minus val(s at i plus k) multiplied by p_pow_k_minus_1 divided by modulo  
            SET current_hash TO remainder of current_hash multiplied by power plus val(s at i) divided by modulo  
            
            IF current_hash EQUALS hashValue THEN  
                SET start_index TO i  
            END IF  
        END FOR  
        
        RETURN substring of s from start_index to start_index plus k  
    END FUNCTION  
END CLASS