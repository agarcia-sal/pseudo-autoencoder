CLASS Solution  
    FUNCTION minFallingPathSum(grid)  
        IF grid IS EMPTY OR grid AT INDEX 0 IS EMPTY THEN  
            RETURN 0  
        SET n TO LENGTH OF grid  
        IF n EQUALS 1 THEN  
            RETURN MINIMUM VALUE IN grid AT INDEX 0  
        SET dp TO COPY OF grid AT INDEX 0  
        FOR i FROM 1 TO n MINUS 1  
            SET new_dp TO LIST OF ZEROES OF LENGTH n  
            SET min1 TO INFINITY  
            SET min2 TO INFINITY  
            SET min1_index TO NEGATIVE ONE  
            FOR j FROM 0 TO n MINUS 1  
                IF dp AT INDEX j LESS THAN min1 THEN  
                    SET min2 TO min1  
                    SET min1 TO dp AT INDEX j  
                    SET min1_index TO j  
                ELSE IF dp AT INDEX j LESS THAN min2 THEN  
                    SET min2 TO dp AT INDEX j  
            FOR j FROM 0 TO n MINUS 1  
                IF j EQUALS min1_index THEN  
                    SET new_dp AT INDEX j TO grid AT INDEX i AT INDEX j PLUS min2  
                ELSE  
                    SET new_dp AT INDEX j TO grid AT INDEX i AT INDEX j PLUS min1  
            SET dp TO COPY OF new_dp  
        RETURN MINIMUM VALUE IN dp  
    END FUNCTION  
END CLASS