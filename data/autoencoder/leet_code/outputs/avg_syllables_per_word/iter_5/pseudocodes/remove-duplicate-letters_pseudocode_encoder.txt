CLASS Solution  
    FUNCTION removeDuplicateLetters(s)  
        SET last_occurrence TO mapping of each character in s to its last index  
        SET stack TO empty list  
        SET in_stack TO empty set  
        
        FOR each index idx and character char IN s  
            IF char IS IN in_stack  
                CONTINUE to next iteration  
            
            WHILE stack IS NOT empty AND char IS LESS THAN last element in stack AND idx IS LESS THAN last_occurrence of last element in stack  
                SET removed_char TO last element removed from stack  
                REMOVE removed_char FROM in_stack  
            
            APPEND char TO stack  
            ADD char TO in_stack  
        
        SET result TO concatenation of characters in stack  
        RETURN result  
    END FUNCTION  
END CLASS