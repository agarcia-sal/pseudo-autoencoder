CLASS Solution  
    FUNCTION profitableSchemes(n, minProfit, group, profit)  
        SET MOD TO 10 raised to the power of 9 plus 7  
        INITIALIZE dp AS a two-dimensional list with (n plus 1) rows and (minProfit plus 1) columns filled with 0  
        FOR i FROM 0 TO n  
            SET dp at position i and 0 TO 1  
        END FOR  
        
        FOR each pair (p, g) IN profit and group together  
            FOR i FROM n DOWN TO g  
                FOR j FROM minProfit DOWN TO 0  
                    SET dp at position i and j TO dp at position i and j plus dp at position (i minus g) and maximum of 0 and (j minus p)  
                    APPLY modulo MOD TO dp at position i and j  
                END FOR  
            END FOR  
        END FOR  
        
        RETURN dp at position n and minProfit  
    END FUNCTION  
END CLASS