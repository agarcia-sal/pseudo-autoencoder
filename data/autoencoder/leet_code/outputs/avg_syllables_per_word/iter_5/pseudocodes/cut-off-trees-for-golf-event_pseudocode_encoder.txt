CLASS Solution  
    FUNCTION cutOffTree(forest)  
        IF forest IS EMPTY OR forest AT 0 IS EMPTY  
            RETURN -1  
        
        SET trees TO EMPTY LIST  
        FOR each i FROM 0 TO LENGTH OF forest MINUS 1  
            FOR each j FROM 0 TO LENGTH OF forest AT 0 MINUS 1  
                IF forest AT i AT j IS GREATER THAN 1  
                    APPEND (forest AT i AT j, i, j) TO trees  
        SORT trees BY HEIGHT  
        
        FUNCTION bfs(start, end)  
            IF start EQUALS end  
                RETURN 0  
            SET m TO LENGTH OF forest  
            SET n TO LENGTH OF forest AT 0  
            INITIALIZE queue WITH start  
            INITIALIZE visited WITH start  
            SET steps TO 0  
            
            WHILE queue IS NOT EMPTY  
                FOR count FROM 1 TO LENGTH OF queue  
                    SET x, y TO REMOVE FIRST ELEMENT OF queue  
                    FOR each (dx, dy) IN [(-1, 0), (1, 0), (0, -1), (0, 1)]  
                        SET nx TO x PLUS dx  
                        SET ny TO y PLUS dy  
                        IF nx IS GREATER THAN OR EQUAL TO 0 AND nx IS LESS THAN m AND ny IS GREATER THAN OR EQUAL TO 0 AND ny IS LESS THAN n AND (nx, ny) NOT IN visited AND forest AT nx AT ny IS NOT 0  
                            IF (nx, ny) EQUALS end  
                                RETURN steps PLUS 1  
                            ADD (nx, ny) TO visited  
                            APPEND (nx, ny) TO queue  
                INCREMENT steps BY 1  
            
            RETURN -1  
        
        SET x TO 0  
        SET y TO 0  
        SET total_steps TO 0  
        
        FOR each (height, tx, ty) IN trees  
            SET steps TO bfs((x, y), (tx, ty))  
            IF steps EQUALS -1  
                RETURN -1  
            INCREMENT total_steps BY steps  
            SET x TO tx  
            SET y TO ty  
        
        RETURN total_steps  
    END FUNCTION  
END CLASS