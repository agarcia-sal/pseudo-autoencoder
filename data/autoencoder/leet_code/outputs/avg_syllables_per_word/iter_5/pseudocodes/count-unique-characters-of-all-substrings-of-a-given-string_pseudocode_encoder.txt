CLASS Solution  
    FUNCTION uniqueLetterString(s)  
        SET MOD TO 10 raised TO 9 plus 7  
        SET n TO LENGTH OF s  
        SET last TO list of size 26 FILLED WITH -1  
        SET last2 TO list of size 26 FILLED WITH -1  
        SET result TO 0  
        
        FOR i FROM 0 TO n MINUS 1  
            SET char TO s AT position i  
            SET idx TO numeric position of char MINUS numeric position of 'A'  
            
            SET result TO result PLUS (i MINUS last AT idx) TIMES (last AT idx MINUS last2 AT idx) MODULO MOD  
            
            SET last2 AT idx TO last AT idx  
            SET last AT idx TO i  
        
        FOR i FROM 0 TO 25  
            SET result TO result PLUS (n MINUS last AT i) TIMES (last AT i MINUS last2 AT i) MODULO MOD  
        
        RETURN result  
    END FUNCTION  
END CLASS