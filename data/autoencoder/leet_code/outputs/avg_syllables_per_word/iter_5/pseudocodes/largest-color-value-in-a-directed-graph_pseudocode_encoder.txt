CLASS Solution  
    FUNCTION largestPathValue(colors, edges)  
        SET n TO LENGTH OF colors  
        SET graph TO a mapping from integers to list of integers with default empty list  
        SET in_degree TO list of zeros with length n  
        
        FOR each pair (u, v) IN edges  
            APPEND v TO graph AT key u  
            INCREMENT in_degree AT index v BY 1  
        
        SET queue TO list of all indices i FROM 0 TO n MINUS 1 WHERE in_degree AT i EQUALS 0  
        SET dp TO list of n lists each containing 26 zeros  
        SET visited TO 0  
        SET max_color_value TO 0  
        
        WHILE queue IS NOT empty  
            REMOVE first element FROM queue AND SET TO node  
            INCREMENT dp AT node AND index (ASCII value of colors AT node MINUS ASCII value of 'a') BY 1  
            IF dp AT node AND index (ASCII value of colors AT node MINUS ASCII value of 'a') GREATER THAN max_color_value  
                SET max_color_value TO dp AT node AND index (ASCII value of colors AT node MINUS ASCII value of 'a')  
            INCREMENT visited BY 1  
            
            FOR each neighbor IN graph AT node  
                FOR c FROM 0 TO 25  
                    SET dp AT neighbor AND c TO maximum BETWEEN dp AT neighbor AND c AND dp AT node AND c  
                DECREMENT in_degree AT neighbor BY 1  
                IF in_degree AT neighbor EQUALS 0  
                    APPEND neighbor TO queue  
        
        IF visited EQUALS n  
            RETURN max_color_value  
        ELSE  
            RETURN negative 1  
    END FUNCTION  
END CLASS