CLASS Solution  
    FUNCTION lengthOfLongestSubstringTwoDistinct(s)  
        SET char_count TO a dictionary with default integer values  
        SET left TO 0  
        SET max_length TO 0  

        FOR right FROM 0 TO LENGTH OF s MINUS 1  
            INCREMENT value of char_count AT s[right] BY 1  

            WHILE NUMBER OF KEYS IN char_count GREATER THAN 2  
                DECREMENT value of char_count AT s[left] BY 1  
                IF value of char_count AT s[left] EQUALS 0  
                    REMOVE s[left] FROM char_count  
                INCREMENT left BY 1  

            SET max_length TO the greater value BETWEEN max_length AND (right MINUS left PLUS 1)  

        RETURN max_length  
    END FUNCTION  
END CLASS