CLASS Solution  
    FUNCTION stoneGameIII(stoneValue)  
        SET n TO LENGTH OF stoneValue  
        INITIALIZE dp AS LIST OF ZEROS WITH SIZE n PLUS 1  
        
        FOR i FROM n MINUS 1 DOWN TO 0  
            SET dp[i] TO stoneValue AT i MINUS dp AT i PLUS 1  
            IF i PLUS 2 IS LESS THAN OR EQUAL TO n  
                SET dp[i] TO MAXIMUM OF dp AT i AND stoneValue AT i PLUS stoneValue AT i PLUS 1 MINUS dp AT i PLUS 2  
            IF i PLUS 3 IS LESS THAN OR EQUAL TO n  
                SET dp[i] TO MAXIMUM OF dp AT i AND stoneValue AT i PLUS stoneValue AT i PLUS 1 PLUS stoneValue AT i PLUS 2 MINUS dp AT i PLUS 3  
        
        IF dp AT 0 IS GREATER THAN 0  
            RETURN "Alice"  
        ELSE IF dp AT 0 IS LESS THAN 0  
            RETURN "Bob"  
        ELSE  
            RETURN "Tie"  
    END FUNCTION  
END CLASS