CLASS Solution  
    FUNCTION countSubranges(nums1, nums2)  
        SET n TO LENGTH OF nums1  
        SET count TO 0  
        SET dp TO LIST OF DICTIONARIES WITH DEFAULT INTEGER VALUE, ONE FOR EACH INDEX FROM 0 TO n MINUS 1  
        
        FOR i FROM 0 TO n MINUS 1  
            INCREMENT dp AT i WITH KEY nums1 AT i BY 1  
            INCREMENT dp AT i WITH KEY NEGATIVE nums2 AT i BY 1  
            
            IF i GREATER THAN 0 THEN  
                FOR EACH balance, freq IN ITEMS OF dp AT i MINUS 1  
                    SET dp AT i WITH KEY balance PLUS nums1 AT i TO dp AT i WITH KEY balance PLUS nums1 AT i PLUS freq MODULO MOD  
                    SET dp AT i WITH KEY balance MINUS nums2 AT i TO dp AT i WITH KEY balance MINUS nums2 AT i PLUS freq MODULO MOD  
                END FOR  
            END IF  
            
            SET count TO count PLUS dp AT i WITH KEY 0 MODULO MOD  
        END FOR  
        
        RETURN count  
    END FUNCTION  
END CLASS