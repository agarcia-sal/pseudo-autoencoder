CLASS Solution  
    FUNCTION validArrangement(pairs)  
        CREATE graph AS mapping from integer TO list of integers  
        CREATE out_degree AS mapping from integer TO integer  
        CREATE in_degree AS mapping from integer TO integer  
        
        FOR each pair (u, v) IN pairs  
            APPEND v TO graph at key u  
            INCREMENT out_degree at key u BY 1  
            INCREMENT in_degree at key v BY 1  
        
        SET start_node TO null  
        FOR each node IN graph keys  
            IF out_degree at node EQUALS in_degree at node PLUS 1  
                SET start_node TO node  
                BREAK out of loop  
        IF start_node IS null  
            SET start_node TO first key in graph  
        
        CREATE empty list path  
        CREATE stack WITH start_node  
        
        WHILE stack is not empty  
            SET u TO last element in stack  
            IF graph at u IS NOT empty  
                SET v TO last element removed from graph at u  
                APPEND v TO stack  
            ELSE  
                APPEND last element removed from stack TO path  
        
        REVERSE path  
        
        CREATE empty list result  
        FOR i FROM 0 TO length of path MINUS 2  
            APPEND list containing path at i AND path at i plus 1 TO result  
        
        RETURN result  
    END FUNCTION  
END CLASS