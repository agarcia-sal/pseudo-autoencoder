CLASS Solution  
    FUNCTION minCostII(costs)  
        IF costs IS EMPTY THEN  
            RETURN 0  
        END IF  
        
        SET n TO LENGTH OF costs  
        SET k TO LENGTH OF costs AT INDEX 0  
        
        IF k EQUALS 1 THEN  
            IF n EQUALS 1 THEN  
                RETURN costs AT INDEX 0 AT INDEX 0  
            ELSE  
                RETURN infinity  
            END IF  
        END IF  
        
        FOR i FROM 1 TO n MINUS 1 DO  
            SET min_cost TO infinity  
            SET min_cost_index TO -1  
            SET second_min_cost TO infinity  
            
            FOR j FROM 0 TO k MINUS 1 DO  
                IF costs AT INDEX i MINUS 1 AT INDEX j LESS THAN min_cost THEN  
                    SET second_min_cost TO min_cost  
                    SET min_cost TO costs AT INDEX i MINUS 1 AT INDEX j  
                    SET min_cost_index TO j  
                ELSE IF costs AT INDEX i MINUS 1 AT INDEX j LESS THAN second_min_cost THEN  
                    SET second_min_cost TO costs AT INDEX i MINUS 1 AT INDEX j  
                END IF  
            END FOR  
            
            FOR j FROM 0 TO k MINUS 1 DO  
                IF j EQUALS min_cost_index THEN  
                    INCREMENT costs AT INDEX i AT INDEX j BY second_min_cost  
                ELSE  
                    INCREMENT costs AT INDEX i AT INDEX j BY min_cost  
                END IF  
            END FOR  
        END FOR  
        
        RETURN MINIMUM VALUE IN costs AT INDEX n MINUS 1  
    END FUNCTION  
END CLASS