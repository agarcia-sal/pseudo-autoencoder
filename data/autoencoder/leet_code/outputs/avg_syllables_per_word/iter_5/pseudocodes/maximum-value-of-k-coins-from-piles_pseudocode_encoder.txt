CLASS Solution  
    FUNCTION maxValueOfCoins(piles, k)  
        SET n TO LENGTH OF piles  
        INITIALIZE dp AS A TWO-DIMENSIONAL LIST WITH (n + 1) ROWS AND (k + 1) COLUMNS FILLED WITH 0  
        
        FOR i FROM 1 TO n INCLUSIVE  
            FOR j FROM 1 TO k INCLUSIVE  
                SET current_pile TO piles AT INDEX (i MINUS 1)  
                SET current_value TO 0  
                FOR l FROM 0 TO MINIMUM OF j AND LENGTH OF current_pile INCLUSIVE  
                    IF l GREATER THAN 0  
                        INCREMENT current_value BY current_pile AT INDEX (l MINUS 1)  
                    SET dp AT ROW i COLUMN j TO THE GREATER OF dp AT ROW i COLUMN j AND dp AT ROW (i MINUS 1) COLUMN (j MINUS l) PLUS current_value  
        
        RETURN dp AT ROW n COLUMN k  
    END FUNCTION  
END CLASS