CLASS Solution  
    FUNCTION numberOfCombinations(num)  
        SET MOD TO 10 TO THE POWER OF 9 PLUS 7  
        SET n TO LENGTH OF num  
        SET memo TO EMPTY DICTIONARY  
        
        FUNCTION dp(index, prev_len)  
            IF index EQUALS n THEN  
                RETURN 1  
            IF memo CONTAINS KEY (index, prev_len) THEN  
                RETURN VALUE OF memo AT (index, prev_len)  
            
            SET count TO 0  
            FOR length FROM 1 TO n MINUS index DO  
                IF CHARACTER AT num AT index EQUALS '0' THEN  
                    BREAK LOOP  
                
                SET current_num TO SUBSTRING OF num FROM index TO index PLUS length  
                
                IF prev_len EQUALS 0 OR current_num GREATER THAN OR EQUAL TO SUBSTRING OF num FROM index MINUS prev_len TO index THEN  
                    SET count TO count PLUS dp(index PLUS length, length) MODULO MOD  
            
            SET memo AT (index, prev_len) TO count  
            RETURN count  
        END FUNCTION  
        
        RETURN dp(0, 0)  
    END FUNCTION  
END CLASS