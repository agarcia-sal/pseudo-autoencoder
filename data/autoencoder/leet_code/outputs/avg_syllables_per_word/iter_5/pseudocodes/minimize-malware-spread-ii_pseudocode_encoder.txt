CLASS Solution  
    FUNCTION minMalwareSpread(graph, initial)  
        SET n TO LENGTH OF graph  
        SET adj_list TO an empty mapping from node TO list of nodes  

        FOR i FROM 0 TO n MINUS 1  
            FOR j FROM i PLUS 1 TO n MINUS 1  
                IF graph AT i AND j EQUALS 1  
                    APPEND j TO adj_list AT i  
                    APPEND i TO adj_list AT j  

        FUNCTION dfs(node, visited)  
            IF node IS IN visited  
                RETURN 0  
            ADD node TO visited  
            SET size TO 1  
            FOR each neighbor IN adj_list AT node  
                INCREMENT size BY dfs(neighbor, visited)  
            RETURN size  
        END FUNCTION  

        SET infected TO set of initial nodes  

        SET component_sizes TO empty list  
        SET visited TO empty set  
        SET component_index TO empty mapping  

        FOR node FROM 0 TO n MINUS 1  
            IF node IS NOT IN visited AND node IS NOT IN infected  
                SET size TO dfs(node, visited)  
                APPEND size TO component_sizes  
                SET i TO LENGTH OF component_sizes MINUS 1  
                LOOP backward over indices from i down to 0  
                    IF component_sizes AT i EQUALS size  
                        BREAK LOOP with current i  
                FOR each neighbor IN adj_list AT node  
                    SET component_index AT neighbor TO i  

        SET infected_in_component TO a mapping with default zero values  
        FOR each node IN infected  
            IF node IS IN component_index  
                INCREMENT infected_in_component AT component_index AT node BY 1  

        SET max_size TO 0  
        SET node_to_remove TO minimum value from initial  

        FOR each node IN infected  
            IF node IS IN component_index  
                SET comp_idx TO component_index AT node  
                IF infected_in_component AT comp_idx EQUALS 1  
                    IF component_sizes AT comp_idx GREATER THAN max_size  
                        SET max_size TO component_sizes AT comp_idx  
                        SET node_to_remove TO node  
                    ELSE IF component_sizes AT comp_idx EQUALS max_size  
                        SET node_to_remove TO minimum of node_to_remove AND node  

        RETURN node_to_remove  
    END FUNCTION  
END CLASS