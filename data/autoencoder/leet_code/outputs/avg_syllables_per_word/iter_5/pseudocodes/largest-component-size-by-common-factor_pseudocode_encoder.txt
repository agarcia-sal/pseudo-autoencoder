CLASS UnionFind
    FUNCTION __init__(self, size)
        SET self.parent TO list of integers from 0 to size minus 1
        SET self.rank TO list of 1 repeated size times
        SET self.size TO list of 1 repeated size times
    END FUNCTION

    FUNCTION find(self, u)
        IF self.parent at position u is not equal to u THEN
            SET self.parent at position u TO self.find(self.parent at position u)
        END IF
        RETURN self.parent at position u
    END FUNCTION

    FUNCTION union(self, u, v)
        SET rootU TO self.find(u)
        SET rootV TO self.find(v)
        IF rootU is not equal to rootV THEN
            IF self.rank at position rootU is greater than self.rank at position rootV THEN
                SET self.parent at position rootV TO rootU
                INCREMENT self.size at position rootU BY self.size at position rootV
            ELSE IF self.rank at position rootU is less than self.rank at position rootV THEN
                SET self.parent at position rootU TO rootV
                INCREMENT self.size at position rootV BY self.size at position rootU
            ELSE
                SET self.parent at position rootV TO rootU
                INCREMENT self.rank at position rootU BY 1
                INCREMENT self.size at position rootU BY self.size at position rootV
            END IF
        END IF
    END FUNCTION
END CLASS

CLASS Solution
    FUNCTION largestComponentSize(self, nums)
        SET max_num TO maximum value in nums
        SET uf TO new UnionFind initialized with max_num plus 1
        
        SET prime_to_index TO empty mapping
        
        FOR each num IN nums DO
            FOR each prime IN self.prime_factors(num) DO
                IF prime exists in prime_to_index THEN
                    CALL uf.union with prime_to_index at prime and num
                ELSE
                    SET prime_to_index at prime TO num
                END IF
            END FOR
        END FOR
        
        SET max_component_size TO 0
        FOR each num IN nums DO
            SET root TO uf.find(num)
            IF uf.size at root is greater than max_component_size THEN
                SET max_component_size TO uf.size at root
            END IF
        END FOR
        
        RETURN max_component_size
    END FUNCTION

    FUNCTION prime_factors(self, n)
        SET factors TO empty set
        WHILE n modulo 2 equals 0 DO
            ADD 2 TO factors
            SET n TO n divided by 2
        END WHILE
        
        FOR i FROM 3 TO square root of n plus 1 STEP 2 DO
            WHILE n modulo i equals 0 DO
                ADD i TO factors
                SET n TO n divided by i
            END WHILE
        END FOR
        
        IF n is greater than 2 THEN
            ADD n TO factors
        END IF
        
        RETURN factors
    END FUNCTION
END CLASS