CLASS Solution  
    FUNCTION validTicTacToe(board)  
        SET countX TO total number of 'X' occurrences in all rows of board  
        SET countO TO total number of 'O' occurrences in all rows of board  
  
        IF countX is less than countO OR countX is greater than countO plus 1 THEN  
            RETURN False  
        END IF  
  
        FUNCTION check_win(player)  
            FOR each row IN board  
                IF row consists entirely of player repeated three times THEN  
                    RETURN True  
                END IF  
            END FOR  
  
            FOR col FROM 0 TO 2  
                IF cell at (0, col), cell at (1, col), and cell at (2, col) all equal player THEN  
                    RETURN True  
                END IF  
            END FOR  
  
            IF diagonal from top-left to bottom-right cells all equal player THEN  
                RETURN True  
            END IF  
  
            IF diagonal from top-right to bottom-left cells all equal player THEN  
                RETURN True  
            END IF  
  
            RETURN False  
        END FUNCTION  
  
        SET winX TO result of check_win with player 'X'  
        SET winO TO result of check_win with player 'O'  
  
        IF winX AND winO THEN  
            RETURN False  
        END IF  
  
        IF winX AND countX equals countO THEN  
            RETURN False  
        END IF  
  
        IF winO AND countX not equal to countO THEN  
            RETURN False  
        END IF  
  
        RETURN True  
    END FUNCTION  
END CLASS