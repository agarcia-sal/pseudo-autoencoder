CLASS Solution  
    FUNCTION numBusesToDestination(routes, source, target)  
        IF source EQUALS target  
            RETURN 0  
        END IF  

        SET stop_to_buses TO a mapping from stop to list of buses  
        FOR each bus, route IN routes WITH index  
            FOR each stop IN route  
                APPEND bus TO stop_to_buses at stop  
            END FOR  
        END FOR  

        SET bus_queue TO an empty queue  
        SET visited_buses TO an empty set  
        SET visited_stops TO an empty set  

        FOR each bus IN stop_to_buses at source  
            APPEND tuple of bus and 1 TO bus_queue  
            ADD bus TO visited_buses  
        END FOR  
        ADD source TO visited_stops  

        WHILE bus_queue is not empty  
            REMOVE and SET current_bus, bus_count FROM front of bus_queue  

            FOR each stop IN routes at current_bus  
                IF stop EQUALS target  
                    RETURN bus_count  
                END IF  

                IF stop NOT IN visited_stops  
                    ADD stop TO visited_stops  
                    FOR each next_bus IN stop_to_buses at stop  
                        IF next_bus NOT IN visited_buses  
                            ADD next_bus TO visited_buses  
                            APPEND tuple of next_bus and bus_count INCREMENTED BY 1 TO bus_queue  
                        END IF  
                    END FOR  
                END IF  
            END FOR  
        END WHILE  

        RETURN -1  
    END FUNCTION  
END CLASS