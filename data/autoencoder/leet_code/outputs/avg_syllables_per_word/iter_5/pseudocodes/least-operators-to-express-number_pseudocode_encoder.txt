CLASS Solution  
    FUNCTION leastOpsExpressTarget(x, target)  
        DEFINE dp(target) WITH CACHE  
            IF target EQUALS 0  
                RETURN -1  
            ELSE IF target LESS THAN x  
                RETURN MINIMUM OF (2 TIMES target MINUS 1) AND (2 TIMES (x MINUS target))  
            END IF  
            
            SET power TO 1  
            WHILE x RAISED TO power LESS THAN OR EQUAL TO target  
                INCREMENT power BY 1  
            END WHILE  
            DECREMENT power BY 1  
            
            SET res TO dp(target MINUS x RAISED TO power) PLUS power  
            
            IF (x RAISED TO (power PLUS 1)) MINUS target LESS THAN target  
                SET res TO MINIMUM OF res AND dp((x RAISED TO (power PLUS 1)) MINUS target) PLUS power PLUS 1  
            END IF  
            
            RETURN res  
        END FUNCTION  
        
        RETURN dp(target)  
    END FUNCTION  
END CLASS