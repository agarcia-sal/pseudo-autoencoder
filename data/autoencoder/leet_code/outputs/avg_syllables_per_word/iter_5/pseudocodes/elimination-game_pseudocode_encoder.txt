CLASS Solution  
    FUNCTION lastRemaining(n)  
        SET remaining TO n  
        SET step TO 1  
        SET left_to_right TO true  
        SET head TO 1  

        WHILE remaining GREATER THAN 1  
            IF left_to_right IS true OR remaining MODULO 2 EQUALS 1  
                SET head TO head PLUS step  
            SET step TO step MULTIPLIED BY 2  
            SET remaining TO remaining DIVIDED BY 2  
            SET left_to_right TO NOT left_to_right  
        END WHILE  

        RETURN head  
    END FUNCTION  
END CLASS