CLASS Solution  
    FUNCTION distinctSubseqII(s)  
        SET MOD TO 10 raised to the power 9 plus 7  
        SET n TO LENGTH OF s  
        SET dp TO list of zeros with size n plus 1  
        SET dp at index 0 TO 1  
        SET last TO empty mapping  
        
        FOR i FROM 1 TO n  
            SET char TO character at position i minus 1 in s  
            SET dp at index i TO dp at index i minus 1 multiplied BY 2 MODULO MOD  
            
            IF char EXISTS IN last  
                SET dp at index i TO dp at index i minus dp at index last at char minus 1 plus MOD MODULO MOD  
            
            SET last at char TO i  
        
        RETURN dp at index n minus 1 MODULO MOD  
    END FUNCTION  
END CLASS