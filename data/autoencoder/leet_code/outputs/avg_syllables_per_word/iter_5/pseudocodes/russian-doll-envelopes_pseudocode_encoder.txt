CLASS Solution  
    FUNCTION maxEnvelopes(envelopes)  
        SORT envelopes BY width IN ASCENDING ORDER AND BY height IN DESCENDING ORDER WHEN widths ARE EQUAL  
        INITIALIZE dp AS EMPTY LIST  
        FOR EACH envelope WITH height h IN envelopes  
            SET idx TO POSITION IN dp WHERE h CAN BE INSERTED TO KEEP dp ORDERED  
            IF idx IS EQUAL TO LENGTH OF dp  
                APPEND h TO dp  
            ELSE  
                SET dp AT idx TO h  
        RETURN LENGTH OF dp  
    END FUNCTION  
END CLASS