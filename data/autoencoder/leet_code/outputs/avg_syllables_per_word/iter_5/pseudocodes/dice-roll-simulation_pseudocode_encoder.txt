CLASS Solution  
    FUNCTION dieSimulator(n, rollMax)  
        SET MOD TO 10 raised to the power 9 PLUS 7  
        SET dp TO three-dimensional list with dimensions (n PLUS 1) by 6 by (maximum value in rollMax PLUS 1) filled with zeros  
  
        FOR j FROM 0 TO 5  
            SET dp at index 1, j, 1 TO 1  
          
        FOR i FROM 2 TO n  
            FOR j FROM 0 TO 5  
                FOR k FROM 1 TO rollMax at index j  
                    IF k GREATER THAN 1 THEN  
                        SET dp at index i, j, k TO dp at index i MINUS 1, j, k MINUS 1  
                    ELSE  
                        SET total TO 0  
                        FOR x FROM 0 TO 5  
                            IF x NOT EQUAL TO j THEN  
                                FOR y FROM 1 TO rollMax at index x  
                                    INCREMENT total BY dp at index i MINUS 1, x, y  
                        SET dp at index i, j, k TO total MODULO MOD  
          
        SET result TO 0  
        FOR j FROM 0 TO 5  
            FOR k FROM 1 TO rollMax at index j  
                INCREMENT result BY dp at index n, j, k  
        RETURN result MODULO MOD  
    END FUNCTION  
END CLASS