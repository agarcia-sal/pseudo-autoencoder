CLASS Solution  
    FUNCTION sumOfDistancesInTree(n, edges)  
        SET graph TO empty mapping from node TO list of connected nodes  
        FOR each pair a, b IN edges  
            APPEND b TO graph at key a  
            APPEND a TO graph at key b  

        SET count TO list of size n WITH all values SET TO 1  
        SET dist TO list of size n WITH all values SET TO 0  

        FUNCTION dfs1(u, p)  
            FOR each v IN graph at key u  
                IF v IS NOT EQUAL TO p THEN  
                    CALL dfs1(v, u)  
                    INCREMENT count at index u BY count at index v  
                    INCREMENT dist at index u BY dist at index v PLUS count at index v  
                END IF  
            END FOR  
        END FUNCTION  

        CALL dfs1(0, -1)  

        FUNCTION dfs2(u, p)  
            FOR each v IN graph at key u  
                IF v IS NOT EQUAL TO p THEN  
                    SET dist at index v TO dist at index u MINUS count at index v PLUS n MINUS count at index v  
                    CALL dfs2(v, u)  
                END IF  
            END FOR  
        END FUNCTION  

        CALL dfs2(0, -1)  

        RETURN dist  
    END FUNCTION  
END CLASS