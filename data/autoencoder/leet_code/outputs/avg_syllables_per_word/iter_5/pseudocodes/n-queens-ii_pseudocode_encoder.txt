CLASS Solution  
    FUNCTION totalNQueens(n)  
        FUNCTION is_not_under_attack(row, col)  
            RETURN NOT (cols AT col PLUS hills AT (row MINUS col) PLUS dales AT (row PLUS col))  
        END FUNCTION

        FUNCTION place_queen(row, col)  
            SET cols AT col TO 1  
            SET hills AT (row MINUS col) TO 1  
            SET dales AT (row PLUS col) TO 1  
        END FUNCTION

        FUNCTION remove_queen(row, col)  
            SET cols AT col TO 0  
            SET hills AT (row MINUS col) TO 0  
            SET dales AT (row PLUS col) TO 0  
        END FUNCTION

        FUNCTION backtrack(row = 0, count = 0)  
            FOR col FROM 0 TO n MINUS 1  
                IF is_not_under_attack(row, col) THEN  
                    place_queen(row, col)  
                    IF row PLUS 1 EQUALS n THEN  
                        INCREMENT count BY 1  
                    ELSE  
                        SET count TO backtrack(row PLUS 1, count)  
                    END IF  
                    remove_queen(row, col)  
                END IF  
            END FOR  
            RETURN count  
        END FUNCTION

        SET cols TO list OF zeros WITH LENGTH n  
        SET hills TO list OF zeros WITH LENGTH (2 TIMES n MINUS 1)  
        SET dales TO list OF zeros WITH LENGTH (2 TIMES n MINUS 1)  

        RETURN backtrack()  
    END FUNCTION  
END CLASS