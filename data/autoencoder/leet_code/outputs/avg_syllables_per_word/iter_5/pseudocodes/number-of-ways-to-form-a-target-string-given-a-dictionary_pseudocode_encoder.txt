CLASS Solution  
    FUNCTION numWays(words, target)  
        SET MOD TO 10 POWER 9 PLUS 7  
        SET n TO LENGTH OF words AT INDEX 0  
        SET m TO LENGTH OF target  
        
        INITIALIZE freq AS LIST OF default dictionaries with default 0 FOR n TIMES  
        FOR each word IN words  
            FOR each index j AND character char IN word  
                INCREMENT freq AT j FOR char BY 1  
        
        INITIALIZE dp AS 2D LIST WITH DIMENSIONS (m PLUS 1) BY (n PLUS 1) FILLED WITH 0  
        
        FOR each index j FROM 0 TO n INCLUSIVE  
            SET dp AT 0 AND j TO 1  
        
        FOR each index i FROM 1 TO m INCLUSIVE  
            FOR each index j FROM 1 TO n INCLUSIVE  
                SET dp AT i AND j TO dp AT i AND (j MINUS 1)  
                IF freq AT (j MINUS 1) FOR target AT (i MINUS 1) IS GREATER THAN 0  
                    INCREMENT dp AT i AND j BY dp AT (i MINUS 1) AND (j MINUS 1) MULTIPLIED BY freq AT (j MINUS 1) FOR target AT (i MINUS 1)  
                    SET dp AT i AND j TO dp AT i AND j MODULO MOD  
        
        RETURN dp AT m AND n  
    END FUNCTION  
END CLASS