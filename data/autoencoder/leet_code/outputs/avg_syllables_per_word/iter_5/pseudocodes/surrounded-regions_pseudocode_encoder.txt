CLASS Solution  
    FUNCTION solve(board)  
        IF board IS empty OR board AT 0 IS empty  
            RETURN  
        
        SET m TO LENGTH OF board  
        SET n TO LENGTH OF board AT 0  
        
        FUNCTION dfs(x, y)  
            IF x LESS THAN 0 OR x GREATER THAN OR EQUAL TO m OR y LESS THAN 0 OR y GREATER THAN OR EQUAL TO n OR board AT x AT y IS NOT 'O'  
                RETURN  
            SET board AT x AT y TO 'S'  
            CALL dfs WITH x PLUS 1 AND y  
            CALL dfs WITH x MINUS 1 AND y  
            CALL dfs WITH x AND y PLUS 1  
            CALL dfs WITH x AND y MINUS 1  
        END FUNCTION  
        
        FOR i FROM 0 TO m MINUS 1  
            CALL dfs WITH i AND 0  
            CALL dfs WITH i AND n MINUS 1  
        
        FOR j FROM 0 TO n MINUS 1  
            CALL dfs WITH 0 AND j  
            CALL dfs WITH m MINUS 1 AND j  
        
        FOR i FROM 0 TO m MINUS 1  
            FOR j FROM 0 TO n MINUS 1  
                IF board AT i AT j IS 'O'  
                    SET board AT i AT j TO 'X'  
        
        FOR i FROM 0 TO m MINUS 1  
            FOR j FROM 0 TO n MINUS 1  
                IF board AT i AT j IS 'S'  
                    SET board AT i AT j TO 'O'  
    END FUNCTION  
END CLASS