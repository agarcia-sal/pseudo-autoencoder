CLASS UnionFind  
    FUNCTION __init__(self, n)  
        SET self.parent TO list of integers from 0 to n inclusive  
        SET self.rank TO list of zeros of length n plus 1  
        SET self.count TO n  
    END FUNCTION  
  
    FUNCTION find(self, u)  
        IF self.parent at position u is not equal to u THEN  
            SET self.parent at position u TO result of find(self.parent at position u)  
        END IF  
        RETURN self.parent at position u  
    END FUNCTION  
  
    FUNCTION union(self, u, v)  
        SET rootU TO find(u)  
        SET rootV TO find(v)  
        IF rootU is not equal to rootV THEN  
            IF self.rank at position rootU is greater than self.rank at position rootV THEN  
                SET self.parent at position rootV TO rootU  
            ELSE IF self.rank at position rootU is less than self.rank at position rootV THEN  
                SET self.parent at position rootU TO rootV  
            ELSE  
                SET self.parent at position rootV TO rootU  
                INCREMENT self.rank at position rootU BY 1  
            END IF  
            DECREMENT self.count BY 1  
            RETURN True  
        END IF  
        RETURN False  
    END FUNCTION  
END CLASS  
  
CLASS Solution  
    FUNCTION maxNumEdgesToRemove(self, n, edges)  
        SET uf_common TO new UnionFind with n  
        SET uf_alice TO new UnionFind with n  
        SET uf_bob TO new UnionFind with n  
  
        SET used_edges TO 0  
  
        FOR each t, u, v IN edges  
            IF t is equal to 3 THEN  
                IF uf_common.union(u, v) returns True THEN  
                    CALL uf_alice.union(u, v)  
                    CALL uf_bob.union(u, v)  
                    INCREMENT used_edges BY 1  
                END IF  
            END IF  
        END FOR  
  
        FOR each t, u, v IN edges  
            IF t is equal to 1 AND uf_alice.union(u, v) returns True THEN  
                INCREMENT used_edges BY 1  
            ELSE IF t is equal to 2 AND uf_bob.union(u, v) returns True THEN  
                INCREMENT used_edges BY 1  
            END IF  
        END FOR  
  
        IF uf_alice.count is equal to 1 AND uf_bob.count is equal to 1 THEN  
            RETURN length of edges MINUS used_edges  
        ELSE  
            RETURN -1  
        END IF  
    END FUNCTION  
END CLASS