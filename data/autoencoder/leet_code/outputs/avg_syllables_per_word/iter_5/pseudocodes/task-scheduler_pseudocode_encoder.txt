CLASS Solution  
    FUNCTION leastInterval(tasks, n)  
        SET task_counts TO count frequencies of tasks  
        SET max_heap TO list of negative counts from task_counts values  
        CONVERT max_heap INTO a heap structure  
        
        SET time TO 0  
        SET queue TO empty list  
        
        WHILE max_heap IS NOT empty OR queue IS NOT empty  
            WHILE queue IS NOT empty AND first element of queue time EQUALS time  
                REMOVE first element from queue INTO (_, count)  
                IF count IS LESS THAN 0  
                    ADD count INTO max_heap as heap element  
            
            IF max_heap IS NOT empty  
                REMOVE smallest element from max_heap INTO count  
                INCREMENT count BY 1  
                IF count IS LESS THAN 0  
                    APPEND pair of (time PLUS n PLUS 1, count) TO queue  
            
            INCREMENT time BY 1  
        
        RETURN time  
    END FUNCTION  
END CLASS