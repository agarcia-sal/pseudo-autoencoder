CLASS Solution  
    FUNCTION numPermsDISequence(s)  
        SET MOD TO 1000000007  
        SET n TO LENGTH OF s  
        SET dp TO A TWO-DIMENSIONAL LIST OF SIZE (n + 1) BY (n + 1) WITH ALL VALUES SET TO 0  
        
        FOR j FROM 0 TO n  
            SET dp AT 0 AND j TO 1  
        
        FOR i FROM 1 TO n  
            SET prefix_sum TO 0  
            IF CHARACTER AT (i MINUS 1) IN s EQUALS 'I' THEN  
                FOR j FROM 0 TO (n PLUS 1 MINUS i) MINUS 1  
                    SET prefix_sum TO (prefix_sum PLUS dp AT (i MINUS 1) AND j) MODULO MOD  
                    SET dp AT i AND j TO prefix_sum  
            ELSE  
                FOR j FROM (n MINUS i) DOWNTO 0  
                    SET prefix_sum TO (prefix_sum PLUS dp AT (i MINUS 1) AND (j PLUS 1)) MODULO MOD  
                    SET dp AT i AND j TO prefix_sum  
        
        RETURN THE SUM OF dp AT n ELEMENTS MODULO MOD  
    END FUNCTION  
END CLASS