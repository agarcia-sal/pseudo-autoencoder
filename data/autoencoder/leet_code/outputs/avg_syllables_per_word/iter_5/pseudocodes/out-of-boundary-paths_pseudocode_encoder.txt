CLASS Solution  
    FUNCTION findPaths(m, n, maxMove, startRow, startColumn)  
        SET MOD TO 10 RAISED TO THE POWER OF 9 PLUS 7  
        SET directions TO LIST OF (0, 1), (0, -1), (1, 0), (-1, 0)  
        INITIALIZE dp AS 3D LIST OF SIZE m BY n BY (maxMove PLUS 1) WITH ALL VALUES SET TO 0  
        
        FOR k FROM 1 TO maxMove INCLUSIVE  
            FOR i FROM 0 TO m MINUS 1  
                FOR j FROM 0 TO n MINUS 1  
                    FOR EACH (di, dj) IN directions  
                        SET ni TO i PLUS di  
                        SET nj TO j PLUS dj  
                        IF ni LESS THAN 0 OR ni GREATER THAN OR EQUAL TO m OR nj LESS THAN 0 OR nj GREATER THAN OR EQUAL TO n  
                            SET dp AT POSITION i, j, k TO (dp AT POSITION i, j, k PLUS 1) MODULO MOD  
                        ELSE  
                            SET dp AT POSITION i, j, k TO (dp AT POSITION i, j, k PLUS dp AT POSITION ni, nj, k MINUS 1) MODULO MOD  
        
        RETURN dp AT POSITION startRow, startColumn, maxMove  
    END FUNCTION  
END CLASS