CLASS Solution  
    FUNCTION subarraysWithKDistinct(nums, k)  
        FUNCTION atMostKDistinct(t)  
            SET count TO a new mapping with default integer zero  
            SET left TO 0  
            SET result TO 0  
            FOR right FROM 0 TO LENGTH OF nums MINUS 1  
                INCREMENT count AT key nums[right] BY 1  
                WHILE LENGTH OF count IS GREATER THAN t  
                    DECREMENT count AT key nums[left] BY 1  
                    IF count AT key nums[left] IS EQUAL TO 0  
                        REMOVE key nums[left] FROM count  
                    INCREMENT left BY 1  
                INCREMENT result BY right MINUS left PLUS 1  
            RETURN result  
        END FUNCTION  
        
        RETURN atMostKDistinct(k) MINUS atMostKDistinct(k MINUS 1)  
    END FUNCTION  
END CLASS