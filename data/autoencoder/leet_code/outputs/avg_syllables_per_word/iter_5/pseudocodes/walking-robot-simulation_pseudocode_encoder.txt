CLASS Solution  
    FUNCTION robotSim(commands, obstacles)  
        SET directions TO list of tuples (0, 1), (1, 0), (0, -1), (-1, 0)  
        SET x TO 0  
        SET y TO 0  
        SET dir_index TO 0  
        SET obstacles_set TO set of tuples converted from obstacles  
        SET max_distance TO 0  

        FOR each command IN commands  
            IF command EQUALS -2  
                SET dir_index TO dir_index MINUS 1 MODULO 4  
            ELSE IF command EQUALS -1  
                SET dir_index TO dir_index PLUS 1 MODULO 4  
            ELSE  
                SET dx TO directions AT dir_index FIRST ELEMENT  
                SET dy TO directions AT dir_index SECOND ELEMENT  
                FOR step FROM 1 TO command  
                    SET next_x TO x PLUS dx  
                    SET next_y TO y PLUS dy  
                    IF tuple (next_x, next_y) IS IN obstacles_set  
                        BREAK OUT OF LOOP  
                    SET x TO next_x  
                    SET y TO next_y  
                END FOR  
                SET max_distance TO maximum of max_distance AND (x MULTIPLIED BY x PLUS y MULTIPLIED BY y)  
            END IF  
        END FOR  

        RETURN max_distance  
    END FUNCTION  
END CLASS