CLASS Solution  
    FUNCTION solve(nums, queries)  
        SET MOD TO 10 raised to the power of 9 PLUS 7  
        SET n TO LENGTH OF nums  
        
        SET max_y TO the maximum y value from queries  
        SET prefix_sums TO a list of lists each initialized to zero, with size (max_y PLUS 1) by n  
        
        FOR y FROM 1 TO max_y INCLUSIVE  
            FOR i FROM n MINUS 1 DOWN TO 0 INCLUSIVE  
                IF i PLUS y IS LESS THAN n THEN  
                    SET prefix_sums[y][i] TO nums[i] PLUS prefix_sums[y][i PLUS y]  
                ELSE  
                    SET prefix_sums[y][i] TO nums[i]  
        
        SET answer TO an empty list  
        FOR each pair (x, y) IN queries  
            APPEND prefix_sums[y][x] MODULO MOD TO answer  
        
        RETURN answer  
    END FUNCTION  
END CLASS