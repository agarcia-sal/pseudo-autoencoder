CLASS Solution  
    FUNCTION maxTotalFruits(fruits, startPos, k)  
        SET max_fruits TO 0  
        SET total_fruits TO 0  
        SET left TO 0  
        
        FOR right FROM 0 TO LENGTH OF fruits MINUS 1  
            SET position TO fruits AT right AT INDEX 0  
            SET amount TO fruits AT right AT INDEX 1  
            INCREMENT total_fruits BY amount  
            
            WHILE left LESS THAN OR EQUAL TO right AND NOT (  
                startPos MINUS k LESS THAN OR EQUAL TO fruits AT left AT INDEX 0 AND  
                fruits AT left AT INDEX 0 LESS THAN OR EQUAL TO startPos PLUS k AND  
                startPos MINUS k LESS THAN OR EQUAL TO fruits AT right AT INDEX 0 AND  
                fruits AT right AT INDEX 0 LESS THAN OR EQUAL TO startPos PLUS k AND  
                MINIMUM OF (ABSOLUTE VALUE OF (fruits AT right AT INDEX 0 MINUS startPos),  
                            ABSOLUTE VALUE OF (fruits AT left AT INDEX 0 MINUS startPos)) PLUS  
                (fruits AT right AT INDEX 0 MINUS fruits AT left AT INDEX 0) LESS THAN OR EQUAL TO k  
            )  
                DECREMENT total_fruits BY fruits AT left AT INDEX 1  
                INCREMENT left BY 1  
            
            IF max_fruits LESS THAN total_fruits  
                SET max_fruits TO total_fruits  
        
        RETURN max_fruits  
    END FUNCTION  
END CLASS