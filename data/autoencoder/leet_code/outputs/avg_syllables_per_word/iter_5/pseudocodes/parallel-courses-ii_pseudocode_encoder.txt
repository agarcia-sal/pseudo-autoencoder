CLASS Solution  
    FUNCTION minNumberOfSemesters(n, relations, k)  
        SET graph TO a default dictionary of lists  
        SET in_degree TO a list of zeros of length n plus one  
      
        FOR each prevCourse, nextCourse IN relations  
            APPEND nextCourse TO graph at prevCourse  
            DECREMENT in_degree at nextCourse BY 1  
      
        SET queue TO an empty deque  
        FOR course FROM 1 TO n inclusive  
            IF in_degree at course EQUALS 0  
                APPEND course TO queue  
      
        SET semesters TO 0  
      
        WHILE queue is not empty  
            SET number_of_courses TO the minimum between k and length of queue  
            FOR each index FROM 1 TO number_of_courses inclusive  
                SET current_course TO REMOVE the leftmost element from queue  
                FOR each next_course IN graph at current_course  
                    DECREMENT in_degree at next_course BY 1  
                    IF in_degree at next_course EQUALS 0  
                        APPEND next_course TO queue  
            INCREMENT semesters BY 1  
      
        RETURN semesters  
    END FUNCTION  
END CLASS