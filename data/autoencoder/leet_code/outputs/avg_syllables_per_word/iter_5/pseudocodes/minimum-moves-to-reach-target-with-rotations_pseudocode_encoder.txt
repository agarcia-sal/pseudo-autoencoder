CLASS Solution  
    FUNCTION minimumMoves(grid)  
        SET n TO LENGTH OF grid  
        INITIALIZE queue WITH (0, 0, 0, 1, 0)  
        INITIALIZE visited WITH (0, 0, 0, 1)  
        
        WHILE queue IS NOT EMPTY  
            REMOVE FIRST ELEMENT FROM queue INTO (r1, c1, r2, c2, steps)  
            
            IF (r1, c1, r2, c2) EQUALS (n MINUS 1, n MINUS 2, n MINUS 1, n MINUS 1)  
                RETURN steps  
            
            IF c2 PLUS 1 IS LESS THAN n AND grid AT (r1, c1 PLUS 1) IS 0 AND grid AT (r2, c2 PLUS 1) IS 0 AND (r1, c1 PLUS 1, r2, c2 PLUS 1) NOT IN visited  
                ADD (r1, c1 PLUS 1, r2, c2 PLUS 1) TO visited  
                ADD (r1, c1 PLUS 1, r2, c2 PLUS 1, steps PLUS 1) TO queue  
            
            IF r2 PLUS 1 IS LESS THAN n AND grid AT (r1 PLUS 1, c1) IS 0 AND grid AT (r2 PLUS 1, c2) IS 0 AND (r1 PLUS 1, c1, r2 PLUS 1, c2) NOT IN visited  
                ADD (r1 PLUS 1, c1, r2 PLUS 1, c2) TO visited  
                ADD (r1 PLUS 1, c1, r2 PLUS 1, c2, steps PLUS 1) TO queue  
            
            IF r1 EQUALS r2 AND r1 PLUS 1 IS LESS THAN n AND grid AT (r1 PLUS 1, c1) IS 0 AND grid AT (r1 PLUS 1, c2) IS 0 AND (r1, c1, r1 PLUS 1, c1) NOT IN visited  
                ADD (r1, c1, r1 PLUS 1, c1) TO visited  
                ADD (r1, c1, r1 PLUS 1, c1, steps PLUS 1) TO queue  
            
            IF c1 EQUALS c2 AND c1 PLUS 1 IS LESS THAN n AND grid AT (r1, c1 PLUS 1) IS 0 AND grid AT (r2, c2 PLUS 1) IS 0 AND (r1, c1, r1, c1 PLUS 1) NOT IN visited  
                ADD (r1, c1, r1, c1 PLUS 1) TO visited  
                ADD (r1, c1, r1, c1 PLUS 1, steps PLUS 1) TO queue  
        
        RETURN MINUS 1  
    END FUNCTION  
END CLASS