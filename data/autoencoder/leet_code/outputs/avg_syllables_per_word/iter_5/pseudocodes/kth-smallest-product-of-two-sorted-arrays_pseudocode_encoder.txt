CLASS Solution  
    FUNCTION kthSmallestProduct(nums1, nums2, k)  
        FUNCTION count(p)  
            SET cnt TO 0  
            SET n TO LENGTH OF nums2  
            FOR each x IN nums1  
                IF x GREATER THAN 0  
                    INCREMENT cnt BY bisect_right(nums2, p DIVIDED BY x)  
                ELSE IF x LESS THAN 0  
                    INCREMENT cnt BY n MINUS bisect_left(nums2, p DIVIDED BY x)  
                ELSE  
                    INCREMENT cnt BY n MULTIPLIED BY (1 IF p GREATER THAN OR EQUAL TO 0 ELSE 0)  
            RETURN cnt  
        END FUNCTION  

        SET mx TO MAXIMUM OF ABSOLUTE VALUE OF nums1 FIRST ELEMENT AND ABSOLUTE VALUE OF nums1 LAST ELEMENT  
        SET mx TO mx MULTIPLIED BY MAXIMUM OF ABSOLUTE VALUE OF nums2 FIRST ELEMENT AND ABSOLUTE VALUE OF nums2 LAST ELEMENT  
        RETURN bisect_left(RANGE FROM NEGATIVE mx TO mx PLUS 1, k, WITH KEY count) MINUS mx  
    END FUNCTION  
END CLASS