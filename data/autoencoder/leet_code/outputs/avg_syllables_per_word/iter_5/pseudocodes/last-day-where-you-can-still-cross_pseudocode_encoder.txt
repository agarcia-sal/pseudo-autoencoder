CLASS UnionFind  
    FUNCTION __init__(self, n)  
        SET self.parent TO list of integers from 0 to n minus 1  
        SET self.rank TO list of zeros of length n  
    END FUNCTION  

    FUNCTION find(self, x)  
        IF self.parent at position x IS NOT x THEN  
            SET self.parent at position x TO self.find(self.parent at position x)  
        END IF  
        RETURN self.parent at position x  
    END FUNCTION  

    FUNCTION union(self, x, y)  
        SET rootX TO self.find(x)  
        SET rootY TO self.find(y)  
        IF rootX IS NOT rootY THEN  
            IF self.rank at rootX IS GREATER THAN self.rank at rootY THEN  
                SET self.parent at rootY TO rootX  
            ELSE IF self.rank at rootX IS LESS THAN self.rank at rootY THEN  
                SET self.parent at rootX TO rootY  
            ELSE  
                SET self.parent at rootY TO rootX  
                INCREMENT self.rank at rootX BY 1  
            END IF  
        END IF  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION latestDayToCross(self, row, col, cells)  
        SET grid TO list of lists with dimensions row by col filled with value 1  
        SET uf TO new UnionFind with parameter (row TIMES col PLUS 2)  
        SET TOP TO row TIMES col  
        SET BOTTOM TO row TIMES col PLUS 1  
        SET directions TO list of tuples [(-1, 0), (1, 0), (0, -1), (0, 1)]  

        FOR day FROM LENGTH OF cells MINUS 1 DOWN TO 0 STEP -1 DO  
            SET r, c TO values of cells at position day  
            DECREMENT r BY 1  
            DECREMENT c BY 1  
            SET grid at row r and column c TO 0  

            FOR each (dr, dc) IN directions DO  
                SET nr TO r PLUS dr  
                SET nc TO c PLUS dc  
                IF nr IS GREATER THAN OR EQUAL TO 0 AND nr IS LESS THAN row AND nc IS GREATER THAN OR EQUAL TO 0 AND nc IS LESS THAN col AND grid at nr and nc IS 0 THEN  
                    CALL uf.union with arguments (r TIMES col PLUS c) and (nr TIMES col PLUS nc)  
                END IF  
            END FOR  

            IF r IS EQUAL TO 0 THEN  
                CALL uf.union with arguments (r TIMES col PLUS c) and TOP  
            END IF  

            IF r IS EQUAL TO row MINUS 1 THEN  
                CALL uf.union with arguments (r TIMES col PLUS c) and BOTTOM  
            END IF  

            IF uf.find(TOP) IS EQUAL TO uf.find(BOTTOM) THEN  
                RETURN day  
            END IF  
        END FOR  

        RETURN 0  
    END FUNCTION  
END CLASS