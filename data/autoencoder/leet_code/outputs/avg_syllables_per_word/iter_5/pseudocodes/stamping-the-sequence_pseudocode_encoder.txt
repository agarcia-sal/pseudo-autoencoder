CLASS Solution  
    FUNCTION movesToStamp(stamp, target)  
        SET m TO LENGTH OF stamp  
        SET n TO LENGTH OF target  
        SET indeg TO LIST OF m REPEATED (n MINUS m PLUS 1) TIMES  
        SET q TO NEW deque  
        SET g TO LIST OF EMPTY LISTS WITH LENGTH n  
        FOR i FROM 0 TO n MINUS m  
            FOR each index j AND character c IN stamp  
                IF character AT target POSITION i PLUS j EQUALS c THEN  
                    DECREMENT indeg AT i BY 1  
                    IF indeg AT i EQUALS 0 THEN  
                        APPEND i TO q  
                ELSE  
                    APPEND i TO g AT POSITION i PLUS j  
        SET ans TO EMPTY LIST  
        SET vis TO LIST OF False WITH LENGTH n  
        WHILE q IS NOT EMPTY  
            SET i TO q POP LEFT  
            APPEND i TO ans  
            FOR j FROM 0 TO m MINUS 1  
                IF vis AT i PLUS j IS False THEN  
                    SET vis AT i PLUS j TO True  
                    FOR each k IN g AT i PLUS j  
                        DECREMENT indeg AT k BY 1  
                        IF indeg AT k EQUALS 0 THEN  
                            APPEND k TO q  
        IF all elements IN vis ARE True THEN  
            RETURN ans REVERSED  
        ELSE  
            RETURN EMPTY LIST  
    END FUNCTION  
END CLASS