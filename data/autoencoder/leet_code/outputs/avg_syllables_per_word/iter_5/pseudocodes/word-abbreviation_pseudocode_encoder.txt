CLASS Solution  
    FUNCTION wordsAbbreviation(words)  
        FUNCTION abbreviate(word, prefix_length)  
            IF LENGTH OF word MINUS prefix_length LESS THAN OR EQUAL TO 2  
                RETURN word  
            RETURN CONCATENATION OF substring of word UP TO prefix_length, string of LENGTH OF word MINUS prefix_length MINUS 1, AND last character of word  
        END FUNCTION  

        FUNCTION get_unique_abbreviations(words_with_indices, prefix_length)  
            SET abbs TO a mapping from abbreviation TO list of (index, word)  
            FOR each index, word IN words_with_indices  
                APPEND (index, word) TO abbs[abbreviate(word, prefix_length)]  
            RETURN abbs  
        END FUNCTION  

        SET n TO LENGTH OF words  
        SET ans TO list of empty strings WITH SIZE n  
        SET words_with_indices TO list OF (index, word) FOR each index and word IN words via enumeration  
        
        SET abbs TO get_unique_abbreviations(words_with_indices, 1)  
        
        FOR each abb, group IN abbs  
            IF LENGTH OF group EQUALS 1  
                SET index, word TO first element of group  
                SET ans[index] TO abb  
            ELSE  
                SET new_group TO empty list  
                FOR each index, word IN group  
                    APPEND (index, word) TO new_group  
                SET prefix_length TO 2  
                WHILE LENGTH OF new_group GREATER THAN 0  
                    SET new_abbs TO get_unique_abbreviations(new_group, prefix_length)  
                    SET new_group TO empty list  
                    FOR each new_abb, new_group_items IN new_abbs  
                        IF LENGTH OF new_group_items EQUALS 1  
                            SET index, word TO first element of new_group_items  
                            SET ans[index] TO new_abb  
                        ELSE  
                            EXTEND new_group BY new_group_items  
                    INCREMENT prefix_length BY 1  
        
        RETURN ans  
    END FUNCTION  
END CLASS