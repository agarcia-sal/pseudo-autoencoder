CLASS Solution  
    FUNCTION longestSubsequenceRepeatedK(s, k)  
        IMPORT Counter FROM collections  

        SET freq TO Counter OF s  

        SET valid_chars TO list of characters FROM freq WHERE their count IS GREATER THAN OR EQUAL TO k  

        SORT valid_chars IN descending lexicographical order  

        FUNCTION is_valid_subsequence(candidate)  
            SET count TO 0  
            SET index TO 0  
            FOR each char IN s  
                IF char IS EQUAL TO candidate AT position index THEN  
                    INCREMENT index BY 1  
                    IF index IS EQUAL TO LENGTH OF candidate THEN  
                        INCREMENT count BY 1  
                        SET index TO 0  
                        IF count IS EQUAL TO k THEN  
                            RETURN True  
            RETURN False  
        END FUNCTION  

        SET best_candidate TO empty string  

        FUNCTION backtrack(candidate)  
            IF LENGTH OF candidate IS GREATER THAN LENGTH OF best_candidate THEN  
                SET best_candidate TO candidate  
            FOR each char IN valid_chars  
                SET new_candidate TO candidate CONCATENATED WITH char  
                IF is_valid_subsequence(new_candidate) THEN  
                    CALL backtrack(new_candidate)  
        END FUNCTION  

        CALL backtrack WITH empty string  

        RETURN best_candidate  
    END FUNCTION  
END CLASS