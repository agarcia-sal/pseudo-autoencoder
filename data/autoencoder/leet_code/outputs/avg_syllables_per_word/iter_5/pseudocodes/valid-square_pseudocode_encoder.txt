CLASS Solution  
    FUNCTION validSquare(p1, p2, p3, p4)  
        FUNCTION squared_distance(point1, point2)  
            SET dx TO point1 AT index 0 MINUS point2 AT index 0  
            SET dy TO point1 AT index 1 MINUS point2 AT index 1  
            SET result TO dx SQUARED PLUS dy SQUARED  
            RETURN result  
        END FUNCTION  
        
        SET points TO LIST CONTAINING p1, p2, p3, p4  
        SET distances TO EMPTY SET  
        
        FOR i FROM 0 TO 3  
            FOR j FROM i PLUS 1 TO 3  
                SET dist TO squared_distance(points AT index i, points AT index j)  
                IF dist EQUALS 0 THEN  
                    RETURN False  
                END IF  
                ADD dist TO distances  
            END FOR  
        END FOR  
        
        RETURN LENGTH OF distances EQUALS 2  
    END FUNCTION  
END CLASS