CLASS Trie  
    FUNCTION __init__()  
        SET children TO list of size 26 with all elements None  
        SET ref TO -1  
    END FUNCTION  
  
    FUNCTION insert(w, ref)  
        SET node TO self  
        FOR each character c IN w  
            SET idx TO position of c in alphabet starting from 0  
            IF node.children at idx IS None  
                SET node.children at idx TO new Trie instance  
            SET node TO node.children at idx  
        SET node.ref TO ref  
    END FUNCTION  
END CLASS  
  
CLASS Solution  
    FUNCTION findWords(board, words)  
        FUNCTION dfs(node, i, j)  
            SET idx TO position of board at i, j character in alphabet starting from 0  
            IF node.children at idx IS None  
                RETURN  
            SET node TO node.children at idx  
            IF node.ref IS GREATER THAN OR EQUAL TO 0  
                APPEND words at node.ref TO ans  
                SET node.ref TO -1  
            SET c TO board at i, j  
            SET board at i, j TO marker '#'  
            FOR each pair (a, b) IN pairs of (-1, 0, 1, 0, -1)  
                SET x TO i INCREMENTED BY a  
                SET y TO j INCREMENTED BY b  
                IF x IS GREATER THAN OR EQUAL TO 0 AND LESS THAN m AND y IS GREATER THAN OR EQUAL TO 0 AND LESS THAN n AND board at x, y IS NOT '#'  
                    CALL dfs WITH node, x, y  
            SET board at i, j TO c  
        END FUNCTION  
  
        SET tree TO new Trie instance  
        FOR each index i AND word w IN words  
            CALL tree.insert WITH w, i  
        SET m TO number of rows in board  
        SET n TO number of columns in board  
        SET ans TO empty list  
        FOR each i FROM 0 TO m minus 1  
            FOR each j FROM 0 TO n minus 1  
                CALL dfs WITH tree, i, j  
        RETURN ans  
    END FUNCTION  
END CLASS