CLASS Solution  
    FUNCTION getMaxRepetitions(s1 s1 AS string n1 n1 AS integer s2 s2 AS string n2 n2 AS integer) RETURNS integer  
        IF n1 EQUALS zero THEN  
            RETURN zero  
        END IF  

        SET s2_count TO a list of zeros with length EQUAL TO the length of s2 PLUS one  
        SET index_map TO a list of zeros with length EQUAL TO the length of s2 PLUS one  

        SET current_index_s2 TO zero  
        SET s1_count TO zero  

        WHILE s1_count LESS THAN n1 DO  
            INCREMENT s1_count BY one  
            FOR each character char IN s1 DO  
                IF char EQUALS the element at position current_index_s2 of s2 THEN  
                    INCREMENT current_index_s2 BY one  
                    IF current_index_s2 EQUALS the length of s2 THEN  
                        SET the element at position s1_count of s2_count TO the element at position s1_count MINUS one of s2_count PLUS one  
                        SET current_index_s2 TO zero  
                    END IF  
                END IF  
                SET the element at position s1_count of index_map TO current_index_s2  
            END FOR  

            IF current_index_s2 IS AN ELEMENT OF the slice of index_map from position zero TO position s1_count MINUS one THEN  
                SET start TO the position of current_index_s2 in index_map  
                SET cycle_length TO s1_count MINUS start  
                SET cycles_fit TO the integer part of (n1 MINUS start) DIVIDED BY cycle_length  
                SET remainder TO (n1 MINUS start) MODULO cycle_length  
                SET total_s2_count TO the element at position start of s2_count PLUS cycles_fit MULTIPLIED BY (the element at position start PLUS cycle_length of s2_count MINUS the element at position start of s2_count) PLUS the element at position start PLUS remainder of s2_count MINUS the element at position start of s2_count  
                RETURN total_s2_count DIVIDED BY n2  
            END IF  
        END WHILE  

        RETURN the element at position s1_count of s2_count DIVIDED BY n2  
    END FUNCTION  
END CLASS