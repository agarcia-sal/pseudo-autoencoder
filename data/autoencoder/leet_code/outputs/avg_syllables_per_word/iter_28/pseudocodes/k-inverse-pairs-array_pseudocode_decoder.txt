CLASS Solution  
    FUNCTION kInversePairs(n, k)  
        SET MOD TO one billion plus seven  
        SET dp TO two dimensional list of zeros with dimensions (n plus one) by (k plus one)  
        SET element at position zero of list at position zero of dp TO one  
        FOR i FROM one TO n  
            SET prefix_sum TO zero  
            FOR j FROM zero TO k  
                SET prefix_sum TO prefix_sum PLUS element at position j of list at position i minus one of dp  
                IF prefix_sum GREATER THAN OR EQUAL TO MOD  
                    SET prefix_sum TO prefix_sum MINUS MOD  
                END IF  
                IF j GREATER THAN OR EQUAL TO i  
                    SET prefix_sum TO prefix_sum MINUS element at position j minus i of list at position i minus one of dp PLUS MOD  
                    IF prefix_sum GREATER THAN OR EQUAL TO MOD  
                        SET prefix_sum TO prefix_sum MINUS MOD  
                    END IF  
                END IF  
                SET element at position j of list at position i of dp TO prefix_sum  
            END FOR  
        END FOR  
        RETURN element at position k of list at position n of dp  
    END FUNCTION  
END CLASS