CLASS Solution  
    FUNCTION maxNumOfSubstrings(s)  
        SET first TO empty dictionary  
        SET last TO empty dictionary  
        FOR each position i AND character c IN s with enumeration  
            IF character c NOT IN first  
                SET element at character c IN first TO position i  
            END IF  
            SET element at character c IN last TO position i  
        END FOR  
        
        SET intervals TO empty list  
        FOR each character c IN keys of first  
            SET start TO element at character c IN first  
            SET end TO element at character c IN last  
            SET i TO start  
            WHILE i LESS THAN OR EQUAL TO end  
                IF element at character at position i of s IN first LESS THAN start  
                    BREAK the loop  
                END IF  
                IF element at character at position i of last GREATER THAN end  
                    SET end TO element at character at position i of last  
                END IF  
                INCREMENT i BY one  
            END WHILE  
            IF loop did not break prematurely  
                APPEND the tuple of start and end TO intervals  
            END IF  
        END FOR  
        
        SORT intervals BY the second element of each tuple in ascending order  
        
        SET result TO empty list  
        SET prev_end TO the number before zero by one  
        FOR each tuple start and end IN intervals  
            IF start GREATER THAN prev_end  
                APPEND substring from position start TO position end inclusive of s TO result  
                SET prev_end TO end  
            END IF  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS