CLASS Solution  
    FUNCTION pathsWithMaxScore(board)  
        SET MOD TO ten POWERED BY nine PLUS one  
        SET n TO the LENGTH OF board  
          
        SET dp TO a two dimensional list of size n BY n WHERE each element is a list with two elements first element set to negative infinity second element set to zero  
          
        SET the element at position n MINUS one FOR rows AND n MINUS one FOR columns of dp TO a list where first element is zero second element is one  
          
        FOR i FROM n MINUS one DOWN TO zero  
            FOR j FROM n MINUS one DOWN TO zero  
                IF the element at position j of the element at position i of board EQUALS the character X OR the element at position j of the element at position i of board EQUALS the character S  
                    CONTINUE to the next iteration  
                END IF  
                
                IF the element at position j of the element at position i of board NOT EQUALS the character E  
                    SET value TO the integer conversion of the element at position j of the element at position i of board  
                ELSE  
                    SET value TO zero  
                END IF  
                
                FOR each pair x AND y IN the list of pairs containing one AND zero zero AND one one AND one  
                    SET ni TO i PLUS x  
                    SET nj TO j PLUS y  
                    IF ni GREATER THAN OR EQUAL TO zero AND ni LESS THAN n AND nj GREATER THAN OR EQUAL TO zero AND nj LESS THAN n  
                        IF the first element of the element at position ni FOR rows AND nj FOR columns OF dp GREATER THAN the first element of the element at position i FOR rows AND j FOR columns OF dp  
                            SET the element at position i FOR rows AND j FOR columns OF dp TO a list where first element is the sum of the first element of the element at position ni FOR rows AND nj FOR columns OF dp AND value second element is the second element of the element at position ni FOR rows AND nj FOR columns OF dp  
                        ELSE IF the first element of the element at position ni FOR rows AND nj FOR columns OF dp EQUALS the first element of the element at position i FOR rows AND j FOR columns OF dp  
                            SET the second element of the element at position i FOR rows AND j FOR columns OF dp TO the sum of the second element of the element at position i FOR rows AND j FOR columns OF dp AND the second element of the element at position ni FOR rows AND nj FOR columns OF dp MODULO MOD  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
          
        IF the first element of the element at position zero FOR rows AND zero FOR columns OF dp EQUALS negative infinity  
            RETURN a list containing zero AND zero  
        END IF  
          
        RETURN a list containing the first element of the element at position zero FOR rows AND zero FOR columns OF dp AND the second element of the element at position zero FOR rows AND zero FOR columns OF dp  
    END FUNCTION  
END CLASS