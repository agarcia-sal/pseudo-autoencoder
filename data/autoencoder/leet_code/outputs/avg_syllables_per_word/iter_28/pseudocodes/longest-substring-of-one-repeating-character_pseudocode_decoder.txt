CLASS Solution  
    FUNCTION longestRepeating(s, queryCharacters, queryIndices)  
        FUNCTION merge_intervals()  
            SET i TO zero  
            WHILE i LESS THAN the LENGTH OF intervals MINUS one  
                SET start_i TO element at position zero of element at position i of intervals  
                SET end_i TO element at position one of element at position i of intervals  
                SET char_i TO element at position two of element at position i of intervals  
                SET start_next TO element at position zero of element at position i PLUS one of intervals  
                SET end_next TO element at position one of element at position i PLUS one of intervals  
                SET char_next TO element at position two of element at position i PLUS one of intervals  
                IF char_i EQUALS char_next  
                    SET new_interval TO start_i, end_next, char_i  
                    SET element at position i of intervals TO new_interval  
                    REMOVE element at position i PLUS one FROM intervals  
                ELSE  
                    INCREMENT i BY one  
                END IF  
            END WHILE  
        END FUNCTION  
        
        SET intervals TO an empty list  
        SET n TO the LENGTH OF s  
        SET start TO zero  
        FOR i FROM one TO n MINUS one  
            SET char_start TO element at position start of s  
            SET char_i TO element at position i of s  
            IF char_i NOT EQUALS char_start  
                SET new_interval TO start, i MINUS one, char_start  
                APPEND new_interval TO intervals  
                SET start TO i  
            END IF  
        END FOR  
        SET last_interval TO start, n MINUS one, element at position start of s  
        APPEND last_interval TO intervals  
        
        SET results TO an empty list  
        SET longest TO the MAXIMUM OF end MINUS start PLUS one FOR each start, end, char triple IN intervals  
        
        FOR each char, idx IN pairs from queryCharacters and queryIndices  
            SET i TO zero  
            WHILE i LESS THAN the LENGTH OF intervals  
                SET start_interval TO element at position zero of element at position i of intervals  
                SET end_interval TO element at position one of element at position i of intervals  
                SET char_interval TO element at position two of element at position i of intervals  
                IF start_interval LESS THAN OR EQUAL TO idx AND idx LESS THAN OR EQUAL TO end_interval  
                    BREAK  
                END IF  
                INCREMENT i BY one  
            END WHILE  
            
            IF idx GREATER THAN start_interval  
                SET left_interval TO start_interval, idx MINUS one, char_interval  
                INSERT left_interval INTO intervals AT position i  
                SET right_interval TO idx, end_interval, char_interval  
                SET element at position i PLUS one of intervals TO right_interval  
                INCREMENT i BY one  
            END IF  
            
            IF idx LESS THAN end_interval  
                SET right_interval TO idx PLUS one, end_interval, char_interval  
                INSERT right_interval INTO intervals AT position i PLUS one  
                SET left_interval TO start_interval, idx, char_interval  
                SET element at position i of intervals TO left_interval  
            END IF  
            
            SET updated_interval TO element at position zero of element at position i of intervals, element at position one of element at position i of intervals, char  
            SET element at position i of intervals TO updated_interval  
            
            CALL merge_intervals()  
            
            SET longest TO the MAXIMUM OF end MINUS start PLUS one FOR each start, end, char triple IN intervals  
            APPEND longest TO results  
        END FOR  
        
        RETURN results  
    END FUNCTION  
END CLASS