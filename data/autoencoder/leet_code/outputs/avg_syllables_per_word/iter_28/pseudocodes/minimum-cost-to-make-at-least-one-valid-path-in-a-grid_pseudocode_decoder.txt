CLASS Solution  
    FUNCTION minCost(grid)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF the element at position zero of grid  
        SET directions TO the list containing the pairs zero and one zero and MINUS one one and zero MINUS one and zero  
        SET costs TO a list containing m elements each being a list containing n elements each being infinity value  
        SET the element at position zero position zero of costs TO zero  
        
        SET pq TO a list containing a tuple of zero zero zero  
        SET visited TO an empty set  
        
        WHILE the LENGTH OF pq IS GREATER THAN zero  
            REMOVE the element with the smallest first component from pq AND ASSIGN the components TO cost i j  
            
            IF the pair i j IS IN visited THEN  
                CONTINUE to the next iteration of the WHILE loop  
            END IF  
            ADD the pair i j TO visited  
            
            IF i IS EQUALS m MINUS one AND j IS EQUALS n MINUS one THEN  
                RETURN cost  
            END IF  
            
            FOR k FROM zero TO the LENGTH OF directions MINUS one  
                SET di TO the first component of the element at position k of directions  
                SET dj TO the second component of the element at position k of directions  
                SET ni TO i PLUS di  
                SET nj TO j PLUS dj  
                IF ni IS GREATER THAN OR EQUAL TO zero AND ni IS LESS THAN m AND nj IS GREATER THAN OR EQUAL TO zero AND nj IS LESS THAN n THEN  
                    SET new_cost TO cost PLUS one IF k PLUS one IS NOT EQUALS the element at position i position j of grid OTHERWISE zero  
                    IF new_cost IS LESS THAN the element at position ni position nj of costs THEN  
                        SET the element at position ni position nj of costs TO new_cost  
                        ADD the tuple new_cost ni nj TO pq AND MAINTAIN pq AS A MINIMUM PRIORITY QUEUE BASED ON THE FIRST COMPONENT  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN MINUS one  
    END FUNCTION  
END CLASS