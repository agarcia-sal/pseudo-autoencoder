CLASS Solution  
    FUNCTION maximumBeauty(flowers)  
        ASSIGN reference TO a dictionary that returns an empty list for missing keys called indices  
        ASSIGN reference TO a list called prefix_sum with the length of the number of flowers PLUS one filled with zeros  
        
        FOR index FROM zero TO the length of flowers MINUS one  
            SET the element at position index PLUS one of prefix_sum TO the element at position index of prefix_sum PLUS the maximum of the element at position index of flowers AND zero  
            APPEND index TO the list associated with the element at position index of flowers in indices  
        END FOR  
        
        SET max_beauty TO negative infinity  
        
        FOR each beauty IN the keys of indices  
            IF the length of the list associated with beauty in indices IS GREATER THAN OR EQUAL TO two  
                SET first TO the element at position zero of the list associated with beauty in indices  
                SET last TO the element at the last position of the list associated with beauty in indices  
                
                SET current_beauty TO two MULTIPLIED BY beauty PLUS the element at position last of prefix_sum MINUS the element at position first PLUS one of prefix_sum  
                IF current_beauty IS GREATER THAN max_beauty  
                    SET max_beauty TO current_beauty  
                END IF  
            END IF  
        END FOR  
        
        RETURN max_beauty  
    END FUNCTION  
END CLASS