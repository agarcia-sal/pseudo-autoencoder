CLASS Solution  
    FUNCTION ways(pizza, k)  
        FUNCTION dfs(i, j, k)  
            IF k EQUALS zero  
                IF the element at position m of the list s at position n MINUS the element at position i of the list s at position n MINUS the element at position m of the list s at position j PLUS the element at position i of the list s at position j GREATER THAN zero  
                    RETURN one  
                ELSE  
                    RETURN zero  
                END IF  
            END IF  
            SET ans TO zero  
            FOR x FROM i PLUS one TO m MINUS one  
                IF the element at position x of the list s at position n MINUS the element at position i of the list s at position n MINUS the element at position x of the list s at position j PLUS the element at position i of the list s at position j GREATER THAN zero  
                    INCREMENT ans BY dfs(x, j, k MINUS one)  
                END IF  
            END FOR  
            FOR y FROM j PLUS one TO n MINUS one  
                IF the element at position m of the list s at position y MINUS the element at position i of the list s at position y MINUS the element at position m of the list s at position j PLUS the element at position i of the list s at position j GREATER THAN zero  
                    INCREMENT ans BY dfs(i, y, k MINUS one)  
                END IF  
            END FOR  
            RETURN ans MODULO mod  
        END FUNCTION  

        SET mod TO one billion PLUS seven  
        SET m TO the length of the list pizza  
        SET n TO the length of the element at position zero of the list pizza  
        SET s TO a list of lists of zeros with length m PLUS one by n PLUS one  
        FOR i FROM one TO m  
            SET row TO the element at position i MINUS one of the list pizza  
            FOR j FROM one TO n  
                SET c TO the element at position j MINUS one of the string row  
                SET the element at position i of the list s at position j TO the sum of the element at position i MINUS one of the list s at position j PLUS the element at position i of the list s at position j MINUS one MINUS the element at position i MINUS one of the list s at position j MINUS one PLUS one IF c EQUALS the character A OTHERWISE zero  
            END FOR  
        END FOR  
        RETURN dfs(zero, zero, k MINUS one)  
    END FUNCTION  
END CLASS