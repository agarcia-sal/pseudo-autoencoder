CLASS Solution  
    FUNCTION isPrintable(targetGrid)  
        SET color_bounds TO default dictionary with default value as list of four elements: positive infinity positive infinity negative infinity negative infinity  
        FOR each row_index FROM zero TO the LENGTH OF targetGrid MINUS one  
            FOR each column_index FROM zero TO the LENGTH OF element at position row_index of targetGrid MINUS one  
                SET color TO element at position row_index of targetGrid at position column_index  
                SET element at position zero of color_bounds at key color TO the LESS THAN of element at position zero of color_bounds at key color AND row_index  
                SET element at position one of color_bounds at key color TO the LESS THAN of element at position one of color_bounds at key color AND column_index  
                SET element at position two of color_bounds at key color TO the GREATER THAN of element at position two of color_bounds at key color AND row_index  
                SET element at position three of color_bounds at key color TO the GREATER THAN of element at position three of color_bounds at key color AND column_index  
            END FOR  
        END FOR  
        
        SET graph TO default dictionary of empty list  
        SET in_degree TO default dictionary of zero  
        
        FOR each color and the tuple of min_row min_column max_row max_column IN color_bounds items  
            FOR each row_index FROM min_row TO max_row  
                FOR each column_index FROM min_column TO max_column  
                    IF element at position row_index of targetGrid at position column_index NOT EQUALS color THEN  
                        SET other_color TO element at position row_index of targetGrid at position column_index  
                        APPEND color TO list at key other_color in graph  
                        INCREMENT in_degree at key color BY one  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        SET queue TO empty double-ended queue containing all colors in color_bounds for which in_degree at key color EQUALS zero  
        SET visited_colors TO zero  
        
        WHILE the LENGTH OF queue GREATER THAN zero  
            REMOVE and SET color TO the element popped from the front of queue  
            INCREMENT visited_colors BY one  
            FOR each next_color IN list at key color in graph  
                DECREMENT in_degree at key next_color BY one  
                IF in_degree at key next_color EQUALS zero THEN  
                    APPEND next_color TO queue  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN visited_colors EQUALS the LENGTH OF color_bounds  
    END FUNCTION  
END CLASS