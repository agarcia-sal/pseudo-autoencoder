CLASS Solution  
    FUNCTION maxEnvelopes(envelopes)  
        SORT envelopes IN ascending order BY element at position one AND IN descending order BY negative of element at position two  
        SET dp TO empty list  
        FOR each pair of underscore and h IN envelopes  
            SET idx TO position found by binary searching for the leftmost place to insert h in dp keeping dp sorted  
            IF idx EQUALS the LENGTH OF dp  
                APPEND h TO dp  
            ELSE  
                SET element at position idx of dp TO h  
            END IF  
        END FOR  
        RETURN the LENGTH OF dp  
    END FUNCTION  
END CLASS