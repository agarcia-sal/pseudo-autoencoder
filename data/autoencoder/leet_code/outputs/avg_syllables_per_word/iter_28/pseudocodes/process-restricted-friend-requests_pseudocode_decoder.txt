CLASS UnionFind  
    FUNCTION __init__(self n)  
        SET self parent TO the list of all integers FROM zero TO n MINUS one  
        SET self size TO the list containing the integer one REPEATED n times  
    END FUNCTION  

    FUNCTION find(self u)  
        IF the element at position u of self parent NOT EQUALS u  
            SET the element at position u of self parent TO the result of calling find with the element at position u of self parent  
        END IF  
        RETURN the element at position u of self parent  
    END FUNCTION  

    FUNCTION union(self u v)  
        SET root_u TO the result of calling find with u  
        SET root_v TO the result of calling find with v  
        IF root_u NOT EQUALS root_v  
            IF the element at position root_u of self size GREATER THAN the element at position root_v of self size  
                SET the element at position root_v of self parent TO root_u  
                SET the element at position root_u of self size TO the element at position root_u of self size PLUS the element at position root_v of self size  
            ELSE  
                SET the element at position root_u of self parent TO root_v  
                SET the element at position root_v of self size TO the element at position root_v of self size PLUS the element at position root_u of self size  
            END IF  
        END IF  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION friendRequests(self n restrictions requests)  
        SET uf TO a new instance of UnionFind with n  
        SET result TO an empty list  
        SET restriction_map TO an empty dictionary  

        FOR each pair x y IN restrictions  
            IF x NOT IN restriction_map  
                SET the element at key x of restriction_map TO an empty set  
            END IF  
            IF y NOT IN restriction_map  
                SET the element at key y of restriction_map TO an empty set  
            END IF  
            ADD y TO the set at key x of restriction_map  
            ADD x TO the set at key y of restriction_map  
        END FOR  

        FUNCTION can_union(u v)  
            SET root_u TO the result of calling uf find with u  
            SET root_v TO the result of calling uf find with v  
            FOR each person IN the set at key root_u of restriction_map IF key root_u EXISTS otherwise an empty set  
                IF the result of calling uf find with person EQUALS root_v  
                    RETURN False  
                END IF  
            END FOR  
            FOR each person IN the set at key root_v of restriction_map IF key root_v EXISTS otherwise an empty set  
                IF the result of calling uf find with person EQUALS root_u  
                    RETURN False  
                END IF  
            END FOR  
            RETURN True  
        END FUNCTION  

        FOR each pair u v IN requests  
            IF the result of calling uf find with u EQUALS the result of calling uf find with v  
                APPEND True TO result  
            ELSE IF calling can_union with u and v RETURNS True  
                CALL uf union with u and v  
                APPEND True TO result  
            ELSE  
                APPEND False TO result  
            END IF  
        END FOR  

        RETURN result  
    END FUNCTION  
END CLASS