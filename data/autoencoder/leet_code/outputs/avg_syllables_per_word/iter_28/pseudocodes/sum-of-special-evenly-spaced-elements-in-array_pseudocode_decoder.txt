CLASS Solution  
    FUNCTION solve(nums list of integers queries list of list of integers) RETURNS list of integers  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF nums  

        SET max_y TO the MAXIMUM value of the second element of each pair in queries  
        SET prefix_sums TO a list containing max_y PLUS one elements each being a list of n zeros  

        FOR y FROM one TO max_y  
            FOR i FROM n MINUS one DOWNTO zero  
                IF i PLUS y LESS THAN n THEN  
                    SET element at position i of prefix_sums at position y TO element at position i of nums PLUS element at position i PLUS y of prefix_sums at position y  
                ELSE  
                    SET element at position i of prefix_sums at position y TO element at position i of nums  
                END IF  
            END FOR  
        END FOR  

        SET answer TO an empty list  
        FOR each pair x y IN queries  
            APPEND the remainder of element at position x of prefix_sums at position y DIVIDED BY MOD TO answer  
        END FOR  

        RETURN answer  
    END FUNCTION  
END CLASS