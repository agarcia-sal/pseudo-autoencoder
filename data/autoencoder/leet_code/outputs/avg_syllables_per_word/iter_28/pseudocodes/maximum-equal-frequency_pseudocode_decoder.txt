CLASS Solution  
    FUNCTION maxEqualFreq(nums)  
        SET count TO a new empty frequency counter  
        SET freq TO a new empty frequency counter for frequencies  
        SET max_len TO zero  
        
        FOR each index i FROM zero TO the length of nums MINUS one  
            SET num TO element at position i of nums  
            INCREMENT the count of num BY one in count  
            
            IF the count of num GREATER THAN one THEN  
                DECREMENT the frequency of the count of num MINUS one BY one in freq  
                IF the frequency of the count of num MINUS one EQUALS zero THEN  
                    REMOVE the frequency entry for count of num MINUS one FROM freq  
                END IF  
            END IF  
            
            INCREMENT the frequency of the count of num BY one in freq  
            
            IF the length of freq EQUALS one AND (freq HAS key one OR the first value in freq EQUALS one) THEN  
                SET max_len TO i PLUS one  
            ELSE IF the length of freq EQUALS two AND  
                ((freq HAS key one AND the frequency of key one EQUALS one) OR  
                 (the difference BETWEEN the maximum key in freq AND the minimum key in freq EQUALS one AND the frequency of the maximum key EQUALS one)) THEN  
                SET max_len TO i PLUS one  
            END IF  
        END FOR  
        
        RETURN max_len  
    END FUNCTION  
END CLASS