CLASS Solution  
    FUNCTION largestRectangleArea WITH PARAMETERS heights  
        SET stack TO list containing element negative one  
        SET max_area TO zero  
        APPEND element zero TO heights  
        FOR each index value i AND height value h IN enumeration of heights  
            WHILE element at last position of stack NOT EQUALS negative one AND height h LESS THAN element at position element at last position of stack of heights  
                SET height TO element at position result of removing last element from stack of heights  
                SET width TO index i MINUS element at last position of stack MINUS one  
                SET max_area TO the greater value BETWEEN max_area AND height MULTIPLIED BY width  
            END WHILE  
            APPEND index i TO stack  
        END FOR  
        RETURN max_area  
    END FUNCTION  
END CLASS