CLASS Solution  
    FUNCTION pacificAtlantic(heights)  
        FUNCTION bfs(q, vis)  
            WHILE q is not empty  
                FOR count FROM one TO the LENGTH OF q  
                    ASSIGN i and j TO the FIRST element REMOVED FROM the FRONT OF q  
                    FOR each pair a and b IN the list of pairs where a and b are zero and negative one then zero and one then one and zero then negative one and zero  
                        SET x TO i PLUS a  
                        SET y TO j PLUS b  
                        IF zero LESS THAN OR EQUAL TO x AND x LESS THAN m AND zero LESS THAN OR EQUAL TO y AND y LESS THAN n AND the pair of x and y NOT IN vis AND the element at position x and y of heights GREATER THAN OR EQUAL TO the element at position i and j of heights THEN  
                            ADD the pair of x and y TO vis  
                            ADD the pair of x and y TO the end of q  
                        END IF  
                    END FOR  
                END FOR  
            END WHILE  
        END FUNCTION  
      
        SET m TO the LENGTH OF heights  
        SET n TO the LENGTH OF the element at position zero of heights  
        CREATE vis1 as an empty set  
        CREATE vis2 as an empty set  
        CREATE q1 as an empty double ended queue  
        CREATE q2 as an empty double ended queue  
      
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF i EQUALS zero OR j EQUALS zero THEN  
                    ADD the pair of i and j TO vis1  
                    ADD the pair of i and j TO the end of q1  
                END IF  
                IF i EQUALS m MINUS one OR j EQUALS n MINUS one THEN  
                    ADD the pair of i and j TO vis2  
                    ADD the pair of i and j TO the end of q2  
                END IF  
            END FOR  
        END FOR  
      
        CALL bfs WITH q1 AND vis1  
        CALL bfs WITH q2 AND vis2  
      
        CREATE result as an empty list  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF the pair of i and j IN vis1 AND the pair of i and j IN vis2 THEN  
                    ADD the pair of i and j TO result  
                END IF  
            END FOR  
        END FOR  
      
        RETURN result  
    END FUNCTION  
END CLASS