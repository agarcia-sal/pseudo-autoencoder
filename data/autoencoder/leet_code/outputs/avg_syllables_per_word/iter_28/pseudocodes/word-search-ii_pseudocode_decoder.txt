CLASS Trie  
    FUNCTION __init__()  
        SET children TO list of twenty six None elements  
        SET ref TO minus one  
    END FUNCTION  

    FUNCTION insert(w, ref)  
        SET node TO this Trie instance  
        FOR each character c IN w  
            SET idx TO the ordinal value of character c MINUS the ordinal value of character a  
            IF element at position idx of node children EQUALS None THEN  
                SET element at position idx of node children TO a new Trie instance  
            END IF  
            SET node TO element at position idx of node children  
        END FOR  
        SET node ref TO ref  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION findWords(board, words)  
        FUNCTION dfs(node, i, j)  
            SET idx TO the ordinal value of element at position i of board AT position j MINUS the ordinal value of character a  
            IF element at position idx of node children EQUALS None THEN  
                RETURN  
            END IF  
            SET node TO element at position idx of node children  
            IF node ref GREATER THAN OR EQUAL TO zero THEN  
                APPEND element at position node ref of words TO ans  
                SET node ref TO minus one  
            END IF  
            SET c TO element at position i of board AT position j  
            SET element at position i of board AT position j TO the character hash symbol  
            FOR each pair of consecutive elements a and b IN the sequence of minus one zero one zero minus one  
                SET x TO i PLUS a  
                SET y TO j PLUS b  
                IF x GREATER THAN OR EQUAL TO zero AND x LESS THAN m AND y GREATER THAN OR EQUAL TO zero AND y LESS THAN n AND element at position x of board AT position y NOT EQUALS character hash symbol THEN  
                    CALL dfs WITH node AND x AND y  
                END IF  
            END FOR  
            SET element at position i of board AT position j TO c  
        END FUNCTION  

        SET tree TO a new Trie instance  
        FOR each index i AND word w in enumerated words  
            CALL insert method of tree WITH w AND i  
        END FOR  
        SET m TO the length of board  
        SET n TO the length of element at position zero of board  
        SET ans TO empty list  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                CALL dfs WITH tree AND i AND j  
            END FOR  
        END FOR  
        RETURN ans  
    END FUNCTION  
END CLASS