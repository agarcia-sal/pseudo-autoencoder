CLASS Solution  
    FUNCTION countSmaller(nums)  
        SET sorted_nums TO the SORTED LIST OF UNIQUE ELEMENTS IN nums  
        SET rank TO an EMPTY DICTIONARY  
        SET index TO zero  
        FOR each value IN sorted_nums  
            INCREMENT index BY one  
            SET the ENTRY in rank with KEY value TO index  
        END FOR  
        
        SET bit TO a LIST of zeros WITH LENGTH the LENGTH OF sorted_nums PLUS one  
        
        FUNCTION get_sum(idx)  
            SET result TO zero  
            WHILE idx GREATER THAN zero  
                INCREMENT result BY the ELEMENT at POSITION idx OF bit  
                SET idx TO idx MINUS THE BITWISE AND OF idx AND THE NEGATION OF idx  
            END WHILE  
            RETURN result  
        END FUNCTION  
        
        FUNCTION update(idx, delta)  
            WHILE idx LESS THAN the LENGTH OF bit  
                INCREMENT the ELEMENT at POSITION idx OF bit BY delta  
                SET idx TO idx PLUS THE BITWISE AND OF idx AND THE NEGATION OF idx  
            END WHILE  
        END FUNCTION  
        
        SET counts TO an EMPTY LIST  
        FOR each num IN the REVERSED ORDER OF nums  
            SET r TO the VALUE in rank WITH KEY num  
            APPEND THE RESULT OF get_sum THE VALUE r MINUS one TO counts  
            CALL update WITH ARGUMENTS r AND one  
        END FOR  
        
        RETURN the REVERSED ORDER OF counts  
    END FUNCTION  
END CLASS