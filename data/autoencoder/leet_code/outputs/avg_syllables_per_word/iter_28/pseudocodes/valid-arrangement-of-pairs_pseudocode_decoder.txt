CLASS Solution  
    FUNCTION validArrangement(pairs)  
        SET graph TO a new mapping from elements to empty lists by default  
        SET out_degree TO a new counting mapping with default zero values  
        SET in_degree TO a new counting mapping with default zero values  
        
        FOR each element pair consisting of u and v IN pairs  
            APPEND element v TO the list corresponding to element u in graph  
            INCREMENT the count for element u in out_degree BY one  
            INCREMENT the count for element v in in_degree BY one  
        END FOR  
        
        SET start_node TO no value  
        FOR each element node IN the keys of graph  
            IF the count for element node in out_degree EQUALS the count for element node in in_degree PLUS one THEN  
                SET start_node TO element node  
                BREAK out of the loop  
            END IF  
        END FOR  
        IF start_node HAS no value THEN  
            SET start_node TO the first element from the iterator of the keys of graph  
        END IF  
        
        SET path TO an empty list  
        SET stack TO a list containing start_node  
        
        WHILE the stack is not empty DO  
            SET u TO the last element of stack  
            IF the list corresponding to u in graph is not empty THEN  
                SET v TO the last element of the list corresponding to u in graph  
                REMOVE the last element from the list corresponding to u in graph  
                APPEND element v TO stack  
            ELSE  
                APPEND the last element removed from stack TO path  
            END IF  
        END WHILE  
        
        REVERSE the order of elements in path  
        
        SET result TO an empty list  
        FOR index i FROM zero TO the number of elements in path MINUS two DO  
            APPEND to result a list containing element at position i of path and element at position i PLUS one of path  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS