CLASS Solution  
    FUNCTION maskPII WITH PARAMETER s  
        IF the character at position representing at symbol IS IN s  
            SET position_of_at_symbol TO the position of the character representing at symbol in s  
            SET local_part TO substring from the start position TO the position one before position_of_at_symbol of s  
            SET domain_part TO substring from the position one after position_of_at_symbol TO the end position of s  
            SET first_character_of_local TO the character at the start position of local_part  
            SET last_character_of_local TO the character at the end position of local_part  
            SET masked_local_part TO first_character_of_local PLUS five repetitions of the word asterisk PLUS last_character_of_local  
            SET result TO the lowercase form of masked_local_part PLUS the character representing at symbol PLUS the lowercase form of domain_part  
            RETURN result  
        ELSE  
            SET digits_only_string TO empty string  
            FOR each character IN s  
                IF the character represents a digit  
                    APPEND character TO digits_only_string  
                END IF  
            END FOR  
            SET length_of_digits TO the number of characters in digits_only_string  
            SET last_four_digits TO substring consisting of the last four characters of digits_only_string  
            SET local_number_mask TO the concatenation of three asterisks PLUS hyphen PLUS three asterisks PLUS hyphen PLUS last_four_digits  
            IF length_of_digits EQUALS ten  
                RETURN local_number_mask  
            ELSE  
                SET country_code_length TO length_of_digits MINUS ten  
                SET country_code_mask TO the concatenation of the character representing plus sign PLUS country_code_length repetitions of the word asterisk PLUS hyphen  
                RETURN country_code_mask PLUS local_number_mask  
            END IF  
        END IF  
    END FUNCTION  
END CLASS