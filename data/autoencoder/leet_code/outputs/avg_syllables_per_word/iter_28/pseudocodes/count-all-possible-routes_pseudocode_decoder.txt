CLASS Solution  
    FUNCTION countRoutes(locations parameter, start parameter, finish parameter, fuel parameter) RETURNS integer  
        SET MOD TO ten raised to the power of nine PLUS one  
        SET n TO the LENGTH OF locations parameter  
        
        FUNCTION dp(city parameter, remaining_fuel parameter) RETURNS integer  
            IF remaining_fuel parameter LESS THAN zero THEN  
                RETURN zero  
            END IF  
            SET routes TO zero  
            IF city parameter EQUALS finish parameter THEN  
                SET routes TO one  
            END IF  
            FOR each next_city parameter FROM zero TO n MINUS one DO  
                IF next_city parameter NOT EQUALS city parameter THEN  
                    SET fuel_cost TO the ABSOLUTE VALUE OF the difference BETWEEN element at position city parameter of locations parameter AND element at position next_city parameter of locations parameter  
                    IF remaining_fuel parameter GREATER THAN OR EQUAL TO fuel_cost THEN  
                        SET routes TO the sum of routes PLUS the result of dp called with next_city parameter AND remaining_fuel parameter MINUS fuel_cost THEN THE REMAINDER AFTER DIVIDING BY MOD  
                    END IF  
                END IF  
            END FOR  
            RETURN routes  
        END FUNCTION  
        
        RETURN the result of calling dp with start parameter AND fuel parameter  
    END FUNCTION  
END CLASS