CLASS Solution  
    FUNCTION canMouseWin(grid, catJump, mouseJump)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero of grid  
        SET cat_start TO zero  
        SET mouse_start TO zero  
        SET food TO zero  
        SET dirs TO the sequence consisting of minus one zero one zero minus one  
        SET g_mouse TO a list containing an empty list repeated m MULTIPLIED BY n times  
        SET g_cat TO a list containing an empty list repeated m MULTIPLIED BY n times  
        
        FOR variable i AND row IN enumeration of grid  
            FOR variable j AND c IN enumeration of row  
                IF c EQUALS the character hash  
                    CONTINUE to next iteration  
                END IF  
                SET v TO i MULTIPLIED BY n PLUS j  
                IF c EQUALS the character C  
                    SET cat_start TO v  
                ELSE IF c EQUALS the character M  
                    SET mouse_start TO v  
                ELSE IF c EQUALS the character F  
                    SET food TO v  
                END IF  
                FOR variable a AND b IN pairwise of dirs  
                    FOR variable k FROM zero TO mouseJump  
                        SET x TO i PLUS k MULTIPLIED BY a  
                        SET y TO j PLUS k MULTIPLIED BY b  
                        IF x LESS THAN zero OR x GREATER THAN OR EQUAL TO m OR y LESS THAN zero OR y GREATER THAN OR EQUAL TO n OR element at position x of grid NOT EQUALS the character hash AND element at position y of element at position x of grid EQUALS the character hash  
                            BREAK the inner loop  
                        END IF  
                        APPEND x MULTIPLIED BY n PLUS y TO element at position v of g_mouse  
                    END FOR  
                    FOR variable k FROM zero TO catJump  
                        SET x TO i PLUS k MULTIPLIED BY a  
                        SET y TO j PLUS k MULTIPLIED BY b  
                        IF x LESS THAN zero OR x GREATER THAN OR EQUAL TO m OR y LESS THAN zero OR y GREATER THAN OR EQUAL TO n OR element at position x of grid NOT EQUALS the character hash AND element at position y of element at position x of grid EQUALS the character hash  
                            BREAK the inner loop  
                        END IF  
                        APPEND x MULTIPLIED BY n PLUS y TO element at position v of g_cat  
                    END FOR  
                END FOR  
            END FOR  
        END FOR  
        RETURN the EQUALITY of the RESULT of calling self dot calc with arguments g_mouse g_cat mouse_start cat_start food TO the number one  
    END FUNCTION  

    FUNCTION calc(g_mouse, g_cat, mouse_start, cat_start, hole)  
        FUNCTION get_prev_states(state)  
            SET m TO element at position zero of state  
            SET c TO element at position one of state  
            SET t TO element at position two of state  
            SET pt TO the bitwise exclusive OR of t WITH one  
            SET pre TO an empty list  
            IF pt EQUALS one  
                FOR variable pc IN element at position c of g_cat  
                    IF element at position m of ans at position pc at position one EQUALS zero  
                        APPEND the tuple consisting of m pc pt TO pre  
                    END IF  
                END FOR  
            ELSE  
                FOR variable pm IN element at position m of g_mouse  
                    IF element at position pm of ans at position c at position zero EQUALS zero  
                        APPEND the tuple consisting of pm c zero TO pre  
                    END IF  
                END FOR  
            END IF  
            RETURN pre  
        END FUNCTION  
        
        SET n TO the LENGTH OF g_mouse  
        SET degree TO a three-dimensional list containing the pair zero zero repeated n times in the second and third dimensions  
        
        FOR variable i FROM zero TO n MINUS one  
            FOR variable j FROM zero TO n MINUS one  
                SET element at position i of element at position j of degree at position zero TO the LENGTH OF element at position i of g_mouse  
                SET element at position i of element at position j of degree at position one TO the LENGTH OF element at position j of g_cat  
            END FOR  
        END FOR  
        
        SET ans TO a three-dimensional list containing the pair zero zero repeated n times in the second and third dimensions  
        SET q TO an empty deque  
        
        FOR variable i FROM zero TO n MINUS one  
            SET element at position hole of element at position i of ans at position one TO one  
            SET element at position i of element at position hole of ans at position zero TO two  
            SET element at position i of element at position i of ans at position one TO two  
            SET element at position i of element at position i of ans at position zero TO two  
            APPEND the tuple consisting of hole i one TO q  
            APPEND the tuple consisting of i hole zero TO q  
            APPEND the tuple consisting of i i zero TO q  
            APPEND the tuple consisting of i i one TO q  
        END FOR  
        
        WHILE q is not empty  
            SET state TO the result of popping from the left of q  
            SET t TO element at position zero of ans at position element at position one of state at position one at position element at position two of state  
            FOR prev_state IN the RESULT of calling get_prev_states with argument state  
                SET pm TO element at position zero of prev_state  
                SET pc TO element at position one of prev_state  
                SET pt TO element at position two of prev_state  
                IF pt EQUALS t MINUS one  
                    SET element at position pm of element at position pc of ans at position pt TO t  
                    APPEND prev_state TO q  
                ELSE  
                    DECREMENT element at position pm of element at position pc of degree at position pt BY one  
                    IF element at position pm of element at position pc of degree at position pt EQUALS zero  
                        SET element at position pm of element at position pc of ans at position pt TO t  
                        APPEND prev_state TO q  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN element at position mouse_start of element at position cat_start of ans at position zero  
    END FUNCTION  
END CLASS