CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MOD TO one billion PLUS seven  
        SORT arr in ascending order  
        CREATE dp mapping each number in arr TO one  

        FOR each index i FROM zero TO the LENGTH OF arr MINUS one  
            SET num TO element at position i of arr  
            FOR each index j FROM zero TO i MINUS one  
                SET factor_candidate TO element at position j of arr  
                IF the remainder of num DIVIDED BY factor_candidate EQUALS zero THEN  
                    SET right_child TO num DIVIDED BY factor_candidate  
                    IF right_child EXISTS AS A KEY IN dp THEN  
                        SET dp[num] TO dp[num] PLUS dp[factor_candidate] MULTIPLIED BY dp[right_child]  
                        SET dp[num] TO dp[num] MODULO MOD  
                    END IF  
                END IF  
            END FOR  
        END FOR  

        SET total_trees TO the SUM OF all values in dp  
        SET total_trees TO total_trees MODULO MOD  
        RETURN total_trees  
    END FUNCTION  
END CLASS