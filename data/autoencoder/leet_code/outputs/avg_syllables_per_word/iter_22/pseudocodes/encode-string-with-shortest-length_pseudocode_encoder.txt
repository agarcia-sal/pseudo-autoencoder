CLASS Solution  
    FUNCTION encode(s)  
        FUNCTION get_encoded_length(count, substring)  
            RETURN the LENGTH OF the string representation of count PLUS the LENGTH OF substring PLUS two  
        END FUNCTION  
        
        FUNCTION dp(i, j)  
            SET substring TO the piece of s from position i TO position j inclusive  
            SET n TO j MINUS i PLUS one  
            IF n LESS THAN five THEN  
                RETURN substring  
            END IF  
            
            SET shortest TO substring  
            FOR k FROM one TO the INTEGER division of n BY two PLUS one  
                IF n MODULO k EQUALS zero THEN  
                    SET repeat_count TO the INTEGER division of n BY k  
                    IF substring EQUALS the concatenation of the piece of substring from position zero TO position k MINUS one MULTIPLIED BY repeat_count THEN  
                        SET encoded_candidate TO the concatenation of  
                            the string representation of repeat_count PLUS an opening bracket PLUS  
                            the result of dp(i, i PLUS k MINUS one) PLUS a closing bracket  
                        IF the LENGTH OF encoded_candidate LESS THAN the LENGTH OF shortest THEN  
                            SET shortest TO encoded_candidate  
                        END IF  
                    END IF  
                END IF  
            END FOR  
            
            FOR k FROM i TO j MINUS one  
                SET left_encoded TO dp(i, k)  
                SET right_encoded TO dp(k PLUS one, j)  
                SET combined TO the concatenation of left_encoded PLUS right_encoded  
                IF the LENGTH OF combined LESS THAN the LENGTH OF shortest THEN  
                    SET shortest TO combined  
                END IF  
            END FOR  
            
            RETURN shortest  
        END FUNCTION  
        
        RETURN dp(zero, the LENGTH OF s MINUS one)  
    END FUNCTION  
END CLASS