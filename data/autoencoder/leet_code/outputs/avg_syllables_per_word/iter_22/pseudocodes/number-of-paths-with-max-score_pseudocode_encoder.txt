CLASS Solution  
    FUNCTION pathsWithMaxScore(board)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF board  
        SET dp TO two dimensional list of size n BY n where each element is a list with the first item set to negative infinity and the second item set to zero  
        SET the element at position n MINUS one BY n MINUS one of dp TO a list with first item zero and second item one  
        FOR i FROM n MINUS one DOWN TO zero  
            FOR j FROM n MINUS one DOWN TO zero  
                IF element at position i OF board EQUALS 'X' OR element at position i OF board EQUALS 'S' THEN  
                    CONTINUE to next iteration  
                END IF  
                IF element at position i BY j OF board NOT EQUALS 'E' THEN  
                    SET value TO the integer value of the element at position i BY j OF board  
                ELSE  
                    SET value TO zero  
                END IF  
                FOR each ordered pair x y IN list containing the ordered pairs one zero zero one and one one  
                    SET ni TO i PLUS x  
                    SET nj TO j PLUS y  
                    IF ni GREATER THAN OR EQUAL TO zero AND ni LESS THAN n AND nj GREATER THAN OR EQUAL TO zero AND nj LESS THAN n THEN  
                        IF the first item of the element at position ni BY nj of dp GREATER THAN the first item of the element at position i BY j of dp THEN  
                            SET the element at position i BY j of dp TO a list with the first item being the first item of the element at position ni BY nj of dp PLUS value and the second item being the second item of the element at position ni BY nj of dp  
                        ELSE IF the first item of the element at position ni BY nj of dp EQUALS the first item of the element at position i BY j of dp THEN  
                            SET the second item of the element at position i BY j of dp TO the second item of the element at position i BY j of dp PLUS the second item of the element at position ni BY nj of dp MODULO MOD  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        IF the first item of the element at position zero BY zero of dp EQUALS negative infinity THEN  
            RETURN list containing zero and zero  
        END IF  
        RETURN list containing the first item of the element at position zero BY zero of dp and the second item of the element at position zero BY zero of dp  
    END FUNCTION  
END CLASS