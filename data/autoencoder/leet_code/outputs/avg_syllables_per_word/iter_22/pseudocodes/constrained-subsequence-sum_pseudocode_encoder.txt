CLASS Solution  
    FUNCTION constrainedSubsetSum(nums k)  
        SET n TO the LENGTH OF nums  
        SET dp TO a list of zeros of LENGTH n  
        SET element at position zero of dp TO element at position zero of nums  
        SET max_sum TO element at position zero of nums  
        ASSIGN reference TO a new empty double-ended queue containing element at position zero  
        
        FOR i FROM one TO n MINUS one  
            IF element at position element at position zero of reference of dp GREATER THAN zero  
                SET value TO element at position element at position zero of reference of dp  
            ELSE  
                SET value TO zero  
            END IF  
            SET element at position i of dp TO element at position i of nums PLUS value  
            IF max_sum LESS THAN element at position i of dp  
                SET max_sum TO element at position i of dp  
            END IF  
            WHILE reference is not empty AND element at position i of dp GREATER THAN OR EQUAL TO element at position element at last position of reference of dp  
                REMOVE last element FROM reference  
            END WHILE  
            APPEND i TO reference  
            IF element at position zero of reference EQUALS i MINUS k  
                REMOVE first element FROM reference  
            END IF  
        END FOR  
        RETURN max_sum  
    END FUNCTION  
END CLASS