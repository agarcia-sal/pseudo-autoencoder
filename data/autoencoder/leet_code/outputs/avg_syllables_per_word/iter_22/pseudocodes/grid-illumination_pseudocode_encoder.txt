CLASS Solution  
    FUNCTION gridIllumination(n parameter lamps parameter queries parameter)  
        SET row_count TO an empty mapping from elements TO integer initialized with zero  
        SET col_count TO an empty mapping from elements TO integer initialized with zero  
        SET diag_count TO an empty mapping from elements TO integer initialized with zero  
        SET anti_diag_count TO an empty mapping from elements TO integer initialized with zero  
        SET lamp_positions TO an empty collection of unique positions  
        
        FOR each pair r and c IN lamps  
            IF the pair r and c is NOT contained IN lamp_positions  
                ADD the pair r and c TO lamp_positions  
                INCREMENT the value at key r in row_count BY one  
                INCREMENT the value at key c in col_count BY one  
                INCREMENT the value at key the result of r MINUS c in diag_count BY one  
                INCREMENT the value at key the result of r PLUS c in anti_diag_count BY one  
            END IF  
        END FOR  
        
        SET directions TO the collection of pairs consisting of the first element MINUS one and second element MINUS one, first element MINUS one and zero, first element MINUS one and second element PLUS one, zero and second element MINUS one, zero and zero, zero and second element PLUS one, first element PLUS one and second element MINUS one, first element PLUS one and zero, first element PLUS one and second element PLUS one  
        
        SET result TO an empty list  
        
        FOR each pair r and c IN queries  
            IF the value at key r in row_count IS GREATER THAN zero OR the value at key c in col_count IS GREATER THAN zero OR the value at key the result of r MINUS c in diag_count IS GREATER THAN zero OR the value at key the result of r PLUS c in anti_diag_count IS GREATER THAN zero  
                APPEND one TO result  
            ELSE  
                APPEND zero TO result  
            END IF  
            
            FOR each pair dr and dc IN directions  
                SET nr TO the result of r PLUS dr  
                SET nc TO the result of c PLUS dc  
                IF the pair nr and nc IS CONTAINED IN lamp_positions  
                    REMOVE the pair nr and nc FROM lamp_positions  
                    DECREMENT the value at key nr in row_count BY one  
                    DECREMENT the value at key nc in col_count BY one  
                    DECREMENT the value at key the result of nr MINUS nc in diag_count BY one  
                    DECREMENT the value at key the result of nr PLUS nc in anti_diag_count BY one  
                END IF  
            END FOR  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS