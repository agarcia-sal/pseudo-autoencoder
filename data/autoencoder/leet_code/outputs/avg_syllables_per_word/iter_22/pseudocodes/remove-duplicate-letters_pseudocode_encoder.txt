CLASS Solution  
    FUNCTION removeDuplicateLetters WITH PARAMETER s  
        CREATE last_occurrence DICTIONARY WHERE each character IN s IS ASSOCIATED WITH its last position index IN s  
        CREATE stack AS empty list  
        CREATE in_stack AS empty set  
        FOR each index idx AND character char IN s WITH POSITION as index  
            IF char IS IN in_stack THEN  
                CONTINUE to next iteration  
            END IF  
            WHILE the stack IS NOT empty AND the character char IS LESS THAN the character at the last position of the stack AND the index idx IS LESS THAN the last position of the character at the last position of the stack IN last_occurrence  
                REMOVE the character at the last position OF stack AND ASSIGN TO removed_char  
                REMOVE removed_char FROM in_stack  
            END WHILE  
            APPEND char TO stack  
            ADD char TO in_stack  
        END FOR  
        RETURN the concatenation of all characters IN stack AS a single string  
    END FUNCTION  
END CLASS