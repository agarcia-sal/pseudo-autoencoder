CLASS Solution  
    FUNCTION maxEnvelopes(envelopes)  
        SORT envelopes BY element at position one of each envelope IN ascending order AND BY element at position two of each envelope IN descending order WHEN element at position one OF envelopes ARE EQUAL  
        SET dp TO an empty list  
        FOR each envelope IN envelopes  
            SET height TO element at position two of envelope  
            SET index TO position obtained by performing binary search on dp to find leftmost position where height CAN BE INSERTED to keep dp sorted  
            IF index EQUALS the LENGTH OF dp THEN  
                APPEND height TO dp  
            ELSE  
                SET element at position index of dp TO height  
            END IF  
        END FOR  
        RETURN the LENGTH OF dp  
    END FUNCTION  
END CLASS