CLASS Solution  
    FUNCTION minNumberOfSemesters(n, relations, k)  
        SET graph TO a mapping from each course to an empty list  
        SET in_degree TO a list of zeros with length equal to n PLUS one  

        FOR each pair of previous course and next course IN relations  
            APPEND next course TO the list of next courses for the previous course in graph  
            INCREMENT the in-degree of next course BY one  
        END FOR  

        SET queue TO an empty double-ended queue  
        FOR course FROM one TO n  
            IF the in-degree of course EQUALS zero  
                APPEND course TO queue  
            END IF  
        END FOR  

        SET semesters TO zero  

        WHILE queue is not empty  
            SET number_of_courses_to_take TO the smaller between k AND the LENGTH OF queue  
            FOR each count FROM one TO number_of_courses_to_take  
                REMOVE the element from the front of queue AND ASSIGN it TO current_course  
                FOR each next_course IN the list of next courses for current_course in graph  
                    DECREMENT the in-degree of next_course BY one  
                    IF the in-degree of next_course EQUALS zero  
                        APPEND next_course TO queue  
                    END IF  
                END FOR  
            END FOR  
            INCREMENT semesters BY one  
        END WHILE  

        RETURN semesters  
    END FUNCTION  
END CLASS