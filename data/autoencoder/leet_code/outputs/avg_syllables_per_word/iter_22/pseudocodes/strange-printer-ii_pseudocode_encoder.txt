CLASS Solution  
    FUNCTION isPrintable(targetGrid)  
        SET color_bounds TO a mapping with default value as a list of four items where the first two items are positive infinity and the last two items are negative infinity  
        FOR r FROM zero TO the length of targetGrid MINUS one  
            FOR c FROM zero TO the length of the element at position zero of targetGrid MINUS one  
                SET color TO the element at position r of targetGrid at position c  
                SET the first item of color_bounds at key color TO the lesser value between the first item of color_bounds at key color AND r  
                SET the second item of color_bounds at key color TO the lesser value between the second item of color_bounds at key color AND c  
                SET the third item of color_bounds at key color TO the greater value between the third item of color_bounds at key color AND r  
                SET the fourth item of color_bounds at key color TO the greater value between the fourth item of color_bounds at key color AND c  
            END FOR  
        END FOR  
  
        SET graph TO a mapping with default value as an empty list  
        SET in_degree TO a mapping with default value as zero  
  
        FOR each color and its bounding box (minr, minc, maxr, maxc) IN color_bounds  
            FOR r FROM minr TO maxr  
                FOR c FROM minc TO maxc  
                    IF the element at position r of targetGrid at position c NOT EQUALS color THEN  
                        SET other_color TO the element at position r of targetGrid at position c  
                        APPEND color TO the list at key other_color in graph  
                        INCREMENT in_degree at key color BY one  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
  
        SET queue TO a double-ended queue containing all colors from color_bounds for which in_degree at key color EQUALS zero  
        SET visited_colors TO zero  
  
        WHILE there are items in queue DO  
            REMOVE and GET the item from the front of queue and assign it to color  
            INCREMENT visited_colors BY one  
            FOR each next_color IN the list at key color in graph  
                DECREMENT in_degree at key next_color BY one  
                IF in_degree at key next_color EQUALS zero THEN  
                    APPEND next_color TO queue  
                END IF  
            END FOR  
        END WHILE  
  
        RETURN the comparison of visited_colors EQUALS the length of color_bounds  
    END FUNCTION  
END CLASS