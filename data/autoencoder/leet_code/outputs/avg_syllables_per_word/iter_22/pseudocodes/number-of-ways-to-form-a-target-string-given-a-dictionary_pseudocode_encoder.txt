CLASS Solution  
    FUNCTION numWays(words AND target)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF the first element of words  
        SET m TO the LENGTH OF target  
        
        SET freq TO a list filled with empty maps from characters to zero counts with size n  
        
        FOR each word IN words  
            FOR each character char WITH index j IN word  
                INCREMENT the count of character char in freq at position j BY one  
            END FOR  
        END FOR  
        
        SET dp TO a two dimensional list with m PLUS one rows and n PLUS one columns filled with zero  
        
        FOR each index j FROM zero TO n INCLUSIVE  
            SET the element at row zero and column j OF dp TO one  
        END FOR  
        
        FOR each index i FROM one TO m INCLUSIVE  
            FOR each index j FROM one TO n INCLUSIVE  
                SET the element at row i and column j OF dp TO the element at row i and column j MINUS one OF dp  
                IF the count of the character at position i MINUS one of target in freq at position j MINUS one IS GREATER THAN zero THEN  
                    SET the element at row i and column j OF dp TO the sum of the current element at row i and column j OF dp AND the product of the element at row i MINUS one and column j MINUS one OF dp AND the count of the character at position i MINUS one of target in freq at position j MINUS one  
                    SET the element at row i and column j OF dp TO the remainder when the element at row i and column j OF dp IS DIVIDED BY MOD  
                END IF  
            END FOR  
        END FOR  
        
        RETURN the element at row m and column n OF dp  
    END FUNCTION  
END CLASS