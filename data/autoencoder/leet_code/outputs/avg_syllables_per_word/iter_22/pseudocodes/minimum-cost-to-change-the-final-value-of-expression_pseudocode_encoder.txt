CLASS Solution  
    FUNCTION minOperationsToFlip(expression)  
        SET stack TO an empty list  
        
        FOR each element e IN expression  
            IF element e EQUALS an opening parenthesis OR element e EQUALS the ampersand character OR element e EQUALS the vertical bar character  
                APPEND a tuple consisting of element e AND zero TO stack  
                CONTINUE to the next iteration  
            END IF  
            
            IF element e EQUALS a closing parenthesis  
                SET lastPair TO the last element removed FROM stack  
                REMOVE the last element FROM stack  
            ELSE  
                SET lastPair TO a tuple consisting of element e AND one  
            END IF  
            
            IF stack IS NOT empty AND the first component of the last element IN stack EQUALS the ampersand character OR the vertical bar character  
                SET op TO the first component of the last element removed FROM stack  
                SET a AND costA TO the components of the last element removed FROM stack  
                SET b AND costB TO the components of lastPair  
                
                IF op EQUALS the ampersand character  
                    IF a EQUALS zero AND b EQUALS zero  
                        SET lastPair TO a tuple consisting of zero AND one PLUS the lesser of costA AND costB  
                    ELSE IF a EQUALS zero AND b EQUALS one  
                        SET lastPair TO a tuple consisting of zero AND one  
                    ELSE IF a EQUALS one AND b EQUALS zero  
                        SET lastPair TO a tuple consisting of zero AND one  
                    ELSE  
                        SET lastPair TO a tuple consisting of one AND the lesser of costA AND costB  
                    END IF  
                ELSE  
                    IF a EQUALS zero AND b EQUALS zero  
                        SET lastPair TO a tuple consisting of zero AND the lesser of costA AND costB  
                    ELSE IF a EQUALS zero AND b EQUALS one  
                        SET lastPair TO a tuple consisting of one AND one  
                    ELSE IF a EQUALS one AND b EQUALS zero  
                        SET lastPair TO a tuple consisting of one AND one  
                    ELSE  
                        SET lastPair TO a tuple consisting of one AND one PLUS the lesser of costA AND costB  
                    END IF  
                END IF  
            END IF  
            
            APPEND lastPair TO stack  
        END FOR  
        
        RETURN the second component of the last element in stack  
    END FUNCTION  
END CLASS