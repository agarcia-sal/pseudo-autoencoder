CLASS Solution  
    FUNCTION minCost(grid)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero of grid  
        SET directions TO the list of pairs zero PLUS one zero MINUS one zero ZERO and MINUS one ZERO  
        SET costs TO a list of lists each containing the infinite value repeated n times repeated m times  
        SET the element at position zero zero of costs TO zero  
        SET pq TO a list containing the tuple of zero zero zero  
        SET visited TO an empty set  
        
        WHILE pq is not empty  
            SET cost TO the first element second element AND third element of the result of removing the smallest element from pq  
            
            IF tuple of cost i j is in visited  
                CONTINUE to next iteration  
            END IF  
            ADD the tuple of i j to visited  
            
            IF i EQUALS m MINUS one AND j EQUALS n MINUS one  
                RETURN cost  
            END IF  
            
            FOR each index k AND pair of di dj IN directions  
                SET ni TO i PLUS di  
                SET nj TO j PLUS dj  
                IF ni IS GREATER THAN OR EQUAL TO zero AND ni IS LESS THAN m AND nj IS GREATER THAN OR EQUAL TO zero AND nj IS LESS THAN n  
                    SET new_cost TO cost PLUS IF k PLUS one NOT EQUALS the element at position i j of grid THEN one ELSE zero  
                    IF new_cost IS LESS THAN the element at position ni nj of costs  
                        SET the element at position ni nj of costs TO new_cost  
                        INSERT the tuple of new_cost ni nj INTO pq preserving heap property  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN minus one  
    END FUNCTION  
END CLASS