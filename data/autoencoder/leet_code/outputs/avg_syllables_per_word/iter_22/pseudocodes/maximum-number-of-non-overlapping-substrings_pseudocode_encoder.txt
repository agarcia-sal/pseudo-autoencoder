CLASS Solution  
    FUNCTION maxNumOfSubstrings(s)  
        SET first TO an empty mapping from character to position  
        SET last TO an empty mapping from character to position  
        FOR each index i and character c IN the enumeration of string s  
            IF c NOT IN the keys of first  
                SET the mapping of c in first TO index i  
            END IF  
            SET the mapping of c in last TO index i  
        END FOR  
        
        SET intervals TO an empty list  
        FOR each character c IN the keys of first  
            SET start TO the mapping of c in first  
            SET end TO the mapping of c in last  
            SET i TO start  
            WHILE i LESS THAN OR EQUAL TO end  
                IF the mapping of the character at position i in s in first LESS THAN start  
                    BREAK the loop  
                END IF  
                SET end TO the greater value BETWEEN end AND the mapping of the character at position i in s in last  
                INCREMENT i BY one  
            END WHILE  
            IF the loop did not break  
                APPEND the pair consisting of start and end TO the list intervals  
            END IF  
        END FOR  
        
        SORT the list intervals BY the second element of each pair IN ascending order  
        
        SET result TO an empty list  
        SET prev_end TO negative one  
        FOR each pair start and end IN intervals  
            IF start GREATER THAN prev_end  
                APPEND the substring starting at position start TO the position end inclusive of string s TO the list result  
                SET prev_end TO end  
            END IF  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS