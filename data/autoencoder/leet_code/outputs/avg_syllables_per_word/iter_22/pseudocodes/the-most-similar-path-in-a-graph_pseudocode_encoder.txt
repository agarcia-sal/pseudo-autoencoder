CLASS Solution  
    FUNCTION mostSimilar WITH PARAMETERS n roads names targetPath  
        SET graph TO empty mapping from key to list  
        FOR each pair u v IN roads  
            APPEND v TO element at position u of graph  
            APPEND u TO element at position v of graph  
        END FOR  
        SET m TO the LENGTH OF targetPath  
          
        FUNCTION dp WITH PARAMETERS i j  
            IF i EQUALS zero THEN  
                IF element at position j of names NOT EQUALS element at position i of targetPath THEN  
                    RETURN one AND list containing j  
                ELSE  
                    RETURN zero AND list containing j  
                END IF  
            END IF  
            SET min_cost TO infinite  
            SET min_path TO empty list  
            FOR each element k IN element at position j of graph  
                SET cost AND path TO result of dp WITH PARAMETERS i MINUS one AND k  
                IF cost LESS THAN min_cost THEN  
                    SET min_cost TO cost  
                    SET min_path TO path  
                END IF  
            END FOR  
            IF element at position j of names NOT EQUALS element at position i of targetPath THEN  
                SET current_cost TO min_cost PLUS one  
            ELSE  
                SET current_cost TO min_cost  
            END IF  
            RETURN current_cost AND min_path APPENDED WITH j  
        END FUNCTION  
          
        SET min_cost TO infinite  
        SET min_path TO empty list  
        FOR j FROM zero TO n MINUS one  
            SET cost AND path TO result of dp WITH PARAMETERS m MINUS one AND j  
            IF cost LESS THAN min_cost THEN  
                SET min_cost TO cost  
                SET min_path TO path  
            END IF  
        END FOR  
          
        RETURN min_path  
    END FUNCTION  
END CLASS