CLASS Solution
    FUNCTION cutOffTree(forest)
        IF forest EQUALS empty OR element at position zero of forest EQUALS empty
            RETURN minus one
        END IF

        SET trees TO empty list
        FOR index i FROM zero TO LENGTH OF forest MINUS one
            FOR index j FROM zero TO LENGTH OF element at position i of forest MINUS one
                IF element at position i of forest at position j GREATER THAN one
                    APPEND tuple of element at position i of forest at position j, i, and j TO trees
                END IF
            END FOR
        END FOR
        SORT trees

        FUNCTION bfs(start, end)
            IF start EQUALS end
                RETURN zero
            END IF
            SET m TO LENGTH OF forest
            SET n TO LENGTH OF element at position zero of forest
            SET queue TO new double-ended queue containing start
            SET visited TO new set containing start
            SET steps TO zero

            WHILE queue is not empty
                FOR count FROM zero TO LENGTH OF queue MINUS one
                    SET x, y TO first element removed from queue
                    FOR each pair dx, dy IN list of pairs of minus one and zero, one and zero, zero and minus one, zero and one
                        SET nx TO x PLUS dx
                        SET ny TO y PLUS dy
                        IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n AND tuple of nx and ny NOT IN visited AND element at position nx of forest at position ny NOT EQUAL TO zero
                            IF tuple of nx and ny EQUALS end
                                RETURN steps PLUS one
                            END IF
                            ADD tuple of nx and ny TO visited
                            APPEND tuple of nx and ny TO queue
                        END IF
                    END FOR
                END FOR
                INCREMENT steps BY one
            END WHILE

            RETURN minus one
        END FUNCTION

        SET x TO zero
        SET y TO zero
        SET total_steps TO zero

        FOR each height, tx, ty IN trees
            SET steps TO bfs(tuple of x and y, tuple of tx and ty)
            IF steps EQUALS minus one
                RETURN minus one
            END IF
            INCREMENT total_steps BY steps
            SET x TO tx
            SET y TO ty
        END FOR

        RETURN total_steps
    END FUNCTION
END CLASS