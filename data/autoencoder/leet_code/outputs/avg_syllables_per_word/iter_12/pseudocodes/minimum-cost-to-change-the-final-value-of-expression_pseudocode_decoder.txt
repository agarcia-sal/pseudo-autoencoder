CLASS Solution
    FUNCTION minOperationsToFlip(expression)
        SET stack TO empty list

        FOR each element e IN expression
            IF e EQUALS open parenthesis OR e EQUALS ampersand OR e EQUALS vertical bar
                APPEND pair of element e AND zero TO stack
                CONTINUE to next iteration
            END IF

            IF e EQUALS close parenthesis
                SET lastPair TO the last element REMOVED FROM stack
                REMOVE last element FROM stack
            ELSE
                SET lastPair TO pair of element e AND one
            END IF

            IF stack IS NOT empty AND the first element of the last item of stack EQUALS ampersand OR vertical bar
                SET op TO first element REMOVED FROM stack
                SET a AND costA TO pair REMOVED FROM stack
                SET b AND costB TO lastPair

                IF op EQUALS ampersand
                    IF a EQUALS zero AND b EQUALS zero
                        SET lastPair TO pair of zero AND one PLUS the smaller value BETWEEN costA AND costB
                    ELSE IF a EQUALS zero AND b EQUALS one
                        SET lastPair TO pair of zero AND one
                    ELSE IF a EQUALS one AND b EQUALS zero
                        SET lastPair TO pair of zero AND one
                    ELSE
                        SET lastPair TO pair of one AND the smaller value BETWEEN costA AND costB
                    END IF
                ELSE
                    IF a EQUALS zero AND b EQUALS zero
                        SET lastPair TO pair of zero AND the smaller value BETWEEN costA AND costB
                    ELSE IF a EQUALS zero AND b EQUALS one
                        SET lastPair TO pair of one AND one
                    ELSE IF a EQUALS one AND b EQUALS zero
                        SET lastPair TO pair of one AND one
                    ELSE
                        SET lastPair TO pair of one AND one PLUS the smaller value BETWEEN costA AND costB
                    END IF
                END IF
            END IF

            APPEND lastPair TO stack
        END FOR

        RETURN second element of the last item of stack
    END FUNCTION
END CLASS