CLASS Solution  
    FUNCTION longestIncreasingPath(matrix)  
        IF matrix EQUALS None OR the LENGTH OF matrix EQUALS zero OR the LENGTH OF the element at position zero of matrix EQUALS zero  
            RETURN zero  
        END IF  
          
        SET m TO the LENGTH OF matrix  
        SET n TO the LENGTH OF the element at position zero of matrix  
        SET directions TO list containing the tuple of one and zero, the tuple of minus one and zero, the tuple of zero and one, the tuple of zero and minus one  
        CALL initialize_dp_matrix WITH m AND n TO RETURN dp  
          
        FUNCTION dfs(x, y)  
            IF the element at position x of dp at position y NOT EQUALS minus one  
                RETURN the element at position x of dp at position y  
            END IF  
              
            SET max_length TO one  
            FOR each dx, dy IN directions  
                SET nx TO x PLUS dx  
                SET ny TO y PLUS dy  
                IF zero LESS THAN OR EQUAL TO nx AND nx LESS THAN m AND zero LESS THAN OR EQUAL TO ny AND ny LESS THAN n  
                   AND the element at position nx of matrix at position ny GREATER THAN the element at position x of matrix at position y  
                    SET max_length TO the GREATER OF max_length AND one PLUS dfs(nx, ny)  
                END IF  
            END FOR  
              
            SET the element at position x of dp at position y TO max_length  
            RETURN max_length  
        END FUNCTION  
          
        SET longest_path TO zero  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                SET longest_path TO the GREATER OF longest_path AND dfs(i, j)  
            END FOR  
        END FOR  
          
        RETURN longest_path  
    END FUNCTION  
      
    FUNCTION initialize_dp_matrix(m, n)  
        SET dp TO empty list  
        FOR index FROM zero TO m MINUS one  
            APPEND a list of n times minus one TO dp  
        END FOR  
        RETURN dp  
    END FUNCTION  
END CLASS