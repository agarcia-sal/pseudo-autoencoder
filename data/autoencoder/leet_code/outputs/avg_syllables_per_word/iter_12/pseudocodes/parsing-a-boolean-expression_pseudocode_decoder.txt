CLASS Solution  
    FUNCTION parseBoolExpr(expression)  
        SET stk TO empty list  
        FOR each c IN expression  
            IF c EQUALS 't' OR c EQUALS 'f' OR c EQUALS '!' OR c EQUALS '&' OR c EQUALS '|'  
                APPEND c TO stk  
            ELSE IF c EQUALS ')'  
                SET t TO zero  
                SET f TO zero  
                WHILE last element of stk EQUALS 't' OR last element of stk EQUALS 'f'  
                    IF last element of stk EQUALS 't'  
                        INCREMENT t BY one  
                    ELSE IF last element of stk EQUALS 'f'  
                        INCREMENT f BY one  
                    END IF  
                    REMOVE last element FROM stk  
                END WHILE  
                SET op TO last element of stk  
                REMOVE last element FROM stk  
                IF op EQUALS '!'  
                    IF f GREATER THAN zero  
                        SET c TO 't'  
                    ELSE  
                        SET c TO 'f'  
                    END IF  
                ELSE IF op EQUALS '&'  
                    IF f GREATER THAN zero  
                        SET c TO 'f'  
                    ELSE  
                        SET c TO 't'  
                    END IF  
                ELSE IF op EQUALS '|'  
                    IF t GREATER THAN zero  
                        SET c TO 't'  
                    ELSE  
                        SET c TO 'f'  
                    END IF  
                END IF  
                APPEND c TO stk  
            END IF  
        END FOR  
        RETURN element at position zero of stk EQUALS 't'  
    END FUNCTION  
END CLASS