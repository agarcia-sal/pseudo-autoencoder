CLASS Solution  
    FUNCTION maximizeXor(nums, queries)  
        SORT nums in ascending order  

        SET sorted_queries TO the enumeration of queries sorted by the second element of each query's value  

        SET result TO a list of length EQUAL TO the LENGTH OF queries with all elements SET TO negative one  

        SET trie TO an empty dictionary  

        SET num_index TO zero  

        FOR each query_index and query_pair IN sorted_queries  
            SET xi TO the first element of query_pair  
            SET mi TO the second element of query_pair  

            WHILE num_index LESS THAN the LENGTH OF nums AND the element at position num_index of nums LESS THAN OR EQUAL TO mi  
                SET num TO the element at position num_index of nums  

                SET node TO trie  

                FOR i FROM thirty one DOWN TO zero  
                    SET bit TO the value of num DIVIDED BY two TO THE POWER OF i THEN MODULO two  

                    IF bit NOT IN node THEN  
                        SET node at key bit TO an empty dictionary  
                    END IF  

                    SET node TO the element at key bit of node  
                END FOR  

                INCREMENT num_index BY one  
            END WHILE  

            IF trie IS empty THEN  
                CONTINUE to next iteration of the FOR loop  
            END IF  

            SET node TO trie  

            SET max_xor TO zero  

            FOR i FROM thirty one DOWN TO zero  
                SET bit TO the value of xi DIVIDED BY two TO THE POWER OF i THEN MODULO two  

                SET toggle_bit TO one MINUS bit  

                IF toggle_bit IN node THEN  
                    SET max_xor TO max_xor PLUS two TO THE POWER OF i  

                    SET node TO the element at key toggle_bit of node  
                ELSE  
                    SET node TO the element at key bit of node  
                END IF  
            END FOR  

            SET the element at position query_index of result TO max_xor  
        END FOR  

        RETURN result  
    END FUNCTION  
END CLASS