CLASS Solution  
    FUNCTION ways(pizza, k)  
        SET mod TO one billion PLUS seven  
        SET m TO the LENGTH OF pizza  
        SET n TO the LENGTH OF the element at position zero of pizza  
        SET s TO a new list with m PLUS one elements each being a list of n PLUS one zeros  

        FOR i FROM one TO m  
            SET row TO the element at position i MINUS one of pizza  
            FOR j FROM one TO n  
                SET c TO the element at position j MINUS one of row  
                SET element at position i of s AT position j TO the element at position i MINUS one of s AT position j PLUS the element at position i of s AT position j MINUS one MINUS the element at position i MINUS one of s AT position j MINUS one PLUS one IF c EQUALS 'A' OTHERWISE zero  
            END FOR  
        END FOR  

        FUNCTION dfs(i, j, k)  
            IF k EQUALS zero  
                IF the element at position m of s AT position n MINUS the element at position i of s AT position n MINUS the element at position m of s AT position j PLUS the element at position i of s AT position j GREATER THAN zero  
                    RETURN one  
                ELSE  
                    RETURN zero  
                END IF  
            END IF  

            SET ans TO zero  

            FOR x FROM i PLUS one TO m MINUS one  
                IF the element at position x of s AT position n MINUS the element at position i of s AT position n MINUS the element at position x of s AT position j PLUS the element at position i of s AT position j GREATER THAN zero  
                    INCREMENT ans BY the RESULT OF dfs(x, j, k MINUS one)  
                END IF  
            END FOR  

            FOR y FROM j PLUS one TO n MINUS one  
                IF the element at position m of s AT position y MINUS the element at position i of s AT position y MINUS the element at position m of s AT position j PLUS the element at position i of s AT position j GREATER THAN zero  
                    INCREMENT ans BY the RESULT OF dfs(i, y, k MINUS one)  
                END IF  
            END FOR  

            RETURN ans MODULO mod  
        END FUNCTION  

        RETURN dfs(zero, zero, k MINUS one)  
    END FUNCTION  
END CLASS