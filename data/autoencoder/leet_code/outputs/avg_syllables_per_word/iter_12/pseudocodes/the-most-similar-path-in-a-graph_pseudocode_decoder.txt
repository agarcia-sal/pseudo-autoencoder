CLASS Solution  
    FUNCTION mostSimilar(n, roads, names, targetPath)  
        CREATE graph WITH DEFAULT VALUE empty list  
        FOR each pair u AND v IN roads  
            APPEND v TO the list AT graph[u]  
            APPEND u TO the list AT graph[v]  
        END FOR  
        
        SET m TO the LENGTH OF targetPath  
        
        FUNCTION dp(i, j)  
            IF i EQUALS zero THEN  
                IF name at position j of names NOT EQUALS element at position i of targetPath THEN  
                    SET base_cost TO one  
                ELSE  
                    SET base_cost TO zero  
                END IF  
                RETURN base_cost AND list containing element j  
            END IF  
            
            SET min_cost TO infinity  
            SET min_path TO empty list  
            FOR each element k IN graph[j]  
                SET cost, path TO dp(i MINUS one, k)  
                IF cost LESS THAN min_cost THEN  
                    SET min_cost TO cost  
                    SET min_path TO path  
                END IF  
            END FOR  
            
            IF name at position j of names NOT EQUALS element at position i of targetPath THEN  
                SET current_cost TO min_cost PLUS one  
            ELSE  
                SET current_cost TO min_cost  
            END IF  
            RETURN current_cost AND min_path WITH element j appended at the end  
        END FUNCTION  
        
        SET min_cost TO infinity  
        SET min_path TO empty list  
        FOR index j FROM zero TO n MINUS one  
            SET cost, path TO dp(m MINUS one, j)  
            IF cost LESS THAN min_cost THEN  
                SET min_cost TO cost  
                SET min_path TO path  
            END IF  
        END FOR  
        
        RETURN min_path  
    END FUNCTION  
END CLASS