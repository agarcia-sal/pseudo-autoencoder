CLASS Solution  
    FUNCTION getCoprimes(nums, edges)  
        SET n TO the LENGTH OF nums  
        SET tree TO a new defaultdict with list as default value  
        FOR each pair u, v IN edges  
            APPEND v TO the list at position u IN tree  
            APPEND u TO the list at position v IN tree  
        END FOR  

        SET coprime TO a two-dimensional list of size fifty by fifty FILLED WITH False  
        FOR i FROM one TO fifty  
            FOR j FROM one TO fifty  
                SET coprime at position i and j TO the EQUALITY TEST of gcd of i AND j EQUALS one  
            END FOR  
        END FOR  

        SET result TO a list of size n FILLED WITH negative one  
        SET ancestor_stack TO a list of size fifty FILLED WITH None  

        FUNCTION dfs(node, parent, depth)  
            SET closest_ancestor TO negative one  
            SET max_depth TO negative one  
            FOR value FROM one TO fifty  
                IF coprime at position nums at node AND value IS True AND ancestor_stack at value IS NOT None  
                    SET anc_node, anc_depth TO the pair stored at ancestor_stack at value  
                    IF anc_depth GREATER THAN max_depth  
                        SET max_depth TO anc_depth  
                        SET closest_ancestor TO anc_node  
                    END IF  
                END IF  
            END FOR  

            SET result at node TO closest_ancestor  

            SET original_ancestor TO ancestor_stack at nums at node  
            SET ancestor_stack at nums at node TO the pair of node AND depth  

            FOR each child IN the list at tree at node  
                IF child NOT EQUALS parent  
                    CALL dfs WITH child, node, depth PLUS one  
                END IF  
            END FOR  

            SET ancestor_stack at nums at node TO original_ancestor  
        END FUNCTION  

        CALL dfs WITH zero, negative one, zero  

        RETURN result  
    END FUNCTION  
END CLASS