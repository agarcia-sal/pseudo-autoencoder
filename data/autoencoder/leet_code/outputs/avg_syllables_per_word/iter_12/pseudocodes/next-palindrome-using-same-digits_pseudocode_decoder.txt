CLASS Solution  
    FUNCTION nextPalindrome(num)  
        SET n TO the LENGTH OF num  
        SET half TO the SUBSTRING of num FROM start TO the INTEGER DIVISION of n BY two  
        
        SET half_list TO the LIST of characters IN half  
        SET k TO negative one  
        SET l TO negative one  
        
        FOR i FROM the LENGTH OF half_list MINUS two DOWN TO zero  
            IF element at position i of half_list LESS THAN element at position i PLUS one of half_list  
                SET k TO i  
                BREAK  
            END IF  
        END FOR  
        
        IF k EQUALS negative one  
            RETURN the EMPTY STRING  
        END IF  
        
        FOR i FROM the LENGTH OF half_list MINUS one DOWN TO k PLUS one  
            IF element at position i of half_list GREATER THAN element at position k of half_list  
                SET l TO i  
                BREAK  
            END IF  
        END FOR  
        
        SET temporary TO element at position l of half_list  
        SET element at position l of half_list TO element at position k of half_list  
        SET element at position k of half_list TO temporary  
        
        SET half_list TO the CONCATENATION of the SUBLIST of half_list FROM start TO k PLUS one AND the SORTED SUBLIST of half_list FROM k PLUS one TO end  
        
        SET new_half TO the JOINED STRING of half_list  
        
        IF n MODULO two EQUALS zero  
            RETURN the CONCATENATION of new_half AND the REVERSED STRING of new_half  
        ELSE  
            RETURN the CONCATENATION of new_half, the CHARACTER at position INTEGER DIVISION of n BY two of num, AND the REVERSED STRING of new_half  
        END IF  
    END FUNCTION  
END CLASS