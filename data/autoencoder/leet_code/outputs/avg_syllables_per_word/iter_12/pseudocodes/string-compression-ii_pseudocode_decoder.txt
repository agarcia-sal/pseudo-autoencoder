CLASS Solution
    FUNCTION getLengthOfOptimalCompression(s, k)
        DEFINE FUNCTION dp(i, k_remaining, prev_char, prev_count)
            IF k_remaining LESS THAN zero
                RETURN positive infinity
            END IF

            IF i EQUALS the LENGTH OF s
                RETURN zero
            END IF

            IF character at position i of s EQUALS prev_char
                SET increment TO one IF prev_count EQUALS one OR prev_count EQUALS nine OR prev_count EQUALS ninety nine ELSE zero
                RETURN increment PLUS dp(i PLUS one, k_remaining, prev_char, prev_count PLUS one)
            ELSE
                SET keep TO one PLUS dp(i PLUS one, k_remaining, character at position i of s, one)
                SET delete TO dp(i PLUS one, k_remaining MINUS one, prev_char, prev_count)
                IF keep LESS THAN delete
                    RETURN keep
                ELSE
                    RETURN delete
                END IF
            END IF
        END FUNCTION

        RETURN dp(zero, k, empty string, zero)
    END FUNCTION
END CLASS