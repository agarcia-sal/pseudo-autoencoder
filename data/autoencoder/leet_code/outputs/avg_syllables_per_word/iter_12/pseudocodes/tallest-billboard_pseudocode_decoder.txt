CLASS Solution  
    FUNCTION tallestBillboard(rods)  
        SET dp TO dictionary with key zero and value zero  
        FOR each rod IN rods  
            SET new_dp TO a copy of dp  
            FOR each pair d and y IN dp items  
                SET sum_for_taller_support TO d PLUS rod  
                SET current_max_for_taller_support TO the value in new_dp at key sum_for_taller_support or zero if key not present  
                SET updated_max_for_taller_support TO the maximum of current_max_for_taller_support and y  
                SET the value in new_dp at key sum_for_taller_support TO updated_max_for_taller_support  

                SET difference_for_shorter_support TO the absolute value of d MINUS rod  
                SET current_max_for_shorter_support TO the value in new_dp at key difference_for_shorter_support or zero if key not present  
                SET additional_height_for_shorter_support TO y PLUS the minimum of d and rod  
                SET updated_max_for_shorter_support TO the maximum of current_max_for_shorter_support and additional_height_for_shorter_support  
                SET the value in new_dp at key difference_for_shorter_support TO updated_max_for_shorter_support  
            END FOR  
            SET dp TO new_dp  
        END FOR  
        RETURN the value in dp at key zero  
    END FUNCTION  
END CLASS