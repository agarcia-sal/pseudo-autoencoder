CLASS Solution  
    FUNCTION pathsWithMaxScore(board)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF board  
        
        FUNCTION initialize_dp(n)  
            SET dp TO an empty two-dimensional list  
            FOR index_i FROM zero TO n MINUS one  
                SET row TO an empty list  
                FOR index_j FROM zero TO n MINUS one  
                    APPEND a list containing negative infinity AND zero TO row  
                END FOR  
                APPEND row TO dp  
            END FOR  
            RETURN dp  
        END FUNCTION  
        
        SET dp TO initialize_dp(n)  
        SET element at position n MINUS one AND n MINUS one OF dp TO a list containing zero AND one  
        
        FOR i FROM n MINUS one DOWN TO zero  
            FOR j FROM n MINUS one DOWN TO zero  
                IF the character at position i AND j OF board EQUALS character 'X' OR character 'S' THEN  
                    CONTINUE to next iteration of inner loop  
                END IF  
                
                IF the character at position i AND j OF board NOT EQUALS character 'E' THEN  
                    SET value TO integer CONVERSION OF the character at position i AND j OF board  
                ELSE  
                    SET value TO zero  
                END IF  
                
                FOR each pair (x, y) IN list containing the pairs (one, zero), (zero, one), (one, one)  
                    SET ni TO i PLUS x  
                    SET nj TO j PLUS y  
                    IF ni GREATER THAN OR EQUAL TO zero AND ni LESS THAN n AND nj GREATER THAN OR EQUAL TO zero AND nj LESS THAN n THEN  
                        IF first element of dp at position ni AND nj GREATER THAN first element of dp at position i AND j THEN  
                            SET dp at position i AND j TO a list containing first element of dp at position ni AND nj PLUS value AND second element of dp at position ni AND nj  
                        ELSE IF first element of dp at position ni AND nj EQUALS first element of dp at position i AND j THEN  
                            SET second element of dp at position i AND j TO (second element of dp at position i AND j PLUS second element of dp at position ni AND nj) MODULO MOD  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        IF first element of dp at position zero AND zero EQUALS negative infinity THEN  
            RETURN a list containing zero AND zero  
        END IF  
        
        RETURN a list containing first element of dp at position zero AND zero AND second element of dp at position zero AND zero  
    END FUNCTION  
END CLASS