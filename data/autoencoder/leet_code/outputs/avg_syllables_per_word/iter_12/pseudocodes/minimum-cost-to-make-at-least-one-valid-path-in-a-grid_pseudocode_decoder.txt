CLASS Solution  
    FUNCTION minCost(grid)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF the element at position zero of grid  
        SET directions TO a list containing elements of zero and one, zero and minus one, one and zero, minus one and zero as pairs  
        CALL a FUNCTION to generate costs grid with m rows and n columns each initialized TO infinity  
        SET the element at position zero zero of costs TO zero  
        SET pq TO a list containing a single tuple of zero, zero, zero  
        SET visited TO an empty set  
        
        WHILE pq is not empty  
            EXTRACT the lowest cost tuple cost, i, j FROM pq according to heap ordering  
            
            IF the pair i, j IS IN visited  
                CONTINUE to next iteration  
            END IF  
            ADD the pair i, j TO visited  
            
            IF i EQUALS m MINUS one AND j EQUALS n MINUS one  
                RETURN cost  
            END IF  
            
            FOR each pair k, direction IN the enumeration of directions  
                LET di TO the first element of direction  
                LET dj TO the second element of direction  
                SET ni TO i PLUS di  
                SET nj TO j PLUS dj  
                
                IF ni IS GREATER THAN OR EQUAL TO zero AND ni IS LESS THAN m AND nj IS GREATER THAN OR EQUAL TO zero AND nj IS LESS THAN n  
                    IF k PLUS one IS NOT EQUAL TO the element at position i j of grid  
                        SET extra_cost TO one  
                    ELSE  
                        SET extra_cost TO zero  
                    END IF  
                    SET new_cost TO cost PLUS extra_cost  
                    
                    IF new_cost IS LESS THAN the element at position ni nj of costs  
                        SET the element at position ni nj of costs TO new_cost  
                        INSERT the tuple new_cost, ni, nj INTO pq MAINTAINING heap order  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN minus one  
    END FUNCTION  
END CLASS