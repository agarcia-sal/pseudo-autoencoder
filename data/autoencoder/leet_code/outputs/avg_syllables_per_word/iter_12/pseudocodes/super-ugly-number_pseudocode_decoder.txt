CLASS Solution  
    FUNCTION nthSuperUglyNumber(n, primes)  
        SET ugly_numbers TO a list containing one  
        SET heap TO a list of pairs of each prime and its index in primes  
        CALL heapify on heap  
        SET indices TO a list of zeros with the same length as primes  
        WHILE the LENGTH OF ugly_numbers IS LESS THAN n  
            REMOVE the smallest pair from heap and SET to next_ugly and prime_index  
            IF next_ugly IS NOT EQUAL TO the last element of ugly_numbers  
                APPEND next_ugly TO ugly_numbers  
            END IF  
            INCREMENT the element of indices at position prime_index BY one  
            SET next_multiple TO the element of primes at position prime_index MULTIPLIED BY the element of ugly_numbers at position indices at prime_index  
            ADD the pair next_multiple and prime_index INTO heap  
        END WHILE  
        RETURN the last element of ugly_numbers  
    END FUNCTION  
END CLASS