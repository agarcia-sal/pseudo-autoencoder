CLASS Solution  
    FUNCTION palindromePartition(s, k)  
        FUNCTION min_changes_to_palindrome(sub)  
            SET i TO zero  
            SET j TO the LENGTH OF sub MINUS one  
            SET changes TO zero  
            WHILE i LESS THAN j  
                IF element at position i of sub NOT EQUALS element at position j of sub  
                    INCREMENT changes BY one  
                END IF  
                INCREMENT i BY one  
                DECREMENT j BY one  
            END WHILE  
            RETURN changes  
        END FUNCTION  

        SET n TO the LENGTH OF s  
        CALL dp_initialization WITH n AND k TO SET dp  
        
        FOR i FROM one TO n  
            FOR j FROM one TO the MINIMUM OF k AND i  
                FOR start FROM zero TO i MINUS one  
                    SET changes TO CALL min_changes_to_palindrome WITH the substring of s FROM start TO i  
                    IF dp at position i and j GREATER THAN dp at position start and j MINUS one PLUS changes  
                        SET dp at position i and j TO dp at position start and j MINUS one PLUS changes  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        RETURN dp at position n and k  
    END FUNCTION  

    FUNCTION dp_initialization(n, k)  
        SET dp TO an empty list  
        FOR i FROM zero TO n  
            SET row TO an empty list  
            FOR j FROM zero TO k  
                SET value TO positive infinity  
                APPEND value TO row  
            END FOR  
            APPEND row TO dp  
        END FOR  
        SET dp at position zero and zero TO zero  
        RETURN dp  
    END FUNCTION  
END CLASS