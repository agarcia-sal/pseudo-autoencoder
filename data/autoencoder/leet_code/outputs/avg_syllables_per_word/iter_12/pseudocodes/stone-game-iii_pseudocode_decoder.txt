CLASS Solution  
    FUNCTION stoneGameIII(stoneValue)  
        SET n TO the LENGTH OF stoneValue  
        SET dp TO a list of zero values with LENGTH EQUAL TO n PLUS one  
        
        FOR index i FROM n MINUS one DOWN TO zero  
            SET value_at_i TO the element at position i of stoneValue  
            SET dp_at_i_plus_one TO the element at position i PLUS one of dp  
            SET element at position i of dp TO value_at_i MINUS dp_at_i_plus_one  
            
            IF i PLUS two IS LESS THAN OR EQUAL TO n  
                SET value_at_i_plus_one TO the element at position i PLUS one of stoneValue  
                SET dp_at_i_plus_two TO the element at position i PLUS two of dp  
                SET element at position i of dp TO the GREATER VALUE BETWEEN element at position i of dp AND value_at_i PLUS value_at_i_plus_one MINUS dp_at_i_plus_two  
            END IF  
            
            IF i PLUS three IS LESS THAN OR EQUAL TO n  
                SET value_at_i_plus_one TO the element at position i PLUS one of stoneValue  
                SET value_at_i_plus_two TO the element at position i PLUS two of stoneValue  
                SET dp_at_i_plus_three TO the element at position i PLUS three of dp  
                SET element at position i of dp TO the GREATER VALUE BETWEEN element at position i of dp AND value_at_i PLUS value_at_i_plus_one PLUS value_at_i_plus_two MINUS dp_at_i_plus_three  
            END IF  
        END FOR  
        
        IF the element at position zero of dp IS GREATER THAN zero  
            RETURN the string "Alice"  
        ELSE IF the element at position zero of dp IS LESS THAN zero  
            RETURN the string "Bob"  
        ELSE  
            RETURN the string "Tie"  
        END IF  
    END FUNCTION  
END CLASS