CLASS Solution  
    FUNCTION maskPII WITH PARAMETER s  
        IF the character at any position of s EQUALS the character at any position AT SYMBOL  
            SET local TO the substring of s from position one TO the position before the character AT SYMBOL  
            SET domain TO the substring of s from the position after the character AT SYMBOL TO the end  
            SET masked_local TO the concatenation of the character at position one of local PLUS five repetitions of the character ASTERISK PLUS the character at the last position of local  
            RETURN the lowercase form of masked_local PLUS the character AT SYMBOL PLUS the lowercase form of domain  
        ELSE  
            SET digits TO all characters in s for which the character is a digit concatenated together in the original order  
            SET local_number TO the concatenation of three characters ASTERISK PLUS the character HYPHEN PLUS three characters ASTERISK PLUS the character HYPHEN PLUS the substring of digits consisting of the last four characters  
            IF the length of digits EQUALS ten  
                RETURN local_number  
            ELSE  
                SET country_code_length TO the length of digits MINUS ten  
                SET country_code TO the concatenation of the character PLUS PLUS the character ASTERISK repeated country_code_length times PLUS the character HYPHEN  
                RETURN the concatenation of country_code PLUS local_number  
            END IF  
        END IF  
    END FUNCTION  
END CLASS