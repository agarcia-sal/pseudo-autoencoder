CLASS Solution  
    FUNCTION sumOfFlooredPairs WITH PARAMETER nums  
        SET MOD TO one billion PLUS seven  
        SET max_num TO the maximum element in nums  
        SET count TO a collection mapping each number in nums to its frequency  
        SET prefix_sum TO a list of zeros with length max_num PLUS one  
        
        FOR each num IN the keys of count  
            INCREMENT the element at position num in prefix_sum BY the frequency of num in count  
        END FOR  
        
        FOR index FROM one TO max_num  
            INCREMENT the element at position index in prefix_sum BY the element at position index MINUS one in prefix_sum  
        END FOR  
        
        SET result TO zero  
        
        FOR each num IN the keys of count  
            FOR multiple FROM one TO the integer division of max_num BY num  
                SET start TO the product of num AND multiple  
                SET end TO the smaller value between the product of num AND the sum of multiple PLUS one MINUS one AND max_num  
                SET multiples_count TO the element at position end in prefix_sum MINUS the element at position start MINUS one in prefix_sum  
                INCREMENT result BY the product of multiples_count MULTIPLIED BY multiple MULTIPLIED BY the frequency of num in count  
                SET result TO the remainder of result DIVIDED BY MOD  
            END FOR  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS