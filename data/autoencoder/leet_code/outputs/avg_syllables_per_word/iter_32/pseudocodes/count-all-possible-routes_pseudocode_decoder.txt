CLASS Solution  
    FUNCTION countRoutes(locations WITH TYPE List of integers, start WITH TYPE integer, finish WITH TYPE integer, fuel WITH TYPE integer) RETURNS integer  
        SET MODULO TO one billion PLUS seven  
        SET number_of_locations TO the LENGTH OF locations  
        
        FUNCTION dp(city WITH TYPE integer, remaining_fuel WITH TYPE integer) RETURNS integer  
            IF remaining_fuel LESS THAN zero THEN  
                RETURN zero  
            END IF  
            SET total_routes TO zero  
            IF city EQUALS finish THEN  
                SET total_routes TO one  
            END IF  
            FOR next_city FROM zero TO number_of_locations MINUS one  
                IF next_city NOT EQUALS city THEN  
                    SET fuel_cost TO the ABSOLUTE VALUE OF the difference BETWEEN element at position city of locations AND element at position next_city of locations  
                    IF remaining_fuel GREATER THAN OR EQUAL TO fuel_cost THEN  
                        SET total_routes TO the REMAINDER OF the SUM OF total_routes PLUS the RESULT OF dp WITH PARAMETERS next_city AND remaining_fuel MINUS fuel_cost DIVIDED BY MODULO  
                    END IF  
                END IF  
            END FOR  
            RETURN total_routes  
        END FUNCTION  
        
        RETURN the RESULT OF dp WITH PARAMETERS start AND fuel  
    END FUNCTION  
END CLASS