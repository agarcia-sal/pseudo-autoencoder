CLASS UnionFind  
    FUNCTION __init__(self, size)  
        SET self.parent TO list of integer numbers from zero TO size MINUS one  
    END FUNCTION  
  
    FUNCTION find(self, u)  
        IF element at position u of self.parent NOT EQUALS u THEN  
            SET element at position u of self.parent TO self.find(element at position u of self.parent)  
        END IF  
        RETURN element at position u of self.parent  
    END FUNCTION  
  
    FUNCTION union(self, u, v)  
        SET root_u TO self.find(u)  
        SET root_v TO self.find(v)  
        IF root_u NOT EQUALS root_v THEN  
            SET element at position root_u of self.parent TO root_v  
        END IF  
    END FUNCTION  
END CLASS  
  
CLASS Solution  
    FUNCTION matrixRankTransform(self, matrix)  
        SET m TO the length of matrix  
        SET n TO the length of element at position zero of matrix  
        SET value_to_indices TO empty mapping from values TO empty lists  
          
        FOR r FROM zero TO m MINUS one  
            FOR c FROM zero TO n MINUS one  
                APPEND pair consisting of r and c TO the list at key element at position r of matrix and position c of matrix in value_to_indices  
            END FOR  
        END FOR  
          
        SET row_rank TO list of zeros of length m  
        SET col_rank TO list of zeros of length n  
        SET result TO list containing m elements each being list of n zeros  
          
        FOR each value IN the keys of value_to_indices SORTED in ascending order  
            SET uf TO new UnionFind with size m PLUS n  
            SET rank TO empty mapping from roots TO integers  
              
            FOR each pair r c IN the list at key value in value_to_indices  
                CALL uf.union with parameters r and c PLUS m  
            END FOR  
              
            FOR each pair r c IN the list at key value in value_to_indices  
                SET root TO uf.find(r)  
                SET rank at key root TO the maximum of rank at key root AND the maximum of element at position r of row_rank AND element at position c of col_rank PLUS one  
            END FOR  
              
            FOR each pair r c IN the list at key value in value_to_indices  
                SET root TO uf.find(r)  
                SET element at position r and c of result TO rank at key root  
                SET element at position r of row_rank TO rank at key root  
                SET element at position c of col_rank TO rank at key root  
            END FOR  
        END FOR  
          
        RETURN result  
    END FUNCTION  
END CLASS