CLASS Solution  
    FUNCTION countArrangement WITH PARAMETER n  
        FUNCTION backtrack WITH PARAMETERS used AND index  
            IF index EQUALS n PLUS one THEN  
                RETURN one  
            END IF  
            SET count TO zero  
            FOR i FROM one TO n  
                IF element at position i of used EQUALS false AND (the remainder of i DIVIDED BY index EQUALS zero OR the remainder of index DIVIDED BY i EQUALS zero) THEN  
                    SET element at position i of used TO true  
                    INCREMENT count BY the RESULT OF backtrack WITH used AND index PLUS one  
                    SET element at position i of used TO false  
                END IF  
            END FOR  
            RETURN count  
        END FUNCTION  
        SET used TO a list of boolean false values of length n PLUS one  
        RETURN the RESULT OF backtrack WITH used AND one  
    END FUNCTION  
END CLASS