CLASS Solution  
    FUNCTION nextPalindrome(num)  
        SET n TO the LENGTH OF num  
        SET half TO the SUBSTRING of num from position zero TO the POSITION obtained by THE INTEGER DIVISION OF n BY two  
        SET half_list TO the LIST OF CHARACTERS of half  
        SET k TO minus one  
        SET l TO minus one  
        
        FOR i FROM THE LENGTH OF half_list MINUS two TO zero DECREMENTED BY one  
            IF the ELEMENT at POSITION i OF half_list IS LESS THAN the ELEMENT at POSITION i PLUS one OF half_list  
                SET k TO i  
                BREAK the loop  
            END IF  
        END FOR  
        
        IF k EQUALS minus one  
            RETURN an EMPTY STRING  
        END IF  
        
        FOR i FROM THE LENGTH OF half_list MINUS one TO k PLUS one DECREMENTED BY one  
            IF the ELEMENT at POSITION i OF half_list IS GREATER THAN the ELEMENT at POSITION k OF half_list  
                SET l TO i  
                BREAK the loop  
            END IF  
        END FOR  
        
        SET temporary TO the ELEMENT at POSITION l OF half_list  
        SET the ELEMENT at POSITION l OF half_list TO the ELEMENT at POSITION k OF half_list  
        SET the ELEMENT at POSITION k OF half_list TO temporary  
        
        SET half_list TO the CONCATENATION OF the SUBLIST of half_list from zero TO k PLUS one AND the SORTED SUBLIST of half_list from k PLUS one TO THE END  
        
        SET new_half TO the STRING FORMED BY JOINING all ELEMENTS OF half_list IN ORDER  
        
        IF n MODULO two EQUALS zero  
            RETURN the CONCATENATION OF new_half AND THE REVERSE OF new_half  
        ELSE  
            RETURN the CONCATENATION OF new_half AND the ELEMENT at POSITION THE INTEGER DIVISION OF n BY two OF num AND THE REVERSE OF new_half  
        END IF  
    END FUNCTION  
END CLASS