CLASS Solution  
    FUNCTION kthSmallest(mat LIST OF LIST OF INTEGER k INTEGER) RETURNS INTEGER  
        SET m TO the LENGTH OF mat  
        SET n TO the LENGTH OF element at position zero of mat  
        SET initial_sum TO the SUM OF element at position zero of each row IN mat  
        SET initial_indices_tuple TO a tuple OF zero REPEATED m TIMES  
        SET min_heap TO a list CONTAINING a tuple OF initial_sum AND initial_indices_tuple  
        SET visited TO a set CONTAINING initial_indices_tuple  
        
        WHILE k GREATER THAN zero holds  
            REMOVE the element WITH smallest current sum FROM min_heap AND ASSIGN TO current_sum AND indices  
            DECREMENT k BY one  
            
            IF k EQUALS zero THEN  
                RETURN current_sum  
            END IF  
            
            FOR i FROM zero TO m MINUS one  
                IF element at position i of indices PLUS one LESS THAN n THEN  
                    SET new_indices TO a list CONTAINING all elements OF indices  
                    INCREMENT element at position i of new_indices BY one  
                    SET new_indices_tuple TO a tuple OF new_indices  
                    SET new_sum TO current_sum MINUS element at position i AND element at position i of indices OF mat PLUS element at position i AND element at position i of new_indices OF mat  
                    
                    IF new_indices_tuple NOT IN visited THEN  
                        ADD new_indices_tuple TO visited  
                        ADD tuple OF new_sum AND new_indices_tuple TO min_heap AS A new element  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN negative one  
    END FUNCTION  
END CLASS