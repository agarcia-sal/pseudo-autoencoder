CLASS Solution  
    FUNCTION leastBricks(wall)  
        SET gap_counts TO a mapping from integer keys to integer values with default zero  
        FOR each row IN wall  
            SET total TO zero  
            FOR each brick IN all elements of row except the last one  
                INCREMENT total BY brick  
                INCREMENT the value at key total in gap_counts BY one  
            END FOR  
        END FOR  
        SET max_gaps TO the maximum value among all values in gap_counts or zero if gap_counts is empty  
        SET number_of_rows TO the length of wall  
        SET result TO number_of_rows MINUS max_gaps  
        RETURN result  
    END FUNCTION  
END CLASS