CLASS Solution  
    FUNCTION numWays(words target)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF element at position one of words  
        SET m TO the LENGTH OF target  
        SET freq TO a list containing n elements each being an empty mapping from character TO integer  
        FOR each word IN words  
            SET j TO zero  
            WHILE j LESS THAN n  
                INCREMENT the value at key character at position j of word in the mapping at position j of freq BY one  
                INCREMENT j BY one  
            END WHILE  
        END FOR  
        SET dp TO a list containing m PLUS one elements each being a list of n PLUS one zeros  
        SET j TO zero  
        WHILE j LESS THAN OR EQUAL TO n  
            SET element at position j of element at position zero of dp TO one  
            INCREMENT j BY one  
        END WHILE  
        SET i TO one  
        WHILE i LESS THAN OR EQUAL TO m  
            SET j TO one  
            WHILE j LESS THAN OR EQUAL TO n  
                SET element at position j of element at position i of dp TO element at position j MINUS one of element at position i of dp  
                IF the value at key character at position i MINUS one of target in the mapping at position j MINUS one of freq GREATER THAN zero  
                    SET element at position j of element at position i of dp TO element at position j of element at position i of dp PLUS element at position j MINUS one of element at position i MINUS one of dp MULTIPLIED BY the value at key character at position i MINUS one of target in the mapping at position j MINUS one of freq  
                    SET element at position j of element at position i of dp TO element at position j of element at position i of dp MODULO MOD  
                END IF  
                INCREMENT j BY one  
            END WHILE  
            INCREMENT i BY one  
        END WHILE  
        RETURN element at position n of element at position m of dp  
    END FUNCTION  
END CLASS