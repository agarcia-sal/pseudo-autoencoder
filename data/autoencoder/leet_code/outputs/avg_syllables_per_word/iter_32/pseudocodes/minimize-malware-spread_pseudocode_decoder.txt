CLASS Solution  
    FUNCTION minMalwareSpread(graph PARAMETER, initial PARAMETER)  
        FUNCTION dfs(node PARAMETER, component PARAMETER)  
            IF node EXISTS IN visited SET  
                RETURN  
            END IF  
            ADD node TO visited SET  
            ADD node TO component SET  
            FOR neighbor FROM zero TO LENGTH OF graph MINUS one  
                IF element at position neighbor of element at position node of graph EQUALS one AND neighbor NOT EXISTS IN visited SET  
                    CALL dfs WITH neighbor AND component PARAMETERS  
                END IF  
            END FOR  
        END FUNCTION  

        SET visited TO an empty set  
        SET components TO an empty list  
        FOR node FROM zero TO LENGTH OF graph MINUS one  
            IF node NOT EXISTS IN visited SET  
                SET component TO an empty set  
                CALL dfs WITH node AND component PARAMETERS  
                APPEND component TO components list  
            END IF  
        END FOR  

        SET infected_count TO a list of zeros with length EQUAL TO LENGTH OF graph  
        FOR each node IN initial  
            SET element at position node of infected_count list TO one  
        END FOR  

        SET component_infected_count TO a list of zeros with length EQUAL TO LENGTH OF components  
        FOR each node IN initial  
            FOR index i FROM zero TO LENGTH OF components MINUS one  
                IF node EXISTS IN element at position i of components list  
                    INCREMENT element at position i of component_infected_count list BY one  
                END IF  
            END FOR  
        END FOR  

        SET max_saving TO zero  
        SET best_node TO the smallest element IN initial list  
        FOR each node IN initial  
            FOR index i FROM zero TO LENGTH OF components MINUS one  
                IF node EXISTS IN element at position i of components list AND element at position i of component_infected_count list EQUALS one  
                    SET saving TO the LENGTH OF element at position i of components list  
                    IF saving GREATER THAN max_saving OR (saving EQUALS max_saving AND node LESS THAN best_node)  
                        SET max_saving TO saving  
                        SET best_node TO node  
                    END IF  
                END IF  
            END FOR  
        END FOR  

        RETURN best_node  
    END FUNCTION  
END CLASS