CLASS Solution  
    FUNCTION maxEqualFreq(nums)  
        ASSIGN reference TO an empty Counter named count  
        ASSIGN reference TO an empty Counter named freq  
        SET max_len TO zero  
        
        FOR index, num IN enumeration of nums  
            INCREMENT the count of num IN count BY one  
            
            IF the count of num IN count IS GREATER THAN one  
                DECREMENT the frequency of the count of num MINUS one IN freq BY one  
                IF the frequency of the count of num MINUS one IN freq EQUALS zero  
                    REMOVE the frequency of the count of num MINUS one FROM freq  
                END IF  
            END IF  
            
            INCREMENT the frequency of the count of num IN freq BY one  
            
            IF the length of freq EQUALS one AND (the digit one IS IN freq OR the only value in freq EQUALS one)  
                SET max_len TO index PLUS one  
            ELSE IF the length of freq EQUALS two AND (the digit one IS IN freq AND the frequency of the digit one IN freq EQUALS one OR the difference BETWEEN the maximum key in freq AND the minimum key in freq EQUALS one AND the frequency of the maximum key IN freq EQUALS one)  
                SET max_len TO index PLUS one  
            END IF  
        END FOR  
        
        RETURN max_len  
    END FUNCTION  
END CLASS