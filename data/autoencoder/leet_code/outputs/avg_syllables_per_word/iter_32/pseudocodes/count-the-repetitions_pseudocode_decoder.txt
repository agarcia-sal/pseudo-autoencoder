CLASS Solution  
    FUNCTION getMaxRepetitions(s1 parameter AS string, n1 parameter AS integer, s2 parameter AS string, n2 parameter AS integer) RETURNS integer  
        IF n1 EQUALS zero THEN  
            RETURN zero  
        END IF  

        SET s2_count TO a list of zeros with the LENGTH OF s2 PLUS one  
        SET index_map TO a list of zeros with the LENGTH OF s2 PLUS one  

        SET current_index_s2 TO zero  
        SET s1_count TO zero  

        WHILE s1_count LESS THAN n1  
            INCREMENT s1_count BY one  
            FOR each character IN s1  
                IF character EQUALS element at position current_index_s2 of s2 THEN  
                    INCREMENT current_index_s2 BY one  
                    IF current_index_s2 EQUALS LENGTH OF s2 THEN  
                        SET element at position s1_count of s2_count TO element at position s1_count MINUS one of s2_count PLUS one  
                        SET current_index_s2 TO zero  
                    END IF  
                END IF  
                SET element at position s1_count of index_map TO current_index_s2  
            END FOR  

            IF current_index_s2 EXISTS IN the slice of index_map from position zero TO position s1_count MINUS one THEN  
                SET start TO the first position of current_index_s2 in index_map  
                SET cycle_length TO s1_count MINUS start  
                SET cycles_fit TO the INTEGER DIVISION of n1 MINUS start BY cycle_length  
                SET remainder TO the MODULO of n1 MINUS start BY cycle_length  
                SET total_s2_count TO element at position start of s2_count PLUS cycles_fit MULTIPLIED BY the DIFFERENCE BETWEEN element at position start PLUS cycle_length of s2_count AND element at position start of s2_count PLUS element at position start PLUS remainder of s2_count MINUS element at position start of s2_count  
                RETURN the INTEGER DIVISION of total_s2_count BY n2  
            END IF  
        END WHILE  

        RETURN the INTEGER DIVISION of element at position s1_count of s2_count BY n2  
    END FUNCTION  
END CLASS