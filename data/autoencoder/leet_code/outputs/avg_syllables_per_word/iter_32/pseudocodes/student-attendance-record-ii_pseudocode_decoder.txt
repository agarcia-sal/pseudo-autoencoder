CLASS Solution  
    FUNCTION checkRecord WITH parameter n  
        SET MODULO TO one billion PLUS seven  
        
        SET dp TO a three dimensional list of size n PLUS one by two by three filled with zeroes  
        
        SET element at position zero of dimension zero position zero of dimension one position zero of dimension two of dp TO one  
        
        FOR i FROM one TO n  
            FOR j FROM zero TO one  
                FOR k FROM zero TO two  
                    SET element at position i of dimension zero position j of dimension one position zero of dimension two of dp TO element at position i of dimension zero position j of dimension one position zero of dimension two of dp PLUS element at position i MINUS one of dimension zero position j of dimension one position k of dimension two of dp  
                    SET element at position i of dimension zero position j of dimension one position zero of dimension two of dp TO element at position i of dimension zero position j of dimension one position zero of dimension two of dp MODULO MODULO  
                    
                    IF j EQUALS zero  
                        SET element at position i of dimension zero position one of dimension one position zero of dimension two of dp TO element at position i of dimension zero position one of dimension one position zero of dimension two of dp PLUS element at position i MINUS one of dimension zero position zero of dimension one position k of dimension two of dp  
                        SET element at position i of dimension zero position one of dimension one position zero of dimension two of dp TO element at position i of dimension zero position one of dimension one position zero of dimension two of dp MODULO MODULO  
                    END IF  
                    
                    IF k LESS THAN two  
                        SET element at position i of dimension zero position j of dimension one position k PLUS one of dimension two of dp TO element at position i of dimension zero position j of dimension one position k PLUS one of dimension two of dp PLUS element at position i MINUS one of dimension zero position j of dimension one position k of dimension two of dp  
                        SET element at position i of dimension zero position j of dimension one position k PLUS one of dimension two of dp TO element at position i of dimension zero position j of dimension one position k PLUS one of dimension two of dp MODULO MODULO  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        SET result TO zero  
        FOR j FROM zero TO one  
            FOR k FROM zero TO two  
                SET result TO result PLUS element at position n of dimension zero position j of dimension one position k of dimension two of dp  
                SET result TO result MODULO MODULO  
            END FOR  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS