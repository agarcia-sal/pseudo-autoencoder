CLASS Solution  
    FUNCTION pacificAtlantic(heights)  
        FUNCTION bfs(q, vis)  
            WHILE the LENGTH OF q IS GREATER THAN zero  
                FOR index FROM zero TO the LENGTH OF q MINUS one  
                    ASSIGN reference TO the ELEMENT REMOVED FROM THE LEFT OF q  
                    ASSIGN i TO the FIRST ELEMENT OF reference  
                    ASSIGN j TO the SECOND ELEMENT OF reference  
                    FOR each pair OF integers a AND b IN the list of pairs consisting of zero MINUS one zero one zero AND minus one zero zero one  
                        SET x TO i PLUS a  
                        SET y TO j PLUS b  
                        IF x IS GREATER THAN OR EQUAL TO zero AND x IS LESS THAN m AND y IS GREATER THAN OR EQUAL TO zero AND y IS LESS THAN n AND THE PAIR x y IS NOT IN vis AND THE ELEMENT AT POSITION x OF heights AT POSITION y IS GREATER THAN OR EQUAL TO THE ELEMENT AT POSITION i OF heights AT POSITION j THEN  
                            ADD THE PAIR x y TO vis  
                            APPEND THE PAIR x y TO q  
                        END IF  
                    END FOR  
                END FOR  
            END WHILE  
        END FUNCTION  

        SET m TO the LENGTH OF heights  
        SET n TO the LENGTH OF the ELEMENT AT POSITION zero OF heights  
        INITIALIZE vis1 AS AN EMPTY SET  
        INITIALIZE vis2 AS AN EMPTY SET  
        INITIALIZE q1 AS AN EMPTY DOUBLE ENDED QUEUE  
        INITIALIZE q2 AS AN EMPTY DOUBLE ENDED QUEUE  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF i EQUALS zero OR j EQUALS zero THEN  
                    ADD THE PAIR i j TO vis1  
                    APPEND THE PAIR i j TO q1  
                END IF  
                IF i EQUALS m MINUS one OR j EQUALS n MINUS one THEN  
                    ADD THE PAIR i j TO vis2  
                    APPEND THE PAIR i j TO q2  
                END IF  
            END FOR  
        END FOR  
        CALL bfs WITH ARGUMENTS q1 AND vis1  
        CALL bfs WITH ARGUMENTS q2 AND vis2  
        INITIALIZE result AS AN EMPTY LIST  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF THE PAIR i j IS IN vis1 AND THE PAIR i j IS IN vis2 THEN  
                    APPEND THE PAIR i j TO result  
                END IF  
            END FOR  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS