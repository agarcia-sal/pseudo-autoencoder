CLASS Solution  
    FUNCTION maximumMinutes(grid)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF the element at position zero of grid  
        SET directions TO a list containing the following pairs of numbers in order  
            first element is one and zero  
            second element is minus one and zero  
            third element is zero and one  
            fourth element is zero and minus one  
        
        FUNCTION can_escape(wait)  
            SET fire_times TO a list of lists, each inner list of length n filled with infinite value, and there are m such inner lists  
            SET queue TO an empty double ended queue  
            
            FOR i FROM zero TO m MINUS one  
                FOR j FROM zero TO n MINUS one  
                    IF the element at position i of grid EQUALS one THEN  
                        APPEND a triple consisting of i j and zero TO queue  
                        SET the element at position i then position j of fire_times TO zero  
                    END IF  
                END FOR  
            END FOR  
            
            WHILE the LENGTH OF queue is greater than zero  
                REMOVE the first element from queue and DESTRUCTURE it into x y t  
                FOR each pair dx dy IN directions  
                    SET nx TO x PLUS dx  
                    SET ny TO y PLUS dy  
                    IF nx is GREATER THAN OR EQUAL TO zero AND nx is LESS THAN m AND ny is GREATER THAN OR EQUAL TO zero AND ny is LESS THAN n AND the element at position nx then position ny of grid EQUALS zero AND the element at position nx then position ny of fire_times EQUALS infinite value THEN  
                        SET the element at position nx then position ny of fire_times TO t PLUS one  
                        APPEND a triple consisting of nx ny and t PLUS one TO queue  
                    END IF  
                END FOR  
            END WHILE  
            
            SET queue TO a double ended queue initialized with a triple zero zero and wait  
            SET visited TO a set initialized with a tuple of zero and zero  
            
            WHILE the LENGTH OF queue is greater than zero  
                REMOVE the first element from queue and DESTRUCTURE it into x y t  
                FOR each pair dx dy IN directions  
                    SET nx TO x PLUS dx  
                    SET ny TO y PLUS dy  
                    IF nx is GREATER THAN OR EQUAL TO zero AND nx is LESS THAN m AND ny is GREATER THAN OR EQUAL TO zero AND ny is LESS THAN n AND the tuple nx ny is NOT IN visited AND the element at position nx then position ny of grid EQUALS zero THEN  
                        IF nx EQUALS m MINUS one AND ny EQUALS n MINUS one THEN  
                            IF the element at position nx then position ny of fire_times is GREATER THAN OR EQUAL TO t PLUS one THEN  
                                RETURN True  
                            ELSE  
                                RETURN False  
                            END IF  
                        END IF  
                        IF the element at position nx then position ny of fire_times is GREATER THAN t PLUS one THEN  
                            ADD the tuple nx ny TO visited  
                            APPEND a triple consisting of nx ny and t PLUS one TO queue  
                        END IF  
                    END IF  
                END FOR  
            END WHILE  
            
            RETURN False  
        END FUNCTION  
        
        SET left TO zero  
        SET right TO m MULTIPLIED BY n  
        SET result TO minus one  
        
        WHILE left is LESS THAN OR EQUAL TO right  
            SET mid TO left PLUS right DIVIDED BY two rounded down to the nearest integer  
            IF can_escape with argument mid returns True THEN  
                SET result TO mid  
                SET left TO mid PLUS one  
            ELSE  
                SET right TO mid MINUS one  
            END IF  
        END WHILE  
        
        IF result NOT EQUALS m MULTIPLIED BY n THEN  
            RETURN result  
        ELSE  
            RETURN one followed by nine zeros  
        END IF  
    END FUNCTION  
END CLASS