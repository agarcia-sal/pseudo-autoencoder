CLASS Solution  
    FUNCTION findPaths(m, n, maxMove, startRow, startColumn)  
        SET MOD TO one billion plus seven  
        
        SET directions TO a collection of tuples consisting of zero and one then zero and negative one then one and zero then negative one and zero representing right left down up  
        
        CALL helper FUNCTION initialize_dp_array WITH parameters m n maxMove  
        SET dp TO the result of the helper FUNCTION initialize_dp_array  
        
        FOR k FROM one TO maxMove INCLUSIVE  
            FOR i FROM zero TO m MINUS one INCLUSIVE  
                FOR j FROM zero TO n MINUS one INCLUSIVE  
                    FOR each pair di dj IN directions  
                        SET ni TO i PLUS di  
                        SET nj TO j PLUS dj  
                        IF ni IS LESS THAN zero OR ni IS GREATER THAN OR EQUAL TO m OR nj IS LESS THAN zero OR nj IS GREATER THAN OR EQUAL TO n  
                            SET dp at position i j k TO dp at position i j k PLUS one MODULO MOD  
                        ELSE  
                            SET dp at position i j k TO dp at position i j k PLUS dp at position ni nj k MINUS one MODULO MOD  
                        END IF  
                    END FOR  
                END FOR  
            END FOR  
        END FOR  
        
        RETURN dp at position startRow startColumn maxMove  
    END FUNCTION  

    FUNCTION initialize_dp_array(m, n, maxMove)  
        CREATE a three dimensional array filled with zero with the first dimension size m the second dimension size n and the third dimension size maxMove plus one  
        RETURN the created array  
    END FUNCTION  
END CLASS