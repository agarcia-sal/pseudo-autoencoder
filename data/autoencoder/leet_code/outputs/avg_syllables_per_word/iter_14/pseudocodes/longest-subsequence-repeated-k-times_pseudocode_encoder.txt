CLASS Solution  
    FUNCTION longestSubsequenceRepeatedK WITH PARAMETERS s AND k  
        IMPORT the Counter FUNCTION FROM the collection utilities

        SET freq TO the COUNT OF EACH CHARACTER IN string s USING Counter

        SET valid_chars TO an EMPTY LIST  
        FOR each character AND its associated count IN freq items  
            IF count IS GREATER THAN OR EQUAL TO k  
                APPEND character TO valid_chars  
            END IF  
        END FOR  

        SORT valid_chars IN REVERSE LEXICOGRAPHICAL ORDER

        FUNCTION is_valid_subsequence WITH PARAMETER candidate  
            SET count TO zero  
            SET index TO zero  
            FOR each character IN string s  
                IF character IS EQUAL TO element at position index OF candidate  
                    INCREMENT index BY one  
                    IF index IS EQUAL TO the LENGTH OF candidate  
                        INCREMENT count BY one  
                        SET index TO zero  
                        IF count IS EQUAL TO k  
                            RETURN TRUE  
                        END IF  
                    END IF  
                END IF  
            END FOR  
            RETURN FALSE  
        END FUNCTION  

        SET max_length TO the LENGTH OF valid_chars DIVIDED BY k  
        SET best_candidate TO an EMPTY STRING

        FUNCTION backtrack WITH PARAMETER candidate  
            IF the LENGTH OF candidate IS GREATER THAN the LENGTH OF best_candidate  
                SET best_candidate TO candidate  
            END IF  
            FOR each character IN valid_chars  
                SET new_candidate TO candidate CONCATENATED WITH character  
                IF is_valid_subsequence WITH new_candidate RETURNS TRUE  
                    CALL backtrack WITH new_candidate  
                END IF  
            END FOR  
        END FUNCTION  

        CALL backtrack WITH an EMPTY STRING  
        RETURN best_candidate  
    END FUNCTION  
END CLASS