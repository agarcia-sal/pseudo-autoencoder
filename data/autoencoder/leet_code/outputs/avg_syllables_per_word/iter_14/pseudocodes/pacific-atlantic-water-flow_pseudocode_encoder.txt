CLASS Solution  
    FUNCTION pacificAtlantic WITH PARAMETER heights AS list of list of integers  
        FUNCTION bfs WITH PARAMETERS q, vis  
            WHILE q IS NOT EMPTY  
                FOR count FROM zero TO the LENGTH OF q MINUS one  
                    SET i TO the first element OF the pair REMOVED FROM the FRONT OF q  
                    SET j TO the second element OF the pair REMOVED FROM the FRONT OF q  
                    FOR each pair a, b IN the list containing the pairs zero MINUS one, zero ONE, ONE zero, MINUS one zero  
                        SET x TO i PLUS a  
                        SET y TO j PLUS b  
                        IF x IS GREATER THAN OR EQUAL TO zero AND x IS LESS THAN m AND y IS GREATER THAN OR EQUAL TO zero AND y IS LESS THAN n AND the pair x, y IS NOT IN vis AND the element at position x OF heights AND the element at position y OF that element IS GREATER THAN OR EQUAL TO the element at position i OF heights AND the element at position j OF that element  
                            ADD the pair x, y TO vis  
                            ADD the pair x, y TO the END OF q  
                        END IF  
                    END FOR  
                END FOR  
            END WHILE  
        END FUNCTION  
  
        SET m TO the LENGTH OF heights  
        SET n TO the LENGTH OF the element at position zero OF heights  
        SET vis1 TO an EMPTY SET  
        SET vis2 TO an EMPTY SET  
        SET q1 TO an EMPTY DOUBLE-ENDED QUEUE  
        SET q2 TO an EMPTY DOUBLE-ENDED QUEUE  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF i IS EQUAL TO zero OR j IS EQUAL TO zero  
                    ADD the pair i, j TO vis1  
                    ADD the pair i, j TO the END OF q1  
                END IF  
                IF i IS EQUAL TO m MINUS one OR j IS EQUAL TO n MINUS one  
                    ADD the pair i, j TO vis2  
                    ADD the pair i, j TO the END OF q2  
                END IF  
            END FOR  
        END FOR  
        CALL bfs WITH ARGUMENTS q1, vis1  
        CALL bfs WITH ARGUMENTS q2, vis2  
  
        SET result TO an EMPTY LIST  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF the pair i, j IS IN vis1 AND the pair i, j IS IN vis2  
                    APPEND the pair i, j TO result  
                END IF  
            END FOR  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS