CLASS Solution  
    FUNCTION sumOfFlooredPairs(nums)  
        SET MOD TO one followed by nine zeros PLUS seven  
        SET max_num TO the maximum value IN nums  
        SET count TO a mapping FROM each unique number IN nums TO its frequency  
        SET prefix_sum TO a list OF zeros WITH LENGTH max_num PLUS one  
          
        FOR each number num IN the keys OF count  
            INCREMENT the element at position num OF prefix_sum BY the frequency count at num  
        END FOR  
          
        FOR index i FROM one TO max_num  
            INCREMENT the element at position i OF prefix_sum BY the element at position i MINUS one OF prefix_sum  
        END FOR  
          
        SET result TO zero  
          
        FOR each number num IN the keys OF count  
            FOR each multiple FROM one TO the integer division of max_num BY num  
                SET start TO num MULTIPLIED BY multiple  
                SET end TO the smaller value BETWEEN num MULTIPLIED BY the sum of multiple PLUS one AND then MINUS one AND max_num  
                SET multiples_count TO the element at position end OF prefix_sum MINUS the element at position start MINUS one OF prefix_sum  
                INCREMENT result BY multiples_count MULTIPLIED BY multiple MULTIPLIED BY the frequency count at num  
                SET result TO result REMAINDER after division BY MOD  
            END FOR  
        END FOR  
          
        RETURN result  
    END FUNCTION  
END CLASS