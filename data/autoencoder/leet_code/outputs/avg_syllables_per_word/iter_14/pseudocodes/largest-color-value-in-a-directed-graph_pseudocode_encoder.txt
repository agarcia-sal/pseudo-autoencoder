CLASS Solution  
    FUNCTION largestPathValue(colors, edges)  
        SET n TO the LENGTH OF colors  
        SET graph TO a new mapping from keys to empty lists  
        SET in_degree TO a new list OF zero repeated n times  
        
        FOR each pair u and v IN edges  
            APPEND v TO the list at key u IN graph  
            INCREMENT the element at position v OF in_degree BY one  
        END FOR  
        
        SET queue TO a new double ended queue containing all indices i FROM zero TO n MINUS one WHERE the element at position i OF in_degree IS EQUAL TO zero  
        SET dp TO a new two dimensional list WITH n rows AND twenty six columns EACH initialized to zero  
        SET visited TO zero  
        SET max_color_value TO zero  
        
        WHILE the LENGTH OF queue IS GREATER THAN zero  
            REMOVE the first element FROM queue AND ASSIGN it TO node  
            INCREMENT the element at position the ordinal value of the character at position node OF colors MINUS the ordinal value of lowercase a IN the list at position node OF dp BY one  
            IF max_color_value IS LESS THAN the element at position the ordinal value of the character at position node OF colors MINUS the ordinal value of lowercase a IN the list at position node OF dp THEN  
                SET max_color_value TO that element  
            END IF  
            INCREMENT visited BY one  
            
            FOR each neighbor IN the list at key node IN graph  
                FOR color_index FROM zero TO twenty five  
                    IF the element at position color_index IN the list at position neighbor OF dp IS LESS THAN the element at position color_index IN the list at position node OF dp THEN  
                        SET the element at position color_index IN the list at position neighbor OF dp TO the element at position color_index IN the list at position node OF dp  
                    END IF  
                END FOR  
                DECREMENT the element at position neighbor OF in_degree BY one  
                IF the element at position neighbor OF in_degree IS EQUAL TO zero THEN  
                    APPEND neighbor TO queue  
                END IF  
            END FOR  
        END WHILE  
        
        IF visited IS EQUAL TO n THEN  
            RETURN max_color_value  
        ELSE  
            RETURN minus one  
        END IF  
    END FUNCTION  
END CLASS