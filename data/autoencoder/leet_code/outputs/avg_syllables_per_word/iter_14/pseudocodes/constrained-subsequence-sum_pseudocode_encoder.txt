CLASS Solution  
    FUNCTION constrainedSubsetSum(nums, k)  
        SET n TO the LENGTH OF nums  
        SET dp TO a list of zeros of LENGTH n  
        SET element at position zero OF dp TO element at position zero OF nums  
        SET max_sum TO element at position zero OF nums  
        
        SET q TO a new deque containing element zero  
        
        FOR i FROM one TO n MINUS one  
            IF element at position zero OF dp at element at position zero OF q IS GREATER THAN zero  
                SET dp at position i TO element at position i OF nums PLUS dp at element at position zero OF q  
            ELSE  
                SET dp at position i TO element at position i OF nums  
            END IF  
            
            IF max_sum IS LESS THAN dp at position i  
                SET max_sum TO dp at position i  
            END IF  
            
            WHILE the LENGTH OF q IS GREATER THAN zero AND dp at position i IS GREATER THAN OR EQUAL TO dp at element at position the LENGTH OF q MINUS one OF q  
                REMOVE the last element FROM q  
            END WHILE  
            
            APPEND i TO q  
            
            IF element at position zero OF q IS EQUAL TO i MINUS k  
                REMOVE the first element FROM q  
            END IF  
        END FOR  
        
        RETURN max_sum  
    END FUNCTION  
END CLASS