CLASS Solution  
    FUNCTION getLengthOfOptimalCompression(s, k)  
        FUNCTION dp(i, k_remaining, previous_character, previous_count)  
            IF k_remaining LESS THAN zero  
                RETURN positive infinity representing unachievable length  
            END IF  
            
            IF i EQUAL TO the LENGTH OF s  
                RETURN zero  
            END IF  
            
            IF character at position i OF s EQUAL TO previous_character  
                IF previous_count EQUAL TO one OR previous_count EQUAL TO nine OR previous_count EQUAL TO ninety nine  
                    SET increment_value TO one  
                ELSE  
                    SET increment_value TO zero  
                END IF  
                RETURN increment_value PLUS dp(i PLUS one, k_remaining, previous_character, previous_count PLUS one)  
            ELSE  
                SET keep_option TO one PLUS dp(i PLUS one, k_remaining, character at position i OF s, one)  
                SET delete_option TO dp(i PLUS one, k_remaining MINUS one, previous_character, previous_count)  
                RETURN the minimum of keep_option and delete_option  
            END IF  
        END FUNCTION  
        
        RETURN dp(zero, k, empty string, zero)  
    END FUNCTION  
END CLASS