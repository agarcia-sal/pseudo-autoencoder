CLASS Solution  
    FUNCTION nthSuperUglyNumber(n, primes)  
        SET ugly_numbers TO list containing the single element one  
        
        SET heap TO list of pairs where each pair contains element at position i OF primes AND i for each i and element in primes  
        CALL heapify FUNCTION ON heap TO TRANSFORM it into a MIN-HEAP structure  
        
        SET indices TO list of zeros with the LENGTH OF primes  
        
        WHILE the LENGTH OF ugly_numbers IS LESS THAN n  
            CALL heap_extract_min FUNCTION TO REMOVE AND RETURN the smallest pair FROM heap AND SET TO next_ugly AND prime_index  
            
            IF next_ugly IS NOT EQUAL TO the last element OF ugly_numbers  
                APPEND next_ugly TO ugly_numbers  
            END IF  
            
            INCREMENT the element at position prime_index OF indices BY one  
            SET next_multiple TO element at position prime_index OF primes MULTIPLIED BY element at position element at position prime_index OF indices OF ugly_numbers  
            CALL heap_insert FUNCTION TO ADD the pair next_multiple AND prime_index INTO heap  
        END WHILE  
        
        RETURN the last element OF ugly_numbers  
    END FUNCTION  
END CLASS