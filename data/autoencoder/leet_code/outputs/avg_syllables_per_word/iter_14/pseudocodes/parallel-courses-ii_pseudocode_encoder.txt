CLASS Solution  
    FUNCTION minNumberOfSemesters(n, relations, k)  
        SET graph TO an empty mapping with default value as an empty list  
        SET in_degree TO a list of zero values with the length of n PLUS one  
        
        FOR each pair of prevCourse AND nextCourse IN relations  
            APPEND nextCourse TO the list associated with prevCourse IN graph  
            INCREMENT the element at position nextCourse OF in_degree BY one  
        END FOR  
        
        SET queue TO an empty double-ended queue  
        FOR course FROM one TO n INCLUSIVE  
            IF the element at position course OF in_degree IS EQUAL TO zero  
                APPEND course TO queue  
            END IF  
        END FOR  
        
        SET semesters TO zero  
        
        WHILE queue IS NOT empty  
            SET limit TO the smaller VALUE BETWEEN k AND the LENGTH OF queue  
            FOR counter FROM one TO limit INCLUSIVE  
                REMOVE the first element FROM queue AND ASSIGN IT TO current_course  
                FOR each next_course IN the list associated with current_course IN graph  
                    DECREMENT the element at position next_course OF in_degree BY one  
                    IF the element at position next_course OF in_degree IS EQUAL TO zero  
                        APPEND next_course TO queue  
                    END IF  
                END FOR  
            END FOR  
            INCREMENT semesters BY one  
        END WHILE  
        
        RETURN semesters  
    END FUNCTION  
END CLASS