CLASS Solution  
    FUNCTION superpalindromesInRange WITH PARAMETERS left right  
        FUNCTION is_palindrome WITH PARAMETER num  
            SET string_representation TO string conversion OF num  
            SET reversed_string TO string_representation IN REVERSE ORDER  
            IF string_representation EQUAL TO reversed_string  
                RETURN true  
            ELSE  
                RETURN false  
            END IF  
        END FUNCTION  

        FUNCTION generate_palindromes WITH PARAMETER limit  
            SET palindromes TO empty list  
            FOR index FROM one TO one hundred thousand MINUS one  
                SET s TO string conversion OF index  
                SET odd_length_palindrome_string TO concatenation OF s AND substring FROM position LENGTH OF s MINUS two DOWN TO zero OF s  
                CONVERT odd_length_palindrome_string TO number AND APPEND TO palindromes  
                SET even_length_palindrome_string TO concatenation OF s AND substring FROM position LENGTH OF s MINUS one DOWN TO zero OF s  
                CONVERT even_length_palindrome_string TO number AND APPEND TO palindromes  
            END FOR  
            SET filtered_palindromes TO empty list  
            FOR each palindrome IN palindromes  
                IF palindrome LESS THAN OR EQUAL TO limit  
                    APPEND palindrome TO filtered_palindromes  
                END IF  
            END FOR  
            RETURN filtered_palindromes  
        END FUNCTION  

        SET left TO integer conversion OF left  
        SET right TO integer conversion OF right  
        SET limit TO integer conversion OF the square root OF right PLUS one  
        SET palindromes TO generate_palindromes WITH PARAMETER limit  

        SET count TO zero  
        FOR each p IN palindromes  
            SET square TO p MULTIPLIED BY p  
            IF left LESS THAN OR EQUAL TO square AND square LESS THAN OR EQUAL TO right AND is_palindrome WITH PARAMETER square RETURNS true  
                INCREMENT count BY one  
            END IF  
        END FOR  

        RETURN count  
    END FUNCTION  
END CLASS