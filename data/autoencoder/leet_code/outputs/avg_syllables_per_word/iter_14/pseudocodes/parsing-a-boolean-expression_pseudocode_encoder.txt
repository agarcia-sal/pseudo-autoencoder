CLASS Solution  
    FUNCTION parseBoolExpr WITH PARAMETER expression  
        SET stk TO an empty list  
        FOR each character c IN expression  
            IF c IS one of t f exclamation AND ampersand OR vertical line  
                APPEND c TO stk  
            ELSE IF c IS closing parenthesis  
                SET t TO zero  
                SET f TO zero  
                WHILE the last element OF stk IS one of t f  
                    INCREMENT t BY one IF the last element OF stk IS t OTHERWISE zero  
                    INCREMENT f BY one IF the last element OF stk IS f OTHERWISE zero  
                    REMOVE the last element FROM stk  
                END WHILE  
                SET op TO the last element OF stk  
                REMOVE the last element FROM stk  
                IF op IS exclamation  
                    SET c TO t IF f IS equal to zero OTHERWISE f  
                ELSE IF op IS ampersand  
                    SET c TO f IF f IS greater than zero OTHERWISE t  
                ELSE IF op IS vertical line  
                    SET c TO t IF t IS greater than zero OTHERWISE f  
                END IF  
                APPEND c TO stk  
            END IF  
        END FOR  
        RETURN whether the first element OF stk IS equal to t  
    END FUNCTION  
END CLASS