CLASS Solution  
    FUNCTION numPoints(darts, r)  
        FUNCTION distance(p1, p2)  
            SET difference_in_x TO element at position zero OF p1 MINUS element at position zero OF p2  
            SET difference_in_y TO element at position one OF p1 MINUS element at position one OF p2  
            SET square_of_difference_in_x TO difference_in_x MULTIPLIED BY difference_in_x  
            SET square_of_difference_in_y TO difference_in_y MULTIPLIED BY difference_in_y  
            SET sum_of_squares TO square_of_difference_in_x PLUS square_of_difference_in_y  
            SET result TO square root OF sum_of_squares  
            RETURN result  
        END FUNCTION  
        
        FUNCTION circle_center(p1, p2, r)  
            SET d TO distance(p1, p2)  
            IF d GREATER THAN two MULTIPLIED BY r  
                RETURN None  
            END IF  
            SET square_of_r TO r MULTIPLIED BY r  
            SET half_d TO d DIVIDED BY two  
            SET square_of_half_d TO half_d MULTIPLIED BY half_d  
            SET a TO square root OF square_of_r MINUS square_of_half_d  
            SET h_x TO element at position zero OF p1 PLUS element at position zero OF p2  
            SET h_y TO element at position one OF p1 PLUS element at position one OF p2  
            SET half_h_x TO h_x DIVIDED BY two  
            SET half_h_y TO h_y DIVIDED BY two  
            SET dx TO element at position one OF p2 MINUS element at position one OF p1  
            SET dx_scaled TO dx MULTIPLIED BY a DIVIDED BY d  
            SET dy TO element at position zero OF p2 MINUS element at position zero OF p1  
            SET dy_scaled TO dy MULTIPLIED BY a DIVIDED BY d  
            SET first_center_x TO half_h_x MINUS dx_scaled  
            SET first_center_y TO half_h_y PLUS dy_scaled  
            SET second_center_x TO half_h_x PLUS dx_scaled  
            SET second_center_y TO half_h_y MINUS dy_scaled  
            SET result TO list CONTAINING tuple OF first_center_x AND first_center_y AND tuple OF second_center_x AND second_center_y  
            RETURN result  
        END FUNCTION  
        
        FUNCTION is_inside(circle, point, r)  
            SET dist TO distance(circle, point)  
            IF dist LESS THAN OR EQUAL TO r  
                RETURN True  
            ELSE  
                RETURN False  
            END IF  
        END FUNCTION  
        
        SET n TO LENGTH OF darts  
        IF n EQUAL TO one  
            RETURN one  
        END IF  
        
        SET max_count TO one  
        
        FOR i FROM zero TO n MINUS one  
            FOR j FROM i PLUS one TO n MINUS one  
                SET centers TO circle_center(element at position i OF darts, element at position j OF darts, r)  
                IF centers IS NOT None  
                    FOR each center IN centers  
                        SET count TO zero  
                        FOR each dart IN darts  
                            IF is_inside(center, dart, r) IS True  
                                INCREMENT count BY one  
                            END IF  
                        END FOR  
                        IF count GREATER THAN max_count  
                            SET max_count TO count  
                        END IF  
                    END FOR  
                END IF  
            END FOR  
        END FOR  
        
        RETURN max_count  
    END FUNCTION  
END CLASS