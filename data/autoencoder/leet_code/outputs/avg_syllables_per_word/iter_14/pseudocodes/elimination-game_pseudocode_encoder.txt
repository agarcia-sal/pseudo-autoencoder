CLASS Solution  
    FUNCTION lastRemaining WITH PARAMETER n  
        SET remaining TO n  
        SET step TO one  
        SET left_to_right TO true  
        SET head TO one  
        
        WHILE remaining IS GREATER THAN one  
            IF left_to_right IS true OR remaining MODULO two IS EQUAL TO one  
                INCREMENT head BY step  
            END IF  
            MULTIPLY step BY two  
            SET remaining TO remaining DIVIDED BY two  
            SET left_to_right TO NOT left_to_right  
        END WHILE  
        
        RETURN head  
    END FUNCTION  
END CLASS