CLASS TrieNode  
    FUNCTION __init__ with self  
        SET self.children TO a new default dictionary mapping to a new TrieNode  
        SET self.deleted TO false  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION deleteDuplicateFolder with self and paths  
        SET ans TO an empty list  
        SET root TO a new TrieNode  
        SET subtreeToNodes TO a new default dictionary mapping to a new empty list  

        FOR each path IN the result of sorting paths in ascending order  
            SET node TO root  
            FOR each s IN path  
                SET node TO the element at key s OF node.children  
            END FOR  
        END FOR  

        FUNCTION buildSubtreeToRoots with node  
            SET subtree TO the string composed of an opening parenthesis concatenated with the concatenation for each key s IN node.children in their natural order of the string s concatenated with the result of calling buildSubtreeToRoots with the element at key s OF node.children concatenated with a closing parenthesis  
            IF subtree IS NOT EQUAL TO the string of an opening parenthesis followed immediately by a closing parenthesis  
                APPEND node TO the list at key subtree OF subtreeToNodes  
            END IF  
            RETURN subtree  
        END FUNCTION  

        CALL buildSubtreeToRoots with root  

        FOR each nodes IN the collection of values OF subtreeToNodes  
            IF the LENGTH OF nodes IS GREATER THAN one  
                FOR each node IN nodes  
                    SET node.deleted TO true  
                END FOR  
            END IF  
        END FOR  

        FUNCTION constructPath with node and path  
            FOR each key s and corresponding child node child IN node.children items  
                IF child.deleted IS EQUAL TO false  
                    CALL constructPath with child and the list created by concatenating path and list containing s  
                END IF  
            END FOR  
            IF the LENGTH OF path IS GREATER THAN zero  
                APPEND path TO ans  
            END IF  
        END FUNCTION  

        CALL constructPath with root and an empty list  
        RETURN ans  
    END FUNCTION  
END CLASS