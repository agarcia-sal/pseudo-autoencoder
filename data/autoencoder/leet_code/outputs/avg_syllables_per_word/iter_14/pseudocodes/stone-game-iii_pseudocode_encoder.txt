CLASS Solution  
    FUNCTION stoneGameIII WITH PARAMETER stoneValue  
        SET n TO the LENGTH OF stoneValue  
        SET dp TO a LIST OF zero WITH the LENGTH OF n PLUS one  
        
        FOR i FROM n MINUS one DOWN TO zero  
            SET dp AT position i TO the ELEMENT at position i OF stoneValue MINUS dp AT position i PLUS one  
            IF i PLUS two IS LESS THAN OR EQUAL TO n  
                SET dp AT position i TO the GREATER VALUE BETWEEN dp AT position i AND the SUM OF the ELEMENTS at positions i AND i PLUS one OF stoneValue MINUS dp AT position i PLUS two  
            END IF  
            IF i PLUS three IS LESS THAN OR EQUAL TO n  
                SET dp AT position i TO the GREATER VALUE BETWEEN dp AT position i AND the SUM OF the ELEMENTS at positions i AND i PLUS one AND i PLUS two OF stoneValue MINUS dp AT position i PLUS three  
            END IF  
        END FOR  
        
        IF dp AT position zero IS GREATER THAN zero  
            RETURN string ALICE  
        ELSE IF dp AT position zero IS LESS THAN zero  
            RETURN string BOB  
        ELSE  
            RETURN string TIE  
        END IF  
    END FUNCTION  
END CLASS