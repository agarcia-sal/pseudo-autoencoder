CLASS Solution  
    FUNCTION maxCandies WITH PARAMETERS status AS list of integer candies AS list of integer keys AS list of list of integer containedBoxes AS list of list of integer initialBoxes AS list of integer  
        SET boxes_we_have TO a new set initialized with all elements from initialBoxes  
        SET keys_we_have TO a new empty set  
        SET total_candies TO zero  
        SET progress_made TO TRUE  
        WHILE progress_made IS TRUE  
            SET progress_made TO FALSE  
            FOR each box IN a new list containing all elements from boxes_we_have  
                IF element at position box OF status IS EQUAL TO one OR box IS AN ELEMENT OF keys_we_have  
                    INCREMENT total_candies BY element at position box OF candies  
                    ADD all elements from element at position box OF keys TO keys_we_have  
                    ADD all elements from element at position box OF containedBoxes TO boxes_we_have  
                    REMOVE box FROM boxes_we_have  
                    SET progress_made TO TRUE  
                END IF  
            END FOR  
        END WHILE  
        RETURN total_candies  
    END FUNCTION  
END CLASS