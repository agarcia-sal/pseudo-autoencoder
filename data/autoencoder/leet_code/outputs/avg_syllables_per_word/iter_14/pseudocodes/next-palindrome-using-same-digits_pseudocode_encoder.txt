CLASS Solution  
    FUNCTION nextPalindrome WITH PARAMETER num  
        SET n TO the LENGTH OF num  
        SET half TO the SUBSTRING FROM the START TO the VALUE OF n DIVIDED BY two OF num  
        
        SET half_list TO the LIST OF CHARACTERS OF half  
        SET k TO negative one  
        SET l TO negative one  
        
        FOR i FROM the VALUE OF the LENGTH OF half_list MINUS two DOWN TO zero  
            IF the ELEMENT AT POSITION i OF half_list IS LESS THAN the ELEMENT AT POSITION i PLUS one OF half_list  
                SET k TO i  
                BREAK the FOR loop  
            END IF  
        END FOR  
        
        IF k IS EQUAL TO negative one  
            RETURN EMPTY STRING  
        END IF  
        
        FOR i FROM the VALUE OF the LENGTH OF half_list MINUS one DOWN TO k PLUS one  
            IF the ELEMENT AT POSITION i OF half_list IS GREATER THAN the ELEMENT AT POSITION k OF half_list  
                SET l TO i  
                BREAK the FOR loop  
            END IF  
        END FOR  
        
        SWAP the ELEMENT AT POSITION k OF half_list WITH the ELEMENT AT POSITION l OF half_list  
        
        SET half_list TO the CONCATENATION OF the SUBLIST FROM START TO k PLUS one OF half_list WITH the SORTED SUBLIST FROM POSITION k PLUS one TO the END OF half_list  
        
        SET new_half TO the STRING FORMED BY JOINING all ELEMENTS OF half_list  
        
        IF n MODULO two IS EQUAL TO zero  
            SET reversed_new_half TO the STRING FORMED BY REVERSING new_half  
            RETURN the CONCATENATION OF new_half WITH reversed_new_half  
        ELSE  
            SET middle_character TO the ELEMENT AT POSITION n DIVIDED BY two OF num  
            SET reversed_new_half TO the STRING FORMED BY REVERSING new_half  
            RETURN the CONCATENATION OF new_half WITH middle_character WITH reversed_new_half  
        END IF  
    END FUNCTION  
END CLASS