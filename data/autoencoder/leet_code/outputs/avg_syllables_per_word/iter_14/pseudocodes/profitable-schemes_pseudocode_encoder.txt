CLASS Solution  
    FUNCTION profitableSchemes(n, minProfit, group, profit)  
        SET MOD to one billion plus seven  
        
        DEFINE FUNCTION MAXIMUM OF two_numbers AND another_number  
            IF two_numbers IS GREATER THAN another_number  
                RETURN two_numbers  
            ELSE  
                RETURN another_number  
            END IF  
        END FUNCTION  
        
        INITIALIZE dp AS a two dimensional list WITH (n PLUS one) rows AND (minProfit PLUS one) columns FILLED WITH zero  
        
        FOR index FROM zero TO n  
            SET element at position zero OF dp at position index TO one  
        END FOR  
        
        FOR each pair p AND g IN profit AND group TOGETHER  
            FOR i FROM n DOWN TO g  
                FOR j FROM minProfit DOWN TO zero  
                    SET j_minus_p TO MAXIMUM OF zero AND (j MINUS p)  
                    SET dp at position i AND j TO dp at position i AND j PLUS dp at position (i MINUS g) AND j_minus_p  
                    SET dp at position i AND j TO dp at position i AND j MODULO MOD  
                END FOR  
            END FOR  
        END FOR  
        
        RETURN dp at position n AND minProfit  
    END FUNCTION  
END CLASS