CLASS Solution  
    FUNCTION removeDuplicateLetters(s)  
        SET last_occurrence TO RESULT OF create_mapping_of_each_character_to_its_last_position_in_s USING s  
        SET stack TO empty list  
        SET in_stack TO empty set  
        
        FOR each pair of index_and_character IN s WITH indexes FROM zero TO LENGTH OF s MINUS one  
            SET idx TO the index part OF index_and_character  
            SET char TO the character part OF index_and_character  
            
            IF char IS IN in_stack  
                CONTINUE TO next iteration  
            END IF  
            
            WHILE the LENGTH OF stack IS GREATER THAN zero AND char IS LESS THAN element_at_position LENGTH OF stack MINUS one OF stack AND idx IS LESS THAN value_at_key element_at_position LENGTH OF stack MINUS one OF stack IN last_occurrence  
                SET removed_char TO last element OF stack REMOVED FROM stack  
                REMOVE removed_char FROM in_stack  
            END WHILE  
            
            APPEND char TO stack  
            ADD char TO in_stack  
        END FOR  
        
        SET result_string TO concatenation OF all characters IN stack IN ORDER  
        RETURN result_string  
    END FUNCTION  
END CLASS