CLASS Solution  
    FUNCTION uniqueLetterString WITH PARAMETER s  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF s  
        
        CALL initializeList WITH PARAMETERS negative one AND twenty six RETURNING last  
        CALL initializeList WITH PARAMETERS negative one AND twenty six RETURNING last2  
        
        SET result TO zero  
        
        FOR each index i AND character char IN s  
            CALL calculateIndex WITH PARAMETERS char RETURNING idx  
            
            CALL calculateContribution WITH PARAMETERS i last idx last last2 MOD result RETURNING result  
            
            CALL updatePositions WITH PARAMETERS idx i last last2  
        END FOR  
        
        FOR index i FROM zero TO twenty six MINUS one  
            CALL finalizeContribution WITH PARAMETERS n last last2 i MOD result RETURNING result  
        END FOR  
        
        RETURN result  
    END FUNCTION  

    FUNCTION initializeList WITH PARAMETERS value count  
        DESCRIPTION create a list containing count number of elements each SET TO value  
    END FUNCTION

    FUNCTION calculateIndex WITH PARAMETER character  
        DESCRIPTION DETERMINE the integer index corresponding TO the character by subtracting the integer value of capital A  
    END FUNCTION

    FUNCTION calculateContribution WITH PARAMETERS currentIndex lastIndex charIndex lastPositions lastPositions2 modulus currentResult  
        DESCRIPTION COMPUTE the contribution of the current character position TO the cumulative result USING the formula:  
        THE currentResult PLUS THE difference of currentIndex MINUS lastPositions AT charIndex MULTIPLIED BY lastPositions AT charIndex MINUS lastPositions2 AT charIndex  
        THEN MODULO modulus  
        RETURN the updated result  
    END FUNCTION

    FUNCTION updatePositions WITH PARAMETERS charIndex currentIndex lastPositions lastPositions2  
        DESCRIPTION SET lastPositions2 AT charIndex TO lastPositions AT charIndex  
        SET lastPositions AT charIndex TO currentIndex  
    END FUNCTION

    FUNCTION finalizeContribution WITH PARAMETERS totalLength lastPositions lastPositions2 index modulus currentResult  
        DESCRIPTION ADD TO currentResult THE product OF totalLength MINUS lastPositions AT index MULTIPLIED BY lastPositions AT index MINUS lastPositions2 AT index  
        THEN MODULO modulus  
        RETURN the updated result  
    END FUNCTION  
END CLASS