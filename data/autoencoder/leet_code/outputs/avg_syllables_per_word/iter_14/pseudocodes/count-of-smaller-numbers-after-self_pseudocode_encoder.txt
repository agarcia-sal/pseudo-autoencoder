CLASS Solution  
    FUNCTION countSmaller(nums)  
        SET sorted_nums TO the UNIQUE ELEMENTS OF nums SORTED IN ASCENDING ORDER  
        SET rank TO AN EMPTY MAPPING FROM VALUE TO INTEGER  
        SET index TO one  
        FOR each value IN sorted_nums  
            ASSIGN value IN rank TO index  
            INCREMENT index BY one  
        END FOR  
        
        SET bit TO A LIST OF ZEROES WITH LENGTH EQUAL TO THE LENGTH OF sorted_nums PLUS one  
        
        FUNCTION get_sum(idx)  
            SET res TO zero  
            WHILE idx IS GREATER THAN zero  
                INCREMENT res BY the ELEMENT at POSITION idx OF bit  
                DECREMENT idx BY THE VALUE OF idx AND BITWISE AND WITH ITS NEGATION  
            END WHILE  
            RETURN res  
        END FUNCTION  
        
        FUNCTION update(idx, delta)  
            WHILE idx IS LESS THAN THE LENGTH OF bit  
                INCREMENT the ELEMENT at POSITION idx OF bit BY delta  
                INCREMENT idx BY THE VALUE OF idx AND BITWISE AND WITH ITS NEGATION  
            END WHILE  
        END FUNCTION  
        
        SET counts TO AN EMPTY LIST  
        FOR each num IN nums TRAVERSED FROM LAST TO FIRST  
            SET r TO THE VALUE MAPPED BY num IN rank  
            APPEND THE RESULT OF get_sum WITH PARAMETER r MINUS one TO counts  
            CALL update WITH PARAMETERS r AND one  
        END FOR  
        
        RETURN counts IN REVERSE ORDER  
    END FUNCTION  
END CLASS