CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MODULO TO one followed by nine zeros PLUS seven  
        SORT the list arr IN ASCENDING ORDER  
        INITIALIZE dictionary dp WITH key each number FROM arr AND value one  
        
        FOR each index i AND number num IN arr FROM START TO END  
            FOR each index j FROM zero TO i MINUS one  
                IF the remainder of num DIVIDED BY the element at position j OF arr IS EQUAL TO zero THEN  
                    SET right_child TO num DIVIDED BY the element at position j OF arr  
                    IF right_child IS A KEY IN dictionary dp THEN  
                        SET dp OF key num TO sum of dp OF key num PLUS product of dp OF key element at position j OF arr AND dp OF key right_child  
                        SET dp OF key num TO dp OF key num MODULO MODULO  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        
        SET total_count TO sum of all values IN dictionary dp  
        SET total_count TO total_count MODULO MODULO  
        RETURN total_count  
    END FUNCTION  
END CLASS