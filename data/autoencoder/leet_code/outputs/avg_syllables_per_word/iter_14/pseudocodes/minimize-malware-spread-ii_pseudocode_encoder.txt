CLASS Solution  
    FUNCTION minMalwareSpread WITH PARAMETERS graph AND initial  
        SET n TO the LENGTH OF graph  
        INITIALIZE adj_list AS a DEFAULT DICTIONARY that maps TO an EMPTY LIST  
        FOR i FROM zero TO n MINUS one  
            FOR j FROM i PLUS one TO n MINUS one  
                IF element at position j OF element at position i OF graph IS EQUAL TO one  
                    APPEND j TO adj_list AT KEY i  
                    APPEND i TO adj_list AT KEY j  
                END IF  
            END FOR  
        END FOR  
  
        FUNCTION dfs WITH PARAMETERS node AND visited  
            IF visited CONTAINS node  
                RETURN zero  
            END IF  
            ADD node TO visited  
            SET size TO one  
            FOR each neighbor IN adj_list AT KEY node  
                SET size TO size PLUS dfs CALLED WITH neighbor AND visited  
            END FOR  
            RETURN size  
        END FUNCTION  
  
        INITIALIZE infected AS a SET CONTAINING all ELEMENTS OF initial  
  
        INITIALIZE component_sizes AS an EMPTY LIST  
        INITIALIZE visited AS an EMPTY SET  
        INITIALIZE component_index AS an EMPTY MAP  
  
        FOR node FROM zero TO n MINUS one  
            IF visited DOES NOT CONTAIN node AND infected DOES NOT CONTAIN node  
                SET size TO dfs CALLED WITH node AND visited  
                APPEND size TO component_sizes  
                SET i TO the LENGTH OF component_sizes MINUS one  
                FOR neighbor IN adj_list AT KEY node  
                    ASSIGN i TO component_index AT KEY neighbor  
                END FOR  
            END IF  
        END FOR  
  
        INITIALIZE infected_in_component AS a DEFAULT DICTIONARY that maps TO zero  
  
        FOR node IN infected  
            IF component_index CONTAINS node  
                INCREMENT infected_in_component AT KEY component_index AT KEY node BY one  
            END IF  
        END FOR  
  
        SET max_size TO zero  
        SET node_to_remove TO the MINIMUM ELEMENT OF initial  
  
        FOR node IN infected  
            IF component_index CONTAINS node  
                SET comp_idx TO component_index AT KEY node  
                IF infected_in_component AT KEY comp_idx IS EQUAL TO one  
                    IF component_sizes AT POSITION comp_idx IS GREATER THAN max_size  
                        SET max_size TO component_sizes AT POSITION comp_idx  
                        SET node_to_remove TO node  
                    ELSE IF component_sizes AT POSITION comp_idx IS EQUAL TO max_size  
                        IF node IS LESS THAN node_to_remove  
                            SET node_to_remove TO node  
                        END IF  
                    END IF  
                END IF  
            END IF  
        END FOR  
  
        RETURN node_to_remove  
    END FUNCTION  
END CLASS