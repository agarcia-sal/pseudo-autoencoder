CLASS Solution  
    FUNCTION calculate WITH PARAMETER s  
        FUNCTION helper WITH PARAMETER s  
            SET stack TO empty list  
            SET sign TO character plus  
            SET num TO zero  
            
            WHILE the LENGTH OF s IS GREATER THAN zero  
                SET char TO remove the FIRST element FROM s  
                
                IF char IS a digit  
                    SET num TO num MULTIPLIED BY ten PLUS the numeric value OF char  
                END IF  
                
                IF char IS character left parenthesis  
                    SET num TO result OF calling helper WITH PARAMETER s  
                END IF  
                
                IF char IS NOT a digit AND char IS NOT a whitespace OR the LENGTH OF s IS EQUAL TO zero  
                    IF sign IS character plus  
                        APPEND num TO stack  
                    ELSE IF sign IS character minus  
                        APPEND negative num TO stack  
                    ELSE IF sign IS character multiplication  
                        SET the LAST element OF stack TO the LAST element OF stack MULTIPLIED BY num  
                    ELSE IF sign IS character division  
                        SET the LAST element OF stack TO the integer part OF the LAST element OF stack DIVIDED BY num  
                    END IF  
                    
                    SET sign TO char  
                    SET num TO zero  
                END IF  
                
                IF char IS character right parenthesis  
                    BREAK the WHILE loop  
                END IF  
            END WHILE  
            
            RETURN the SUM OF stack  
        END FUNCTION  
        
        RETURN the RESULT OF calling helper WITH PARAMETER the CONVERSION OF s INTO a list of characters  
    END FUNCTION  
END CLASS