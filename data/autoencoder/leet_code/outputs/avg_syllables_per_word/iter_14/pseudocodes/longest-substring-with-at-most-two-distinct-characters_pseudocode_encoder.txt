CLASS Solution  
    FUNCTION lengthOfLongestSubstringTwoDistinct WITH PARAMETER s  
        INITIALIZE character count dictionary TO a new dictionary that returns zero for any missing key  
        SET left pointer TO zero  
        SET maximum length TO zero  
        
        FOR right pointer FROM zero TO the length of s MINUS one  
            INCREMENT the count of the character at position right pointer OF s BY one  
            
            WHILE the count of distinct keys in character count dictionary IS GREATER THAN two  
                DECREMENT the count of the character at position left pointer OF s BY one  
                IF the count of the character at position left pointer OF s IS EQUAL TO zero  
                    REMOVE the character at position left pointer OF s FROM the character count dictionary  
                END IF  
                INCREMENT left pointer BY one  
            END WHILE  
            
            SET maximum length TO the GREATER OF maximum length AND the difference BETWEEN right pointer AND left pointer PLUS one  
        END FOR  
        
        RETURN maximum length  
    END FUNCTION  
END CLASS