CLASS Solution  
    FUNCTION maxNumOfSubstrings(s)  
        SET first TO an empty mapping from character TO integer  
        SET last TO an empty mapping from character TO integer  
        SET index TO zero  
        FOR each character c IN s WITH index index  
            IF c is NOT IN first  
                SET first at key c TO index  
            END IF  
            SET last at key c TO index  
            INCREMENT index BY one  
        END FOR  
        
        SET intervals TO an empty list  
        FOR each character c IN the keys of first  
            SET start TO the value of first at key c  
            SET end TO the value of last at key c  
            SET i TO start  
            WHILE i IS LESS THAN OR EQUAL TO end  
                IF the value of first at key character at position i OF s IS LESS THAN start  
                    BREAK from WHILE  
                END IF  
                SET end TO the GREATER OF end AND the value of last at key character at position i OF s  
                INCREMENT i BY one  
            END WHILE  
            IF i IS GREATER THAN end (condition following WHILE without break)  
                APPEND the tuple of start AND end TO intervals  
            END IF  
        END FOR  
        
        CALL the sort ROUTINE on intervals USING a key function that RETURNS the second element of the tuple  
        
        SET result TO an empty list  
        SET prev_end TO negative one  
        FOR each tuple of start AND end IN intervals  
            IF start IS GREATER THAN prev_end  
                APPEND the substring from position start TO position end OF s TO result  
                SET prev_end TO end  
            END IF  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS