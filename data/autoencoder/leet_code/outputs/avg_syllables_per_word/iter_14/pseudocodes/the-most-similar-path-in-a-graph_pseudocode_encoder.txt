CLASS Solution  
    FUNCTION mostSimilar WITH PARAMETERS n names roads targetPath  
        SET graph TO a new default dictionary with list as default value  
        FOR each element consisting of u AND v IN roads  
            APPEND element v TO the list at key u in graph  
            APPEND element u TO the list at key v in graph  
        END FOR  
        
        SET m TO the LENGTH OF targetPath  
        
        FUNCTION dp WITH PARAMETERS i j  
            IF i EQUAL TO zero THEN  
                IF element at position j OF names IS NOT EQUAL TO element at position i OF targetPath THEN  
                    RETURN one AND list containing element j  
                ELSE  
                    RETURN zero AND list containing element j  
                END IF  
            END IF  
            
            SET min_cost TO positive infinity  
            SET min_path TO empty list  
            FOR each element k IN the list at key j in graph  
                SET cost_and_path TO the result OF calling dp WITH PARAMETERS i MINUS one AND k  
                SET cost TO the first element OF cost_and_path  
                SET path TO the second element OF cost_and_path  
                IF cost IS LESS THAN min_cost THEN  
                    SET min_cost TO cost  
                    SET min_path TO path  
                END IF  
            END FOR  
            
            IF element at position j OF names IS NOT EQUAL TO element at position i OF targetPath THEN  
                SET current_cost TO min_cost PLUS one  
            ELSE  
                SET current_cost TO min_cost  
            END IF  
            RETURN current_cost AND the result OF concatenating min_path WITH list containing element j  
        END FUNCTION  
        
        SET min_cost TO positive infinity  
        SET min_path TO empty list  
        FOR integer j FROM zero TO n MINUS one  
            SET cost_and_path TO the result OF calling dp WITH PARAMETERS m MINUS one AND j  
            SET cost TO the first element OF cost_and_path  
            SET path TO the second element OF cost_and_path  
            IF cost IS LESS THAN min_cost THEN  
                SET min_cost TO cost  
                SET min_path TO path  
            END IF  
        END FOR  
        
        RETURN min_path  
    END FUNCTION  
END CLASS