CLASS Solution  
    FUNCTION countSubgraphsForEachDiameter(n parameter, edges parameter)  
        SET graph TO a new empty mapping FROM integers TO lists  
        FOR each integer i FROM one TO n parameter inclusive  
            SET the element at position i OF graph TO a new empty list  
        END FOR  
        FOR each pair u and v IN edges parameter  
            APPEND v TO the element at position u OF graph  
            APPEND u TO the element at position v OF graph  
        END FOR  
        
        FUNCTION bfs(subtree parameter)  
            SET start TO an arbitrary element FROM subtree parameter  
            SET queue TO a new queue containing start  
            SET visited TO a new set containing start  
            SET distance TO zero  
            SET farthest_node TO start  
            
            WHILE queue IS NOT empty  
                SET node TO the element taken from the front of queue  
                FOR each neighbor IN the element at position node OF graph  
                    IF neighbor IS IN subtree parameter AND neighbor IS NOT IN visited THEN  
                        ADD neighbor TO visited  
                        ADD neighbor TO queue  
                        SET farthest_node TO neighbor  
                    END IF  
                END FOR  
            END WHILE  
            
            SET queue TO a new queue containing farthest_node  
            SET visited TO a new set containing farthest_node  
            SET max_distance TO zero  
            
            WHILE queue IS NOT empty  
                SET size TO the number of elements IN queue  
                FOR each index FROM one TO size inclusive  
                    SET node TO the element taken from the front of queue  
                    FOR each neighbor IN the element at position node OF graph  
                        IF neighbor IS IN subtree parameter AND neighbor IS NOT IN visited THEN  
                            ADD neighbor TO visited  
                            ADD neighbor TO queue  
                        END IF  
                    END FOR  
                END FOR  
                IF queue IS NOT empty THEN  
                    INCREMENT max_distance BY one  
                END IF  
            END WHILE  
            
            RETURN max_distance  
        END FUNCTION  
        
        SET result TO a new list containing zero repeated n parameter MINUS one times  
        
        FOR each size FROM two TO n parameter inclusive  
            FOR each subset IN all combinations OF integers FROM one TO n parameter inclusive TAKEN size AT a TIME  
                SET visited TO a new empty set  
                SET stack TO a new list containing the element at position one OF subset  
                WHILE stack IS NOT empty  
                    SET node TO the last element REMOVED FROM stack  
                    IF node IS NOT IN visited THEN  
                        ADD node TO visited  
                        FOR each neighbor IN the element at position node OF graph  
                            IF neighbor IS IN subset AND neighbor IS NOT IN visited THEN  
                                ADD neighbor TO stack  
                            END IF  
                        END FOR  
                    END IF  
                END WHILE  
                IF visited IS EQUAL TO a new set constructed FROM subset THEN  
                    SET diameter TO the result OF bfs APPLIED TO a new set constructed FROM subset  
                    IF diameter IS GREATER THAN zero THEN  
                        INCREMENT the element at position diameter MINUS one OF result BY one  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS