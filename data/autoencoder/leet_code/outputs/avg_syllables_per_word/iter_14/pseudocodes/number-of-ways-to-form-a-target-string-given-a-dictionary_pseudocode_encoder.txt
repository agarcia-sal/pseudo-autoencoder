CLASS Solution  
    FUNCTION numWays WITH PARAMETERS words AND target  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF the first element OF words  
        SET m TO the LENGTH OF target  
        
        CREATE a list named freq WITH n elements WHERE each element IS a default dictionary FROM character TO integer  
        
        FOR each word IN words  
            FOR each position j AND character char IN word  
                INCREMENT the value AT character char IN freq element at position j BY one  
            END FOR  
        END FOR  
        
        CREATE a two-dimensional list named dp WITH m PLUS one rows AND n PLUS one columns FILLED WITH zeroes  
        
        FOR each position j FROM zero TO n INCLUSIVE  
            SET element at row zero AND column j OF dp TO one  
        END FOR  
        
        FOR each position i FROM one TO m INCLUSIVE  
            FOR each position j FROM one TO n INCLUSIVE  
                SET element at row i AND column j OF dp TO element at row i AND column j MINUS one OF dp  
                IF the value AT character at position i MINUS one OF target IN freq element at position j MINUS one IS GREATER THAN zero  
                    INCREMENT element at row i AND column j OF dp BY element at row i MINUS one AND column j MINUS one OF dp MULTIPLIED BY value AT character at position i MINUS one OF target IN freq element at position j MINUS one  
                    SET element at row i AND column j OF dp TO element at row i AND column j OF dp MODULO MOD  
                END IF  
            END FOR  
        END FOR  
        
        RETURN element at row m AND column n OF dp  
    END FUNCTION  
END CLASS