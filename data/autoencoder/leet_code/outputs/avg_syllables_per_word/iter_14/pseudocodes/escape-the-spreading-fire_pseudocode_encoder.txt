CLASS Solution  
    FUNCTION maximumMinutes(grid)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero OF grid  
        SET directions TO a list OF elements representing down, up, right, left movements as pairs of integers one zero, minus one zero, zero one, zero minus one respectively  
        
        FUNCTION can_escape(wait)  
            SET fire_times TO a two-dimensional list WITH m rows AND n columns FILLED WITH value representing positive infinity  
            SET queue TO an empty double-ended queue  
            
            FOR i FROM zero TO m MINUS one  
                FOR j FROM zero TO n MINUS one  
                    IF element at position i OF grid EQUAL TO one THEN  
                        APPEND the tuple consisting of i, j, zero TO queue  
                        SET element at position i OF fire_times AT position j TO zero  
                    END IF  
                END FOR  
            END FOR  
            
            WHILE queue IS NOT empty  
                REMOVE and RETURN the leftmost element from queue INTO variables x, y, t  
                FOR each pair dx, dy IN directions  
                    SET nx TO x PLUS dx  
                    SET ny TO y PLUS dy  
                    IF nx IS GREATER THAN OR EQUAL TO zero AND nx IS LESS THAN m AND ny IS GREATER THAN OR EQUAL TO zero AND ny IS LESS THAN n AND element at position nx OF grid AT position ny EQUAL TO zero AND element at position nx OF fire_times AT position ny IS EQUAL TO positive infinity THEN  
                        SET element at position nx OF fire_times AT position ny TO t PLUS one  
                        APPEND the tuple consisting of nx, ny, t PLUS one TO queue  
                    END IF  
                END FOR  
            END WHILE  
            
            SET queue TO a new double-ended queue INITIALIZED WITH a single tuple consisting of zero, zero, wait  
            SET visited TO a set CONTAINING a single tuple zero, zero  
            
            WHILE queue IS NOT empty  
                REMOVE and RETURN the leftmost element from queue INTO variables x, y, t  
                FOR each pair dx, dy IN directions  
                    SET nx TO x PLUS dx  
                    SET ny TO y PLUS dy  
                    IF nx IS GREATER THAN OR EQUAL TO zero AND nx IS LESS THAN m AND ny IS GREATER THAN OR EQUAL TO zero AND ny IS LESS THAN n AND the tuple nx, ny IS NOT IN visited AND element at position nx OF grid AT position ny EQUAL TO zero THEN  
                        IF nx IS EQUAL TO m MINUS one AND ny IS EQUAL TO n MINUS one THEN  
                            IF element at position nx OF fire_times AT position ny IS GREATER THAN OR EQUAL TO t PLUS one THEN  
                                RETURN TRUE  
                            ELSE  
                                RETURN FALSE  
                            END IF  
                        END IF  
                        IF element at position nx OF fire_times AT position ny IS GREATER THAN t PLUS one THEN  
                            ADD the tuple nx, ny TO visited  
                            APPEND the tuple consisting of nx, ny, t PLUS one TO queue  
                        END IF  
                    END IF  
                END FOR  
            END WHILE  
            
            RETURN FALSE  
        END FUNCTION  
        
        SET left TO zero  
        SET right TO m MULTIPLIED BY n  
        SET result TO minus one  
        
        WHILE left IS LESS THAN OR EQUAL TO right  
            SET mid TO the INTEGER DIVISION OF the sum of left AND right BY two  
            IF can_escape(mid) IS TRUE THEN  
                SET result TO mid  
                SET left TO mid PLUS one  
            ELSE  
                SET right TO mid MINUS one  
            END IF  
        END WHILE  
        
        IF result IS NOT EQUAL TO m MULTIPLIED BY n THEN  
            RETURN result  
        ELSE  
            RETURN ten RAISED TO THE POWER OF nine  
        END IF  
    END FUNCTION  
END CLASS