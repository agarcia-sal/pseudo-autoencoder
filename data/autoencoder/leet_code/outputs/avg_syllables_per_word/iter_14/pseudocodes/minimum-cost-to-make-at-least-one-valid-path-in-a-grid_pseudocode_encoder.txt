CLASS Solution  
    FUNCTION minCost(grid)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF the element at position zero OF grid  
        SET directions TO a list containing the elements representing zero STEPS IN row AND one STEP IN column, zero STEPS IN row AND negative one STEP IN column, one STEP IN row AND zero STEPS IN column, negative one STEP IN row AND zero STEPS IN column IN THIS ORDER  
        SET costs TO a two-dimensional list of size m BY n FILLED WITH infinite value  
        SET the element at row zero AND column zero OF costs TO zero  
        SET pq TO a list containing a tuple WITH elements zero zero zero representing cost zero row zero column zero  
        SET visited TO an empty set  
        
        WHILE pq IS NOT empty  
            REMOVE AND RETURN the element of the smallest cost element FROM pq INTO variables cost, i, and j  
            
            IF the tuple of i and j IS IN visited THEN  
                CONTINUE TO the next iteration of the WHILE loop  
            END IF  
            ADD the tuple of i and j TO visited  
            
            IF i EQUAL TO m minus one AND j EQUAL TO n minus one THEN  
                RETURN cost  
            END IF  
            
            FOR each index k AND tuple of di AND dj IN directions  
                SET ni TO i PLUS di  
                SET nj TO j PLUS dj  
                IF ni IS GREATER THAN OR EQUAL TO zero AND ni IS LESS THAN m AND nj IS GREATER THAN OR EQUAL TO zero AND nj IS LESS THAN n THEN  
                    SET additional_cost TO one IF k PLUS one IS NOT EQUAL TO the element at row i AND column j OF grid OTHERWISE zero  
                    SET new_cost TO cost PLUS additional_cost  
                    IF new_cost IS LESS THAN the element at row ni AND column nj OF costs THEN  
                        SET the element at row ni AND column nj OF costs TO new_cost  
                        ADD the tuple containing new_cost ni AND nj TO pq  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN negative one  
    END FUNCTION  
END CLASS