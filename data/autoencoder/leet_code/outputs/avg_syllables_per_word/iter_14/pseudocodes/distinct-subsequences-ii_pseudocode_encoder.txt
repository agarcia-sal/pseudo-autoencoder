CLASS Solution  
    FUNCTION distinctSubseqII WITH PARAMETER s  
        SET MOD TO one multiplied by one followed by nine zeros added TO seven  
        SET n TO the LENGTH OF s  
        SET dp TO a list OF zeros WITH LENGTH n plus one  
        SET the element AT position zero OF dp TO one  
        SET last TO an empty mapping  
        FOR index i FROM one TO n  
            SET char TO the element AT position i minus one OF s  
            SET the element AT position i OF dp TO the element AT position i minus one OF dp multiplied BY two  
            SET the element AT position i OF dp TO the remainder OF the element AT position i OF dp DIVIDED BY MOD  
            IF char EXISTS IN last  
                SET the element AT position i OF dp TO the element AT position i OF dp MINUS the element AT position last value FOR char MINUS one OF dp PLUS MOD  
                SET the element AT position i OF dp TO the remainder OF the element AT position i OF dp DIVIDED BY MOD  
            END IF  
            ASSIGN last value FOR char TO i  
        END FOR  
        RETURN the element AT position n OF dp MINUS one MODULO MOD  
    END FUNCTION  
END CLASS