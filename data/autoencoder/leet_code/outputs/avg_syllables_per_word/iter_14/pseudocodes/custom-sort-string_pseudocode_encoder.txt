CLASS Solution  
    FUNCTION customSortString(order, s)  
        SET d TO RESULT OF create_dictionary_for_custom_order USING order  
        SET sorted_characters TO RESULT OF sort_string_s_by_custom_order USING s AND d  
        SET result_string TO concatenate_characters IN sorted_characters  
        RETURN result_string  
    END FUNCTION  

    FUNCTION create_dictionary_for_custom_order(order)  
        SET d TO empty dictionary  
        SET index TO zero  
        FOR each character IN order  
            ASSIGN character WITH index IN d  
            INCREMENT index BY one  
        END FOR  
        RETURN d  
    END FUNCTION  

    FUNCTION sort_string_s_by_custom_order(s, d)  
        SET list_of_characters TO list of individual characters in s  
        SET sorted_list TO empty list  
        WHILE list_of_characters IS NOT empty  
            FIND character WITH the LOWEST order value AS order_value WHERE order_value IS the ORDER VALUE OF character IN d OR zero IF character NOT IN d  
            APPEND character WITH LOWEST order_value TO sorted_list IN ORDER OF INCREASING order_value  
            REMOVE characters FROM list_of_characters IN THE SAME ORDER  
        END WHILE  
        RETURN sorted_list  
    END FUNCTION  

    FUNCTION concatenate_characters(characters_list)  
        SET result_string TO empty string  
        FOR each character IN characters_list  
            APPEND character TO result_string  
        END FOR  
        RETURN result_string  
    END FUNCTION  
END CLASS