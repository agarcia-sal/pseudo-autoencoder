CLASS Solution  
    FUNCTION maxEqualFreq(nums)  
        SET count TO a new empty Counter collection for counting frequencies of numbers  
        SET freq TO a new empty Counter collection for counting frequencies of frequencies  
        SET max_len TO zero  

        FOR each index i AND each number num IN nums  
            INCREMENT the frequency count of num BY one IN count  

            IF the frequency count of num IS GREATER THAN one  
                DECREMENT the frequency count of the frequency count of num MINUS one BY one IN freq  
                IF the frequency count of the frequency count of num MINUS one IS EQUAL TO zero  
                    REMOVE the frequency count of num MINUS one FROM freq  
                END IF  
            END IF  

            INCREMENT the frequency count of the frequency count of num BY one IN freq  

            IF the number of distinct keys in freq IS EQUAL TO one AND  
                (the key one IS PRESENT IN freq OR the single value in freq IS EQUAL TO one)  
                SET max_len TO i PLUS one  
            ELSE IF the number of distinct keys in freq IS EQUAL TO two AND  
                (the key one IS PRESENT IN freq AND the frequency count associated with one IS EQUAL TO one OR  
                 the maximum key in freq MINUS the minimum key in freq IS EQUAL TO one AND the frequency count associated with the maximum key IS EQUAL TO one)  
                SET max_len TO i PLUS one  
            END IF  
        END FOR  

        RETURN max_len  
    END FUNCTION  
END CLASS