CLASS Solution  
    FUNCTION numBusesToDestination(routes AS List OF List OF integer, source AS integer, target AS integer) AS integer  
        IF source IS EQUAL TO target  
            RETURN zero  
        END IF  

        SET stop_to_buses TO A DEFAULT MAPPING THAT MAPS EACH STOP TO A LIST OF BUSES THAT STOP THERE  

        FOR each bus WITH index bus_index IN routes  
            FOR each stop IN route AT position bus_index OF routes  
                APPEND bus_index TO the LIST ASSOCIATED WITH stop IN stop_to_buses  
            END FOR  
        END FOR  

        SET bus_queue TO AN EMPTY DOUBLE ENDED QUEUE  
        SET visited_buses TO AN EMPTY SET  
        SET visited_stops TO AN EMPTY SET  

        FOR each bus IN the LIST ASSOCIATED WITH source IN stop_to_buses  
            APPEND A TUPLE OF bus AND one TO bus_queue  
            ADD bus TO visited_buses  
            ADD source TO visited_stops  
        END FOR  

        WHILE bus_queue IS NOT EMPTY  
            REMOVE AND RETURN THE FIRST ELEMENT OF bus_queue INTO current_bus AND bus_count  

            FOR each stop IN route AT position current_bus OF routes  
                IF stop IS EQUAL TO target  
                    RETURN bus_count  
                END IF  

                IF stop IS NOT IN visited_stops  
                    ADD stop TO visited_stops  

                    FOR each next_bus IN the LIST ASSOCIATED WITH stop IN stop_to_buses  
                        IF next_bus IS NOT IN visited_buses  
                            ADD next_bus TO visited_buses  
                            APPEND A TUPLE OF next_bus AND bus_count PLUS one TO bus_queue  
                        END IF  
                    END FOR  
                END IF  
            END FOR  
        END WHILE  

        RETURN negative one  
    END FUNCTION  
END CLASS