CLASS UnionFind
    FUNCTION __init__(self, size)
        SET self.parent TO a list of all integers from zero TO size MINUS one
        SET self.rank TO a list of size elements each SET TO one
    END FUNCTION

    FUNCTION find(self, p)
        IF the element at position p OF self.parent IS NOT EQUAL TO p
            SET the element at position p OF self.parent TO self.find(the element at position p OF self.parent)
        END IF
        RETURN the element at position p OF self.parent
    END FUNCTION

    FUNCTION union(self, p, q)
        SET rootP TO self.find(p)
        SET rootQ TO self.find(q)
        IF rootP IS EQUAL TO rootQ
            RETURN False
        END IF
        IF the element at position rootP OF self.rank IS GREATER THAN the element at position rootQ OF self.rank
            SET the element at position rootQ OF self.parent TO rootP
        ELSE IF the element at position rootP OF self.rank IS LESS THAN the element at position rootQ OF self.rank
            SET the element at position rootP OF self.parent TO rootQ
        ELSE
            SET the element at position rootQ OF self.parent TO rootP
            INCREMENT the element at position rootP OF self.rank BY one
        END IF
        RETURN True
    END FUNCTION
END CLASS

CLASS Solution
    FUNCTION distanceLimitedPathsExist(self, n, edgeList, queries)
        CALL sort ON edgeList BY the third element of each element IN edgeList ASCENDINGLY

        SET indexedQueries TO an empty list
        FOR each index FROM zero TO the LENGTH OF queries MINUS one
            LET p, q, limit BE the elements at positions zero, one, and two OF the element at position index OF queries
            APPEND a tuple of limit, p, q, index TO indexedQueries
        END FOR
        CALL sort ON indexedQueries ASCENDINGLY BY the first element OF each tuple

        SET uf TO a new UnionFind object initialized WITH n

        SET edgeIndex TO zero
        SET numEdges TO the LENGTH OF edgeList
        SET results TO a list of LENGTH EQUAL TO the LENGTH OF queries FILLED WITH False

        FOR each limit, p, q, originalIndex IN indexedQueries
            WHILE edgeIndex IS LESS THAN numEdges AND the third element OF the element at position edgeIndex OF edgeList IS LESS THAN limit
                LET u, v BE the first and second elements OF the element at position edgeIndex OF edgeList
                CALL uf.union(u, v)
                INCREMENT edgeIndex BY one
            END WHILE

            IF uf.find(p) IS EQUAL TO uf.find(q)
                SET the element at position originalIndex OF results TO True
            END IF
        END FOR

        RETURN results
    END FUNCTION
END CLASS