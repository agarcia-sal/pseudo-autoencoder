CLASS Solution  
    FUNCTION atMostNGivenDigitSet WITH PARAMETERS digits AND n  
        FUNCTION count_numbers_with_length WITH PARAMETER length  
            RETURN the LENGTH OF digits RAISED TO THE POWER OF length  
        END FUNCTION  
        
        FUNCTION count_numbers_up_to_n WITH PARAMETER n  
            SET str_n TO the string REPRESENTATION OF n  
            SET length TO the LENGTH OF str_n  
            SET count TO zero  
            
            FOR l FROM one TO length MINUS one  
                INCREMENT count BY count_numbers_with_length WITH PARAMETER l  
            END FOR  
            
            FOR i FROM zero TO length MINUS one  
                SET current_digit TO the INTEGER VALUE OF the CHARACTER AT position i OF str_n  
                FOR each digit IN digits  
                    SET digit_value TO the INTEGER VALUE OF digit  
                    IF digit_value IS LESS THAN current_digit  
                        INCREMENT count BY count_numbers_with_length WITH PARAMETER length MINUS i MINUS one  
                    ELSE IF digit_value IS EQUAL TO current_digit  
                        IF i IS EQUAL TO length MINUS one  
                            INCREMENT count BY one  
                        END IF  
                    ELSE  
                        BREAK out OF the FOR LOOP  
                    END IF  
                END FOR  
            END FOR  
            
            RETURN count  
        END FUNCTION  
        
        RETURN count_numbers_up_to_n WITH PARAMETER n  
    END FUNCTION  
END CLASS