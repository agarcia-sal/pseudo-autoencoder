CLASS Solution  
    FUNCTION numberOfPatterns(m, n)  
        SET jumps TO a mapping where the pair one three maps to two  
                              the pair one seven maps to four  
                              the pair one nine maps to five  
                              the pair two eight maps to five  
                              the pair three one maps to two  
                              the pair three seven maps to five  
                              the pair three nine maps to six  
                              the pair four six maps to five  
                              the pair five five maps to five  
                              the pair six four maps to five  
                              the pair seven one maps to four  
                              the pair seven three maps to five  
                              the pair seven nine maps to eight  
                              the pair eight two maps to five  
                              the pair nine one maps to five  
                              the pair nine three maps to six  
                              the pair nine seven maps to eight  
  
        FUNCTION countPatternsFromDot(current, visited, length)  
            IF length EQUAL TO n THEN  
                RETURN one  
            END IF  
            SET count TO one IF length GREATER THAN OR EQUAL TO m OTHERWISE zero  
            FOR next_dot FROM one TO nine  
                IF visited at position next_dot IS FALSE THEN  
                    SET jump TO the value mapped by the pair current next_dot in jumps  
                    IF jump IS NOT DEFINED OR visited at position jump IS TRUE THEN  
                        SET visited at position next_dot TO TRUE  
                        INCREMENT count BY countPatternsFromDot(next_dot, visited, length PLUS one)  
                        SET visited at position next_dot TO FALSE  
                    END IF  
                END IF  
            END FOR  
            RETURN count  
        END FUNCTION  
  
        SET visited TO a list of ten FALSE values  
        SET result TO zero  
        FOR i FROM one TO nine  
            SET visited at position i TO TRUE  
            INCREMENT result BY countPatternsFromDot(i, visited, one)  
            SET visited at position i TO FALSE  
        END FOR  
  
        RETURN result  
    END FUNCTION  
END CLASS