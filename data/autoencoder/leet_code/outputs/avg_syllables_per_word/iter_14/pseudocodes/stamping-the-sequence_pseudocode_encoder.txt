CLASS Solution  
    FUNCTION movesToStamp(stamp, target) RETURNS list of integer  
        SET m TO the LENGTH OF stamp  
        SET n TO the LENGTH OF target  
        SET indeg TO a list of length equal TO n MINUS m PLUS one FILLED WITH the value m  
        SET q TO an empty double ended queue  
        SET g TO a list of length equal TO n FILLED WITH empty lists  
        
        FOR index i FROM zero TO n MINUS m  
            FOR each position j AND character c IN the enumeration of stamp  
                IF the character at position i PLUS j OF target EQUAL TO c  
                    DECREMENT indeg element at position i BY one  
                    IF indeg element at position i EQUAL TO zero  
                        APPEND i TO q  
                    END IF  
                ELSE  
                    APPEND i TO the list element at position i PLUS j OF g  
                END IF  
            END FOR  
        END FOR  
        
        SET ans TO an empty list  
        SET vis TO a list of length equal TO n FILLED WITH the boolean FALSE  
        
        WHILE q IS NOT empty  
            REMOVE the element from the left end OF q AND ASSIGN IT TO i  
            APPEND i TO ans  
            FOR index j FROM zero TO m MINUS one  
                IF the boolean at position i PLUS j OF vis IS FALSE  
                    SET the boolean at position i PLUS j OF vis TO TRUE  
                    FOR each element k IN the list element at position i PLUS j OF g  
                        DECREMENT indeg element at position k BY one  
                        IF indeg element at position k EQUAL TO zero  
                            APPEND k TO q  
                        END IF  
                    END FOR  
                END IF  
            END FOR  
        END WHILE  
        
        IF all elements OF vis ARE TRUE  
            RETURN the reversal OF ans  
        ELSE  
            RETURN an empty list  
        END IF  
    END FUNCTION  
END CLASS