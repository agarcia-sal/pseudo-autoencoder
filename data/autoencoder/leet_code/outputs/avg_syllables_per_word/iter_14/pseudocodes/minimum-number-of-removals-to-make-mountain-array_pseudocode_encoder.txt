CLASS Solution  
    FUNCTION minimumMountainRemovals(nums)  
        SET n TO the LENGTH OF nums  
        
        SET lis TO a new list of size n WHERE each element IS one  
        FOR i FROM zero TO n MINUS one  
            FOR j FROM zero TO i MINUS one  
                IF element at position i OF nums IS GREATER THAN element at position j OF nums  
                    SET lis at position i TO THE GREATER OF lis at position i AND lis at position j PLUS one  
                END IF  
            END FOR  
        END FOR  
        
        SET lds TO a new list of size n WHERE each element IS one  
        FOR i FROM n MINUS one DOWN TO zero  
            FOR j FROM i PLUS one TO n MINUS one  
                IF element at position i OF nums IS GREATER THAN element at position j OF nums  
                    SET lds at position i TO THE GREATER OF lds at position i AND lds at position j PLUS one  
                END IF  
            END FOR  
        END FOR  
        
        SET max_mountain_length TO zero  
        FOR i FROM one TO n MINUS two  
            IF lis at position i IS GREATER THAN one AND lds at position i IS GREATER THAN one  
                SET max_mountain_length TO THE GREATER OF max_mountain_length AND lis at position i PLUS lds at position i MINUS one  
            END IF  
        END FOR  
        
        RETURN n MINUS max_mountain_length  
    END FUNCTION  
END CLASS