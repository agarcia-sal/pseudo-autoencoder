CLASS Solution  
    FUNCTION minCostII WITH PARAMETER costs  
        IF costs IS EMPTY  
            RETURN zero  
        END IF  
        
        SET n TO the LENGTH OF costs  
        SET k TO the LENGTH OF the element at position zero OF costs  
        
        IF k IS EQUAL TO one  
            IF n IS EQUAL TO one  
                RETURN the element at position zero at position zero OF costs  
            ELSE  
                RETURN positive infinity  
            END IF  
        END IF  
        
        FOR i FROM one TO n MINUS one  
            SET min_cost TO positive infinity  
            SET min_cost_index TO negative one  
            SET second_min_cost TO positive infinity  
            
            FOR j FROM zero TO k MINUS one  
                IF the element at position j OF the element at position i MINUS one OF costs IS LESS THAN min_cost  
                    SET second_min_cost TO min_cost  
                    SET min_cost TO the element at position j OF the element at position i MINUS one OF costs  
                    SET min_cost_index TO j  
                ELSE IF the element at position j OF the element at position i MINUS one OF costs IS LESS THAN second_min_cost  
                    SET second_min_cost TO the element at position j OF the element at position i MINUS one OF costs  
                END IF  
            END FOR  
            
            FOR j FROM zero TO k MINUS one  
                IF j IS EQUAL TO min_cost_index  
                    INCREMENT the element at position j OF the element at position i OF costs BY second_min_cost  
                ELSE  
                    INCREMENT the element at position j OF the element at position i OF costs BY min_cost  
                END IF  
            END FOR  
        END FOR  
        
        SET last_row TO the element at position n MINUS one OF costs  
        SET result TO the minimum VALUE IN last_row  
        RETURN result  
    END FUNCTION  
END CLASS