CLASS Solution  
    FUNCTION countArrangement WITH PARAMETER n  
        FUNCTION backtrack WITH PARAMETERS used AND index  
            IF index IS EQUAL TO n PLUS one  
                RETURN one  
            END IF  
            SET count TO zero  
            FOR i FROM one TO n  
                IF used AT position i IS FALSE AND (i MODULO index IS EQUAL TO zero OR index MODULO i IS EQUAL TO zero)  
                    SET used AT position i TO TRUE  
                    INCREMENT count BY backtrack WITH PARAMETERS used AND index PLUS one  
                    SET used AT position i TO FALSE  
                END IF  
            END FOR  
            RETURN count  
        END FUNCTION  
        SET used TO list OF BOOLEAN FALSE WITH LENGTH n PLUS one  
        RETURN backtrack WITH PARAMETERS used AND one  
    END FUNCTION  
END CLASS