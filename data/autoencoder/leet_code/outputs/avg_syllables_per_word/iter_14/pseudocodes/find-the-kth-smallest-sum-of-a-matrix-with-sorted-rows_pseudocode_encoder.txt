CLASS Solution  
    FUNCTION kthSmallest WITH PARAMETERS mat AND k  
        SET m TO the LENGTH OF mat  
        SET n TO the LENGTH OF element at position zero OF mat  
        
        SET initial_sum TO zero  
        FOR each row IN mat  
            INCREMENT initial_sum BY element at position zero OF row  
        END FOR  
        
        SET initial_indices TO a tuple consisting of zero REPEATED m times  
        SET min_heap TO a list CONTAINING a tuple of initial_sum AND initial_indices  
        SET visited TO a set CONTAINING initial_indices  
        
        WHILE k IS GREATER THAN zero  
            REMOVE and RETURN the SMALLEST element FROM min_heap ASSIGN TO current_sum AND indices  
            DECREMENT k BY one  
            
            IF k IS EQUAL TO zero  
                RETURN current_sum  
            END IF  
            
            FOR i FROM zero TO m MINUS one  
                IF element at position i OF indices PLUS one IS LESS THAN n  
                    SET new_indices TO a list COPY OF indices  
                    INCREMENT element at position i OF new_indices BY one  
                    SET new_indices_tuple TO a tuple CONVERTED FROM new_indices  
                    
                    SET old_value TO element at position i OF mat AT position element at position i OF indices  
                    SET new_value TO element at position i OF mat AT position element at position i OF new_indices  
                    SET new_sum TO current_sum MINUS old_value PLUS new_value  
                    
                    IF new_indices_tuple IS NOT IN visited  
                        ADD new_indices_tuple TO visited  
                        ADD the tuple of new_sum AND new_indices_tuple TO min_heap PRESERVING the MIN HEAP PROPERTY  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN minus one  
    END FUNCTION  
END CLASS