CLASS Solution  
    FUNCTION numberOfCombinations WITH PARAMETER num  
        SET MODULO_VALUE TO ten RAISED TO THE POWER OF nine PLUS one  
        SET string_length TO the LENGTH OF num  
        CREATE an EMPTY DICTIONARY named memo  
        
        FUNCTION dp WITH PARAMETERS index AND previous_length  
            IF index IS EQUAL TO string_length THEN  
                RETURN one  
            END IF  
            
            IF memo CONTAINS KEY a PAIR OF index AND previous_length THEN  
                RETURN the VALUE ASSOCIATED WITH the PAIR OF index AND previous_length IN memo  
            END IF  
            
            SET count TO zero  
            FOR length FROM one TO string_length MINUS index PLUS one  
                IF the CHARACTER AT position index OF num IS EQUAL TO zero THEN  
                    EXIT FROM the FOR LOOP  
                END IF  
                
                SET current_number_string TO the SUBSTRING FROM position index TO THE position index PLUS length MINUS one OF num  
                
                IF previous_length IS EQUAL TO zero OR current_number_string IS GREATER THAN OR EQUAL TO the SUBSTRING FROM position index MINUS previous_length TO THE position index MINUS one OF num THEN  
                    SET count TO count PLUS THE RESULT OF dp WITH PARAMETERS index PLUS length AND length  
                    SET count TO count MODULO MODULO_VALUE  
                END IF  
            END FOR  
            
            ASSIGN count TO memo WITH KEY a PAIR OF index AND previous_length  
            RETURN count  
        END FUNCTION  
        
        RETURN dp WITH PARAMETERS zero AND zero  
    END FUNCTION  
END CLASS