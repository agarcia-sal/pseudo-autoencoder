CLASS Solution  
    FUNCTION longestWord(words)  
        SORT words BY the LENGTH OF the word AND THEN BY the ORDER of the word lexicographically  
        CREATE an empty SET named valid_words  
        SET longest_word TO an empty string  
        FOR each word IN words  
            IF the LENGTH OF word IS EQUAL TO one OR the SUBSTRING from the FIRST CHARACTER TO the SECOND LAST CHARACTER OF word IS IN valid_words  
                ADD word TO valid_words  
                IF the LENGTH OF word IS GREATER THAN the LENGTH OF longest_word  
                    SET longest_word TO word  
                END IF  
            END IF  
        END FOR  
        RETURN longest_word  
    END FUNCTION  
END CLASS