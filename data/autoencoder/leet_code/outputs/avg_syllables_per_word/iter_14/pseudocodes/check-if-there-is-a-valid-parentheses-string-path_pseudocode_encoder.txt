CLASS Solution  
    FUNCTION hasValidPath WITH PARAMETER grid  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero OF grid  
        
        IF the remainder WHEN the sum of m AND n MINUS one IS DIVIDED BY two IS NOT EQUAL TO zero THEN  
            RETURN false  
        END IF  
        
        SET dp TO a three-dimensional list of dimensions m PLUS one BY n PLUS one BY m PLUS n PLUS one FILLED WITH false  
        
        SET element at position zero OF element at position one OF dp TO true  
        
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                FOR k FROM zero TO m PLUS n  
                    IF element at position i OF element at position j PLUS one OF dp IS true OR element at position i PLUS one OF element at position j OF dp IS true THEN  
                        IF element at position i OF element at position j OF grid IS EQUAL TO an opening parenthesis THEN  
                            IF k PLUS one IS LESS THAN m PLUS n PLUS one THEN  
                                SET element at position i PLUS one OF element at position j PLUS one OF element at position k PLUS one OF dp TO true  
                            END IF  
                        ELSE IF element at position i OF element at position j OF grid IS EQUAL TO a closing parenthesis THEN  
                            IF k MINUS one IS GREATER THAN OR EQUAL TO zero THEN  
                                SET element at position i PLUS one OF element at position j PLUS one OF element at position k MINUS one OF dp TO true  
                            END IF  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        RETURN the value of element at position m OF element at position n OF element at position zero OF dp  
    END FUNCTION  
END CLASS