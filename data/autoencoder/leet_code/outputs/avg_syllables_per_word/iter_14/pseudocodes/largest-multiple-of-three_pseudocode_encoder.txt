CLASS Solution  
    FUNCTION largestMultipleOfThree WITH PARAMETER digits AS list of integer  
        SET count TO the frequency COUNTER of the elements IN digits  
        SET total_sum TO the total SUM OF elements IN digits  
        SET remainder TO total_sum MODULO three  
        
        IF remainder IS EQUAL TO one  
            FOR each digit IN the sequence one, four, seven  
                IF the FREQUENCY OF digit IN count IS GREATER THAN zero  
                    DECREMENT the FREQUENCY OF digit IN count BY one  
                    BREAK the FOR loop  
                END IF  
            END FOR  
            IF no digit WAS removed IN the previous loop  
                FOR each digit IN the sequence two, five, eight  
                    IF the FREQUENCY OF digit IN count IS GREATER THAN one  
                        DECREMENT the FREQUENCY OF digit IN count BY two  
                        BREAK the FOR loop  
                    END IF  
                END FOR  
            END IF  
        END IF  
        
        IF remainder IS EQUAL TO two  
            FOR each digit IN the sequence two, five, eight  
                IF the FREQUENCY OF digit IN count IS GREATER THAN zero  
                    DECREMENT the FREQUENCY OF digit IN count BY one  
                    BREAK the FOR loop  
                END IF  
            END FOR  
            IF no digit WAS removed IN the previous loop  
                FOR each digit IN the sequence one, four, seven  
                    IF the FREQUENCY OF digit IN count IS GREATER THAN one  
                        DECREMENT the FREQUENCY OF digit IN count BY two  
                        BREAK the FOR loop  
                    END IF  
                END FOR  
            END IF  
        END IF  
        
        SET result TO an empty list  
        FOR digit FROM nine DOWN TO zero  
            APPEND the STRING REPRESENTATION OF digit REPEATED the FREQUENCY OF digit IN count TIMES TO result  
        END FOR  
        
        SET final_number TO the concatenation OF all elements IN result  
        
        IF final_number IS NOT EMPTY AND the FIRST CHARACTER OF final_number IS ZERO  
            RETURN the STRING REPRESENTATION OF zero  
        ELSE  
            RETURN final_number  
        END IF  
    END FUNCTION  
END CLASS