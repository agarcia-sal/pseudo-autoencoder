CLASS Solution  
    FUNCTION minMoves(nums AS list OF integers, k AS integer) AS integer  
        SET positions TO CALL extract_positions WITH nums  
        
        FUNCTION calculate_cost(start AS integer, end AS integer) AS integer  
            SET mid TO THE INTEGER DIVISION OF start PLUS end BY two  
            SET median TO element at position mid OF positions  
            SET cost TO zero  
            FOR i FROM start TO end MINUS one  
                SET offset TO median MINUS mid MINUS i MULTIPLIED BY negative one  
                SET distance TO absolute value OF element at position i OF positions MINUS offset  
                INCREMENT cost BY distance  
            END FOR  
            RETURN cost  
        END FUNCTION  
        
        SET min_cost TO positive infinity  
        SET limit TO THE LENGTH OF positions MINUS k PLUS one  
        FOR i FROM zero TO limit MINUS one  
            SET current_cost TO CALL calculate_cost WITH i AND i PLUS k  
            IF current_cost LESS THAN min_cost THEN  
                SET min_cost TO current_cost  
            END IF  
        END FOR  
        
        RETURN min_cost  
    END FUNCTION  
    
    FUNCTION extract_positions(nums AS list OF integers) AS list OF integers  
        SET result TO empty list  
        SET index TO zero  
        FOR each num IN nums  
            IF num EQUAL TO one THEN  
                APPEND index TO result  
            END IF  
            INCREMENT index BY one  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS