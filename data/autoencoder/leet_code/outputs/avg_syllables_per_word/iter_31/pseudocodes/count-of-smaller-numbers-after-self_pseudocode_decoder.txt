CLASS Solution  
    FUNCTION countSmaller(nums)  
        SET sorted_nums TO the list of unique elements in nums sorted in ascending order  
        SET rank TO an empty dictionary  
        FOR each index FROM zero TO the length of sorted_nums MINUS one  
            SET the element at position index of sorted_nums TO value  
            SET the value of the key value in rank TO index PLUS one  
        END FOR  
      
        SET bit TO a list of zeros with the length of sorted_nums PLUS one  
      
        FUNCTION get_sum(idx)  
            SET res TO zero  
            WHILE idx GREATER THAN zero  
                INCREMENT res BY the element at position idx of bit  
                DECREMENT idx BY the binary AND of idx and the NEGATION of idx  
            END WHILE  
            RETURN res  
        END FUNCTION  
      
        FUNCTION update(idx delta)  
            WHILE idx LESS THAN the length of bit  
                INCREMENT the element at position idx of bit BY delta  
                INCREMENT idx BY the binary AND of idx and the NEGATION of idx  
            END WHILE  
        END FUNCTION  
      
        SET counts TO an empty list  
        FOR each num IN the elements of nums traversed in reverse order  
            SET r TO the value of num in rank  
            APPEND the result of get_sum with the argument r MINUS one TO counts  
            CALL update with the arguments r and one  
        END FOR  
      
        RETURN counts traversed in reverse order  
    END FUNCTION  
END CLASS