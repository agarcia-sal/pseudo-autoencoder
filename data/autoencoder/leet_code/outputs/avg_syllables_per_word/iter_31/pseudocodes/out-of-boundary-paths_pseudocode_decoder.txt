CLASS Solution  
    FUNCTION findPaths(m startRow n startColumn maxMove)  
        SET MOD TO ten raised to the power of nine PLUS one  
        SET directions TO the list containing the elements consisting of zero and one zero and minus one zero and zero and one and minus one and zero and zero and minus one  
        SET dp TO three dimensional list consisting of zero repeated maxMove PLUS one times for each of n repeated for each of m  
        FOR k FROM one TO maxMove  
            FOR i FROM zero TO m MINUS one  
                FOR j FROM zero TO n MINUS one  
                    FOR each pair di dj IN directions  
                        SET ni TO i PLUS di  
                        SET nj TO j PLUS dj  
                        IF ni LESS THAN zero OR ni GREATER THAN OR EQUAL TO m OR nj LESS THAN zero OR nj GREATER THAN OR EQUAL TO n  
                            SET dp element at position i element at position j element at position k TO dp element at position i element at position j element at position k PLUS one MODULO MOD  
                        ELSE  
                            SET dp element at position i element at position j element at position k TO dp element at position i element at position j element at position k PLUS dp element at position ni element at position nj element at position k MINUS one MODULO MOD  
                        END IF  
                    END FOR  
                END FOR  
            END FOR  
        END FOR  
        RETURN dp element at position startRow element at position startColumn element at position maxMove  
    END FUNCTION  
END CLASS