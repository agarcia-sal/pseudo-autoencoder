CLASS Solution  
    FUNCTION removeDuplicateLetters WITH PARAMETER s  
        SET last_occurrence TO empty mapping from character TO position  
        FOR each index AND character IN the enumeration of s  
            SET character AT last_occurrence TO index  
        END FOR  
          
        SET stack TO empty list  
        SET in_stack TO empty set  
          
        FOR each index AND character IN the enumeration of s  
            IF character IS IN in_stack THEN  
                CONTINUE to the next iteration  
            END IF  
              
            WHILE the LENGTH OF stack IS GREATER THAN zero AND character IS LESS THAN the element at the last position of stack AND index IS LESS THAN the position AT last_occurrence of the element at the last position of stack DO  
                SET removed_char TO the element popped from the end of stack  
                REMOVE removed_char FROM in_stack  
            END WHILE  
              
            APPEND character TO stack  
            ADD character TO in_stack  
        END FOR  
          
        SET result_string TO the concatenation of all elements in stack in their order  
        RETURN result_string  
    END FUNCTION  
END CLASS