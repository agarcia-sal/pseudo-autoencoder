CLASS Solution  
    FUNCTION cutOffTree(forest)  
        IF forest EQUALS empty OR element at position zero of forest EQUALS empty  
            RETURN the number one MINUS the number two  
        END IF  
  
        SET trees TO the list of elements formed by element at position i of forest at position j of forest when element at position i of forest at position j of forest GREATER THAN the number one for i FROM zero TO the length of forest MINUS the number one for j FROM zero TO the length of element at position zero of forest MINUS the number one  
        SORT trees in ascending order  
  
        FUNCTION bfs(start, end)  
            IF start EQUALS end  
                RETURN zero  
            END IF  
            SET m TO the length of forest  
            SET n TO the length of element at position zero of forest  
            SET queue TO a new double ended queue initialized with start  
            SET visited TO a new set initialized with start  
            SET steps TO zero  
  
            WHILE the length of queue GREATER THAN zero  
                FOR index FROM zero TO the length of queue MINUS the number one  
                    REMOVE the element at the front of queue and ASSIGN the two parts to x and y respectively  
                    FOR each pair dx and dy IN the list of pairs consisting of the negative number one and zero and the number one and zero and zero and the negative number one and zero and the number one  
                        SET nx TO x PLUS dx  
                        SET ny TO y PLUS dy  
                        IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n AND the pair nx and ny NOT IN visited AND element at position nx of forest at position ny of forest NOT EQUALS zero  
                            IF the pair nx and ny EQUALS end  
                                RETURN steps PLUS the number one  
                            END IF  
                            ADD the pair nx and ny TO visited  
                            APPEND the pair nx and ny TO queue  
                        END IF  
                    END FOR  
                END FOR  
                INCREMENT steps BY the number one  
            END WHILE  
  
            RETURN the number one MINUS the number two  
        END FUNCTION  
  
        SET x TO zero  
        SET y TO zero  
        SET total_steps TO zero  
  
        FOR each height tx and ty IN trees  
            SET steps TO the result of calling bfs with the pair x and y and the pair tx and ty  
            IF steps EQUALS the number one MINUS the number two  
                RETURN the number one MINUS the number two  
            END IF  
            INCREMENT total_steps BY steps  
            SET x TO tx  
            SET y TO ty  
        END FOR  
  
        RETURN total_steps  
    END FUNCTION  
END CLASS