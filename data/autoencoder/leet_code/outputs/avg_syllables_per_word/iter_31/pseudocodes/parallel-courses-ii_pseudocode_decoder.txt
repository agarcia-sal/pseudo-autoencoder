CLASS Solution  
    FUNCTION minNumberOfSemesters(n, relations, k)  
        SET graph TO a default dictionary with list as default value  
        SET in_degree TO a list of zeros with the size of n PLUS one  
        
        FOR each previousCourse AND nextCourse IN relations  
            APPEND nextCourse TO the list at key previousCourse in graph  
            INCREMENT the value at position nextCourse of in_degree BY one  
        END FOR  
        
        SET queue TO an empty double ended queue  
        FOR course FROM one TO n  
            IF the value at position course of in_degree EQUALS zero  
                APPEND course TO queue  
            END IF  
        END FOR  
        
        SET semesters TO zero  
        
        WHILE queue is not empty  
            SET numberOfCoursesThisSemester TO the smaller value BETWEEN k AND the length of queue  
            FOR count FROM one TO numberOfCoursesThisSemester  
                SET currentCourse TO the element removed from the left end of queue  
                FOR each nextCourse IN the list at key currentCourse in graph  
                    DECREMENT the value at position nextCourse of in_degree BY one  
                    IF the value at position nextCourse of in_degree EQUALS zero  
                        APPEND nextCourse TO queue  
                    END IF  
                END FOR  
            END FOR  
            INCREMENT semesters BY one  
        END WHILE  
        
        RETURN semesters  
    END FUNCTION  
END CLASS