CLASS UnionFind  
    FUNCTION __init__(self, size)  
        SET self dot root TO a new list  
        FOR each element i FROM zero TO size MINUS one  
            APPEND i TO self dot root  
        END FOR  
        SET self dot rank TO a new list containing size repetitions of one  
    END FUNCTION  

    FUNCTION find(self, x)  
        IF element at position x of self dot root EQUALS x THEN  
            RETURN x  
        END IF  
        SET element at position x of self dot root TO self dot find(element at position x of self dot root)  
        RETURN element at position x of self dot root  
    END FUNCTION  

    FUNCTION union(self, x, y)  
        SET rootX TO self dot find(x)  
        SET rootY TO self dot find(y)  
        IF rootX NOT EQUALS rootY THEN  
            IF element at position rootX of self dot rank GREATER THAN element at position rootY of self dot rank THEN  
                SET element at position rootY of self dot root TO rootX  
            ELSE IF element at position rootX of self dot rank LESS THAN element at position rootY of self dot rank THEN  
                SET element at position rootX of self dot root TO rootY  
            ELSE  
                SET element at position rootY of self dot root TO rootX  
                INCREMENT element at position rootX of self dot rank BY one  
            END IF  
        END IF  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION accountsMerge(self, accounts)  
        SET email_to_id TO an empty mapping  
        SET uf TO a new UnionFind object initialized with the LENGTH OF accounts  
        
        FOR each index i AND the account comprising name and emails in accounts  
            FOR each email IN emails  
                IF email NOT IN email_to_id THEN  
                    SET email_to_id at email TO i  
                ELSE  
                    CALL uf dot union with parameters i AND email_to_id at email  
                END IF  
            END FOR  
        END FOR  
        
        SET merged_emails TO a new mapping defaulting to empty lists  
        FOR each email AND account_id IN email_to_id  
            SET root_id TO uf dot find(account_id)  
            APPEND email TO element at key root_id of merged_emails  
        END FOR  
        
        SET result TO an empty list  
        FOR each account_id AND emails IN merged_emails  
            SET name TO element at position zero of element at position account_id of accounts  
            SET sorted_emails TO emails sorted in ascending order  
            APPEND a new list consisting of name FOLLOWED BY each element in sorted_emails TO result  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS