CLASS Trie  
    FUNCTION __init__ with parameter self  
        SET self.children TO list of length twenty six filled with None values  
        SET self.ref TO negative one  
    END FUNCTION  

    FUNCTION insert with parameters self w ref  
        SET node TO self  
        FOR each character c IN w  
            SET idx TO the Unicode code point of character c MINUS the Unicode code point of lowercase letter a  
            IF element at position idx of node.children EQUALS None  
                SET element at position idx of node.children TO new instance of Trie  
            END IF  
            SET node TO element at position idx of node.children  
        END FOR  
        SET node.ref TO ref  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION findWords with parameters self board words  
        FUNCTION dfs with parameters node i j  
            SET idx TO the Unicode code point of element at position i of board at position j MINUS the Unicode code point of lowercase letter a  
            IF element at position idx of node.children EQUALS None  
                RETURN  
            END IF  
            SET node TO element at position idx of node.children  
            IF node.ref GREATER THAN OR EQUAL TO zero  
                APPEND element at position node.ref of words TO ans  
                SET node.ref TO negative one  
            END IF  
            SET c TO element at position i of board at position j  
            SET element at position i of board at position j TO the character hash sign  
            FOR each pair of integers a and b in consecutive pairs from the sequence negative one zero one zero negative one  
                SET x TO i PLUS a  
                SET y TO j PLUS b  
                IF x GREATER THAN OR EQUAL TO zero AND x LESS THAN m AND y GREATER THAN OR EQUAL TO zero AND y LESS THAN n AND element at position x of board at position y NOT EQUALS the character hash sign  
                    CALL dfs with arguments node x y  
                END IF  
            END FOR  
            SET element at position i of board at position j TO c  
        END FUNCTION  

        SET tree TO new instance of Trie  
        FOR each index i and element w IN enumeration of words  
            CALL insert method of tree with arguments w i  
        END FOR  
        SET m TO the number of rows in board  
        SET n TO the number of columns in board  
        SET ans TO empty list  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                CALL dfs with arguments tree i j  
            END FOR  
        END FOR  
        RETURN ans  
    END FUNCTION  
END CLASS