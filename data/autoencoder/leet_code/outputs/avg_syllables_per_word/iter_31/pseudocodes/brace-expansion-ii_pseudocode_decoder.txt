CLASS Solution  
    FUNCTION braceExpansionII(expression)  
        FUNCTION parse_expression(index)  
            SET current_set TO an empty collection of unique elements  
            SET current_product TO a list that contains an empty string  
            
            WHILE index is less than the length of expression  
                SET char TO the element at position index of expression  
                
                IF char EQUALS the character for opening brace  
                    SET inner_set AND index TO the result of calling parse_expression with index incremented by one  
                    SET current_product TO a new list formed by concatenating each element a in current_product with each element b in inner_set  
                
                ELSE IF char EQUALS the character for closing brace  
                    ADD all elements formed by joining each element in current_product as a sequence of characters TO current_set  
                    RETURN current_set AND index  
                
                ELSE IF char EQUALS the character for comma  
                    ADD all elements formed by joining each element in current_product as a sequence of characters TO current_set  
                    SET current_product TO a list that contains an empty string  
                
                ELSE  
                    SET current_product TO a new list formed by concatenating each element a in current_product with the character char  
                
                INCREMENT index BY one  
            END WHILE  
            
            ADD all elements formed by joining each element in current_product as a sequence of characters TO current_set  
            RETURN current_set AND index  
        END FUNCTION  
        
        SET result_set AND a placeholder variable TO the result of calling parse_expression with zero  
        RETURN the sorted list of elements in result_set  
    END FUNCTION  
END CLASS