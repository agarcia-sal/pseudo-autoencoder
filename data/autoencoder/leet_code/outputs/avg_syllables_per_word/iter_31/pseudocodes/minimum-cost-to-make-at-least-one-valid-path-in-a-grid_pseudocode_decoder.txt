CLASS Solution  
    FUNCTION minCost(grid)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero of grid  
        SET directions TO a LIST containing the TUPLES of zero AND one, zero AND MINUS one, one AND zero, MINUS one AND zero  
        SET costs TO a LIST  
        FOR each x FROM zero TO m MINUS one  
            APPEND a LIST of infinite cost repeated n times TO costs  
        END FOR  
        SET the element at position zero of the element at position zero of costs TO zero  
        SET pq TO a LIST containing a TUPLE of zero, zero, zero  
        SET visited TO an EMPTY SET  
        
        WHILE pq holds  
            SET cost i j TO the result of removing the SMALLEST element from pq by heap operation  
            IF the TUPLE of i AND j is IN visited THEN  
                CONTINUE to the next iteration  
            END IF  
            ADD the TUPLE of i AND j TO visited  
            
            IF i EQUALS m MINUS one AND j EQUALS n MINUS one THEN  
                RETURN cost  
            END IF  
            
            FOR each k AND the TUPLE of di AND dj IN the ENUMERATED directions  
                SET ni TO i PLUS di  
                SET nj TO j PLUS dj  
                IF ni IS GREATER THAN OR EQUAL TO zero AND ni IS LESS THAN m AND nj IS GREATER THAN OR EQUAL TO zero AND nj IS LESS THAN n THEN  
                    SET new_cost TO cost PLUS the VALUE one IF k PLUS one IS NOT EQUALS the element at position i of the element at position j of grid OTHERWISE zero  
                    IF new_cost IS LESS THAN the element at position ni of the element at position nj of costs THEN  
                        SET the element at position ni of the element at position nj of costs TO new_cost  
                        ADD the TUPLE of new_cost, ni, nj TO pq USING heap operation  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN minus one  
    END FUNCTION  
END CLASS