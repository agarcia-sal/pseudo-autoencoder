CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MOD TO ten raised to the power of nine PLUS one  
        SORT arr in ascending order  
        SET dp TO a mapping from each element in arr TO one  
        FOR index i FROM zero TO the length of arr MINUS one  
            SET num TO element at position i of arr  
            FOR index j FROM zero TO i MINUS one  
                SET factor_candidate TO element at position j of arr  
                IF num divided by factor_candidate multiplied by factor_candidate EQUALS num  
                    SET right_child TO num DIVIDED BY factor_candidate  
                    IF right_child EXISTS AS a key in dp  
                        SET dp at key num TO dp at key num PLUS dp at key factor_candidate MULTIPLIED BY dp at key right_child MINUS THE MOD MULTIPLIED BY the quotient of dp at key num PLUS dp at key factor_candidate MULTIPLIED BY dp at key right_child DIVIDED BY MOD, THEN TAKE THE REMAINDER MODULO MOD  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        SET total_trees TO zero  
        FOR each value IN dp  
            INCREMENT total_trees BY value  
        END FOR  
        RETURN total_trees MODULO MOD  
    END FUNCTION  
END CLASS