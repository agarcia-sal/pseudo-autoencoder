CLASS Solution  
    FUNCTION validArrangement(pairs)  
        SET graph TO a mapping from an element to a list of elements where missing keys map to an empty list  
        SET out_degree TO a mapping from an element to a count defaulting to zero  
        SET in_degree TO a mapping from an element to a count defaulting to zero  
        
        FOR each pair of elements u and v IN pairs  
            APPEND element v TO the list at graph for key u  
            INCREMENT out_degree for key u BY one  
            INCREMENT in_degree for key v BY one  
        END FOR  
        
        SET start_node TO None  
        FOR each node IN the keys of graph  
            IF out_degree for node EQUALS in_degree for node PLUS one  
                SET start_node TO node  
                BREAK  
            END IF  
        END FOR  
        IF start_node EQUALS None  
            SET start_node TO the first element of the keys of graph  
        END IF  
        
        SET path TO an empty list  
        SET stack TO a list containing start_node  
        
        WHILE the stack is not empty  
            SET u TO the element at the last position of stack  
            IF the list at graph for key u is not empty  
                REMOVE the element at the last position from the list at graph for key u and assign it TO v  
                APPEND element v TO stack  
            ELSE  
                REMOVE the element at the last position from stack and APPEND it TO path  
            END IF  
        END WHILE  
        
        REVERSE the order of elements in path  
        
        SET result TO an empty list  
        FOR index FROM zero TO LENGTH OF path MINUS one  
            APPEND a list containing element at position index of path AND element at position index PLUS one of path TO result  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS