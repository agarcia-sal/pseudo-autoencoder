CLASS Solution  
    FUNCTION getLengthOfOptimalCompression WITH PARAMETERS s AND k  
        FUNCTION dp WITH PARAMETERS i AND k AND prev_char AND prev_count  
            IF k LESS THAN zero THEN  
                RETURN positive infinity  
            END IF  
            IF i EQUALS the length of s THEN  
                RETURN zero  
            END IF  
            IF element at position i of s EQUALS prev_char THEN  
                IF prev_count EQUALS one OR prev_count EQUALS nine OR prev_count EQUALS ninety nine THEN  
                    SET increment TO one  
                ELSE  
                    SET increment TO zero  
                END IF  
                RETURN increment PLUS dp WITH ARGUMENTS i PLUS one AND k AND prev_char AND prev_count PLUS one  
            ELSE  
                SET keep TO one PLUS dp WITH ARGUMENTS i PLUS one AND k AND element at position i of s AND one  
                SET delete TO dp WITH ARGUMENTS i PLUS one AND k MINUS one AND prev_char AND prev_count  
                RETURN the smaller value BETWEEN keep AND delete  
            END IF  
        END FUNCTION  
        RETURN dp WITH ARGUMENTS zero AND k AND empty string AND zero  
    END FUNCTION  
END CLASS