CLASS Solution  
    FUNCTION tilingRectangle(n, m)  
        FUNCTION backtrack(heights, moves)  
            IF all elements IN heights EQUALS n THEN  
                SET min_moves TO the smaller value BETWEEN min_moves AND moves  
                RETURN  
            END IF  
              
            IF moves GREATER THAN OR EQUAL TO min_moves THEN  
                RETURN  
            END IF  
              
            SET min_height TO the smallest value AMONG elements IN heights  
            SET left TO the first position WHERE element AT position left IN heights EQUALS min_height  
            SET right TO left  
            WHILE right LESS THAN m AND element AT position right IN heights EQUALS min_height  
                INCREMENT right BY one  
            END WHILE  
              
            FOR size FROM the difference BETWEEN right AND left DOWN TO one  
                IF for every index i FROM zero TO size MINUS one element AT position left PLUS i IN heights PLUS size LESS THAN OR EQUAL TO n THEN  
                    SET new_heights TO a copy OF heights  
                    FOR i FROM zero TO size MINUS one  
                        INCREMENT element AT position left PLUS i IN new_heights BY size  
                    END FOR  
                    CALL backtrack WITH new_heights AND moves PLUS one  
                END IF  
            END FOR  
        END FUNCTION  
          
        SET min_moves TO positive infinity  
        CALL backtrack WITH a list OF zero repeated m times AND zero  
        RETURN min_moves  
    END FUNCTION  
END CLASS