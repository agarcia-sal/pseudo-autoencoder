CLASS Solution  
    FUNCTION pathsWithMaxScore(board)  
        SET MODULO TO one billion plus seven  
        SET size_n TO the LENGTH OF board  
        
        SET dp TO a two dimensional list of size_n by size_n where each element is a list containing negative infinity and zero  
        
        SET the element at position size_n MINUS one by size_n MINUS one of dp TO a list containing zero and one  
        
        FOR i FROM size_n MINUS one DOWN TO zero  
            FOR j FROM size_n MINUS one DOWN TO zero  
                IF the element at position i of board at position j EQUALS one of the characters uppercase X or uppercase S THEN  
                    CONTINUE to the next iteration  
                END IF  
                
                IF the element at position i of board at position j NOT EQUALS uppercase E THEN  
                    SET value TO the integer representation of the element at position i of board at position j  
                ELSE  
                    SET value TO zero  
                END IF  
                
                FOR each pair x and y IN the list containing the tuples one zero and zero one and one one  
                    SET new_i TO i PLUS x  
                    SET new_j TO j PLUS y  
                    IF new_i GREATER THAN OR EQUAL TO zero AND new_i LESS THAN size_n AND new_j GREATER THAN OR EQUAL TO zero AND new_j LESS THAN size_n THEN  
                        IF the first element of the list at position new_i by new_j of dp GREATER THAN the first element of the list at position i by j of dp THEN  
                            SET the element at position i by j of dp TO a list containing the sum of the first element of the list at position new_i by new_j of dp PLUS value and the second element of the list at position new_i by new_j of dp  
                        ELSE IF the first element of the list at position new_i by new_j of dp EQUALS the first element of the list at position i by j of dp THEN  
                            SET the second element of the list at position i by j of dp TO the sum of the second element of the list at position i by j of dp PLUS the second element of the list at position new_i by new_j of dp MODULO MODULO  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        IF the first element of the list at position zero by zero of dp EQUALS negative infinity THEN  
            RETURN a list containing zero and zero  
        END IF  
        
        RETURN a list containing the first element of the list at position zero by zero of dp and the second element of the list at position zero by zero of dp  
    END FUNCTION  
END CLASS