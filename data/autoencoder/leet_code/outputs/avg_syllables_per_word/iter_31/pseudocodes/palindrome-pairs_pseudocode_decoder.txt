CLASS Solution  
    FUNCTION palindromePairs(words)  
        FUNCTION is_palindrome(s)  
            RETURN s EQUALS string s in reverse order  
        END FUNCTION  
        
        SET word_dict TO a dictionary mapping each word to its position in words  
        SET result TO an empty list  
        
        FOR each position i and each word word IN words  
            IF word EQUALS an empty string THEN  
                CONTINUE to the next iteration  
            END IF  
            
            IF word_dict CONTAINS an empty string AND is_palindrome(word) THEN  
                APPEND a list containing i and the position of the empty string in word_dict TO result  
                APPEND a list containing the position of the empty string in word_dict and i TO result  
            END IF  
            
            SET reversed_word TO word in reverse order  
            IF word_dict CONTAINS reversed_word AND the position associated with reversed_word in word_dict NOT EQUALS i THEN  
                APPEND a list containing i and the position of reversed_word in word_dict TO result  
            END IF  
            
            FOR each integer j FROM one TO the length of word MINUS one  
                SET prefix TO the substring from position zero TO position j MINUS one of word  
                SET suffix TO the substring from position j TO the last position of word  
                SET reversed_prefix TO prefix in reverse order  
                SET reversed_suffix TO suffix in reverse order  
                
                IF is_palindrome(suffix) AND word_dict CONTAINS reversed_prefix THEN  
                    APPEND a list containing i and the position of reversed_prefix in word_dict TO result  
                END IF  
                
                IF is_palindrome(prefix) AND word_dict CONTAINS reversed_suffix THEN  
                    APPEND a list containing the position of reversed_suffix in word_dict and i TO result  
                END IF  
            END FOR  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS