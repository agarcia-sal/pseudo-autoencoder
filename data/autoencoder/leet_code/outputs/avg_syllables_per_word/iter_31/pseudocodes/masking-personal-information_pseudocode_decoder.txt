CLASS Solution  
    FUNCTION maskPII WITH parameter s  
        IF the character at some position IN s EQUALS the at symbol  
            SET local AND domain TO the two parts of s SPLIT at the at symbol  
            SET masked_local TO the first character of local CONCATENATED WITH the character five times repeated as an asterisk CONCATENATED WITH the last character of local  
            RETURN the lowercase version of masked_local CONCATENATED WITH the at symbol CONCATENATED WITH the lowercase version of domain  
        ELSE  
            SET digits TO the concatenation of all characters in s THAT are digits  
            SET local_number TO three asterisks CONCATENATED WITH a hyphen CONCATENATED WITH three asterisks CONCATENATED WITH a hyphen CONCATENATED WITH the last four characters of digits  
            IF the length of digits EQUALS ten  
                RETURN local_number  
            ELSE  
                SET country_code_length TO the length of digits MINUS ten  
                SET country_code TO the plus symbol CONCATENATED WITH the character asterisk REPEATED country_code_length times CONCATENATED WITH a hyphen  
                RETURN country_code CONCATENATED WITH local_number  
            END IF  
        END IF  
    END FUNCTION  
END CLASS