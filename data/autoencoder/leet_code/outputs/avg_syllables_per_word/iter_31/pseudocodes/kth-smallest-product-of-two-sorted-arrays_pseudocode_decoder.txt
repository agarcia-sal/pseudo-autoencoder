CLASS Solution  
    FUNCTION kthSmallestProduct(nums1 PARAMETER, nums2 PARAMETER, k PARAMETER)  
        FUNCTION count(p PARAMETER)  
            SET cnt TO zero  
            SET n TO the LENGTH OF nums2  
            FOR each x IN nums1  
                IF x GREATER THAN zero  
                    INCREMENT cnt BY the number of elements in nums2 strictly less than or equal to the result of p DIVIDED BY x  
                ELSE IF x LESS THAN zero  
                    INCREMENT cnt BY n MINUS the number of elements in nums2 strictly less than the result of p DIVIDED BY x  
                ELSE  
                    INCREMENT cnt BY n MULTIPLIED BY one IF p GREATER THAN OR EQUAL TO zero OTHERWISE zero  
                END IF  
            END FOR  
            RETURN cnt  
        END FUNCTION  
        
        SET mx TO the maximum BETWEEN the absolute value of the element at the first position of nums1 AND the absolute value of the element at the last position of nums1  
        SET mx TO mx MULTIPLIED BY the maximum BETWEEN the absolute value of the element at the first position of nums2 AND the absolute value of the element at the last position of nums2  
        
        RETURN the smallest number in the range from negative mx TO positive mx including positive mx for which the count of products less than or equal to that number is greater than or equal to k MINUS mx  
    END FUNCTION  
END CLASS