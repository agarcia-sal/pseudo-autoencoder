CLASS Solution  
    FUNCTION findDerangement WITH PARAMETER n  
        SET MOD TO one billion PLUS seven  
        
        IF n EQUALS one THEN  
            RETURN zero  
        END IF  
        
        IF n EQUALS two THEN  
            RETURN one  
        END IF  
        
        SET prev2 TO one  
        SET prev1 TO zero  
        
        FOR i FROM three TO n  
            SET sum_prev TO prev1 PLUS prev2  
            SET product TO i MINUS one MULTIPLIED BY sum_prev  
            SET current TO product MODULO MOD  
            SET prev2 TO prev1  
            SET prev1 TO current  
        END FOR  
        
        RETURN prev1  
    END FUNCTION  
END CLASS