CLASS Solution  
    FUNCTION maxScoreWords(words letters score)  
        FUNCTION word_score(word score_map)  
            SET total_score TO the sum of the values in score_map for each character in word  
            RETURN total_score  
        END FUNCTION  
          
        FUNCTION can_form(word letter_count)  
            SET word_count TO the count of each character in word  
            FOR each character AND its count IN word_count  
                IF the value at character in letter_count LESS THAN count  
                    RETURN false  
                END IF  
            END FOR  
            RETURN true  
        END FUNCTION  
          
        FUNCTION update_letter_count(letter_count word add)  
            FOR each character IN word  
                IF add EQUALS true  
                    INCREMENT the value at character in letter_count BY one  
                ELSE  
                    DECREMENT the value at character in letter_count BY one  
                END IF  
            END FOR  
        END FUNCTION  
          
        FUNCTION backtrack(index current_score letter_count)  
            IF index EQUALS the length of words  
                RETURN current_score  
            END IF  
            
            SET max_score TO current_score  
            FOR i FROM index TO the length of words MINUS one  
                IF can_form(element at position i of words letter_count) EQUALS true  
                    CALL update_letter_count(letter_count element at position i of words false)  
                    SET potential_score TO backtrack(i PLUS one current_score PLUS word_score(element at position i of words score_map) letter_count)  
                    IF potential_score GREATER THAN max_score  
                        SET max_score TO potential_score  
                    END IF  
                    CALL update_letter_count(letter_count element at position i of words true)  
                END IF  
            END FOR  
            
            RETURN max_score  
        END FUNCTION  
          
        SET score_map TO an empty map  
        FOR i FROM zero TO twenty five  
            ASSIGN the character at ASCII code of the lowercase letter a PLUS i TO the key in score_map  
            ASSIGN the element at position i of score TO the value in score_map for the key  
        END FOR  
          
        SET letter_count TO the count of each character in letters  
          
        RETURN backtrack(zero zero letter_count)  
    END FUNCTION  
END CLASS