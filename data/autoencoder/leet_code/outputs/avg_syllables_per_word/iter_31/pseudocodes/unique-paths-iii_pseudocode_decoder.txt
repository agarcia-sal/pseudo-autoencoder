CLASS Solution  
    FUNCTION uniquePathsIII(grid)  
        FUNCTION dfs(x, y, steps)  
            IF element at position x of grid AND element at position y of that element EQUALS two  
                RETURN steps EQUALS zero  
            END IF  
            SET original TO element at position x of grid AND element at position y of that element  
            SET element at position x of grid AND element at position y of that element TO minus two  
            SET count TO zero  
            FOR each dx AND dy IN list consisting of element minus one AND zero AND element one AND zero AND zero AND minus one AND zero AND one  
                SET nx TO x PLUS dx  
                SET ny TO y PLUS dy  
                IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n AND element at position nx of grid AND element at position ny of that element GREATER THAN OR EQUAL TO zero  
                    INCREMENT count BY dfs(nx, ny, steps MINUS one)  
                END IF  
            END FOR  
            SET element at position x of grid AND element at position y of that element TO original  
            RETURN count  
        END FUNCTION  

        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero of grid  
        SET start_x TO zero  
        SET start_y TO zero  
        SET empty_squares TO one  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF element at position i of grid AND element at position j of that element EQUALS one  
                    SET start_x TO i  
                    SET start_y TO j  
                ELSE IF element at position i of grid AND element at position j of that element EQUALS zero  
                    INCREMENT empty_squares BY one  
                END IF  
            END FOR  
        END FOR  
        RETURN dfs(start_x, start_y, empty_squares)  
    END FUNCTION  
END CLASS