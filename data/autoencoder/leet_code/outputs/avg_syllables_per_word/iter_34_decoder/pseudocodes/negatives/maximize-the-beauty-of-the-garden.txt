CLASS Solution  
    FUNCTION maximumBeauty(flowers)  
        SET indices TO an empty dictionary that assigns an empty list for each new key  
        SET prefix_sum TO a list of zeros with length equal to the length of flowers PLUS one  
        FOR index FROM zero TO the length of flowers MINUS one  
            SET element_at_position_index_of_prefix_sum_plus_one TO element_at_position_index_of_prefix_sum PLUS the maximum between element_at_position_index_of_flowers AND zero  
            APPEND index TO the list at key element_at_position_index_of_flowers in indices  
        END FOR  
        SET max_beauty TO negative infinity  
        FOR each beauty IN the keys of indices  
            IF the length of the list at key beauty in indices IS GREATER THAN OR EQUAL TO two  
                SET first TO the element at position zero of the list at key beauty in indices  
                SET last TO the element at the last position of the list at key beauty in indices  
                SET current_beauty TO two MULTIPLIED BY beauty PLUS element_at_position_last_of_prefix_sum MINUS element_at_position_first PLUS one_of_prefix_sum  
                IF current_beauty IS GREATER THAN max_beauty  
                    SET max_beauty TO current_beauty  
                END IF  
            END IF  
        END FOR  
        RETURN max_beauty  
    END FUNCTION  
END CLASS