CLASS Solution  
    FUNCTION minMalwareSpread(graph AS List OF List OF integer, initial AS List OF integer) RETURNS integer  
        SET number_of_nodes TO the LENGTH OF graph  
        SET adjacency_list TO a new mapping from integer to list of integers with default empty list  
        FOR index i FROM zero TO number_of_nodes MINUS one  
            FOR index j FROM i PLUS one TO number_of_nodes MINUS one  
                IF the element at position j of the list at position i of graph EQUALS one  
                    APPEND j TO the list at position i of adjacency_list  
                    APPEND i TO the list at position j of adjacency_list  
                END IF  
            END FOR  
        END FOR  

        FUNCTION dfs(node AS integer, visited AS set) RETURNS integer  
            IF visited CONTAINS node  
                RETURN zero  
            END IF  
            ADD node TO visited  
            SET component_size TO one  
            FOR each neighbor IN the list at position node of adjacency_list  
                SET component_size TO component_size PLUS the result of dfs called with neighbor and visited  
            END FOR  
            RETURN component_size  
        END FUNCTION  

        SET infected_nodes TO a new set initialized with all elements of initial  
        SET component_sizes TO an empty list  
        SET visited_nodes TO an empty set  
        SET component_indices TO a new mapping from integer to integer  

        FOR each node FROM zero TO number_of_nodes MINUS one  
            IF visited_nodes DOES NOT CONTAIN node AND infected_nodes DOES NOT CONTAIN node  
                SET size_of_component TO the result of dfs called with node and visited_nodes  
                APPEND size_of_component TO component_sizes  
                FOR index i FROM the LENGTH OF component_sizes MINUS one DOWN TO zero  
                    IF the element at position i of component_sizes EQUALS size_of_component  
                        BREAK the loop  
                    END IF  
                END FOR  
                FOR each neighbor IN the list at position node of adjacency_list  
                    SET the element at position neighbor of component_indices TO i  
                END FOR  
            END IF  
        END FOR  

        SET infected_count_per_component TO a new mapping from integer to integer with default zero  
        FOR each node IN infected_nodes  
            IF component_indices CONTAINS the key node  
                INCREMENT the element at position node of component_indices in infected_count_per_component BY one  
            END IF  
        END FOR  

        SET maximum_size TO zero  
        SET node_to_remove TO the minimum element of initial  

        FOR each node IN infected_nodes  
            IF component_indices CONTAINS the key node  
                SET component_index TO the element at position node of component_indices  
                IF the element at position component_index of infected_count_per_component EQUALS one  
                    IF the element at position component_index of component_sizes GREATER THAN maximum_size  
                        SET maximum_size TO the element at position component_index of component_sizes  
                        SET node_to_remove TO node  
                    ELSE IF the element at position component_index of component_sizes EQUALS maximum_size  
                        IF node LESS THAN node_to_remove  
                            SET node_to_remove TO node  
                        END IF  
                    END IF  
                END IF  
            END IF  
        END FOR  

        RETURN node_to_remove  
    END FUNCTION  
END CLASS