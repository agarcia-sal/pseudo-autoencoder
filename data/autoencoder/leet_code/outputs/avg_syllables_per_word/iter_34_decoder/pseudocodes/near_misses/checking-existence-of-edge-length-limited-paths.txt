CLASS UnionFind  
    FUNCTION __init__ WITH PARAMETER size  
        SET parent TO a list of integers starting from zero to size MINUS one inclusive  
        SET rank TO a list containing size times the value one  
    END FUNCTION  

    FUNCTION find WITH PARAMETER p  
        IF element at position p of parent NOT EQUALS p THEN  
            SET element at position p of parent TO the result of calling find WITH PARAMETER element at position p of parent  
        END IF  
        RETURN element at position p of parent  
    END FUNCTION  

    FUNCTION union WITH PARAMETERS p q  
        SET rootP TO the result of calling find WITH PARAMETER p  
        SET rootQ TO the result of calling find WITH PARAMETER q  
        IF rootP EQUALS rootQ THEN  
            RETURN False  
        END IF  
        IF element at position rootP of rank GREATER THAN element at position rootQ of rank THEN  
            SET element at position rootQ of parent TO rootP  
        ELSE IF element at position rootP of rank LESS THAN element at position rootQ of rank THEN  
            SET element at position rootP of parent TO rootQ  
        ELSE  
            SET element at position rootQ of parent TO rootP  
            INCREMENT element at position rootP of rank BY one  
        END IF  
        RETURN True  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION distanceLimitedPathsExist WITH PARAMETERS n edgeList queries  
        SORT edgeList IN ascending order BY the element at position two of each item  

        SET indexedQueries TO an empty list  
        FOR each index i and element having elements p q limit IN queries  
            APPEND a tuple consisting of limit p q i TO indexedQueries  
        END FOR  
        SORT indexedQueries IN ascending order  

        SET uf TO a new instance of UnionFind WITH PARAMETER n  

        SET edgeIndex TO zero  
        SET numEdges TO the count of elements in edgeList  
        SET results TO a list containing the value False repeated the count of elements in queries times  

        FOR each limit p q originalIndex IN indexedQueries  
            WHILE edgeIndex LESS THAN numEdges AND the element at position two of the element at position edgeIndex of edgeList LESS THAN limit DO  
                SET u TO the element at position zero of the element at position edgeIndex of edgeList  
                SET v TO the element at position one of the element at position edgeIndex of edgeList  
                CALL union ON uf WITH PARAMETERS u v  
                INCREMENT edgeIndex BY one  
            END WHILE  

            IF the result of calling find ON uf WITH PARAMETER p EQUALS the result of calling find ON uf WITH PARAMETER q THEN  
                SET element at position originalIndex of results TO True  
            END IF  
        END FOR  

        RETURN results  
    END FUNCTION  
END CLASS