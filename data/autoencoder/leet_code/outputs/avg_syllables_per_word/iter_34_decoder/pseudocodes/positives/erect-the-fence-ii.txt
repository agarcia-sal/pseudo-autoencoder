CLASS Solution  
    FUNCTION outerTrees(trees)  
        FUNCTION dist_sq(p1, p2)  
            SET difference in first element OF p1 MINUS first element OF p2 TO variable dx  
            SET difference in second element OF p1 MINUS second element OF p2 TO variable dy  
            SET result TO dx MULTIPLIED BY dx PLUS dy MULTIPLIED BY dy  
            RETURN result  
        END FUNCTION  

        FUNCTION circumcenter(p1, p2, p3)  
            ASSIGN first element OF p1 TO ax  
            ASSIGN second element OF p1 TO ay  
            ASSIGN first element OF p2 TO bx  
            ASSIGN second element OF p2 TO by  
            ASSIGN first element OF p3 TO cx  
            ASSIGN second element OF p3 TO cy  
            SET d TO two MULTIPLIED BY (ax MULTIPLIED BY (by MINUS cy) PLUS bx MULTIPLIED BY (cy MINUS ay) PLUS cx MULTIPLIED BY (ay MINUS by))  
            SET ux TO (((ax MULTIPLIED BY ax PLUS ay MULTIPLIED BY ay) MULTIPLIED BY (by MINUS cy)) PLUS ((bx MULTIPLIED BY bx PLUS by MULTIPLIED BY by) MULTIPLIED BY (cy MINUS ay)) PLUS ((cx MULTIPLIED BY cx PLUS cy MULTIPLIED BY cy) MULTIPLIED BY (ay MINUS by))) DIVIDED BY d  
            SET uy TO (((ax MULTIPLIED BY ax PLUS ay MULTIPLIED BY ay) MULTIPLIED BY (cx MINUS bx)) PLUS ((bx MULTIPLIED BY bx PLUS by MULTIPLIED BY by) MULTIPLIED BY (ax MINUS cx)) PLUS ((cx MULTIPLIED BY cx PLUS cy MULTIPLIED BY cy) MULTIPLIED BY (bx MINUS ax))) DIVIDED BY d  
            SET center TO list containing ux and uy  
            SET radius TO square root of (ux MINUS ax) MULTIPLIED BY (ux MINUS ax) PLUS (uy MINUS ay) MULTIPLIED BY (uy MINUS ay)  
            RETURN center and radius  
        END FUNCTION  

        FUNCTION welzl(points, boundary, n)  
            IF n EQUALS zero OR LENGTH OF boundary EQUALS three  
                IF LENGTH OF boundary EQUALS zero  
                    RETURN list containing zero and zero, zero  
                ELSE IF LENGTH OF boundary EQUALS one  
                    RETURN element at position zero of boundary, zero  
                ELSE IF LENGTH OF boundary EQUALS two  
                    SET center TO list containing (first element of element at position zero of boundary PLUS first element OF element at position one of boundary) DIVIDED BY two AND (second element of element at position zero of boundary PLUS second element OF element at position one of boundary) DIVIDED BY two  
                    SET radius TO square root of dist_sq OF element at position zero of boundary and element at position one of boundary DIVIDED BY two  
                    RETURN center and radius  
                ELSE  
                    RETURN result of calling circumcenter with elements unpacked from boundary  
                END IF  
            END IF  

            SET p TO element at position n MINUS one of points  
            SET center and radius TO result of calling welzl with points boundary and n MINUS one  
            IF dist_sq(center, p) LESS THAN OR EQUAL TO radius MULTIPLIED BY radius  
                RETURN center and radius  
            END IF  
            RETURN result of calling welzl with points, boundary with element p appended, and n MINUS one  
        END FUNCTION  

        CALL shuffle function ON trees  
        SET center and radius TO result of calling welzl with trees, empty list, and length of trees  
        RETURN list containing first element OF center, second element OF center, and radius  
    END FUNCTION  
END CLASS