CLASS Solution  
    FUNCTION validArrangement(pairs)  
        SET graph TO a new mapping from element to list of elements with default empty list  
        SET out_degree TO a new counting mapping from element to integer with default zero  
        SET in_degree TO a new counting mapping from element to integer with default zero  
        
        FOR each element u and element v IN pairs  
            APPEND element v TO the list at position u of graph  
            INCREMENT the count at position u of out_degree BY one  
            INCREMENT the count at position v of in_degree BY one  
        END FOR  
        
        SET start_node TO none  
        FOR each node IN graph  
            IF the count at position node of out_degree EQUALS the count at position node of in_degree PLUS one  
                SET start_node TO node  
                BREAK the loop  
            END IF  
        END FOR  
        
        IF start_node IS none  
            SET start_node TO the first element yielded by iterating over graph  
        END IF  
        
        SET path TO an empty list  
        SET stack TO a list containing start_node  
        
        WHILE the LENGTH OF stack IS greater than zero  
            SET u TO the last element of stack  
            IF the list at position u of graph IS NOT empty  
                REMOVE the last element FROM the list at position u of graph AND SET it TO v  
                APPEND element v TO stack  
            ELSE  
                REMOVE the last element FROM stack AND APPEND it TO path  
            END IF  
        END WHILE  
        
        REVERSE the order of elements in path  
        
        SET result TO an empty list  
        FOR each index i FROM zero TO the LENGTH OF path MINUS one MINUS one  
            APPEND a list containing the element at position i of path AND the element at position i PLUS one of path TO result  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS