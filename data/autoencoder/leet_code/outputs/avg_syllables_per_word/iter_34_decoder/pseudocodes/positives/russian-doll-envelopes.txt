CLASS Solution  
    FUNCTION maxEnvelopes(envelopes)  
        CALL sort envelopes BY the first element of each item IN ascending order AND BY the second element of each item IN descending order  
        SET dp TO an empty list  
        FOR each element WITH second value h IN envelopes  
            SET idx TO the position found by binary searching the leftmost place to insert h INTO dp  
            IF idx EQUALS the LENGTH OF dp THEN  
                APPEND h TO dp  
            ELSE  
                SET element at position idx of dp TO h  
            END IF  
        END FOR  
        RETURN the LENGTH OF dp  
    END FUNCTION  
END CLASS