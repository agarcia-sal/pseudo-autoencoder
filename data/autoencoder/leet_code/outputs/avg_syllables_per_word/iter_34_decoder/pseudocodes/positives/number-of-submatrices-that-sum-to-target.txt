CLASS Solution  
    FUNCTION numSubmatrixSumTarget(matrix parameter, target parameter) RETURNS integer  
        FUNCTION subarraySum(nums parameter, target parameter) RETURNS integer  
            SET count TO zero  
            SET seen_sums TO empty mapping from integer TO integer  
            SET cumulative_sum TO zero  
            FOR each num IN nums parameter  
                SET cumulative_sum TO cumulative_sum PLUS num  
                IF cumulative_sum EQUALS target parameter  
                    INCREMENT count BY one  
                END IF  
                IF cumulative_sum MINUS target parameter IS A KEY IN seen_sums  
                    INCREMENT count BY the value ASSOCIATED TO cumulative_sum MINUS target parameter IN seen_sums  
                END IF  
                INCREMENT the value ASSOCIATED TO cumulative_sum IN seen_sums BY one  
            END FOR  
            RETURN count  
        END FUNCTION  
        
        SET rows TO the number OF elements IN matrix parameter  
        SET cols TO the number OF elements IN element at position zero of matrix parameter  
        SET total_count TO zero  
        
        FOR top FROM zero TO rows MINUS one  
            SET current_cols TO a list OF cols elements each initialized TO zero  
            FOR bottom FROM top TO rows MINUS one  
                FOR col FROM zero TO cols MINUS one  
                    SET element at position col of current_cols TO element at position col of current_cols PLUS element at position bottom of matrix parameter at position col  
                END FOR  
                SET total_count TO total_count PLUS subarraySum(current_cols, target parameter)  
            END FOR  
        END FOR  
        
        RETURN total_count  
    END FUNCTION  
END CLASS