CLASS Solution  
    FUNCTION maskPII WITH PARAMETER s  
        IF s CONTAINS character AT symbol of email  
            SET local TO substring before character AT symbol of email in s  
            SET domain TO substring after character AT symbol of email in s  
            SET masked_local TO concatenation of first character of local PLUS five repetitions of asterisk PLUS last character of local  
            RETURN lowercase form of masked_local concatenated with character AT symbol PLUS lowercase form of domain  
        ELSE  
            SET digits TO empty string  
            FOR each character IN s  
                IF character IS a digit  
                    APPEND character TO digits  
                END IF  
            END FOR  
            SET local_number TO concatenation of three asterisks MINUS three asterisks MINUS last four characters of digits  
            IF LENGTH OF digits EQUALS ten  
                RETURN local_number  
            ELSE  
                SET country_code_length TO LENGTH OF digits MINUS ten  
                SET country_code TO concatenation of plus sign PLUS asterisk repeated country_code_length times PLUS minus sign  
                RETURN concatenation of country_code PLUS local_number  
            END IF  
        END IF  
    END FUNCTION  
END CLASS