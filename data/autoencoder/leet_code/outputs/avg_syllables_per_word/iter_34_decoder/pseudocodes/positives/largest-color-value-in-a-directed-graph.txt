CLASS Solution  
    FUNCTION largestPathValue(colors parameters AS string, edges parameters AS list of list of integers) RETURNS integer  
        SET number_of_nodes TO the LENGTH OF colors  
        ASSIGN reference TO an empty mapping from integer keys to list values named graph  
        SET list_in_degree TO a list of zeros of LENGTH number_of_nodes  
        
        FOR each pair origin_node comma destination_node IN edges  
            APPEND destination_node TO list at key origin_node IN graph  
            INCREMENT element at position destination_node OF list_in_degree BY one  
        END FOR  
        
        SET queue TO a double-ended queue containing elements index i FOR each i FROM zero TO number_of_nodes MINUS one WHERE element at position i of list_in_degree EQUALS zero  
        SET dp TO a list of lists each containing twenty-six zeros FOR each index FROM zero TO number_of_nodes MINUS one  
        SET visited_nodes_count TO zero  
        SET maximum_color_value TO zero  
        
        WHILE queue holds elements  
            REMOVE and RETURN the leftmost element FROM queue AND ASSIGN IT TO current_node  
            INCREMENT element at position corresponding to the alphabetical index of color at position current_node IN colors of dp at position current_node BY one  
            SET maximum_color_value TO the GREATER THAN OF maximum_color_value AND element at position corresponding to the alphabetical index of color at position current_node IN colors of dp at position current_node  
            INCREMENT visited_nodes_count BY one  
            
            FOR each neighbor_node IN list of neighbors of current_node in graph  
                FOR color_index FROM zero TO twenty-five  
                    SET element at position color_index of dp at position neighbor_node TO the GREATER THAN OF element at position color_index of dp at position neighbor_node AND element at position color_index of dp at position current_node  
                END FOR  
                DECREMENT element at position neighbor_node of list_in_degree BY one  
                IF element at position neighbor_node of list_in_degree EQUALS zero  
                    APPEND neighbor_node TO queue  
                END IF  
            END FOR  
        END WHILE  
        
        IF visited_nodes_count EQUALS number_of_nodes  
            RETURN maximum_color_value  
        ELSE  
            RETURN negative one  
        END IF  
    END FUNCTION  
END CLASS