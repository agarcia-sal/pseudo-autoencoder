CLASS Solution  
    FUNCTION numMatchingSubseq s words  
        SET waiting TO an empty dictionary  
        FOR each character IN the set of unique characters of s  
            ASSIGN reference TO an empty double-ended queue  
            SET the element at key character of waiting TO the empty double-ended queue  
        END FOR  
        
        FOR each word IN words  
            ASSIGN reference TO the iterator of word  
            SET first_letter TO the next element from the iterator of word or None if exhausted  
            IF first_letter IS NOT equal to None AND first_letter IS an element of waiting  
                APPEND the iterator reference TO the double-ended queue stored at key first_letter of waiting  
            END IF  
        END FOR  
        
        SET match_count TO zero  
        
        FOR each character c IN s  
            IF character c IS an element of waiting  
                ASSIGN reference TO the double-ended queue stored at key c of waiting  
                ASSIGN reference TO an empty double-ended queue  
                SET the element at key c of waiting TO the empty double-ended queue  
                FOR each iterator it IN the previous double-ended queue stored at key c  
                    SET next_char TO the next element from iterator it or None if exhausted  
                    IF next_char IS equal to None  
                        INCREMENT match_count BY one  
                    ELSE  
                        IF next_char IS an element of waiting  
                            APPEND iterator it TO the double-ended queue stored at key next_char of waiting  
                        END IF  
                    END IF  
                END FOR  
            END IF  
        END FOR  
        
        RETURN match_count  
    END FUNCTION  
END CLASS