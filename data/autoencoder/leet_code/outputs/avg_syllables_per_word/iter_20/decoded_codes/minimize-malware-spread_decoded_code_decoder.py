from typing import List, Set

class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        def dfs(node: int, component: Set[int]) -> None:
            if node in visited:
                return
            visited.add(node)
            component.add(node)
            for neighbor in range(len(graph)):
                if graph[node][neighbor] == 1 and neighbor not in visited:
                    dfs(neighbor, component)

        visited = set()
        components = []
        n = len(graph)

        for node in range(n):
            if node not in visited:
                component = set()
                dfs(node, component)
                components.append(component)

        # Count how many initial infected nodes are in each component
        component_infected_count = [0] * len(components)
        # Map node to component index for quick lookup
        node_to_component = {}
        for idx, comp in enumerate(components):
            for node in comp:
                node_to_component[node] = idx

        for node in initial:
            idx = node_to_component[node]
            component_infected_count[idx] += 1

        max_saving = 0
        best_node = min(initial)

        for node in initial:
            idx = node_to_component[node]
            if component_infected_count[idx] == 1:
                saving = len(components[idx])
                if saving > max_saving or (saving == max_saving and node < best_node):
                    max_saving = saving
                    best_node = node

        return best_node