CLASS Solution  
    FUNCTION longestPath(parent AS List OF integer, s AS string) RETURNS integer  
        CREATE tree AS a mapping from integer TO list of integers with default empty list  
        
        FOR each index i WITH element p IN parent  
            IF p IS NOT EQUAL TO negative one  
                APPEND i TO the list associated with key p IN tree  
            END IF  
        END FOR  
        
        SET self result TO one  
        
        FUNCTION dfs(node AS integer) RETURNS integer  
            SET max one TO zero  
            SET max two TO zero  
            
            FOR each child IN the list at key node IN tree  
                SET child length TO dfs(child)  
                
                IF the character at position child of s IS NOT EQUAL TO the character at position node of s  
                    IF child length IS GREATER THAN max one  
                        SET max two TO max one  
                        SET max one TO child length  
                    ELSE IF child length IS GREATER THAN max two  
                        SET max two TO child length  
                    END IF  
                END IF  
            END FOR  
            
            SET self result TO the greater value BETWEEN self result AND the sum of max one PLUS max two PLUS one  
            
            RETURN the sum of max one PLUS one  
        END FUNCTION  
        
        CALL dfs WITH zero  
        
        RETURN self result  
    END FUNCTION  
END CLASS