CLASS Solution  
    FUNCTION isPrintable(targetGrid)  
        SET color_bounds TO a default mapping where each key maps TO a list containing positive infinity, positive infinity, negative infinity, negative infinity  
        
        FOR each row_index FROM zero TO the LENGTH OF targetGrid MINUS one  
            FOR each column_index FROM zero TO the LENGTH OF the element at position zero of targetGrid MINUS one  
                SET color TO the element at position row_index of targetGrid at position column_index  
                SET the element at position zero of color_bounds at color TO the SMALLER OF the element at position zero of color_bounds at color AND row_index  
                SET the element at position one of color_bounds at color TO the SMALLER OF the element at position one of color_bounds at color AND column_index  
                SET the element at position two of color_bounds at color TO the LARGER OF the element at position two of color_bounds at color AND row_index  
                SET the element at position three of color_bounds at color TO the LARGER OF the element at position three of color_bounds at color AND column_index  
            END FOR  
        END FOR  
        
        SET graph TO a default mapping where each key maps TO an empty list  
        SET in_degree TO a default mapping where each key maps TO zero  
        
        FOR each color and its bounding_box IN color_bounds  
            SET min_row TO the element at position zero of bounding_box  
            SET min_column TO the element at position one of bounding_box  
            SET max_row TO the element at position two of bounding_box  
            SET max_column TO the element at position three of bounding_box  
            
            FOR each row_index FROM min_row TO max_row  
                FOR each column_index FROM min_column TO max_column  
                    IF the element at position row_index of targetGrid at position column_index IS NOT EQUAL TO color THEN  
                        SET other_color TO the element at position row_index of targetGrid at position column_index  
                        APPEND color TO the list at key other_color in graph  
                        INCREMENT the element at key color in in_degree BY one  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        SET queue TO a deque containing each color IN color_bounds WHERE the element at key color in in_degree IS EQUAL TO zero  
        SET visited_colors TO zero  
        
        WHILE queue is not empty  
            REMOVE the first element FROM queue AND ASSIGN it TO color  
            INCREMENT visited_colors BY one  
            FOR each next_color IN the list at key color in graph  
                DECREMENT the element at key next_color in in_degree BY one  
                IF the element at key next_color in in_degree IS EQUAL TO zero THEN  
                    APPEND next_color TO queue  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN visited_colors IS EQUAL TO the LENGTH OF color_bounds  
    END FUNCTION  
END CLASS