CLASS Solution  
    FUNCTION sumOfFlooredPairs(nums)  
        SET MOD TO one billion PLUS seven  
        SET max_num TO the maximum value in nums  
        SET count TO a collection counting the occurrences of each number in nums  
        CREATE a list prefix_sum of length max_num PLUS one filled with zeros  
        
        FOR each num IN count  
            INCREMENT the element at position num of prefix_sum BY the count of num  
        END FOR  
        
        FOR index FROM one TO max_num  
            INCREMENT the element at position index of prefix_sum BY the element at position index MINUS one of prefix_sum  
        END FOR  
        
        SET result TO zero  
        
        FOR each num IN count  
            FOR multiple FROM one TO the integer division of max_num BY num  
                SET start TO the product of num AND multiple  
                SET end TO the smaller value between the product of num AND the sum of multiple PLUS one MINUS one AND max_num  
                SET multiples_count TO the element at position end of prefix_sum MINUS the element at position start MINUS one of prefix_sum  
                INCREMENT result BY the product of multiples_count, multiple, AND the count of num  
                SET result TO the remainder of result DIVIDED BY MOD  
            END FOR  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS