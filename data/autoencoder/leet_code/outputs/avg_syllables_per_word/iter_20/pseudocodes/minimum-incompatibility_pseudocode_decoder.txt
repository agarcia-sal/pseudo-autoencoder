CLASS Solution  
    FUNCTION minimumIncompatibility(nums AS List OF integer, k AS integer) RETURNS integer  
        IMPORT Counter FROM collections  
        
        SET n TO the LENGTH OF nums  
        SET subset_size TO n DIVIDED BY k  
        
        IF there EXISTS any frequency IN the COLLECTION OF frequencies FROM Counter APPLIED TO nums WHERE the frequency IS GREATER THAN k  
            RETURN negative one  
        END IF  
        
        INITIALIZE an empty dictionary named subset_incompatibility  
        
        FOR each mask FROM zero TO two RAISED TO THE POWER OF n MINUS one  
            SET count_of_ones TO the NUMBER OF ONES IN the BINARY REPRESENTATION OF mask  
            IF count_of_ones EQUALS subset_size  
                INITIALIZE an empty list named elements  
                FOR each index i FROM zero TO n MINUS one  
                    IF the bitwise AND OF mask AND two RAISED TO THE POWER OF i IS NOT zero  
                        APPEND the element at position i OF nums TO elements  
                    END IF  
                END FOR  
                IF the NUMBER OF UNIQUE ELEMENTS IN elements EQUALS subset_size  
                    SET maximum_element TO the MAXIMUM VALUE IN elements  
                    SET minimum_element TO the MINIMUM VALUE IN elements  
                    SET incompatibility TO maximum_element MINUS minimum_element  
                    ASSIGN the value incompatibility TO the key mask IN subset_incompatibility  
                END IF  
            END IF  
        END FOR  
        
        INITIALIZE a list named dp WITH two RAISED TO THE POWER OF n ELEMENTS EACH SET TO positive infinity  
        SET the element at position zero OF dp TO zero  
        
        FOR each mask FROM zero TO two RAISED TO THE POWER OF n MINUS one  
            SET count_of_ones TO the NUMBER OF ONES IN the BINARY REPRESENTATION OF mask  
            IF count_of_ones MODULO subset_size IS NOT EQUAL TO zero  
                CONTINUE TO the next iteration  
            END IF  
            FOR each subset_mask IN the KEYS OF subset_incompatibility  
                IF the bitwise AND OF mask AND subset_mask EQUALS subset_mask  
                    SET possible_new_value TO the ELEMENT AT position mask EXCLUSIVE OR subset_mask OF dp PLUS the VALUE ASSOCIATED WITH subset_mask IN subset_incompatibility  
                    IF possible_new_value IS LESS THAN the ELEMENT AT position mask OF dp  
                        SET the ELEMENT AT position mask OF dp TO possible_new_value  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        
        SET final_mask TO two RAISED TO THE POWER OF n MINUS one  
        IF the ELEMENT AT position final_mask OF dp IS NOT EQUAL TO positive infinity  
            RETURN the ELEMENT AT position final_mask OF dp  
        ELSE  
            RETURN negative one  
        END IF  
    END FUNCTION  
END CLASS