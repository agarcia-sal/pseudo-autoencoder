CLASS Solution  
    FUNCTION maxNumOfSubstrings(s)  
        SET first TO an empty mapping from characters to their first occurrence position  
        SET last TO an empty mapping from characters to their last occurrence position  
        FOR each position i WITH corresponding character c IN s  
            IF character c is not a key in first  
                SET the value at key c in first TO position i  
            END IF  
            SET the value at key c in last TO position i  
        END FOR  
  
        SET intervals TO an empty list of pairs of positions  
        FOR each character c IN keys of first  
            SET start TO the value at key c in first  
            SET end TO the value at key c in last  
            SET position i TO start  
            WHILE position i is less than or equal to end  
                IF the value at key the character at position i of s in first is less than start  
                    BREAK out of the while loop  
                END IF  
                SET end TO the greater value between end and the value at key the character at position i of s in last  
                INCREMENT i BY one  
            END WHILE  
            IF the while loop was not broken  
                APPEND the pair consisting of start and end TO intervals  
            END IF  
        END FOR  
  
        SORT intervals in ascending order based on the second element of each pair  
  
        SET result TO an empty list of strings  
        SET prev_end TO negative one  
        FOR each pair start and end IN intervals  
            IF start is greater than prev_end  
                APPEND the substring from position start TO end of s TO result  
                SET prev_end TO end  
            END IF  
        END FOR  
  
        RETURN result  
    END FUNCTION  
END CLASS