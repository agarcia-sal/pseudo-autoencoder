CLASS Solution  
    FUNCTION constrainedSubsetSum(nums AS List OF Integer, k AS Integer) RETURNS Integer  
        SET n TO the LENGTH OF nums  
        SET dp TO a list of n elements each initialized TO zero  
        SET element at position zero of dp TO element at position zero of nums  
        SET max_sum TO element at position zero of nums  
        ASSIGN pointer TO a new empty double-ended queue initialized WITH element zero  
        
        FOR i FROM one TO n MINUS one  
            IF element at position at front of pointer OF dp IS GREATER THAN zero  
                SET dp at position i TO element at position i of nums PLUS element at position at front of pointer OF dp  
            ELSE  
                SET dp at position i TO element at position i of nums PLUS zero  
            END IF  
            
            IF max_sum IS LESS THAN dp at position i  
                SET max_sum TO dp at position i  
            END IF  
            
            WHILE pointer IS NOT empty AND dp at position i IS GREATER THAN OR EQUAL TO dp at position at back of pointer  
                REMOVE element at back FROM pointer  
            END WHILE  
            
            APPEND i TO pointer  
            
            IF element at front of pointer EQUALS i MINUS k  
                REMOVE element at front FROM pointer  
            END IF  
        END FOR  
        
        RETURN max_sum  
    END FUNCTION  
END CLASS