CLASS Solution  
    FUNCTION pacificAtlantic(heights)  
        FUNCTION bfs(queue, visited)  
            WHILE the LENGTH OF queue IS GREATER THAN zero  
                FOR each element FROM one TO the LENGTH OF queue  
                    ASSIGN i AND j TO the element REMOVED FROM the FRONT OF queue  
                    FOR each pair a AND b IN the set consisting of zero AND minus one zero AND one one AND zero MINUS one AND zero  
                        SET x TO i PLUS a  
                        SET y TO j PLUS b  
                        IF x IS GREATER THAN OR EQUAL TO zero AND x IS LESS THAN m AND y IS GREATER THAN OR EQUAL TO zero AND y IS LESS THAN n AND the PAIR x AND y IS NOT IN visited AND the element at position x AND y of heights IS GREATER THAN OR EQUAL TO the element at position i AND j of heights  
                            ADD the PAIR x AND y TO visited  
                            ADD the PAIR x AND y TO the END OF queue  
                        END IF  
                    END FOR  
                END FOR  
            END WHILE  
        END FUNCTION  

        SET m TO the LENGTH OF heights  
        SET n TO the LENGTH OF the element at position zero of heights  
        ASSIGN empty SET TO vis1  
        ASSIGN empty SET TO vis2  
        ASSIGN empty double ended QUEUE TO q1  
        ASSIGN empty double ended QUEUE TO q2  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF i EQUALS zero OR j EQUALS zero  
                    ADD the PAIR i AND j TO vis1  
                    ADD the PAIR i AND j TO the END OF q1  
                END IF  
                IF i EQUALS m MINUS one OR j EQUALS n MINUS one  
                    ADD the PAIR i AND j TO vis2  
                    ADD the PAIR i AND j TO the END OF q2  
                END IF  
            END FOR  
        END FOR  
        CALL bfs WITH q1 AND vis1 AS arguments  
        CALL bfs WITH q2 AND vis2 AS arguments  
        ASSIGN empty LIST TO result  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF the PAIR i AND j IS IN vis1 AND the PAIR i AND j IS IN vis2  
                    ADD the PAIR i AND j TO result  
                END IF  
            END FOR  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS