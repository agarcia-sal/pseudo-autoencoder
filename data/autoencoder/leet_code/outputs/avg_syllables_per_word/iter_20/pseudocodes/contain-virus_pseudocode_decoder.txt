CLASS Solution  
    FUNCTION containVirus(isInfected)  
        FUNCTION neighbors(r, c)  
            RETURN list of positions consisting of position one row below r and same column c AND position one row above r and same column c AND position same row r and one column right c AND position same row r and one column left c  
        END FUNCTION

        FUNCTION bfs(r, c)  
            SET infected TO empty set  
            SET threatened TO empty set  
            SET queue TO a double ended queue initialized with position r and c  
            SET visited TO a set initialized with position r and c  
            WHILE the queue is not empty  
                REMOVE and RETURN the leftmost element from queue and ASSIGN to x and y  
                ADD position x and y to infected  
                FOR each nx and ny IN neighbors of position x and y  
                    IF nx is greater than or equal to zero AND nx is less than m AND ny is greater than or equal to zero AND ny is less than n AND position nx and ny is not in visited  
                        ADD position nx and ny to visited  
                        IF element at position nx of rows and position ny of columns of isInfected EQUALS one  
                            APPEND position nx and ny TO queue  
                        ELSE IF element at position nx of rows and position ny of columns of isInfected EQUALS zero  
                            ADD position nx and ny TO threatened  
                        END IF  
                    END IF  
                END FOR  
            END WHILE  
            RETURN infected AND threatened  
        END FUNCTION

        FUNCTION build_walls(infected)  
            SET walls TO zero  
            FOR each x and y IN infected  
                FOR each nx and ny IN neighbors of position x and y  
                    IF nx is greater than or equal to zero AND nx is less than m AND ny is greater than or equal to zero AND ny is less than n AND element at position nx of rows and position ny of columns of isInfected EQUALS zero  
                        INCREMENT walls BY one  
                    END IF  
                END FOR  
            END FOR  
            RETURN walls  
        END FUNCTION

        FUNCTION spread_virus(threatened)  
            FOR each x and y IN threatened  
                SET element at position x of rows and position y of columns of isInfected TO one  
            END FOR  
        END FUNCTION

        SET m TO the length of isInfected  
        SET n TO the length of the element at position zero of isInfected  
        SET total_walls TO zero  

        WHILE true  
            SET regions TO an empty list  
            SET visited TO an empty set  
            FOR r FROM zero TO m MINUS one  
                FOR c FROM zero TO n MINUS one  
                    IF element at position r of rows and position c of columns of isInfected EQUALS one AND position r and c is not in visited  
                        SET infected AND threatened TO the result of bfs with parameters r and c  
                        APPEND the tuple of infected and threatened TO regions  
                        UNION visited with infected  
                    END IF  
                END FOR  
            END FOR  

            IF regions is empty  
                BREAK the loop  
            END IF  

            SORT regions IN descending order by the LENGTH OF the second element of each tuple in regions  

            INCREMENT total_walls BY the result of build_walls with the first element of the first tuple in regions  
            FOR each x and y IN the first element of the first tuple in regions  
                SET element at position x of rows and position y of columns of isInfected TO minus one  
            END FOR  

            FOR i FROM one TO LENGTH OF regions MINUS one  
                CALL spread_virus with the second element of the ith tuple in regions  
            END FOR  
        END WHILE  

        RETURN total_walls  
    END FUNCTION  
END CLASS