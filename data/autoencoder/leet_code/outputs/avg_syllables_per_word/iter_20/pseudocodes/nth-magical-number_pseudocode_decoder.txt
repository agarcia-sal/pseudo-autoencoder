CLASS Solution  
    FUNCTION nthMagicalNumber(n AS integer, a AS integer, b AS integer) RETURNS integer  
        SET MOD TO one billion PLUS seven  
        
        FUNCTION gcd(x AS integer, y AS integer) RETURNS integer  
            WHILE y IS NOT EQUAL TO zero  
                SET temporary_value TO y  
                SET y TO the remainder of x DIVIDED BY y  
                SET x TO temporary_value  
            END WHILE  
            RETURN x  
        END FUNCTION  
        
        FUNCTION lcm(x AS integer, y AS integer) RETURNS integer  
            SET product TO x MULTIPLIED BY y  
            SET divisor TO the result of gcd with parameters x and y  
            SET result TO product DIVIDED BY divisor  
            RETURN result  
        END FUNCTION  
        
        SET L TO the result of lcm with parameters a and b  
        
        SET left TO one  
        SET right TO n MULTIPLIED BY the smaller of a and b  
        
        WHILE left IS LESS THAN right  
            SET mid TO the sum of left and right DIVIDED BY two with integer division  
            
            SET count TO the integer division of mid BY a PLUS the integer division of mid BY b MINUS the integer division of mid BY L  
            
            IF count IS LESS THAN n  
                SET left TO mid PLUS one  
            ELSE  
                SET right TO mid  
            END IF  
        END WHILE  
        
        SET result TO the remainder of left DIVIDED BY MOD  
        RETURN result  
    END FUNCTION  
END CLASS