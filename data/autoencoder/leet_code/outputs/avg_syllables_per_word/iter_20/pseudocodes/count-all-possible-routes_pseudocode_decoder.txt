CLASS Solution  
    FUNCTION countRoutes(locations AS list of integers, start AS integer, finish AS integer, fuel AS integer) RETURNS integer  
        SET MODULO TO ten raised to the power of nine PLUS one  
        SET number_of_locations TO the LENGTH OF locations  
        
        FUNCTION dp(city AS integer, remaining_fuel AS integer) RETURNS integer  
            IF remaining_fuel LESS THAN zero THEN  
                RETURN zero  
            END IF  
            
            SET routes TO zero  
            
            IF city EQUALS finish THEN  
                SET routes TO one  
            END IF  
            
            FOR next_city FROM zero TO number_of_locations MINUS one  
                IF next_city NOT EQUALS city THEN  
                    SET fuel_cost TO the ABSOLUTE VALUE OF the element at position city of locations MINUS the element at position next_city of locations  
                    IF remaining_fuel GREATER THAN OR EQUAL TO fuel_cost THEN  
                        SET routes TO routes PLUS dp(next_city, remaining_fuel MINUS fuel_cost)  
                        SET routes TO routes MODULO MODULO  
                    END IF  
                END IF  
            END FOR  
            
            RETURN routes  
        END FUNCTION  
        
        RETURN dp(start, fuel)  
    END FUNCTION  
END CLASS