CLASS Solution  
    FUNCTION kthSmallestProduct(nums1, nums2, k)  
        FUNCTION count(p)  
            SET cnt TO zero  
            SET n TO the LENGTH OF nums2  
            FOR each x IN nums1  
                IF x IS GREATER THAN zero  
                    INCREMENT cnt BY the POSITION WHERE p DIVIDED BY x WOULD BE INSERTED TO THE RIGHT IN nums2 to KEEP SORT ORDER  
                ELSE IF x IS LESS THAN zero  
                    INCREMENT cnt BY n MINUS the POSITION WHERE p DIVIDED BY x WOULD BE INSERTED TO THE LEFT IN nums2 to KEEP SORT ORDER  
                ELSE  
                    INCREMENT cnt BY n MULTIPLIED BY THE VALUE ONE IF p IS GREATER THAN OR EQUAL TO zero OTHERWISE ZERO  
                END IF  
            END FOR  
            RETURN cnt  
        END FUNCTION  
        SET mx TO the MAXIMUM OF THE ABSOLUTE VALUE OF the FIRST ELEMENT OF nums1 AND THE ABSOLUTE VALUE OF the LAST ELEMENT OF nums1 MULTIPLIED BY the MAXIMUM OF THE ABSOLUTE VALUE OF the FIRST ELEMENT OF nums2 AND THE ABSOLUTE VALUE OF the LAST ELEMENT OF nums2  
        RETURN THE POSITION WHERE k WOULD BE INSERTED TO THE LEFT IN THE RANGE OF NUMBERS FROM negative mx TO mx PLUS ONE USING THE count FUNCTION AS KEY MINUS mx  
    END FUNCTION  
END CLASS