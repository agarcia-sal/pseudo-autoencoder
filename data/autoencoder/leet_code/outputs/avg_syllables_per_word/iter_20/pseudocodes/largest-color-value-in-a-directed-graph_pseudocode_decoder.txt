CLASS Solution  
    FUNCTION largestPathValue(colors, edges)  
        SET n TO the LENGTH OF colors  
        SET graph TO a new default dictionary mapping each key to an empty list  
        SET in_degree TO a list of zeros of length n  
        
        FOR each pair u and v IN edges  
            APPEND v TO the list at key u in graph  
            INCREMENT element at position v of in_degree BY one  
        END FOR  
        
        SET queue TO a double-ended queue containing all indices i from zero TO n MINUS one WHERE element at position i of in_degree EQUALS zero  
        SET dp TO a list of n elements each being a list of twenty six zeros  
        SET visited TO zero  
        SET max_color_value TO zero  
        
        WHILE queue is not empty  
            REMOVE the element from the left end of queue and ASSIGN it TO node  
            INCREMENT element at position corresponding to the alphabetical index of character at position node of colors in dp[node] BY one  
            SET max_color_value TO the maximum of max_color_value AND element at that alphabetical position in dp[node]  
            INCREMENT visited BY one  
            
            FOR each neighbor IN the list at key node in graph  
                FOR each c FROM zero TO twenty five  
                    SET element at position c of dp[neighbor] TO the maximum of element at position c of dp[neighbor] AND element at position c of dp[node]  
                END FOR  
                DECREMENT element at position neighbor of in_degree BY one  
                IF element at position neighbor of in_degree EQUALS zero  
                    APPEND neighbor TO queue  
                END IF  
            END FOR  
        END WHILE  
        
        IF visited EQUALS n  
            RETURN max_color_value  
        ELSE  
            RETURN negative one  
        END IF  
    END FUNCTION  
END CLASS