CLASS Solution  
    FUNCTION braceExpansionII(expression)  
        FUNCTION parse_expression(index)  
            SET current_set TO empty set  
            SET current_product TO list containing empty string  
            
            WHILE index LESS THAN the LENGTH OF expression HOLDS  
                SET char TO element at position index of expression  
                
                IF char EQUALS the opening brace symbol  
                    SET inner_set, index TO the RESULT OF calling parse_expression WITH index PLUS one  
                    SET current_product TO list of concatenations of each element a FROM current_product WITH each element b FROM inner_set  
                ELSE IF char EQUALS the closing brace symbol  
                    ADD TO current_set each concatenation of elements in current_product as strings  
                    RETURN current_set AND index  
                ELSE IF char EQUALS the comma symbol  
                    ADD TO current_set each concatenation of elements in current_product as strings  
                    SET current_product TO list containing empty string  
                ELSE  
                    SET current_product TO list of concatenations of each element a FROM current_product WITH char  
                END IF  
                
                INCREMENT index BY one  
            END WHILE  
            
            ADD TO current_set each concatenation of elements in current_product as strings  
            RETURN current_set AND index  
        END FUNCTION  
        
        SET result_set, unused TO the RESULT OF calling parse_expression WITH zero  
        RETURN the SORTED list of result_set  
    END FUNCTION  
END CLASS