CLASS Solution  
    FUNCTION validArrangement(pairs)  
        SET graph TO a collection that assigns an empty list to each new key by default  
        SET out_degree TO a collection that counts occurrences of keys defaulting to zero  
        SET in_degree TO a collection that counts occurrences of keys defaulting to zero  
  
        FOR each element u and element v IN pairs  
            APPEND element v TO the list at position u of graph  
            INCREMENT out_degree value associated with u BY one  
            INCREMENT in_degree value associated with v BY one  
        END FOR  
  
        SET start_node TO nothing  
        FOR each node IN graph  
            IF the value associated with node in out_degree EQUALS the value associated with node in in_degree PLUS one  
                SET start_node TO node  
                EXIT the loop  
            END IF  
        END FOR  
  
        IF start_node IS nothing  
            SET start_node TO the first key obtained from iterating over graph  
        END IF  
  
        SET path TO an empty list  
        SET stack TO a list containing start_node  
  
        WHILE stack IS not empty  
            SET u TO the last element of stack  
            IF the list at position u of graph IS not empty  
                SET v TO the element removed from the end of the list at position u of graph  
                APPEND element v TO stack  
            ELSE  
                APPEND the last element removed from stack TO path  
            END IF  
        END WHILE  
  
        REVERSE path  
  
        SET result TO an empty list  
        FOR index FROM zero TO the LENGTH OF path MINUS one  
            APPEND a list containing the element at position index of path and the element at position index PLUS one of path TO result  
        END FOR  
  
        RETURN result  
    END FUNCTION  
END CLASS