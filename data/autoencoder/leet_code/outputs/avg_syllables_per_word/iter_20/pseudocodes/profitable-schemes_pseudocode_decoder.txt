CLASS Solution  
    FUNCTION profitableSchemes(n integer, minProfit integer, group list OF integer, profit list OF integer) RETURNS integer  
        SET MOD TO one billion PLUS seven  
        SET dp TO a two dimensional list with n PLUS one rows each containing minProfit PLUS one zeros  
        FOR each i FROM zero TO n  
            SET element at position zero of the row at position i of dp TO one  
        END FOR  
        FOR each pair of p AND g IN profit AND group  
            FOR each i FROM n DOWN TO g  
                FOR each j FROM minProfit DOWN TO zero  
                    SET element at position j of the row at position i of dp TO the sum of element at position j of the row at position i of dp AND element at position of the maximum of zero AND j MINUS p of the row at position i MINUS g of dp MODULO MOD  
                END FOR  
            END FOR  
        END FOR  
        RETURN element at position minProfit of the row at position n of dp  
    END FUNCTION  
END CLASS