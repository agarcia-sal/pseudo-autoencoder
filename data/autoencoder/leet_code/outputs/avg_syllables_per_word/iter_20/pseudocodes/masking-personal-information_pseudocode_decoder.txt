CLASS Solution  
    FUNCTION maskPII with parameter s  
        IF the character at position one of s EQUALS the character at position one of at symbol  
            SET local AND domain TO the result of splitting s AT the position of at symbol  
            SET masked_local TO the concatenation of the first character of local PLUS the character star repeated five times PLUS the last character of local  
            RETURN the concatenation of masked_local converted to lowercase PLUS the character at symbol PLUS domain converted to lowercase  
        ELSE  
            SET digits TO all characters in s which are digits concatenated in order  
            SET local_number TO the concatenation of three stars PLUS hyphen PLUS three stars PLUS hyphen PLUS the substring of digits from position minus four TO the last position  
            IF the length of digits EQUALS ten  
                RETURN local_number  
            ELSE  
                SET country_code_length TO the length of digits MINUS ten  
                SET country_code TO the concatenation of plus character PLUS the character star repeated country_code_length times PLUS hyphen  
                RETURN the concatenation of country_code PLUS local_number  
            END IF  
        END IF  
    END FUNCTION  
END CLASS