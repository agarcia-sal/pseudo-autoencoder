CLASS Solution  
    FUNCTION countSmaller(nums)  
        SET sorted_nums TO the sorted list of unique elements of nums  
        SET rank TO a dictionary mapping each value in sorted_nums TO its position index plus one in sorted_nums  
        SET bit TO a list of zeros with length equal to the length of sorted_nums plus one  
        
        FUNCTION get_sum(idx)  
            SET result TO zero  
            WHILE idx IS GREATER THAN zero  
                INCREMENT result BY element at position idx of bit  
                DECREMENT idx BY the value of idx AND the two's complement of idx  
            END WHILE  
            RETURN result  
        END FUNCTION  
        
        FUNCTION update(idx, delta)  
            WHILE idx IS LESS THAN the LENGTH OF bit  
                INCREMENT element at position idx of bit BY delta  
                INCREMENT idx BY the value of idx AND the two's complement of idx  
            END WHILE  
        END FUNCTION  
        
        SET counts TO an empty list  
        FOR each num IN the reverse order of nums  
            SET r TO the value associated with num in rank  
            APPEND get_sum of r MINUS one TO counts  
            CALL update with r and one  
        END FOR  
        
        RETURN the reverse order of counts  
    END FUNCTION  
END CLASS