CLASS Solution  
    FUNCTION largestRectangleArea WITH parameter heights  
        SET stack TO a list containing minus one  
        SET max_area TO zero  
        APPEND zero TO the end of heights  
        
        FOR each index i and height h IN enumeration of heights  
            WHILE element at position last of stack NOT EQUALS minus one AND height h LESS THAN element at position element at position last of stack of heights  
                SET height TO element at position element popped from stack of heights  
                SET width TO index i MINUS element at position last of stack MINUS one  
                SET max_area TO the maximum value BETWEEN max_area AND height MULTIPLIED BY width  
            END WHILE  
            APPEND index i TO stack  
        END FOR  
        
        RETURN max_area  
    END FUNCTION  
END CLASS