CLASS Solution  
    FUNCTION minAbbreviation(target WITH TYPE string, dictionary WITH TYPE list OF string) RETURNS string  
        FUNCTION is_valid_abbr(string_s WITH TYPE string, abbr WITH TYPE string) RETURNS boolean  
            SET variable_i TO zero  
            SET variable_j TO zero  
            WHILE variable_i IS LESS THAN the LENGTH OF string_s AND variable_j IS LESS THAN the LENGTH OF abbr  
                IF the element at position variable_j of abbr IS A DIGIT  
                    IF the element at position variable_j of abbr IS EQUAL TO zero (leading zeros not allowed)  
                        RETURN false  
                    END IF  
                    SET variable_shift TO zero  
                    WHILE variable_j IS LESS THAN the LENGTH OF abbr AND the element at position variable_j of abbr IS A DIGIT  
                        SET variable_shift TO variable_shift MULTIPLIED BY ten PLUS the INTEGER VALUE OF the element at position variable_j of abbr  
                        INCREMENT variable_j BY one  
                    END WHILE  
                    INCREMENT variable_i BY variable_shift  
                ELSE  
                    IF the element at position variable_i of string_s IS NOT EQUAL TO the element at position variable_j of abbr  
                        RETURN false  
                    END IF  
                    INCREMENT variable_i BY one  
                    INCREMENT variable_j BY one  
                END IF  
            END WHILE  
            RETURN the TEST WHETHER variable_i IS EQUAL TO the LENGTH OF string_s AND variable_j IS EQUAL TO the LENGTH OF abbr  
        END FUNCTION  
        
        FUNCTION generate_abbrs(word WITH TYPE string, length WITH TYPE integer, abbr WITH TYPE string ASSIGNED TO empty string, index WITH TYPE integer ASSIGNED TO zero, skip_count WITH TYPE integer ASSIGNED TO zero)  
            IF index IS EQUAL TO length  
                IF skip_count IS GREATER THAN zero  
                    SET abbr TO abbr CONCATENATED WITH THE STRING REPRESENTATION OF skip_count  
                END IF  
                APPEND abbr TO the global list abbrs  
                RETURN  
            END IF  
            CALL generate_abbrs WITH parameters word, length, abbr, index INCREMENTED BY one, skip_count INCREMENTED BY one  
            IF skip_count IS GREATER THAN zero  
                SET abbr TO abbr CONCATENATED WITH THE STRING REPRESENTATION OF skip_count  
            END IF  
            CALL generate_abbrs WITH parameters word, length, abbr CONCATENATED WITH the element at position index of word, index INCREMENTED BY one, zero  
        END FUNCTION  
        
        FUNCTION find_unique_abbr() RETURNS string OR null  
            FOR length FROM one TO the LENGTH OF target  
                CLEAR the global list abbrs  
                CALL generate_abbrs WITH parameters target, the LENGTH OF target  
                SET variable_min_abbr TO null  
                SET variable_min_length TO infinity  
                FOR each abbr IN abbrs  
                    IF FOR ALL word IN filtered_dict THE TEST is_valid_abbr(word, abbr) IS false  
                        IF the LENGTH OF abbr IS LESS THAN variable_min_length  
                            SET variable_min_length TO the LENGTH OF abbr  
                            SET variable_min_abbr TO abbr  
                        END IF  
                    END IF  
                END FOR  
                IF variable_min_abbr IS NOT null  
                    RETURN variable_min_abbr  
                END IF  
            END FOR  
        END FUNCTION  
        
        SET filtered_dict TO an empty list  
        FOR each word IN dictionary  
            IF the LENGTH OF word IS EQUAL TO the LENGTH OF target  
                APPEND word TO filtered_dict  
            END IF  
        END FOR  
        
        SET abbrs TO an empty list  
        RETURN the RESULT OF find_unique_abbr()  
    END FUNCTION  
END CLASS