CLASS Solution  
    FUNCTION findRedundantDirectedConnection(edges AS List OF List OF Integer) RETURNS List OF Integer  
        FUNCTION find(parent AS List OF Integer, i AS Integer) RETURNS Integer  
            IF element at position i of parent NOT EQUALS i  
                SET element at position i of parent TO find(parent, element at position i of parent)  
            END IF  
            RETURN element at position i of parent  
        END FUNCTION  
        
        FUNCTION union(parent AS List OF Integer, rank AS List OF Integer, x AS Integer, y AS Integer) RETURNS Boolean  
            SET rootX TO find(parent, x)  
            SET rootY TO find(parent, y)  
            IF rootX NOT EQUALS rootY  
                IF element at position rootX of rank GREATER THAN element at position rootY of rank  
                    SET element at position rootY of parent TO rootX  
                ELSE IF element at position rootX of rank LESS THAN element at position rootY of rank  
                    SET element at position rootX of parent TO rootY  
                ELSE  
                    SET element at position rootY of parent TO rootX  
                    INCREMENT element at position rootX of rank BY one  
                END IF  
                RETURN true  
            END IF  
            RETURN false  
        END FUNCTION  
        
        SET n TO the LENGTH OF edges  
        SET parent TO list of integers from zero TO n  
        SET rank TO list of zeros of length n PLUS one  
        
        SET candidate1 TO null  
        SET candidate2 TO null  
        SET last TO null  
        
        FOR each element u v IN edges  
            IF element at position v of parent NOT EQUALS v  
                SET candidate1 TO list containing element at position v of parent AND v  
                SET candidate2 TO list containing u AND v  
            ELSE  
                IF union(parent, rank, u, v) EQUALS false  
                    SET last TO list containing u AND v  
                END IF  
            END IF  
        END FOR  
        
        IF candidate1 EQUALS null  
            RETURN last  
        END IF  
        
        IF last NOT EQUALS null  
            RETURN candidate1  
        END IF  
        
        RETURN candidate2  
    END FUNCTION  
END CLASS