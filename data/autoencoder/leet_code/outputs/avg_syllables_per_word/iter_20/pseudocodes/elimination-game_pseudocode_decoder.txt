CLASS Solution  
    FUNCTION lastRemaining(n)  
        SET remaining TO n  
        SET step TO one  
        SET left_to_right TO true  
        SET head TO one  
        
        WHILE remaining IS GREATER THAN one  
            IF left_to_right IS true OR the remainder when remaining IS DIVIDED BY two IS EQUALS one  
                INCREMENT head BY step  
            END IF  
            MULTIPLY step BY two AND ASSIGN TO step  
            DIVIDE remaining BY two AND ASSIGN TO remaining  
            SET left_to_right TO NOT left_to_right  
        END WHILE  
        
        RETURN head  
    END FUNCTION  
END CLASS