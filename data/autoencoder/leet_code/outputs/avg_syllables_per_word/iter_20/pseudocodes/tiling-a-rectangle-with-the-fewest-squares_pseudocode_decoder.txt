CLASS Solution  
    FUNCTION tilingRectangle WITH PARAMETERS n AND m  
        FUNCTION backtrack WITH PARAMETERS heights AND moves  
            IF all elements at positions h in heights ARE EQUAL TO n  
                SET min_moves TO the minimum of min_moves AND moves  
                RETURN  
            END IF  
            
            IF moves IS GREATER THAN OR EQUAL TO min_moves  
                RETURN  
            END IF  
            
            SET min_height TO the minimum value IN heights  
            SET left TO the position of the first occurrence of min_height IN heights  
            SET right TO left  
            WHILE right IS LESS THAN m AND the element at position right of heights IS EQUAL TO min_height  
                INCREMENT right BY one  
            END WHILE  
            
            FOR size FROM the difference BETWEEN right AND left DOWN TO one  
                IF for each i FROM zero TO size MINUS one all elements at positions left PLUS i of heights PLUS size ARE LESS THAN OR EQUAL TO n  
                    SET new_heights TO a copy of heights  
                    FOR i FROM zero TO size MINUS one  
                        INCREMENT the element at position left PLUS i of new_heights BY size  
                    END FOR  
                    CALL backtrack WITH new_heights AND moves PLUS one  
                END IF  
            END FOR  
        END FUNCTION  
        
        SET min_moves TO infinity  
        CALL backtrack WITH a list of zeros of length m AND zero  
        RETURN min_moves  
    END FUNCTION  
END CLASS