CLASS Solution  
    FUNCTION numWays(words AS list OF string, target AS string) RETURNS integer  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF element at position zero of words  
        SET m TO the LENGTH OF target  
        
        SET freq TO a list of dictionaries mapping characters to integers with size n  
        FOR each word IN words  
            FOR each index j AND character char IN the enumeration of word  
                INCREMENT the value for character char in dictionary at position j of freq BY one  
            END FOR  
        END FOR  
        
        SET dp TO a two dimensional list of integers with m PLUS one rows and n PLUS one columns initialized to zero  
        
        FOR each index j FROM zero TO n  
            SET element at row zero and column j of dp TO one  
        END FOR  
        
        FOR each index i FROM one TO m  
            FOR each index j FROM one TO n  
                SET element at row i and column j of dp TO the value of element at row i and column j MINUS one of dp  
                IF the value for character at position i MINUS one of target in dictionary at position j MINUS one of freq IS GREATER THAN zero  
                    INCREMENT element at row i and column j of dp BY element at row i MINUS one and column j MINUS one of dp MULTIPLIED BY the value for character at position i MINUS one of target in dictionary at position j MINUS one of freq  
                    SET element at row i and column j of dp TO element at row i and column j of dp MODULO MOD  
                END IF  
            END FOR  
        END FOR  
        
        RETURN element at row m and column n of dp  
    END FUNCTION  
END CLASS