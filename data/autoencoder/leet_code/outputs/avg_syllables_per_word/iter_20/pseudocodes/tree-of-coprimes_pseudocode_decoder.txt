CLASS Solution  
    FUNCTION getCoprimes(nums, edges)  
        SET n TO the LENGTH OF nums  
        SET tree TO a new default dictionary of type list  
        FOR each pair u and v IN edges  
            APPEND v TO element at position u of tree  
            APPEND u TO element at position v of tree  
        END FOR  
  
        SET coprime TO a two dimensional list of size fifty by fifty with all elements SET TO false  
        FOR i FROM one TO fifty  
            FOR j FROM one TO fifty  
                SET element at position i and j of coprime TO the result of whether the greatest common divisor of i AND j EQUALS one  
            END FOR  
        END FOR  
  
        SET result TO a list of length n with all elements SET TO minus one  
        SET ancestor_stack TO a list of length fifty one with all elements SET TO none  
  
        FUNCTION dfs(node, parent, depth)  
            SET closest_ancestor TO minus one  
            SET max_depth TO minus one  
            FOR value FROM one TO fifty  
                IF element at position nums at position node AND value of coprime IS true AND element at position value of ancestor_stack IS NOT none  
                    SET anc_node TO the first element of element at position value of ancestor_stack  
                    SET anc_depth TO the second element of element at position value of ancestor_stack  
                    IF anc_depth GREATER THAN max_depth  
                        SET max_depth TO anc_depth  
                        SET closest_ancestor TO anc_node  
                    END IF  
                END IF  
            END FOR  
  
            SET element at position node of result TO closest_ancestor  
  
            SET original_ancestor TO element at position nums at position node of ancestor_stack  
            SET element at position nums at position node of ancestor_stack TO a tuple containing node and depth  
  
            FOR each child IN element at position node of tree  
                IF child NOT EQUALS parent  
                    CALL dfs with arguments child, node, depth PLUS one  
                END IF  
            END FOR  
  
            SET element at position nums at position node of ancestor_stack TO original_ancestor  
        END FUNCTION  
  
        CALL dfs with arguments zero, minus one, zero  
  
        RETURN result  
    END FUNCTION  
END CLASS