CLASS Solution  
    FUNCTION minMalwareSpread(graph AS List OF List OF integer, initial AS List OF integer) RETURNS integer  
        SET number_of_nodes TO the LENGTH OF graph  
        SET adjacency_list TO a new mapping FROM integer TO list OF integer with default empty list  
        
        FOR index FROM zero TO number_of_nodes MINUS one  
            FOR inner_index FROM index PLUS one TO number_of_nodes MINUS one  
                IF the element at position inner_index of the element at position index of graph EQUALS one  
                    APPEND inner_index TO the list at key index of adjacency_list  
                    APPEND index TO the list at key inner_index of adjacency_list  
                END IF  
            END FOR  
        END FOR  
        
        FUNCTION dfs(node AS integer, visited AS set OF integer) RETURNS integer  
            IF node IS IN visited  
                RETURN zero  
            END IF  
            ADD node TO visited  
            SET size TO one  
            FOR each neighbor IN the list at key node of adjacency_list  
                INCREMENT size BY the RESULT OF dfs called with neighbor AND visited  
            END FOR  
            RETURN size  
        END FUNCTION  
        
        SET infected_nodes TO a new set initialized with all elements of initial  
        SET component_sizes TO an empty list  
        SET visited_nodes TO an empty set  
        SET component_index_mapping TO a new mapping FROM integer TO integer with default zero  
        
        FOR node FROM zero TO number_of_nodes MINUS one  
            IF node IS NOT IN visited_nodes AND node IS NOT IN infected_nodes  
                SET component_size TO the RESULT OF dfs called with node AND visited_nodes  
                APPEND component_size TO component_sizes  
                FOR index_reverse FROM the LENGTH OF component_sizes MINUS one DOWN TO zero  
                    IF the element at position index_reverse of component_sizes EQUALS component_size  
                        BREAK  
                    END IF  
                END FOR  
                FOR each neighbor IN the list at key node of adjacency_list  
                    SET the value at key neighbor of component_index_mapping TO index_reverse  
                END FOR  
            END IF  
        END FOR  
        
        SET infected_component_count TO a new mapping FROM integer TO integer with default zero  
        FOR each infected_node IN infected_nodes  
            IF infected_node IS IN component_index_mapping  
                INCREMENT the value at key the value at key infected_node of component_index_mapping of infected_component_count BY one  
            END IF  
        END FOR  
        
        SET maximum_size TO zero  
        SET node_to_remove TO the smallest element IN initial  
        
        FOR each infected_node IN infected_nodes  
            IF infected_node IS IN component_index_mapping  
                SET component_idx TO the value at key infected_node of component_index_mapping  
                IF the value at key component_idx of infected_component_count EQUALS one  
                    IF the element at position component_idx of component_sizes GREATER THAN maximum_size  
                        SET maximum_size TO the element at position component_idx of component_sizes  
                        SET node_to_remove TO infected_node  
                    ELSE IF the element at position component_idx of component_sizes EQUALS maximum_size  
                        IF infected_node LESS THAN node_to_remove  
                            SET node_to_remove TO infected_node  
                        END IF  
                    END IF  
                END IF  
            END IF  
        END FOR  
        
        RETURN node_to_remove  
    END FUNCTION  
END CLASS