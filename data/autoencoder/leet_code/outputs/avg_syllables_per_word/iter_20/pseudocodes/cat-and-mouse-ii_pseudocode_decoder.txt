CLASS Solution  
    FUNCTION canMouseWin(grid, catJump, mouseJump)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero of grid  
        SET cat_start TO zero  
        SET mouse_start TO zero  
        SET food TO zero  
        SET dirs TO the SEQUENCE minus one zero one zero minus one  
        SET g_mouse TO a LIST of empty LISTS with the LENGTH OF the MULTIPLICATION of m AND n  
        SET g_cat TO a LIST of empty LISTS with the LENGTH OF the MULTIPLICATION of m AND n  

        FOR each i and row IN the ENUMERATION OF grid  
            FOR each j and c IN the ENUMERATION OF row  
                IF c EQUALS the character representing a wall  
                    CONTINUE to next iteration  
                END IF  
                SET v TO the MULTIPLICATION of i AND n PLUS j  
                IF c EQUALS the character representing the cat  
                    SET cat_start TO v  
                ELSE IF c EQUALS the character representing the mouse  
                    SET mouse_start TO v  
                ELSE IF c EQUALS the character representing the food  
                    SET food TO v  
                END IF  
                FOR each a and b IN consecutive pairs of elements IN dirs  
                    FOR k FROM zero TO mouseJump INCLUSIVE  
                        SET x TO i PLUS the MULTIPLICATION of k AND a  
                        SET y TO j PLUS the MULTIPLICATION of k AND b  
                        IF x IS LESS THAN zero OR x IS GREATER THAN OR EQUAL TO m OR y IS LESS THAN zero OR y IS GREATER THAN OR EQUAL TO n OR the element at position x of grid AT position y EQUALS the character representing a wall  
                            BREAK the loop  
                        END IF  
                        APPEND the MULTIPLICATION of x AND n PLUS y TO the element at position v of g_mouse  
                    END FOR  
                    FOR k FROM zero TO catJump INCLUSIVE  
                        SET x TO i PLUS the MULTIPLICATION of k AND a  
                        SET y TO j PLUS the MULTIPLICATION of k AND b  
                        IF x IS LESS THAN zero OR x IS GREATER THAN OR EQUAL TO m OR y IS LESS THAN zero OR y IS GREATER THAN OR EQUAL TO n OR the element at position x of grid AT position y EQUALS the character representing a wall  
                            BREAK the loop  
                        END IF  
                        APPEND the MULTIPLICATION of x AND n PLUS y TO the element at position v of g_cat  
                    END FOR  
                END FOR  
            END FOR  
        END FOR  
        RETURN the result of the CALL of the FUNCTION calc WITH g_mouse, g_cat, mouse_start, cat_start, food EQUALS one  
    END FUNCTION  

    FUNCTION calc(g_mouse, g_cat, mouse_start, cat_start, hole)  
        FUNCTION get_prev_states(state)  
            SET m TO the element at position zero of state  
            SET c TO the element at position one of state  
            SET t TO the element at position two of state  
            SET pt TO the BITWISE EXCLUSIVE OR of t AND one  
            SET pre TO an empty LIST  
            IF pt EQUALS one  
                FOR each pc IN the element at position c of g_cat  
                    IF the element at position m of ans AT position pc AT position one EQUALS zero  
                        APPEND a TUPLE containing m, pc, pt TO pre  
                    END IF  
                END FOR  
            ELSE  
                FOR each pm IN the element at position m of g_mouse  
                    IF the element at position pm of ans AT position c AT position zero EQUALS zero  
                        APPEND a TUPLE containing pm, c, zero TO pre  
                    END IF  
                END FOR  
            END IF  
            RETURN pre  
        END FUNCTION  

        SET n TO the LENGTH OF g_mouse  
        SET degree TO a THREE-DIMENSIONAL LIST of ZEROES with the SIZE n BY n BY two  
        FOR i FROM zero TO n MINUS one  
            FOR j FROM zero TO n MINUS one  
                SET the element at position zero of the element at position j of the element at position i of degree TO the LENGTH OF the element at position i of g_mouse  
                SET the element at position one of the element at position j of the element at position i of degree TO the LENGTH OF the element at position j of g_cat  
            END FOR  
        END FOR  

        SET ans TO a THREE-DIMENSIONAL LIST of ZEROES with the SIZE n BY n BY two  
        SET q TO an EMPTY double-ended QUEUE  
        FOR i FROM zero TO n MINUS one  
            SET the element at position one of the element at position i of the element at position hole of ans TO one  
            SET the element at position zero of the element at position hole of the element at position i of ans TO two  
            SET the element at position zero of the element at position i of the element at position i of ans TO two  
            SET the element at position one of the element at position i of the element at position i of ans TO two  
            APPEND the TUPLE containing hole, i, one TO q  
            APPEND the TUPLE containing i, hole, zero TO q  
            APPEND the TUPLE containing i, i, zero TO q  
            APPEND the TUPLE containing i, i, one TO q  
        END FOR  

        WHILE q IS NOT EMPTY  
            SET state TO the result of REMOVING FROM THE FRONT of q  
            SET t TO the element at position two of ans AT position one of ans AT position zero of state  
            FOR each prev_state IN the CALL of get_prev_states WITH state  
                SET pm TO the element at position zero of prev_state  
                SET pc TO the element at position one of prev_state  
                SET pt TO the element at position two of prev_state  
                IF pt EQUALS t MINUS one  
                    SET the element at position pt of the element at position pc of the element at position pm of ans TO t  
                    APPEND prev_state TO q  
                ELSE  
                    DECREMENT the element at position pt of the element at position pc of the element at position pm of degree BY one  
                    IF the element at position pt of the element at position pc of the element at position pm of degree EQUALS zero  
                        SET the element at position pt of the element at position pc of the element at position pm of ans TO t  
                        APPEND prev_state TO q  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        RETURN the element at position zero of the element at position cat_start of the element at position mouse_start of ans  
    END FUNCTION  
END CLASS