CLASS Solution  
    FUNCTION numberOfCombinations(num)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF num  
        ASSIGN memo TO an EMPTY dictionary  

        FUNCTION dp(index, prev_len)  
            IF index EQUALS n  
                RETURN one  
            END IF  
            
            IF the KEY composed of index and prev_len EXISTS IN memo  
                RETURN the VALUE ASSOCIATED WITH the KEY composed of index and prev_len IN memo  
            END IF  
            
            SET count TO zero  
            FOR length FROM one TO n MINUS index  
                IF element at position index of num EQUALS the CHARACTER ZERO  
                    BREAK the loop  
                END IF  
                
                SET current_num TO the SUBSTRING from position index TO index PLUS length MINUS one of num  
                
                IF prev_len EQUALS zero OR current_num IS GREATER THAN OR EQUAL TO the SUBSTRING from position index MINUS prev_len TO index MINUS one of num  
                    SET count TO count PLUS dp WITH PARAMETERS index PLUS length AND length  
                    SET count TO count MODULO MOD  
                END IF  
            END FOR  
            
            SET memo WITH KEY composed of index and prev_len TO count  
            RETURN count  
        END FUNCTION  
        
        RETURN dp WITH PARAMETERS zero AND zero  
    END FUNCTION  
END CLASS