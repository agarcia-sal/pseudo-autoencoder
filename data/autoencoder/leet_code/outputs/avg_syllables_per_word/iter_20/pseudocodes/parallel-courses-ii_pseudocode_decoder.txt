CLASS Solution  
    FUNCTION minNumberOfSemesters(n, relations, k)  
        SET graph TO an empty mapping from course TO list of courses that depend on it  
        SET in_degree TO a list of zeroes with length equal TO n plus one  
        FOR each pair of previous course AND next course IN relations  
            APPEND next course TO the list at key previous course IN graph  
            INCREMENT the element at position next course IN in_degree BY one  
        END FOR  
        SET queue TO an empty double ended queue data structure  
        FOR each course FROM one TO n  
            IF the element at position course IN in_degree EQUALS zero  
                APPEND course TO queue  
            END IF  
        END FOR  
        SET semesters TO zero  
        WHILE queue IS NOT empty  
            SET limit TO the smaller of k AND the LENGTH OF queue  
            FOR count FROM one TO limit  
                REMOVE the element from the left end of queue AND ASSIGN it TO current_course  
                FOR each next_course IN the list at key current_course IN graph  
                    DECREMENT the element at position next_course IN in_degree BY one  
                    IF the element at position next_course IN in_degree EQUALS zero  
                        APPEND next_course TO queue  
                    END IF  
                END FOR  
            END FOR  
            INCREMENT semesters BY one  
        END WHILE  
        RETURN semesters  
    END FUNCTION  
END CLASS