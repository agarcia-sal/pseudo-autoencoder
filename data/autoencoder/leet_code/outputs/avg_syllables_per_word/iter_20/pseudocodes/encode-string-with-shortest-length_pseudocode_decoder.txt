CLASS Solution  
    FUNCTION encode(s)  
        FUNCTION get_encoded_length(count, substring)  
            RETURN the LENGTH OF the string CONVERTED FROM the integer count PLUS the LENGTH OF substring PLUS two for the open bracket and the close bracket  
        END FUNCTION

        FUNCTION dp(i, j)  
            SET substring TO the element at positions from i TO j of s  
            SET n TO j MINUS i PLUS one  
            IF n LESS THAN five THEN  
                RETURN substring  
            END IF

            SET shortest TO substring  
            FOR each k FROM one TO the INTEGER DIVISION of n BY two PLUS one  
                IF n MODULO k EQUALS zero THEN  
                    SET repeat_count TO n DIVIDED BY k  
                    IF substring EQUALS the concatenation of substring from the start TO position k MINUS one REPEATED repeat_count TIMES THEN  
                        SET encoded_candidate TO the string of repeat_count CONCATENATED WITH the open bracket CONCATENATED WITH the result of dp called with i AND i PLUS k MINUS one CONCATENATED WITH the close bracket  
                        IF the LENGTH OF encoded_candidate LESS THAN the LENGTH OF shortest THEN  
                            SET shortest TO encoded_candidate  
                        END IF  
                    END IF  
                END IF  
            END FOR

            FOR each k FROM i TO j MINUS one  
                SET left_encoded TO the result of dp called with i AND k  
                SET right_encoded TO the result of dp called with k PLUS one AND j  
                SET combined TO the concatenation of left_encoded AND right_encoded  
                IF the LENGTH OF combined LESS THAN the LENGTH OF shortest THEN  
                    SET shortest TO combined  
                END IF  
            END FOR

            RETURN shortest  
        END FUNCTION

        RETURN the result of dp called with zero AND the LENGTH OF s MINUS one  
    END FUNCTION  
END CLASS