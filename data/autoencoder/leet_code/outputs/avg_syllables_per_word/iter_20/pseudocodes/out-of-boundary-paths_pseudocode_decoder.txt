CLASS Solution  
    FUNCTION findPaths(m, n, maxMove, startRow, startColumn)  
        SET MOD TO one billion PLUS seven  
        SET directions TO a list containing the pairs zero AND one one AND zero zero AND minus one minus one AND zero  
        CALL initialize_dp_array WITH parameters m n maxMove PLUS one AND ASSIGN RESULT TO dp  
        FOR number_of_moves FROM one TO maxMove  
            FOR row_index FROM zero TO m MINUS one  
                FOR column_index FROM zero TO n MINUS one  
                    FOR each direction_delta_row AND direction_delta_column IN directions  
                        SET new_row TO row_index PLUS direction_delta_row  
                        SET new_column TO column_index PLUS direction_delta_column  
                        IF new_row IS LESS THAN zero OR new_row IS GREATER THAN OR EQUAL TO m OR new_column IS LESS THAN zero OR new_column IS GREATER THAN OR EQUAL TO n  
                            SET dp element at position row_index AND column_index AND number_of_moves TO the sum of dp element at position row_index AND column_index AND number_of_moves AND one MODULO MOD  
                        ELSE  
                            SET dp element at position row_index AND column_index AND number_of_moves TO the sum of dp element at position row_index AND column_index AND number_of_moves AND dp element at position new_row AND new_column AND number_of_moves MINUS one MODULO MOD  
                        END IF  
                    END FOR  
                END FOR  
            END FOR  
        END FOR  
        RETURN dp element at position startRow AND startColumn AND maxMove  
    END FUNCTION  

    FUNCTION initialize_dp_array(rows, columns, depth)  
        RETURN a three dimensional array of zeros with dimensions rows BY columns BY depth  
    END FUNCTION  
END CLASS