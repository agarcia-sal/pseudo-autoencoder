CLASS Solution  
    FUNCTION isScramble WITH PARAMETERS s1 AS string AND s2 AS string  
        IF the value of s1 EQUALS the value of s2  
            RETURN True  
        END IF  
        IF the sequence of characters of s1 SORTED DOES NOT EQUAL the sequence of characters of s2 SORTED  
            RETURN False  
        END IF  
        SET n TO the LENGTH OF s1  
        FOR i FROM one TO n MINUS one  
            IF the result of calling isScramble WITH substring from position one TO i of s1 AND substring from position one TO i of s2 IS True  
                AND the result of calling isScramble WITH substring from position i PLUS one TO the end of s1 AND substring from position i PLUS one TO the end of s2 IS True  
                RETURN True  
            END IF  
            IF the result of calling isScramble WITH substring from position one TO i of s1 AND substring from position n MINUS i PLUS one TO the end of s2 IS True  
                AND the result of calling isScramble WITH substring from position i PLUS one TO the end of s1 AND substring from position one TO n MINUS i of s2 IS True  
                RETURN True  
            END IF  
        END FOR  
        RETURN False  
    END FUNCTION  
END CLASS