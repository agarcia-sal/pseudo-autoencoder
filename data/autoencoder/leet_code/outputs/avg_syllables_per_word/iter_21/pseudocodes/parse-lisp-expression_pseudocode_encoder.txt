CLASS Solution  
    FUNCTION evaluate(expression)  
        FUNCTION get_tokens(expression)  
            SET tokens TO empty list  
            SET buf TO empty string  
            SET depth TO zero  
            FOR each char IN expression  
                IF char EQUALS a space AND depth EQUALS zero  
                    APPEND buf TO tokens  
                    SET buf TO empty string  
                ELSE  
                    IF char EQUALS open parenthesis  
                        INCREMENT depth BY one  
                    ELSE IF char EQUALS close parenthesis  
                        DECREMENT depth BY one  
                    END IF  
                    APPEND char TO buf  
                END IF  
            END FOR  
            IF buf IS NOT empty  
                APPEND buf TO tokens  
            END IF  
            RETURN tokens  
        END FUNCTION  

        FUNCTION evaluate_expression(tokens, context)  
            IF element at position zero OF tokens EQUALS the string add  
                RETURN evaluate_expression(element at position one OF tokens, context) PLUS evaluate_expression(element at position two OF tokens, context)  
            ELSE IF element at position zero OF tokens EQUALS the string mult  
                RETURN evaluate_expression(element at position one OF tokens, context) MULTIPLIED BY evaluate_expression(element at position two OF tokens, context)  
            ELSE IF element at position zero OF tokens EQUALS the string let  
                SET new_context TO a copy of context  
                SET i TO one  
                WHILE i LESS THAN the length OF tokens MINUS one  
                    SET var TO element at position i OF tokens  
                    SET expr TO element at position i PLUS one OF tokens  
                    SET the value in new_context at key var TO evaluate_expression(expr, new_context)  
                    INCREMENT i BY two  
                END WHILE  
                RETURN evaluate_expression(the last element of tokens, new_context)  
            ELSE  
                TRY  
                    RETURN integer conversion OF element at position zero OF tokens  
                CATCH ValueError  
                    RETURN the value in context at key element at position zero OF tokens  
                END TRY  
            END IF  
        END FUNCTION  

        FUNCTION parse_expression(expression)  
            IF element at position zero OF expression NOT EQUALS open parenthesis  
                RETURN expression  
            END IF  
            SET tokens TO CALL get_tokens WITH PARAMETERS substring of expression from position one TO the length of expression MINUS one  
            RETURN list comprehension of CALL parse_expression WITH PARAMETERS token FOR each token IN tokens  
        END FUNCTION  

        SET parsed_expression TO CALL parse_expression WITH PARAMETERS expression  
        RETURN CALL evaluate_expression WITH PARAMETERS parsed_expression AND empty dictionary  
    END FUNCTION  
END CLASS