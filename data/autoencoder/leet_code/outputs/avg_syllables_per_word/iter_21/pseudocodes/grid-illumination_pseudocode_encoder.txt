CLASS Solution  
    FUNCTION gridIllumination(n, lamps, queries)  
        CALL initialize a dictionary named row_count with default integer zero  
        CALL initialize a dictionary named col_count with default integer zero  
        CALL initialize a dictionary named diag_count with default integer zero where the key is row MINUS column  
        CALL initialize a dictionary named anti_diag_count with default integer zero where the key is row PLUS column  
  
        CALL initialize an empty set named lamp_positions  
  
        FOR each pair of values r AND c IN lamps  
            IF the pair r AND c is NOT IN lamp_positions  
                ADD the pair r AND c TO lamp_positions  
                INCREMENT the value at key r IN row_count BY one  
                INCREMENT the value at key c IN col_count BY one  
                INCREMENT the value at key r MINUS c IN diag_count BY one  
                INCREMENT the value at key r PLUS c IN anti_diag_count BY one  
            END IF  
        END FOR  
  
        SET directions TO the list of coordinate pairs of all eight adjacent cells plus the cell itself as follows  
            minus one MINUS one, minus one zero, minus one PLUS one, zero MINUS one, zero zero, zero PLUS one, plus one MINUS one, plus one zero, plus one PLUS one  
  
        INITIALIZE an empty list named result  
  
        FOR each pair of values r AND c IN queries  
            IF the value at key r IN row_count IS GREATER THAN zero OR the value at key c IN col_count IS GREATER THAN zero OR the value at key r MINUS c IN diag_count IS GREATER THAN zero OR the value at key r PLUS c IN anti_diag_count IS GREATER THAN zero  
                APPEND one TO result  
            ELSE  
                APPEND zero TO result  
            END IF  
  
            FOR each pair of values dr AND dc IN directions  
                SET nr TO r PLUS dr  
                SET nc TO c PLUS dc  
                IF the pair nr AND nc IS IN lamp_positions  
                    REMOVE the pair nr AND nc FROM lamp_positions  
                    DECREMENT the value at key nr IN row_count BY one  
                    DECREMENT the value at key nc IN col_count BY one  
                    DECREMENT the value at key nr MINUS nc IN diag_count BY one  
                    DECREMENT the value at key nr PLUS nc IN anti_diag_count BY one  
                END IF  
            END FOR  
        END FOR  
  
        RETURN result  
    END FUNCTION  
END CLASS