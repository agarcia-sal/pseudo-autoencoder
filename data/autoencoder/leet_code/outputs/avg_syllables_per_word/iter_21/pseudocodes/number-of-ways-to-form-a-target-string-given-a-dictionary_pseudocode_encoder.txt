CLASS Solution  
    FUNCTION numWays(words, target)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF the element at position zero OF words  
        SET m TO the LENGTH OF target  
          
        CALL precompute_frequencies WITH PARAMETERS words AND n RETURNING freq  
          
        CALL initialize_dp_table WITH PARAMETERS m AND n RETURNING dp  
          
        CALL set_base_case WITH PARAMETERS dp AND n  
          
        FOR i FROM one TO m  
            FOR j FROM one TO n  
                SET element at position j OF element at position i OF dp TO element at position j MINUS one OF element at position i OF dp  
                IF element at position j MINUS one OF freq CONTAINS key element at position i MINUS one OF target AND element at position i MINUS one OF freq AT key element at position i MINUS one OF target IS GREATER THAN zero THEN  
                    INCREMENT element at position j OF element at position i OF dp BY element at position j MINUS one OF element at position i MINUS one OF dp MULTIPLIED BY element at position i MINUS one OF freq AT key element at position i MINUS one OF target  
                    SET element at position j OF element at position i OF dp TO element at position j OF element at position i OF dp MODULO MOD  
                END IF  
            END FOR  
        END FOR  
          
        RETURN element at position n OF element at position m OF dp  
    END FUNCTION  
      
    FUNCTION precompute_frequencies(words, n)  
        SET freq TO a list containing n elements each being an empty mapping from character TO integer  
        FOR each word IN words  
            FOR j FROM zero TO n MINUS one  
                SET char TO element at position j OF word  
                IF char NOT IN element at position j OF freq THEN  
                    SET element at position j OF freq AT key char TO zero  
                END IF  
                INCREMENT element at position j OF freq AT key char BY one  
            END FOR  
        END FOR  
        RETURN freq  
    END FUNCTION  
      
    FUNCTION initialize_dp_table(m, n)  
        SET dp TO a list containing m PLUS one elements each being a list containing n PLUS one zeros  
        RETURN dp  
    END FUNCTION  
      
    FUNCTION set_base_case(dp, n)  
        FOR j FROM zero TO n  
            SET element at position j OF element at position zero OF dp TO one  
        END FOR  
    END FUNCTION  
END CLASS