CLASS Solution  
    FUNCTION longestSubsequenceRepeatedK(s, k)  
        FUNCTION Counter(string_input)  
            RETURN a mapping from each character TO the number of times it appears IN string_input  
        END FUNCTION  
        
        SET freq TO CALL Counter WITH PARAMETERS s  
        
        SET valid_chars TO an empty list  
        FOR each character_and_count IN the items OF freq  
            IF the count OF character_and_count IS GREATER THAN OR EQUAL TO k  
                APPEND the character OF character_and_count TO valid_chars  
            END IF  
        END FOR  
        
        SORT valid_chars IN descending lexicographical order  
        
        FUNCTION is_valid_subsequence(candidate)  
            SET count TO zero  
            SET index TO zero  
            FOR each character IN s  
                IF the character IS EQUAL TO the element at position index OF candidate  
                    INCREMENT index BY one  
                    IF index EQUALS the length OF candidate  
                        INCREMENT count BY one  
                        SET index TO zero  
                        IF count EQUALS k  
                            RETURN True  
                        END IF  
                    END IF  
                END IF  
            END FOR  
            RETURN False  
        END FUNCTION  
        
        SET max_length TO the length OF valid_chars DIVIDED BY k  
        SET best_candidate TO an empty string  
        
        FUNCTION backtrack(candidate)  
            IF the length OF candidate IS GREATER THAN the length OF best_candidate  
                SET best_candidate TO candidate  
            END IF  
            FOR each character IN valid_chars  
                SET new_candidate TO candidate FOLLOWED BY character  
                IF CALL is_valid_subsequence WITH PARAMETERS new_candidate HOLDS True  
                    CALL backtrack WITH PARAMETERS new_candidate  
                END IF  
            END FOR  
        END FUNCTION  
        
        CALL backtrack WITH PARAMETERS an empty string  
        RETURN best_candidate  
    END FUNCTION  
END CLASS