CLASS Solution  
    FUNCTION subStrHash(s, power, modulo, k, hashValue)  
        FUNCTION val(c)  
            RETURN the Unicode code point of character c MINUS the Unicode code point of character a PLUS one  
        END FUNCTION  
        
        SET n TO the LENGTH OF s  
        SET current_hash TO zero  
        SET p_pow TO one  
        
        FOR i FROM n MINUS k TO n MINUS one  
            SET current_hash TO current_hash PLUS val(element at position i OF s) MULTIPLIED BY p_pow  
            SET current_hash TO current_hash MODULO modulo  
            IF i LESS THAN n MINUS one THEN  
                SET p_pow TO p_pow MULTIPLIED BY power  
                SET p_pow TO p_pow MODULO modulo  
            END IF  
        END FOR  
        
        SET start_index TO n MINUS k  
        IF current_hash EQUALS hashValue THEN  
            RETURN substring from position start_index TO end OF s  
        END IF  
        
        SET p_pow_k_minus_1 TO p_pow  
        FOR i FROM n MINUS k MINUS one DOWN TO zero  
            SET current_hash TO current_hash MINUS val(element at position i PLUS k OF s) MULTIPLIED BY p_pow_k_minus_1  
            SET current_hash TO current_hash MODULO modulo  
            SET current_hash TO current_hash MULTIPLIED BY power  
            SET current_hash TO current_hash PLUS val(element at position i OF s)  
            SET current_hash TO current_hash MODULO modulo  
            
            IF current_hash EQUALS hashValue THEN  
                SET start_index TO i  
            END IF  
        END FOR  
        
        RETURN substring from position start_index TO start_index PLUS k OF s  
    END FUNCTION  
END CLASS