CLASS Solution
    FUNCTION shortestDistance(grid)
        IF NOT grid OR NOT element at position zero OF grid
            RETURN negative one
        END IF

        SET m TO LENGTH OF grid
        SET n TO LENGTH OF element at position zero OF grid
        SET total_distance TO CALL initializeMatrix WITH PARAMETERS m AND n
        SET reach_count TO CALL initializeMatrix WITH PARAMETERS m AND n
        SET building_count TO zero

        SET directions TO LIST OF TUPLES OF (one zero), (minus one zero), (zero one), (zero minus one)

        FUNCTION bfs(start_x, start_y)
            SET queue TO CALL initializeQueue WITH PARAMETERS start_x AND start_y
            SET visited TO CALL initializeVisited WITH PARAMETERS m AND n
            SET distance TO zero
            SET reachable TO zero

            WHILE queue IS NOT EMPTY
                SET size TO LENGTH OF queue
                INCREMENT distance BY one

                FOR index FROM one TO size
                    SET x, y TO CALL dequeue FROM queue
                    FOR each dx, dy IN directions
                        SET nx TO x PLUS dx
                        SET ny TO y PLUS dy
                        IF nx IS GREATER THAN OR EQUAL TO zero AND nx IS LESS THAN m AND ny IS GREATER THAN OR EQUAL TO zero AND ny IS LESS THAN n AND NOT element at position nx AND ny OF visited AND element at position nx AND ny OF grid EQUALS zero
                            SET element at position nx AND ny OF visited TO true
                            CALL enqueue TO queue WITH PARAMETERS nx AND ny
                            INCREMENT element at position nx AND ny OF total_distance BY distance
                            INCREMENT element at position nx AND ny OF reach_count BY one
                            INCREMENT reachable BY one
                        END IF
                    END FOR
                END FOR
            END WHILE

            RETURN reachable
        END FUNCTION

        FOR i FROM zero TO m MINUS one
            FOR j FROM zero TO n MINUS one
                IF element at position i AND j OF grid EQUALS one
                    INCREMENT building_count BY one
                    IF CALL bfs WITH PARAMETERS i AND j IS LESS THAN building_count MINUS one
                        RETURN negative one
                    END IF
                END IF
            END FOR
        END FOR

        SET min_distance TO positive infinity

        FOR i FROM zero TO m MINUS one
            FOR j FROM zero TO n MINUS one
                IF element at position i AND j OF grid EQUALS zero AND element at position i AND j OF reach_count EQUALS building_count
                    IF element at position i AND j OF total_distance IS LESS THAN min_distance
                        SET min_distance TO element at position i AND j OF total_distance
                    END IF
                END IF
            END FOR
        END FOR

        IF min_distance IS EQUAL TO positive infinity
            RETURN negative one
        ELSE
            RETURN min_distance
        END IF
    END FUNCTION

    FUNCTION initializeMatrix(rows, cols)
        SET matrix TO EMPTY LIST
        FOR row_index FROM zero TO rows MINUS one
            SET row TO EMPTY LIST
            FOR col_index FROM zero TO cols MINUS one
                APPEND zero TO row
            END FOR
            APPEND row TO matrix
        END FOR
        RETURN matrix
    END FUNCTION

    FUNCTION initializeQueue(start_x, start_y)
        SET queue TO EMPTY COLLECTION THAT SUPPORTS FIRST IN FIRST OUT
        ADD tuple of start_x AND start_y TO queue
        RETURN queue
    END FUNCTION

    FUNCTION initializeVisited(rows, cols)
        SET visited_matrix TO EMPTY LIST
        FOR row_index FROM zero TO rows MINUS one
            SET row TO EMPTY LIST
            FOR col_index FROM zero TO cols MINUS one
                APPEND false TO row
            END FOR
            APPEND row TO visited_matrix
        END FOR
        RETURN visited_matrix
    END FUNCTION
END CLASS