CLASS Solution  
    FUNCTION minTransfers(transactions)  
        SET balance TO an empty dictionary  
        FOR each transaction CONSISTING OF frm TO, to TO, amount TO IN transactions  
            IF frm IS IN balance  
                SET balance at frm TO the value at balance at frm MINUS amount  
            ELSE  
                SET balance at frm TO zero MINUS amount  
            END IF  
            IF to IS IN balance  
                SET balance at to TO the value at balance at to PLUS amount  
            ELSE  
                SET balance at to TO amount  
            END IF  
        END FOR  
        
        SET balances TO an empty list  
        FOR each net IN the values of balance  
            IF net NOT EQUALS zero  
                APPEND net TO balances  
            END IF  
        END FOR  
        
        IF the LENGTH OF balances EQUALS zero  
            RETURN zero  
        END IF  
        
        FUNCTION settle(start, cnt)  
            WHILE start LESS THAN the LENGTH OF balances AND the element at position start OF balances EQUALS zero  
                INCREMENT start BY one  
            END WHILE  
            
            IF start EQUALS the LENGTH OF balances  
                RETURN cnt  
            END IF  
            
            SET min_cnt TO positive infinity  
            FOR i FROM start PLUS one TO the LENGTH OF balances MINUS one  
                IF the element at position start OF balances MULTIPLIED BY the element at position i OF balances LESS THAN zero  
                    SET the element at position i OF balances TO the element at position i OF balances PLUS the element at position start OF balances  
                    SET min_cnt TO the smaller value BETWEEN min_cnt AND CALL settle WITH PARAMETERS start PLUS one AND cnt PLUS one  
                    SET the element at position i OF balances TO the element at position i OF balances MINUS the element at position start OF balances  
                END IF  
            END FOR  
            
            RETURN min_cnt  
        END FUNCTION  
        
        RETURN CALL settle WITH PARAMETERS zero AND zero  
    END FUNCTION  
END CLASS