CLASS Solution  
    FUNCTION longestWord(words)  
        CALL words.sort WITH PARAMETERS key DEFINED AS FUNCTION x  
            RETURN THE TUPLE OF THE LENGTH OF x AND x  
        END FUNCTION  
          
        SET valid_words TO AN EMPTY SET  
        SET longest_word TO AN EMPTY STRING  
          
        FOR each word IN words  
            IF THE LENGTH OF word EQUALS one OR THE SUBSTRING OF word FROM THE FIRST POSITION TO THE SECOND TO LAST POSITION IS IN valid_words  
                ADD word TO valid_words  
                IF THE LENGTH OF word IS GREATER THAN THE LENGTH OF longest_word  
                    SET longest_word TO word  
                END IF  
            END IF  
        END FOR  
          
        RETURN longest_word  
    END FUNCTION  
END CLASS