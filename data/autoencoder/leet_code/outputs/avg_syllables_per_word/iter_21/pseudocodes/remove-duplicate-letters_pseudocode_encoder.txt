CLASS Solution  
    FUNCTION removeDuplicateLetters(s)  
        CALL last_occurrence TO THE RESULT OF a FUNCTION THAT CREATES A DICTIONARY MAPPING each character IN s TO its last position index IN s  
        SET stack TO an empty list  
        SET in_stack TO an empty set  
        
        FOR each index idx AND character char IN s WITH their positions  
            IF char IS AN ELEMENT OF in_stack  
                CONTINUE TO next iteration  
            END IF  
            
            WHILE stack IS NOT EMPTY AND character char IS LESS THAN the element at the last position OF stack AND index idx IS LESS THAN the last position index OF the element at the last position OF stack IN last_occurrence  
                SET removed_char TO the result of REMOVING the element at the last position OF stack  
                REMOVE removed_char FROM in_stack  
            END WHILE  
            
            APPEND character char TO stack  
            ADD character char TO in_stack  
        END FOR  
        
        SET result_string TO the result of CONCATENATING all elements OF stack INTO A STRING  
        RETURN result_string  
    END FUNCTION  
END CLASS