CLASS Solution  
    FUNCTION hasValidPath(grid)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero OF grid  
        
        IF (m PLUS n MINUS one) MODULO two NOT EQUALS zero  
            RETURN False  
        END IF  
        
        CALL dp INITIALIZATION FUNCTION WITH PARAMETERS m PLUS one n PLUS one m PLUS n PLUS one AND ASSIGN RESULT TO dp  
        
        SET element at position zero at position one at position zero OF dp TO True  
        
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                FOR k FROM zero TO m PLUS n  
                    IF element at position i at position j PLUS one at position k OF dp OR element at position i PLUS one at position j at position k OF dp  
                        IF element at position i at position j OF grid EQUALS open parenthesis  
                            IF k PLUS one LESS THAN m PLUS n PLUS one  
                                SET element at position i PLUS one at position j PLUS one at position k PLUS one OF dp TO True  
                            END IF  
                        ELSE IF element at position i at position j OF grid EQUALS close parenthesis  
                            IF k MINUS one GREATER THAN OR EQUAL TO zero  
                                SET element at position i PLUS one at position j PLUS one at position k MINUS one OF dp TO True  
                            END IF  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        RETURN element at position m at position n at position zero OF dp  
    END FUNCTION  
    
    FUNCTION dp INITIALIZATION FUNCTION WITH PARAMETERS rows columns depth  
        CREATE three dimensional list named result WITH dimensions rows by columns by depth FILLED WITH False  
        RETURN result  
    END FUNCTION  
END CLASS