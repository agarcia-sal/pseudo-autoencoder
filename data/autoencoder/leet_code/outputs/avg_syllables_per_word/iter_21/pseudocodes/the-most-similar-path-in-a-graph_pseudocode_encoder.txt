CLASS Solution  
    FUNCTION mostSimilar(n, roads, names, targetPath)  
        CALL build_graph WITH PARAMETERS roads RETURNING graph  
        SET m TO the LENGTH OF targetPath  
  
        FUNCTION dp(i, j)  
            IF i EQUALS zero THEN  
                IF the element at position j OF names NOT EQUALS the element at position i OF targetPath THEN  
                    RETURN one AND a list CONTAINING j  
                ELSE  
                    RETURN zero AND a list CONTAINING j  
                END IF  
            END IF  
  
            SET min_cost TO infinity  
            SET min_path TO an empty list  
            FOR each element k IN the element at position j OF graph  
                CALL dp WITH PARAMETERS i MINUS one AND k RETURNING cost AND path  
                IF cost LESS THAN min_cost THEN  
                    SET min_cost TO cost  
                    SET min_path TO path  
                END IF  
            END FOR  
  
            IF the element at position j OF names NOT EQUALS the element at position i OF targetPath THEN  
                SET current_cost TO min_cost PLUS one  
            ELSE  
                SET current_cost TO min_cost  
            END IF  
  
            RETURN current_cost AND the concatenation of min_path AND a list CONTAINING j  
        END FUNCTION  
  
        SET min_cost TO infinity  
        SET min_path TO an empty list  
        FOR index j FROM zero TO n MINUS one  
            CALL dp WITH PARAMETERS m MINUS one AND j RETURNING cost AND path  
            IF cost LESS THAN min_cost THEN  
                SET min_cost TO cost  
                SET min_path TO path  
            END IF  
        END FOR  
  
        RETURN min_path  
    END FUNCTION  
  
    FUNCTION build_graph(roads)  
        CREATE a mapping FROM keys TO lists AND ASSIGN IT TO graph  
        FOR each pair u AND v IN roads  
            APPEND v TO the element at key u OF graph  
            APPEND u TO the element at key v OF graph  
        END FOR  
        RETURN graph  
    END FUNCTION  
END CLASS