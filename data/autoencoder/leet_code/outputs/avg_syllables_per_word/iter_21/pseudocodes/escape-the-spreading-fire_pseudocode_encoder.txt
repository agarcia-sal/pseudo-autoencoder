CLASS Solution
    FUNCTION maximumMinutes(grid)
        SET m TO the LENGTH OF grid
        SET n TO the LENGTH OF element at position zero OF grid
        SET directions TO a list containing four pairs:
            pair containing one and zero
            pair containing minus one and zero
            pair containing zero and one
            pair containing zero and minus one

        FUNCTION can_escape(wait)
            SET fire_times TO a two dimensional list of size m by n where each element IS positive infinity
            ASSIGN reference TO a new empty deque NAMED queue

            FOR i FROM zero TO m MINUS one
                FOR j FROM zero TO n MINUS one
                    IF element at position i OF grid EQUALS one
                        APPEND the tuple containing i j and zero TO queue
                        SET element at position i position j OF fire_times TO zero
                    END IF
                END FOR
            END FOR

            WHILE queue IS NOT empty
                REMOVE the first element FROM queue AND ASSIGN TO the tuple containing x y and t
                FOR each pair dx dy IN directions
                    SET nx TO x PLUS dx
                    SET ny TO y PLUS dy
                    IF nx IS GREATER THAN OR EQUAL TO zero AND nx IS LESS THAN m AND ny IS GREATER THAN OR EQUAL TO zero AND ny IS LESS THAN n AND element at position nx position ny OF grid EQUALS zero AND element at position nx position ny OF fire_times EQUALS positive infinity
                        SET element at position nx position ny OF fire_times TO t PLUS one
                        APPEND the tuple containing nx ny and t PLUS one TO queue
                    END IF
                END FOR
            END WHILE

            ASSIGN reference TO a new deque containing a single tuple containing zero zero and wait NAMED queue
            SET visited TO a set containing the tuple containing zero and zero

            WHILE queue IS NOT empty
                REMOVE the first element FROM queue AND ASSIGN TO the tuple containing x y and t
                FOR each pair dx dy IN directions
                    SET nx TO x PLUS dx
                    SET ny TO y PLUS dy
                    IF nx IS GREATER THAN OR EQUAL TO zero AND nx IS LESS THAN m AND ny IS GREATER THAN OR EQUAL TO zero AND ny IS LESS THAN n AND the tuple containing nx and ny IS NOT IN visited AND element at position nx position ny OF grid EQUALS zero
                        IF nx EQUALS m MINUS one AND ny EQUALS n MINUS one
                            IF element at position nx position ny OF fire_times IS GREATER THAN OR EQUAL TO t PLUS one
                                RETURN True
                            ELSE
                                RETURN False
                            END IF
                        END IF
                        IF element at position nx position ny OF fire_times IS GREATER THAN t PLUS one
                            ADD the tuple containing nx and ny TO visited
                            APPEND the tuple containing nx ny and t PLUS one TO queue
                        END IF
                    END IF
                END FOR
            END WHILE

            RETURN False
        END FUNCTION

        SET left TO zero
        SET right TO m MULTIPLIED BY n
        SET result TO minus one

        WHILE left IS LESS THAN OR EQUAL TO right
            SET mid TO the integer division of left PLUS right BY two
            IF CALL can_escape WITH PARAMETERS mid
                SET result TO mid
                SET left TO mid PLUS one
            ELSE
                SET right TO mid MINUS one
            END IF
        END WHILE

        IF result NOT EQUALS m MULTIPLIED BY n
            RETURN result
        ELSE
            RETURN one MULTIPLIED BY ten RAISED TO THE POWER OF nine
        END IF
    END FUNCTION
END CLASS