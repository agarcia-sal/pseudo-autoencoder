CLASS Solution  
    FUNCTION kthSmallest(mat, k)  
        SET m TO the LENGTH OF mat  
        SET n TO the LENGTH OF the element at position zero OF mat  
        SET min_heap TO a list containing a tuple consisting of the SUM OF each element at position zero OF each row IN mat AND a tuple of zeros with the LENGTH m  
        SET visited TO a set containing the element at position one OF the element at position zero OF min_heap  
        
        WHILE k IS GREATER THAN zero  
            CALL heapq POP the smallest element FROM min_heap AND ASSIGN the unpacked values TO current_sum AND indices  
            DECREMENT k BY one  
            
            IF k EQUALS zero  
                RETURN current_sum  
            END IF  
            
            FOR i FROM zero TO m MINUS one  
                IF the element at position i OF indices PLUS one IS LESS THAN n  
                    SET new_indices TO a list CONVERTED FROM indices  
                    INCREMENT the element at position i OF new_indices BY one  
                    SET new_indices_tuple TO a tuple CONVERTED FROM new_indices  
                    SET new_sum TO current_sum MINUS the element at position i THEN at the element at the element at position i OF indices OF mat PLUS the element at position i THEN at the element at the element at position i OF new_indices OF mat  
                    
                    IF new_indices_tuple IS NOT IN visited  
                        ADD new_indices_tuple TO visited  
                        CALL heapq PUSH the tuple consisting of new_sum AND new_indices_tuple INTO min_heap  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN negative one  
    END FUNCTION  
END CLASS