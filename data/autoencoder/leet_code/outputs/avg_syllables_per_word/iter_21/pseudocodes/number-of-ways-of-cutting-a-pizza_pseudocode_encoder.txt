CLASS Solution  
    FUNCTION ways(pizza, k)  
        FUNCTION dfs(i, j, k)  
            IF k EQUALS zero THEN  
                IF element at position m AND n OF s MINUS element at position i AND n OF s MINUS element at position m AND j OF s PLUS element at position i AND j OF s GREATER THAN zero THEN  
                    RETURN one  
                ELSE  
                    RETURN zero  
                END IF  
            END IF  
            SET ans TO zero  
            FOR x FROM i PLUS one TO m MINUS one  
                IF element at position x AND n OF s MINUS element at position i AND n OF s MINUS element at position x AND j OF s PLUS element at position i AND j OF s GREATER THAN zero THEN  
                    INCREMENT ans BY CALL dfs WITH PARAMETERS x, j, k MINUS one  
                END IF  
            END FOR  
            FOR y FROM j PLUS one TO n MINUS one  
                IF element at position m AND y OF s MINUS element at position i AND y OF s MINUS element at position m AND j OF s PLUS element at position i AND j OF s GREATER THAN zero THEN  
                    INCREMENT ans BY CALL dfs WITH PARAMETERS i, y, k MINUS one  
                END IF  
            END FOR  
            RETURN ans MODULO mod  
        END FUNCTION  
          
        SET mod TO one billion PLUS seven  
        SET m TO the LENGTH OF pizza  
        SET n TO the LENGTH OF element at position zero OF pizza  
        SET s TO a new two-dimensional list of size m PLUS one BY n PLUS one FILLED WITH zeros  
        FOR i, row IN ENUMERATE pizza STARTING FROM one  
            FOR j, c IN ENUMERATE row STARTING FROM one  
                SET element at position i AND j OF s TO element at position i MINUS one AND j OF s PLUS element at position i AND j MINUS one OF s MINUS element at position i MINUS one AND j MINUS one OF s PLUS one IF c EQUALS the character A OTHERWISE zero  
            END FOR  
        END FOR  
        RETURN CALL dfs WITH PARAMETERS zero, zero, k MINUS one  
    END FUNCTION  
END CLASS