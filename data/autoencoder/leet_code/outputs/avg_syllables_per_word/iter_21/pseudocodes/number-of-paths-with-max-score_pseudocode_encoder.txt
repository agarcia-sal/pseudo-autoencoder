CLASS Solution  
    FUNCTION pathsWithMaxScore(board)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF board  
        
        CALL dp INITIALIZATION FUNCTION WITH PARAMETERS n ASSIGN TO dp  
        
        FOR i FROM n MINUS one TO zero INCLUSIVE STEP MINUS one  
            FOR j FROM n MINUS one TO zero INCLUSIVE STEP MINUS one  
                IF element at position j OF element at position i OF board EQUALS one OF the characters X OR S  
                    CONTINUE to next iteration of the inner FOR loop  
                END IF  
                
                IF element at position j OF element at position i OF board EQUALS E  
                    SET value TO zero  
                ELSE  
                    CONVERT element at position j OF element at position i OF board TO integer AND SET TO value  
                END IF  
                
                FOR each pair OF integers x AND y IN the list containing the triples (one zero) (zero one) (one one)  
                    SET ni TO i PLUS x  
                    SET nj TO j PLUS y  
                    IF ni IS GREATER THAN OR EQUAL TO zero AND LESS THAN n AND nj IS GREATER THAN OR EQUAL TO zero AND LESS THAN n  
                        IF element at position zero OF element at position ni OF element at position nj OF dp IS GREATER THAN element at position zero OF element at position i OF element at position j OF dp  
                            SET element at position zero OF element at position i OF element at position j OF dp TO element at position zero OF element at position ni OF element at position nj OF dp PLUS value  
                            SET element at position one OF element at position i OF element at position j OF dp TO element at position one OF element at position ni OF element at position nj OF dp  
                        ELSE IF element at position zero OF element at position ni OF element at position nj OF dp EQUALS element at position zero OF element at position i OF element at position j OF dp  
                            SET element at position one OF element at position i OF element at position j OF dp TO (element at position one OF element at position i OF element at position j OF dp PLUS element at position one OF element at position ni OF element at position nj OF dp) MODULO MOD  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        IF element at position zero OF element at position zero OF dp EQUALS negative infinity  
            RETURN the list containing zero AND zero  
        END IF  
        
        RETURN the list containing element at position zero OF element at position zero OF dp AND element at position one OF element at position zero OF dp  
    END FUNCTION  
    
    FUNCTION dp INITIALIZATION FUNCTION WITH PARAMETERS n  
        INITIALIZE a list result AS EMPTY  
        FOR index i FROM zero TO n MINUS one INCLUSIVE  
            INITIALIZE a list row AS EMPTY  
            FOR index j FROM zero TO n MINUS one INCLUSIVE  
                APPEND the list containing negative infinity AND zero TO row  
            END FOR  
            APPEND row TO result  
        END FOR  
        SET element at position n MINUS one OF element at position n MINUS one OF result TO the list containing zero AND one  
        RETURN result  
    END FUNCTION  
END CLASS