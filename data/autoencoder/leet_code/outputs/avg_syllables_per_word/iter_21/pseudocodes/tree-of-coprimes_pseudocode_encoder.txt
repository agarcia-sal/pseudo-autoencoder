CLASS Solution
    FUNCTION getCoprimes(nums, edges)
        SET n TO the LENGTH OF nums
        SET tree TO the RESULT OF FUNCTION defaultdict WITH PARAMETERS list
        
        FOR each pair u AND v IN edges
            CALL the METHOD append ON the ELEMENT at position u OF tree WITH PARAMETER v
            CALL the METHOD append ON the ELEMENT at position v OF tree WITH PARAMETER u
        END FOR
        
        SET coprime TO a TWO-DIMENSIONAL list OF size FIFTY ONE BY FIFTY ONE FILLED WITH False
        
        FOR i FROM ONE TO FIFTY
            FOR j FROM ONE TO FIFTY
                SET coprime[i][j] TO (the RESULT OF FUNCTION gcd WITH PARAMETERS i AND j EQUALS ONE)
            END FOR
        END FOR
        
        SET result TO a list OF size n FILLED WITH negative one
        SET ancestor_stack TO a list OF size FIFTY ONE FILLED WITH None
        
        FUNCTION dfs(node, parent, depth)
            SET closest_ancestor TO negative one
            SET max_depth TO negative one
            
            FOR value FROM ONE TO FIFTY
                IF coprime[the ELEMENT at position node OF nums][value] AND the ELEMENT at position value OF ancestor_stack IS NOT None THEN
                    SET anc_node, anc_depth TO the ELEMENT at position value OF ancestor_stack
                    IF anc_depth GREATER THAN max_depth THEN
                        SET max_depth TO anc_depth
                        SET closest_ancestor TO anc_node
                    END IF
                END IF
            END FOR
            
            SET the ELEMENT at position node OF result TO closest_ancestor
            
            SET original_ancestor TO the ELEMENT at position the ELEMENT at position node OF nums OF ancestor_stack
            SET the ELEMENT at position the ELEMENT at position node OF nums OF ancestor_stack TO the TUPLE of node AND depth
            
            FOR each child IN the ELEMENT at position node OF tree
                IF child NOT EQUALS parent THEN
                    CALL dfs WITH PARAMETERS child, node, depth PLUS ONE
                END IF
            END FOR
            
            SET the ELEMENT at position the ELEMENT at position node OF nums OF ancestor_stack TO original_ancestor
        END FUNCTION
        
        CALL dfs WITH PARAMETERS zero, negative one, zero
        
        RETURN result
    END FUNCTION
END CLASS