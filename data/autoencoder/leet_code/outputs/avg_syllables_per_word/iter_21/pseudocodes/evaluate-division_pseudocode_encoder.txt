CLASS Solution  
    FUNCTION calcEquation(equations, values, queries)  
        SET graph TO call create_default_dictionary_of_dictionary WITH NO PARAMETERS  
        FOR each pair_of_variables AND corresponding_value IN zip of equations AND values  
            SET variable_a TO element at position zero OF pair_of_variables  
            SET variable_b TO element at position one OF pair_of_variables  
            SET graph at key variable_a and key variable_b TO corresponding_value  
            SET graph at key variable_b and key variable_a TO one DIVIDED BY corresponding_value  
        END FOR  
        
        FUNCTION dfs(start, end, visited)  
            IF start NOT IN graph OR end NOT IN graph THEN  
                RETURN negative one POINT zero  
            END IF  
            
            IF start EQUALS end THEN  
                RETURN one POINT zero  
            END IF  
            
            CALL add start TO visited  
            FOR each neighbor AND weight IN items of graph at key start  
                IF neighbor NOT IN visited THEN  
                    SET recursive_result TO CALL dfs WITH PARAMETERS neighbor, end, visited  
                    IF recursive_result NOT EQUALS negative one POINT zero THEN  
                        RETURN weight MULTIPLIED BY recursive_result  
                    END IF  
                END IF  
            END FOR  
            CALL remove start FROM visited  
            RETURN negative one POINT zero  
        END FUNCTION  
        
        SET results TO empty list  
        FOR each query IN queries  
            SET start TO element at position zero OF query  
            SET end TO element at position one OF query  
            SET visited TO empty set  
            SET result TO CALL dfs WITH PARAMETERS start, end, visited  
            CALL append result TO results  
        END FOR  
        
        RETURN results  
    END FUNCTION  
END CLASS