CLASS Solution  
    FUNCTION constrainedSubsetSum(nums, k)  
        SET n TO the LENGTH OF nums  
        SET dp TO a list OF zero repeated n times  
        SET element at position zero OF dp TO element at position zero OF nums  
        SET max_sum TO element at position zero OF nums  
          
        SET q TO a deque initialized with element zero  
          
        FOR i FROM one TO n MINUS one  
            IF element at position zero OF dp at position at front of q IS GREATER THAN zero  
                SET dp at position i TO element at position i OF nums PLUS element at position at front of q OF dp  
            ELSE  
                SET dp at position i TO element at position i OF nums  
            END IF  
              
            IF max_sum IS LESS THAN dp at position i  
                SET max_sum TO dp at position i  
            END IF  
              
            WHILE q IS NOT empty AND dp at position i IS GREATER THAN OR EQUAL TO dp at position at back of q  
                REMOVE the element at back of q  
            END WHILE  
              
            APPEND i TO q  
              
            IF element at position zero OF q EQUALS i MINUS k  
                REMOVE the element at front of q  
            END IF  
        END FOR  
          
        RETURN max_sum  
    END FUNCTION  
END CLASS