CLASS Solution  
    FUNCTION shortestPath(grid, k)  
        IF grid IS EMPTY OR the element at position zero OF grid IS EMPTY  
            RETURN negative one  
        END IF  
        
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF the element at position zero OF grid  
        
        IF k IS GREATER THAN OR EQUAL TO m PLUS n MINUS two  
            RETURN m PLUS n MINUS two  
        END IF  
        
        SET directions TO a list containing tuples of  
            zero AND one, one AND zero, zero AND minus one, minus one AND zero  
        
        SET queue TO a double-ended queue containing a tuple of zero, zero, k, and zero  
        
        SET visited TO a set containing a tuple of zero, zero, and k  
        
        WHILE the queue IS NOT EMPTY  
            REMOVE AND ASSIGN the first element OF queue TO variables x, y, remaining_k, steps  
            
            IF x EQUALS m MINUS one AND y EQUALS n MINUS one  
                RETURN steps  
            END IF  
            
            FOR each tuple dx, dy IN directions  
                SET nx TO x PLUS dx  
                SET ny TO y PLUS dy  
                
                IF nx IS GREATER THAN OR EQUAL TO zero AND nx IS LESS THAN m AND ny IS GREATER THAN OR EQUAL TO zero AND ny IS LESS THAN n  
                    SET new_k TO remaining_k MINUS the element at position nx OF grid AT position ny  
                    IF new_k IS GREATER THAN OR EQUAL TO zero AND the tuple nx, ny, new_k IS NOT IN visited  
                        ADD the tuple nx, ny, new_k TO visited  
                        APPEND the tuple nx, ny, new_k, steps PLUS one TO queue  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN negative one  
    END FUNCTION  
END CLASS