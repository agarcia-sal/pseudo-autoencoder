CLASS Solution  
    FUNCTION calculate(s)  
        FUNCTION helper(s)  
            SET stack TO an empty list  
            SET sign TO the character plus  
            SET num TO zero  
            
            WHILE the LENGTH OF s IS GREATER THAN zero  
                SET char TO the element at position zero OF s  
                REMOVE the element at position zero FROM s  
                
                IF char IS A digit  
                    SET num TO num MULTIPLIED BY ten PLUS the integer value OF char  
                END IF  
                
                IF char EQUALS the character opening parenthesis  
                    SET num TO CALL helper WITH PARAMETERS s  
                END IF  
                
                IF char IS NOT A digit AND char IS NOT A whitespace CHARACTER OR the LENGTH OF s EQUALS zero  
                    IF sign EQUALS the character plus  
                        APPEND num TO stack  
                    ELSE IF sign EQUALS the character minus  
                        APPEND the negation OF num TO stack  
                    ELSE IF sign EQUALS the character asterisk  
                        SET the element at the last position OF stack TO the element at the last position OF stack MULTIPLIED BY num  
                    ELSE IF sign EQUALS the character forward slash  
                        SET the element at the last position OF stack TO the integer part OF the element at the last position OF stack DIVIDED BY num  
                    END IF  
                    
                    SET sign TO char  
                    SET num TO zero  
                END IF  
                
                IF char EQUALS the character closing parenthesis  
                    BREAK the loop  
                END IF  
            END WHILE  
            
            SET total TO zero  
            FOR each element IN stack  
                INCREMENT total BY element  
            END FOR  
            RETURN total  
        END FUNCTION  
        
        RETURN CALL helper WITH PARAMETERS the list CONSTRUCTED FROM s  
    END FUNCTION  
END CLASS