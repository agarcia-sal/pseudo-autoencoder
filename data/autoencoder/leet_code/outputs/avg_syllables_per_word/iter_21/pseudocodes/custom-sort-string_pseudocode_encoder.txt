CLASS Solution  
    FUNCTION customSortString(order, s)  
        SET d TO CALL create_custom_order_dictionary WITH PARAMETERS order  
        SET sorted_characters TO CALL sort_string_based_on_custom_order WITH PARAMETERS s, d  
        SET result_string TO CALL join_characters INTO string WITH PARAMETERS sorted_characters  
        RETURN result_string  
    END FUNCTION  

    FUNCTION create_custom_order_dictionary(order)  
        SET dictionary TO empty mapping of character TO integer  
        SET index TO zero  
        FOR each character IN order  
            SET dictionary AT key character TO index  
            INCREMENT index BY one  
        END FOR  
        RETURN dictionary  
    END FUNCTION  

    FUNCTION sort_string_based_on_custom_order(s, d)  
        SET list_of_characters TO list of individual characters FROM s  
        SORT list_of_characters BY ascending order of  
            IF character IS a key IN d THEN  
                RETURN value at character IN d  
            ELSE  
                RETURN zero  
            END IF  
        END SORT  
        RETURN list_of_characters  
    END FUNCTION  

    FUNCTION join_characters INTO string WITH PARAMETERS character_list  
        SET result TO empty string  
        FOR each character IN character_list  
            APPEND character TO result  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS