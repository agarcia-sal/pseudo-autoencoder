CLASS Solution
    FUNCTION cherryPickup(grid)
        SET n TO the LENGTH OF grid
        IF the element at position zero zero OF grid EQUALS negative one OR the element at position n MINUS one n MINUS one OF grid EQUALS negative one
            RETURN zero
        END IF

        SET dp TO the result OF CALLING initialize_dp WITH PARAMETERS n
        SET the element at position zero zero zero OF dp TO the element at position zero zero OF grid

        SET directions TO the list CONTAINING the pair zero one AND the pair one zero

        FOR t FROM one TO two MULTIPLIED BY n MINUS one MINUS one
            FOR i1 FROM the MAXIMUM OF zero AND t MINUS (n MINUS one) TO the MINIMUM OF n AND t PLUS one MINUS one
                FOR i2 FROM the MAXIMUM OF zero AND t MINUS (n MINUS one) TO the MINIMUM OF n AND t PLUS one MINUS one
                    SET j1 TO t MINUS i1
                    SET j2 TO t MINUS i2
                    IF the element at position i1 j1 OF grid EQUALS negative one OR the element at position i2 j2 OF grid EQUALS negative one
                        CONTINUE TO the NEXT ITERATION of the innermost FOR loop
                    END IF

                    SET prev_max TO negative one

                    FOR each pair di1 dj1 IN directions
                        FOR each pair di2 dj2 IN directions
                            SET pi1 TO i1 MINUS di1
                            SET pj1 TO j1 MINUS dj1
                            SET pi2 TO i2 MINUS di2
                            SET pj2 TO j2 MINUS dj2
                            IF pi1 IS GREATER THAN OR EQUAL TO zero AND pi1 IS LESS THAN n AND pj1 IS GREATER THAN OR EQUAL TO zero AND pj1 IS LESS THAN n AND pi2 IS GREATER THAN OR EQUAL TO zero AND pi2 IS LESS THAN n AND pj2 IS GREATER THAN OR EQUAL TO zero AND pj2 IS LESS THAN n
                                SET prev_max TO the MAXIMUM OF prev_max AND the element at position pi1 pi2 pj1 OF dp
                            END IF
                        END FOR
                    END FOR

                    IF prev_max IS GREATER THAN OR EQUAL TO zero
                        IF i1 EQUALS i2
                            SET cherries TO the element at position i1 j1 OF grid
                        ELSE
                            SET cherries TO the element at position i1 j1 OF grid PLUS the element at position i2 j2 OF grid
                        END IF
                        SET the element at position i1 i2 j1 OF dp TO prev_max PLUS cherries
                    END IF
                END FOR
            END FOR
        END FOR

        RETURN the MAXIMUM OF zero AND the element at position n MINUS one n MINUS one n MINUS one OF dp
    END FUNCTION

    FUNCTION initialize_dp(n)
        SET dp TO an empty list
        FOR i FROM zero TO n MINUS one
            SET layer_i TO an empty list
            FOR j FROM zero TO n MINUS one
                SET row_j TO a list containing n elements EACH SET TO negative one
                APPEND row_j TO layer_i
            END FOR
            APPEND layer_i TO dp
        END FOR
        RETURN dp
    END FUNCTION
END CLASS