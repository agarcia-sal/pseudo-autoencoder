CLASS Solution  
    FUNCTION maxCandies(status, candies, keys, containedBoxes, initialBoxes)  
        SET boxes_we_have TO a new set containing all elements of initialBoxes  
        SET keys_we_have TO an empty set  
        SET total_candies TO zero  
        
        SET progress_made TO true  
        
        WHILE progress_made HOLDS  
            SET progress_made TO false  
            
            FOR each box IN a new list containing all elements of boxes_we_have  
                IF the element at position box OF status EQUALS one OR box IS IN keys_we_have  
                    INCREMENT total_candies BY the element at position box OF candies  
                    
                    CALL the update operation of keys_we_have WITH PARAMETERS the list at position box OF keys  
                    
                    CALL the update operation of boxes_we_have WITH PARAMETERS the list at position box OF containedBoxes  
                    
                    CALL the remove operation of boxes_we_have WITH PARAMETERS box  
                    
                    SET progress_made TO true  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN total_candies  
    END FUNCTION  
END CLASS