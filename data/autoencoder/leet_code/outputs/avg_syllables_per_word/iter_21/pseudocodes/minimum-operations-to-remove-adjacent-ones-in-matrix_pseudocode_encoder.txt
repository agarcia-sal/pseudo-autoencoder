CLASS Solution  
    FUNCTION minimumOperations(grid)  
        FUNCTION bfs()  
            SET queue TO an empty double-ended queue  
            FOR each u FROM zero TO n MINUS one  
                IF element at position u OF match EQUALS minus one  
                    SET element at position u OF dist TO zero  
                    APPEND element u TO queue  
                ELSE  
                    SET element at position u OF dist TO positive infinity  
                END IF  
            END FOR  
            SET element at position minus one OF dist TO positive infinity  
            WHILE queue is not empty  
                REMOVE leftmost element FROM queue AND ASSIGN TO u  
                IF element at position u OF dist LESS THAN element at position minus one OF dist  
                    FOR each v IN element at position u OF graph  
                        IF element at position element at position v OF match OF dist EQUALS positive infinity  
                            SET element at position element at position v OF match OF dist TO element at position u OF dist PLUS one  
                            APPEND element at position element at position v OF match TO queue  
                        END IF  
                    END FOR  
                END IF  
            END WHILE  
            RETURN element at position minus one OF dist LESS THAN positive infinity  
        END FUNCTION  
        
        FUNCTION dfs(u)  
            IF u NOT EQUALS minus one  
                FOR each v IN element at position u OF graph  
                    IF element at position element at position v OF match OF dist EQUALS element at position u OF dist PLUS one  
                        IF CALL dfs WITH PARAMETER element at position v OF match RETURNS true  
                            SET element at position v OF match TO u  
                            SET element at position u OF match TO v  
                            RETURN true  
                        END IF  
                    END IF  
                END FOR  
                SET element at position u OF dist TO positive infinity  
                RETURN false  
            END IF  
            RETURN true  
        END FUNCTION  
        
        SET rows TO the LENGTH OF grid  
        SET cols TO the LENGTH OF element at position zero OF grid  
        SET n TO rows MULTIPLIED BY cols  
        SET graph TO a list of empty sets with SIZE n PLUS one  
        SET match TO a list of minus one with SIZE n PLUS one  
        SET dist TO a list of zero with SIZE n PLUS one  
        
        FOR each r FROM zero TO rows MINUS one  
            FOR each c FROM zero TO cols MINUS one  
                IF element at position r OF grid AT position c EQUALS one  
                    SET u TO r MULTIPLIED BY cols PLUS c  
                    FOR each dr, dc IN the list of tuples minus one and zero, one and zero, zero and minus one, zero and one  
                        SET nr TO r PLUS dr  
                        SET nc TO c PLUS dc  
                        IF nr GREATER THAN OR EQUAL TO zero AND nr LESS THAN rows AND nc GREATER THAN OR EQUAL TO zero AND nc LESS THAN cols AND element at position nr OF grid AT position nc EQUALS one  
                            SET v TO nr MULTIPLIED BY cols PLUS nc  
                            ADD v TO element at position u OF graph  
                        END IF  
                    END FOR  
                END IF  
            END FOR  
        END FOR  
        
        SET matching TO zero  
        WHILE CALL bfs RETURNS true  
            FOR each u FROM zero TO n MINUS one  
                IF element at position u OF match EQUALS minus one AND CALL dfs WITH PARAMETER u RETURNS true  
                    INCREMENT matching BY one  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN matching  
    END FUNCTION  
END CLASS