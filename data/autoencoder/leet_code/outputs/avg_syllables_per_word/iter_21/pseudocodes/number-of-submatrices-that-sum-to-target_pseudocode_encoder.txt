CLASS Solution  
    FUNCTION numSubmatrixSumTarget(matrix, target)  
        FUNCTION subarraySum(nums, target)  
            SET count TO zero  
            SET seen_sums TO an empty map with default integer zero  
            SET cumulative_sum TO zero  
            FOR each num IN nums  
                INCREMENT cumulative_sum BY num  
                IF cumulative_sum EQUALS target THEN  
                    INCREMENT count BY one  
                END IF  
                IF the element of seen_sums AT key cumulative_sum MINUS target EXISTS THEN  
                    INCREMENT count BY the element of seen_sums AT key cumulative_sum MINUS target  
                END IF  
                INCREMENT the element of seen_sums AT key cumulative_sum BY one  
            END FOR  
            RETURN count  
        END FUNCTION  
      
        SET rows TO the LENGTH OF matrix  
        SET cols TO the LENGTH OF element at position zero OF matrix  
        SET total_count TO zero  
      
        FOR top FROM zero TO rows MINUS one  
            SET current_cols TO a list of zero values of length cols  
            FOR bottom FROM top TO rows MINUS one  
                FOR col FROM zero TO cols MINUS one  
                    INCREMENT element at position col OF current_cols BY element at position col OF element at position bottom OF matrix  
                END FOR  
                INCREMENT total_count BY CALL subarraySum WITH PARAMETERS current_cols AND target  
            END FOR  
        END FOR  
      
        RETURN total_count  
    END FUNCTION  
END CLASS