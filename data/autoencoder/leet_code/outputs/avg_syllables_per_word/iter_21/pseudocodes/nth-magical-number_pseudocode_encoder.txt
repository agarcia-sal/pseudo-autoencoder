CLASS Solution  
    FUNCTION nthMagicalNumber(n, a, b)  
        SET MOD TO one billion PLUS seven  
        
        FUNCTION gcd(x, y)  
            WHILE y IS NOT EQUAL TO zero  
                SET temporary_x TO y  
                SET temporary_y TO the remainder of x DIVIDED BY y  
                SET x TO temporary_x  
                SET y TO temporary_y  
            END WHILE  
            RETURN x  
        END FUNCTION  
        
        FUNCTION lcm(x, y)  
            SET greatest_common_divisor TO CALL gcd WITH PARAMETERS x AND y  
            SET least_common_multiple TO x MULTIPLIED BY y DIVIDED BY greatest_common_divisor  
            RETURN least_common_multiple  
        END FUNCTION  
        
        SET L TO CALL lcm WITH PARAMETERS a AND b  
        
        SET left TO one  
        SET right TO n MULTIPLIED BY the smaller value BETWEEN a AND b  
        
        WHILE left IS LESS THAN right  
            SET mid TO the integer division of the sum of left AND right BY two  
            SET count TO the integer division of mid BY a PLUS the integer division of mid BY b MINUS the integer division of mid BY L  
            
            IF count IS LESS THAN n  
                SET left TO mid PLUS one  
            ELSE  
                SET right TO mid  
            END IF  
        END WHILE  
        
        RETURN the remainder of left DIVIDED BY MOD  
    END FUNCTION  
END CLASS