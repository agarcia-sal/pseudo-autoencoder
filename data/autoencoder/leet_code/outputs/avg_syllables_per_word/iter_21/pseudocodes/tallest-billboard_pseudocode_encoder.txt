CLASS Solution  
    FUNCTION tallestBillboard(rods)  
        SET dp TO a dictionary with key zero mapped to value zero  
        
        FOR each rod IN rods  
            SET new_dp TO a new dictionary copied from dp  
            FOR each key d AND value y IN dp  
                SET sum_for_taller_support TO d PLUS rod  
                IF sum_for_taller_support IS IN new_dp  
                    SET new_dp_at_taller_support TO value at key sum_for_taller_support OF new_dp  
                ELSE  
                    SET new_dp_at_taller_support TO zero  
                END IF  
                SET value_for_taller_support TO the maximum BETWEEN new_dp_at_taller_support AND y  
                SET key sum_for_taller_support OF new_dp TO value_for_taller_support  
                
                IF d IS GREATER THAN rod  
                    SET difference_absolute TO d MINUS rod  
                ELSE  
                    SET difference_absolute TO rod MINUS d  
                END IF  
                
                IF difference_absolute IS IN new_dp  
                    SET new_dp_at_shorter_support TO value at key difference_absolute OF new_dp  
                ELSE  
                    SET new_dp_at_shorter_support TO zero  
                END IF  
                
                IF d IS LESS THAN rod  
                    SET minimum_height TO d  
                ELSE  
                    SET minimum_height TO rod  
                END IF  
                
                SET value_for_shorter_support TO the maximum BETWEEN new_dp_at_shorter_support AND y PLUS minimum_height  
                SET key difference_absolute OF new_dp TO value_for_shorter_support  
            END FOR  
            
            SET dp TO new_dp  
        END FOR  
        
        RETURN value at key zero OF dp  
    END FUNCTION  
END CLASS