CLASS Solution  
    FUNCTION maxScoreWords(words, letters, score)  
        FUNCTION word_score(word, score_map)  
            SET total_score TO zero  
            FOR each character IN word  
                INCREMENT total_score BY element AT position character OF score_map  
            END FOR  
            RETURN total_score  
        END FUNCTION  
        
        FUNCTION can_form(word, letter_count)  
            SET word_count TO CALL Counter WITH PARAMETERS word  
            FOR each character AND count IN items OF word_count  
                IF element AT position character OF letter_count LESS THAN count THEN  
                    RETURN false  
                END IF  
            END FOR  
            RETURN true  
        END FUNCTION  
        
        FUNCTION update_letter_count(letter_count, word, add)  
            FOR each character IN word  
                IF add IS true THEN  
                    INCREMENT element AT position character OF letter_count BY one  
                ELSE  
                    DECREMENT element AT position character OF letter_count BY one  
                END IF  
            END FOR  
        END FUNCTION  
        
        FUNCTION backtrack(index, current_score, letter_count)  
            IF index EQUALS the LENGTH OF words THEN  
                RETURN current_score  
            END IF  
            
            SET max_score TO current_score  
            FOR i FROM index TO the LENGTH OF words MINUS one  
                IF CALL can_form WITH PARAMETERS element AT position i OF words AND letter_count IS true THEN  
                    CALL update_letter_count WITH PARAMETERS letter_count, element AT position i OF words, false  
                    SET max_score TO the GREATER OF max_score AND CALL backtrack WITH PARAMETERS i PLUS one, current_score PLUS CALL word_score WITH PARAMETERS element AT position i OF words AND score_map, letter_count  
                    CALL update_letter_count WITH PARAMETERS letter_count, element AT position i OF words, true  
                END IF  
            END FOR  
            
            RETURN max_score  
        END FUNCTION  
        
        SET score_map TO an EMPTY MAPPING  
        FOR i FROM zero TO twenty FIVE  
            SET key TO character AT position i PLUS character 'a'  
            SET element AT position key OF score_map TO element AT position i OF score  
        END FOR  
        
        SET letter_count TO CALL Counter WITH PARAMETERS letters  
        
        RETURN CALL backtrack WITH PARAMETERS zero, zero, letter_count  
    END FUNCTION  
END CLASS