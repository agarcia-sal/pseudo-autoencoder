CLASS Solution  
    FUNCTION maxIncreaseKeepingSkyline(grid)  
        SET n TO the LENGTH OF grid  
        SET row_maxes TO CALL get_row_maxes WITH PARAMETERS grid  
        SET col_maxes TO CALL get_col_maxes WITH PARAMETERS grid  
        SET total_increase TO zero  
        FOR i FROM zero TO n MINUS one  
            FOR j FROM zero TO n MINUS one  
                SET max_height TO the MINIMUM OF element at position i OF row_maxes AND element at position j OF col_maxes  
                IF max_height MINUS element at position i OF grid AND element at position j OF grid IS GREATER THAN zero  
                    INCREMENT total_increase BY max_height MINUS element at position i OF grid AND element at position j OF grid  
                END IF  
            END FOR  
        END FOR  
        RETURN total_increase  
    END FUNCTION  

    FUNCTION get_row_maxes(grid)  
        SET row_maxes TO EMPTY LIST  
        FOR each row IN grid  
            SET current_max TO negative infinity  
            FOR each element IN row  
                IF element IS GREATER THAN current_max  
                    SET current_max TO element  
                END IF  
            END FOR  
            APPEND current_max TO row_maxes  
        END FOR  
        RETURN row_maxes  
    END FUNCTION  

    FUNCTION get_col_maxes(grid)  
        SET n TO the LENGTH OF grid  
        SET col_maxes TO EMPTY LIST  
        FOR j FROM zero TO n MINUS one  
            SET current_max TO negative infinity  
            FOR i FROM zero TO n MINUS one  
                IF element at position i OF grid AND element at position j OF grid IS GREATER THAN current_max  
                    SET current_max TO element at position i OF grid AND element at position j OF grid  
                END IF  
            END FOR  
            APPEND current_max TO col_maxes  
        END FOR  
        RETURN col_maxes  
    END FUNCTION  
END CLASS