CLASS Solution  
    FUNCTION countArrangement(n)  
        FUNCTION backtrack(used, index)  
            IF index EQUALS n PLUS one  
                RETURN one  
            END IF  
            SET count TO zero  
            FOR i FROM one TO n  
                IF element at position i OF used EQUALS false AND (i MODULO index EQUALS zero OR index MODULO i EQUALS zero)  
                    SET element at position i OF used TO true  
                    INCREMENT count BY CALL backtrack WITH PARAMETERS used AND index PLUS one  
                    SET element at position i OF used TO false  
                END IF  
            END FOR  
            RETURN count  
        END FUNCTION  
        SET used TO CALL initialize_list_with_false BOOLEAN VALUES OF LENGTH n PLUS one  
        RETURN CALL backtrack WITH PARAMETERS used AND one  
    END FUNCTION  
END CLASS