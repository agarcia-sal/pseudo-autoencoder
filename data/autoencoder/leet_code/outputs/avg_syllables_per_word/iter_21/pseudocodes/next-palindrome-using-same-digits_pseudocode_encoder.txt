CLASS Solution  
    FUNCTION nextPalindrome(num)  
        SET n TO the LENGTH OF num  
        SET half TO the SUBSTRING from position zero TO the INTEGER DIVISION OF n BY two OF num  
        
        SET half_list TO CALL convert_string_to_list WITH PARAMETERS half  
        SET k TO negative one  
        SET l TO negative one  
        
        FOR i FROM the LENGTH OF half_list MINUS two DOWN TO zero STEP minus one  
            IF the ELEMENT at position i OF half_list LESS THAN the ELEMENT at position i PLUS one OF half_list  
                SET k TO i  
                BREAK the loop  
            END IF  
        END FOR  
        
        IF k EQUALS negative one  
            RETURN an EMPTY string  
        END IF  
        
        FOR i FROM the LENGTH OF half_list MINUS one DOWN TO k PLUS one STEP minus one  
            IF the ELEMENT at position i OF half_list GREATER THAN the ELEMENT at position k OF half_list  
                SET l TO i  
                BREAK the loop  
            END IF  
        END FOR  
        
        CALL swap_elements AT positions k AND l OF half_list  
        SET half_list TO concatenate the SUBLIST of half_list FROM position zero TO k PLUS one WITH the SORTED SUBLIST of half_list FROM position k PLUS one TO the END  
        
        SET new_half TO CALL convert_list_to_string WITH PARAMETERS half_list  
        
        IF n MODULO two EQUALS zero  
            RETURN the CONCATENATION of new_half AND the REVERSE OF new_half  
        ELSE  
            RETURN the CONCATENATION of new_half AND the ELEMENT at position INTEGER DIVISION OF n BY two OF num AND the REVERSE OF new_half  
        END IF  
    END FUNCTION  
    
    FUNCTION convert_string_to_list(input_string)  
        RETURN the LIST of individual CHARACTERS OF input_string  
    END FUNCTION  
    
    FUNCTION convert_list_to_string(input_list)  
        RETURN the STRING formed by JOINING all CHARACTERS in input_list in ORDER  
    END FUNCTION  
    
    FUNCTION swap_elements AT positions first_index AND second_index OF input_list  
        SET temporary TO the ELEMENT at position first_index OF input_list  
        SET the ELEMENT at position first_index OF input_list TO the ELEMENT at position second_index OF input_list  
        SET the ELEMENT at position second_index OF input_list TO temporary  
    END FUNCTION  
END CLASS