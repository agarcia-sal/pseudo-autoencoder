CLASS Solution  
    FUNCTION reachableNodes(edges AS List OF List OF Integer, maxMoves AS Integer, n AS Integer) RETURNS Integer  
        SET graph TO CALL buildGraph WITH PARAMETERS edges AND n  
        SET distances TO CALL dijkstra WITH PARAMETERS graph AND n  
        SET reachable_nodes TO zero  
        FOR each distance IN distances  
            IF distance IS LESS THAN OR EQUAL TO maxMoves  
                INCREMENT reachable_nodes BY one  
            END IF  
        END FOR  
        SET used_edges TO CALL initializeUsedEdges WITH PARAMETERS edges  
        FOR each edge IN edges  
            SET u TO element at position zero OF edge  
            SET v TO element at position one OF edge  
            SET cnt TO element at position two OF edge  
            SET moves_u TO maximum OF zero AND maxMoves MINUS element at position u OF distances  
            SET moves_v TO maximum OF zero AND maxMoves MINUS element at position v OF distances  
            SET reachable_new_nodes TO minimum OF cnt AND moves_u PLUS moves_v  
            INCREMENT reachable_nodes BY reachable_new_nodes  
            CALL storeUsedEdges WITH PARAMETERS used_edges u v reachable_new_nodes  
        END FOR  
        RETURN reachable_nodes  
    END FUNCTION  

    FUNCTION buildGraph(edges AS List OF List OF Integer, n AS Integer) RETURNS Dictionary  
        SET graph TO an empty dictionary WITH keys FROM zero TO n MINUS one AND values AS empty lists  
        FOR each edge IN edges  
            SET u TO element at position zero OF edge  
            SET v TO element at position one OF edge  
            SET cnt TO element at position two OF edge  
            APPEND tuple OF v AND cnt TO element at position u OF graph  
            APPEND tuple OF u AND cnt TO element at position v OF graph  
        END FOR  
        RETURN graph  
    END FUNCTION  

    FUNCTION dijkstra(graph AS Dictionary, n AS Integer) RETURNS List OF Integer  
        SET distances TO a list WITH length n AND all values AS positive infinity  
        SET element at position zero OF distances TO zero  
        SET priority_queue TO a list containing tuple of zero AND zero  
        WHILE priority_queue IS NOT empty  
            SET pair TO CALL heapPop FROM priority_queue  
            SET dist TO element at position zero OF pair  
            SET node TO element at position one OF pair  
            IF dist IS GREATER THAN element at position node OF distances  
                CONTINUE TO next iteration  
            END IF  
            FOR each neighbor_pair IN element at position node OF graph  
                SET neighbor TO element at position zero OF neighbor_pair  
                SET cnt TO element at position one OF neighbor_pair  
                SET new_dist TO dist PLUS cnt PLUS one  
                IF new_dist IS LESS THAN element at position neighbor OF distances  
                    SET element at position neighbor OF distances TO new_dist  
                    CALL heapPush WITH PARAMETERS priority_queue AND tuple OF new_dist AND neighbor  
                END IF  
            END FOR  
        END WHILE  
        RETURN distances  
    END FUNCTION  

    FUNCTION initializeUsedEdges(edges AS List OF List OF Integer) RETURNS Dictionary  
        SET used_edges TO an empty dictionary  
        FOR each edge IN edges  
            SET u TO element at position zero OF edge  
            SET v TO element at position one OF edge  
            SET element at key (u v) OF used_edges TO zero  
        END FOR  
        RETURN used_edges  
    END FUNCTION  

    FUNCTION storeUsedEdges(used_edges AS Dictionary, u AS Integer, v AS Integer, reachable_new_nodes AS Integer)  
        SET element at key (u v) OF used_edges TO reachable_new_nodes  
    END FUNCTION  
END CLASS