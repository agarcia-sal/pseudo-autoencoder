CLASS Solution  
    FUNCTION exclusiveTime(n, logs)  
        SET exclusive_time TO a list of zeroes WITH length n  
        SET stack TO an empty list  
        
        FOR each log IN logs  
            CALL log.split using the character colon AND ASSIGN function_id, action, timestamp TO the result  
            SET function_id TO the integer conversion OF function_id  
            SET timestamp TO the integer conversion OF timestamp  
            
            IF action EQUALS the string "start"  
                IF the stack is not empty  
                    SET prev_function_id, prev_timestamp TO the element at the last position OF stack  
                    INCREMENT the element at position prev_function_id OF exclusive_time BY timestamp MINUS prev_timestamp  
                END IF  
                APPEND the tuple of function_id AND timestamp TO stack  
            ELSE  
                SET prev_function_id, prev_timestamp TO the result of removing the last element FROM stack  
                INCREMENT the element at position prev_function_id OF exclusive_time BY timestamp MINUS prev_timestamp PLUS one  
                IF the stack is not empty  
                    SET the last element OF stack TO the tuple of the first element OF the last element OF stack AND timestamp PLUS one  
                END IF  
            END IF  
        END FOR  
        
        RETURN exclusive_time  
    END FUNCTION  
END CLASS