CLASS Solution  
    FUNCTION wallsAndGates(rooms)  
        IF rooms EQUALS None OR LENGTH OF rooms EQUALS zero OR LENGTH OF element at position zero OF rooms EQUALS zero  
            RETURN  
        END IF  
        
        SET rows TO LENGTH OF rooms  
        SET cols TO LENGTH OF element at position zero OF rooms  
        SET queue TO result OF create a new double-ended queue  
        
        FOR r FROM zero TO rows MINUS one  
            FOR c FROM zero TO cols MINUS one  
                IF element at position r OF rooms AT position c EQUALS zero  
                    CALL append TO queue WITH PARAMETERS tuple of r AND c  
                END IF  
            END FOR  
        END FOR  
        
        SET directions TO list containing tuple of zero AND one, tuple of one AND zero, tuple of zero AND negative one, tuple of negative one AND zero  
        
        WHILE queue IS NOT empty  
            CALL pop left TO queue AND ASSIGN result TO tuple r AND c  
            FOR each tuple dr AND dc IN directions  
                SET nr TO r PLUS dr  
                SET nc TO c PLUS dc  
                IF nr GREATER THAN OR EQUAL TO zero AND nr LESS THAN rows AND nc GREATER THAN OR EQUAL TO zero AND nc LESS THAN cols AND element at position nr OF rooms AT position nc EQUALS two billion one hundred forty seven million four hundred eighty three thousand six hundred forty seven  
                    SET element at position nr OF rooms AT position nc TO element at position r OF rooms AT position c PLUS one  
                    CALL append TO queue WITH PARAMETERS tuple of nr AND nc  
                END IF  
            END FOR  
        END WHILE  
    END FUNCTION  
END CLASS