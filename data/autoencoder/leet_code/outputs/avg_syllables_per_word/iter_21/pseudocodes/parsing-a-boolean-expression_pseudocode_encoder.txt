CLASS Solution  
    FUNCTION parseBoolExpr(expression)  
        SET stk TO empty list  
        FOR each c IN expression  
            IF c EQUALS one of the characters t OR f OR exclamation mark OR ampersand OR vertical bar  
                APPEND c TO stk  
            ELSE IF c EQUALS closing parenthesis  
                SET t TO zero  
                SET f TO zero  
                WHILE the last element of stk EQUALS one of the characters t OR f  
                    IF the last element of stk EQUALS character t  
                        INCREMENT t BY one  
                    END IF  
                    IF the last element of stk EQUALS character f  
                        INCREMENT f BY one  
                    END IF  
                    REMOVE the last element FROM stk  
                END WHILE  
                SET op TO the last element of stk  
                REMOVE the last element FROM stk  
                IF op EQUALS exclamation mark  
                    IF f GREATER THAN zero  
                        SET c TO character t  
                    ELSE  
                        SET c TO character f  
                    END IF  
                ELSE IF op EQUALS ampersand  
                    IF f GREATER THAN zero  
                        SET c TO character f  
                    ELSE  
                        SET c TO character t  
                    END IF  
                ELSE IF op EQUALS vertical bar  
                    IF t GREATER THAN zero  
                        SET c TO character t  
                    ELSE  
                        SET c TO character f  
                    END IF  
                END IF  
                APPEND c TO stk  
            END IF  
        END FOR  
        RETURN whether the first element of stk EQUALS character t  
    END FUNCTION  
END CLASS