CLASS Solution  
    FUNCTION distinctSubseqII(s)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF s  
        SET dp TO a list of zeros WITH length n PLUS one  
        SET element at position zero OF dp TO one  
        SET last TO an empty dictionary  
        FOR i FROM one TO n  
            SET char TO element at position i MINUS one OF s  
            SET element at position i OF dp TO the element at position i MINUS one OF dp MULTIPLIED BY two MODULO MOD  
            IF char IS a key IN last  
                SET element at position i OF dp TO the element at position i OF dp MINUS element at position last AT char MINUS one OF dp PLUS MOD MODULO MOD  
            END IF  
            SET last AT char TO i  
        END FOR  
        RETURN the element at position n OF dp MINUS one MODULO MOD  
    END FUNCTION  
END CLASS