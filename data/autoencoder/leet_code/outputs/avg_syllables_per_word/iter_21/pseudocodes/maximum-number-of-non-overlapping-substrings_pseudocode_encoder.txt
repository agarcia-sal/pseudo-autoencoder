CLASS Solution  
    FUNCTION maxNumOfSubstrings(s)  
        SET first TO an empty mapping of characters TO integers  
        SET last TO an empty mapping of characters TO integers  
        FOR each index i FROM zero TO the length of s MINUS one  
            SET c TO character at position i OF s  
            IF c NOT IN keys OF first THEN  
                SET first at key c TO i  
            END IF  
            SET last at key c TO i  
        END FOR  

        SET intervals TO an empty list  
        FOR each character c IN keys OF first  
            SET start TO value at key c OF first  
            SET end TO value at key c OF last  
            SET i TO start  
            WHILE i IS LESS THAN OR EQUAL TO end  
                IF value at key character at position i OF s OF first IS LESS THAN start THEN  
                    BREAK THE LOOP  
                END IF  
                SET end TO the GREATER OF end AND value at key character at position i OF s OF last  
                INCREMENT i BY one  
            END WHILE  
            IF loop did NOT break THEN  
                APPEND the pair start AND end TO intervals  
            END IF  
        END FOR  

        CALL the sort METHOD ON intervals WITH A FUNCTION THAT RETURNS the second element OF each pair AS KEY  

        SET result TO an empty list  
        SET prev_end TO minus one  
        FOR each pair start AND end IN intervals  
            IF start IS GREATER THAN prev_end THEN  
                APPEND the substring from position start TO end OF s TO result  
                SET prev_end TO end  
            END IF  
        END FOR  

        RETURN result  
    END FUNCTION  
END CLASS