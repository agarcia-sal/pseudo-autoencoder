CLASS Solution  
    FUNCTION minWastedSpace(packages, boxes)  
        SET MOD TO one billion PLUS seven  
        CALL sort ON packages  
        SET n TO the LENGTH OF packages  
        
        CALL prefix_sum TO THE FUNCTION create_prefix_sum WITH PARAMETERS packages AND n  
        
        SET min_wasted_space TO infinity  
        
        FOR each box IN boxes  
            CALL sort ON box  
            IF the element at the last position OF box IS LESS THAN the element at the last position OF packages  
                CONTINUE to the next iteration  
            END IF  
            
            SET total_wasted TO zero  
            SET last_index TO zero  
            
            FOR each box_size IN box  
                SET index TO last_index  
                WHILE index IS LESS THAN n AND the element at position index OF packages IS LESS THAN OR EQUAL TO box_size  
                    INCREMENT index BY one  
                END WHILE  
                
                IF index IS GREATER THAN last_index  
                    CALL calculate_wasted_space TO THE FUNCTION calculate_single_wasted_space WITH PARAMETERS total_wasted, index, last_index, box_size, prefix_sum  
                    SET total_wasted TO the RESULT OF calculate_single_wasted_space  
                    SET last_index TO index  
                END IF  
            END FOR  
            
            IF last_index EQUALS n  
                SET min_wasted_space TO THE MINIMUM OF min_wasted_space AND total_wasted  
            END IF  
        END FOR  
        
        IF min_wasted_space IS NOT EQUAL TO infinity  
            RETURN min_wasted_space MODULO MOD  
        ELSE  
            RETURN negative one  
        END IF  
    END FUNCTION  

    FUNCTION create_prefix_sum(packages, n)  
        SET prefix_sum TO a list of zeros with length n PLUS one  
        FOR index FROM zero TO n MINUS one  
            SET the element at position index PLUS one OF prefix_sum TO the element at position index OF prefix_sum PLUS the element at position index OF packages  
        END FOR  
        RETURN prefix_sum  
    END FUNCTION  

    FUNCTION calculate_single_wasted_space(total_wasted, index, last_index, box_size, prefix_sum)  
        SET wasted_for_current_box TO (index MINUS last_index) MULTIPLIED BY box_size MINUS (the element at position index OF prefix_sum MINUS the element at position last_index OF prefix_sum)  
        SET total_wasted TO total_wasted PLUS wasted_for_current_box  
        RETURN total_wasted  
    END FUNCTION  
END CLASS