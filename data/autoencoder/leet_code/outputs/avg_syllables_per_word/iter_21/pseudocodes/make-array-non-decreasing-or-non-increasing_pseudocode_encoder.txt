CLASS Solution  
    FUNCTION convertArray(nums)  
        FUNCTION min_operations_to_non_decreasing(nums)  
            SET max_heap TO an empty list  
            SET operations TO zero  
            FOR each num IN nums  
                IF max_heap IS NOT empty AND the NEGATION OF element at position zero OF max_heap IS GREATER THAN num  
                    INCREMENT operations BY the NEGATION OF the element REMOVED FROM max_heap USING heap pop AT position zero MINUS num  
                    CALL heap push ON max_heap WITH PARAMETERS the NEGATION OF num  
                END IF  
                CALL heap push ON max_heap WITH PARAMETERS the NEGATION OF num  
            END FOR  
            RETURN operations  
        END FUNCTION  
      
        FUNCTION min_operations_to_non_increasing(nums)  
            SET min_heap TO an empty list  
            SET operations TO zero  
            FOR each num IN nums  
                IF min_heap IS NOT empty AND element at position zero OF min_heap IS LESS THAN num  
                    INCREMENT operations BY num MINUS the element REMOVED FROM min_heap USING heap pop AT position zero  
                    CALL heap push ON min_heap WITH PARAMETERS num  
                END IF  
                CALL heap push ON min_heap WITH PARAMETERS num  
            END FOR  
            RETURN operations  
        END FUNCTION  
      
        RETURN the MINIMUM OF CALLING min_operations_to_non_decreasing WITH PARAMETERS nums AND CALLING min_operations_to_non_increasing WITH PARAMETERS nums  
    END FUNCTION  
END CLASS