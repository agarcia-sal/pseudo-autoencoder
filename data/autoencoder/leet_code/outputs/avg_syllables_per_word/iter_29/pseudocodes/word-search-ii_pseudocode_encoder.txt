CLASS Trie  
    FUNCTION __init__(self)  
        SET self.children TO a list containing twenty six elements each set TO no value  
        SET self.ref TO negative one  
    END FUNCTION  

    FUNCTION insert(self, w, ref)  
        SET node TO self  
        FOR each character IN w  
            SET idx TO the numerical code of character MINUS the numerical code of the lowercase letter a  
            IF the element at position idx of node.children HAS no value  
                SET the element at position idx of node.children TO a new instance of Trie  
            END IF  
            SET node TO the element at position idx of node.children  
        END FOR  
        SET node.ref TO ref  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION findWords(self, board, words)  

        FUNCTION dfs(node, i, j)  
            SET idx TO the numerical code of the character at position i of board and position j of that element MINUS the numerical code of the lowercase letter a  
            IF the element at position idx of node.children HAS no value  
                RETURN with no value  
            END IF  
            SET node TO the element at position idx of node.children  
            IF node.ref IS GREATER THAN OR EQUAL TO zero  
                APPEND the element at position node.ref of words TO ans  
                SET node.ref TO negative one  
            END IF  
            SET c TO the character at position i of board and position j of that element  
            SET the character at position i of board and position j of that element TO a single hash mark character  
            FOR each pair of adjacent elements a and b in the sequence negative one zero one zero negative one  
                SET x TO i PLUS a  
                SET y TO j PLUS b  
                IF x IS GREATER THAN OR EQUAL TO zero AND x IS LESS THAN m AND y IS GREATER THAN OR EQUAL TO zero AND y IS LESS THAN n AND the character at position x of board and position y of that element IS NOT equal TO a single hash mark character  
                    CALL dfs with parameters node x y  
                END IF  
            END FOR  
            SET the character at position i of board and position j of that element TO c  
        END FUNCTION  

        SET tree TO a new instance of Trie  
        FOR each index i and element w in words enumerated by increasing index starting from zero  
            CALL insert method of tree with parameters w and i  
        END FOR  
        SET m TO the length of board  
        SET n TO the length of the element at position zero of board  
        SET ans TO an empty list  
        FOR each i FROM zero TO m MINUS one  
            FOR each j FROM zero TO n MINUS one  
                CALL dfs with parameters tree i j  
            END FOR  
        END FOR  
        RETURN ans  
    END FUNCTION  
END CLASS