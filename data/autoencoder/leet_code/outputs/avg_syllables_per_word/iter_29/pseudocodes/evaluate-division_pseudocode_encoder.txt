CLASS Solution  
    FUNCTION calcEquation(equations, values, queries)  
        SET graph TO an empty mapping with default value as an empty mapping  
        
        FOR each pair of elements a and b TAKEN FROM each element of equations AND each element of values  
            SET the element at key b of the element at key a of graph TO value  
            SET the element at key a of the element at key b of graph TO one DIVIDED BY value  
        END FOR  
        
        FUNCTION dfs(start, end, visited)  
            IF start NOT IN the keys of graph OR end NOT IN the keys of graph THEN  
                RETURN negative one  
            END IF  
            
            IF start EQUALS end THEN  
                RETURN one  
            END IF  
            
            ADD start TO visited  
            
            FOR each neighbor AND corresponding weight TAKEN FROM each key and value of the element at key start of graph  
                IF neighbor NOT IN visited THEN  
                    SET result TO dfs(neighbor, end, visited)  
                    IF result NOT EQUALS negative one THEN  
                        RETURN weight MULTIPLIED BY result  
                    END IF  
                END IF  
            END FOR  
            
            REMOVE start FROM visited  
            RETURN negative one  
        END FUNCTION  
        
        SET results TO an empty list  
        
        FOR each query TAKEN FROM queries  
            SET start TO the element at position one of query  
            SET end TO the element at position two of query  
            SET visited TO an empty set  
            SET result TO dfs(start, end, visited)  
            APPEND result TO results  
        END FOR  
        
        RETURN results  
    END FUNCTION  
END CLASS