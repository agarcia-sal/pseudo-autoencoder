CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MODULO_VALUE TO ten POWERED BY nine PLUS seven  
        SORT the list arr IN ascending order  
        SET dp TO a new mapping WHERE each element in arr maps TO one  
        FOR each index i AND element num IN the enumerated arr  
            FOR each index j FROM zero TO i MINUS one  
                IF the remainder WHEN num IS DIVIDED BY the element at position j of arr EQUALS zero  
                    SET right_child TO num DIVIDED BY the element at position j of arr  
                    IF right_child EXISTS IN dp  
                        SET dp at key num TO the sum of dp at key num PLUS the product of dp at key element at position j of arr AND dp at key right_child  
                        SET dp at key num TO dp at key num MODULO modulo value  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        SET total_trees TO the sum OF all values IN dp  
        RETURN total_trees MODULO modulo value  
    END FUNCTION  
END CLASS