CLASS Solution  
    FUNCTION numPoints(darts, r)  
        FUNCTION distance(p1, p2)  
            SET horizontal_difference TO element at position zero of p1 MINUS element at position zero of p2  
            SET vertical_difference TO element at position one of p1 MINUS element at position one of p2  
            SET horizontal_difference_powered BY two TO horizontal_difference POWERED BY two  
            SET vertical_difference_powered BY two TO vertical_difference POWERED BY two  
            SET sum_of_squares TO horizontal_difference_powered BY two PLUS vertical_difference_powered BY two  
            RETURN the square root of sum_of_squares  
        END FUNCTION  
        
        FUNCTION circle_center(p1, p2, r)  
            SET distance_between_points TO distance(p1, p2)  
            IF distance_between_points GREATER THAN two MULTIPLIED BY r  
                RETURN None  
            END IF  
            SET a TO the square root of r MULTIPLIED BY r MINUS distance_between_points DIVIDED BY two MULTIPLIED BY distance_between_points DIVIDED BY two  
            SET midpoint_horizontal TO element at position zero of p1 PLUS element at position zero of p2 DIVIDED BY two  
            SET midpoint_vertical TO element at position one of p1 PLUS element at position one of p2 DIVIDED BY two  
            SET dx TO element at position one of p2 MINUS element at position one of p1 MULTIPLIED BY a DIVIDED BY distance_between_points  
            SET dy TO element at position zero of p2 MINUS element at position zero of p1 MULTIPLIED BY a DIVIDED BY distance_between_points  
            SET first_center TO a list with first element midpoint_horizontal MINUS dx and second element midpoint_vertical PLUS dy  
            SET second_center TO a list with first element midpoint_horizontal PLUS dx and second element midpoint_vertical MINUS dy  
            RETURN a list containing first_center and second_center  
        END FUNCTION  
        
        FUNCTION is_inside(circle, point, r)  
            SET distance_to_point TO distance(circle, point)  
            IF distance_to_point LESS THAN OR EQUAL TO r  
                RETURN True  
            ELSE  
                RETURN False  
            END IF  
        END FUNCTION  
        
        SET number_of_darts TO the length of darts  
        IF number_of_darts EQUALS one  
            RETURN one  
        END IF  
        
        SET max_count TO one  
        
        FOR i FROM zero TO number_of_darts MINUS one  
            FOR j FROM i PLUS one TO number_of_darts MINUS one  
                SET centers TO circle_center(element at position i of darts, element at position j of darts, r)  
                IF centers IS NOT None  
                    FOR each center IN centers  
                        SET count TO zero  
                        FOR each dart IN darts  
                            IF is_inside(center, dart, r) EQUALS True  
                                INCREMENT count BY one  
                            END IF  
                        END FOR  
                        IF count GREATER THAN max_count  
                            SET max_count TO count  
                        END IF  
                    END FOR  
                END IF  
            END FOR  
        END FOR  
        
        RETURN max_count  
    END FUNCTION  
END CLASS