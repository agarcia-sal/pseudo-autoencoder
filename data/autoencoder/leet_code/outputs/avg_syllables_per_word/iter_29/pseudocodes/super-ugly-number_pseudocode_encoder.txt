CLASS Solution  
    FUNCTION nthSuperUglyNumber(n, primes)  
        SET ugly_numbers TO a list containing only one element which is one  
        SET heap TO a list created by pairing each element of primes with its position in primes where each element is a pair of the prime value and its position  
        APPLY operation to organize heap as a minimum priority structure based on the first element of each pair  
        SET indices TO a list of zeros with the length equal to the number of elements in primes  
        WHILE the LENGTH OF ugly_numbers IS LESS THAN n  
            REMOVE and RETURN the pair with the smallest first element FROM heap and STORE the first element in next_ugly and the second element in prime_index  
            IF next_ugly IS NOT EQUAL TO the last element in ugly_numbers  
                APPEND next_ugly TO ugly_numbers  
            END IF  
            INCREMENT the value at position prime_index in indices BY one  
            SET next_multiple TO the element at position prime_index in primes MULTIPLIED BY the element in ugly_numbers at the position given by the value at position prime_index in indices  
            ADD the pair consisting of next_multiple and prime_index INTO heap maintaining the minimum priority property  
        END WHILE  
        RETURN the last element in ugly_numbers  
    END FUNCTION  
END CLASS