CLASS Solution  
    FUNCTION removeDuplicateLetters(s)  
        SET last_occurrence TO a dictionary mapping each character IN s TO its last position index IN s  
        SET stack TO an empty list  
        SET in_stack TO an empty set  
        
        FOR each position index AND character IN s WITH their respective enumeration  
            IF character IS IN in_stack  
                CONTINUE  
            END IF  
            
            WHILE the stack IS NOT empty AND character IS LESS THAN the last element at the last position of stack AND position index IS LESS THAN the last occurrence of the last element at the last position of stack IN last_occurrence  
                SET removed_char TO the element popped from stack  
                REMOVE removed_char FROM in_stack  
            END WHILE  
            
            APPEND character TO stack  
            ADD character TO in_stack  
        END FOR  
        
        SET result_string TO the concatenation of all characters contained IN stack in their existing order  
        RETURN result_string  
    END FUNCTION  
END CLASS