CLASS Solution  
    FUNCTION maxScoreWords(words list_of_strings letters list_of_strings score list_of_integers)  
        FUNCTION word_score(word string score_map mapping FROM character TO integer)  
            SET total_score TO zero  
            FOR each character IN word  
                INCREMENT total_score BY the value at character IN score_map  
            END FOR  
            RETURN total_score  
        END FUNCTION  
        
        FUNCTION can_form(word string letter_count mapping FROM character TO integer)  
            SET word_count TO a mapping FROM characters TO integers counting occurrences of each character IN word  
            FOR each character AND count IN word_count  
                IF the value at character IN letter_count IS LESS THAN count  
                    RETURN false  
                END IF  
            END FOR  
            RETURN true  
        END FUNCTION  
        
        FUNCTION update_letter_count(letter_count mapping FROM character TO integer word string add boolean)  
            FOR each character IN word  
                IF add IS true  
                    INCREMENT the value at character IN letter_count BY one  
                ELSE  
                    DECREMENT the value at character IN letter_count BY one  
                END IF  
            END FOR  
        END FUNCTION  
        
        FUNCTION backtrack(index integer current_score integer letter_count mapping FROM character TO integer)  
            IF index EQUALS the LENGTH OF words  
                RETURN current_score  
            END IF  
            
            SET max_score TO current_score  
            FOR i FROM index TO the LENGTH OF words MINUS one  
                IF can_form(element at position i of words letter_count) IS true  
                    CALL update_letter_count(letter_count element at position i of words false)  
                    SET max_score TO the GREATER OF max_score AND the RESULT OF calling backtrack WITH i PLUS one current_score PLUS the RESULT OF calling word_score WITH element at position i of words AND score_map letter_count  
                    CALL update_letter_count(letter_count element at position i of words true)  
                END IF  
            END FOR  
            RETURN max_score  
        END FUNCTION  
        
        SET score_map TO an empty mapping FROM characters TO integers  
        FOR i FROM zero TO twenty five  
            SET character TO the character CORRESPONDING TO the position i PLUS the position OF character a in the alphabet  
            SET the value at character IN score_map TO the element at position i of score  
        END FOR  
        
        SET letter_count TO a mapping FROM characters TO integers counting occurrences of each character IN letters  
        
        RETURN the RESULT OF calling backtrack WITH zero zero letter_count  
    END FUNCTION  
END CLASS