CLASS Solution  
    FUNCTION solve(nums, queries)  
        SET MODULO_VALUE TO ten POWERED BY nine PLUS seven  
        SET total_numbers TO the LENGTH OF nums  
        
        SET maximum_step TO the HIGHEST second element IN queries  
        SET prefix_sums TO a collection OF collections OF zero WITH total_numbers elements each AND maximum_step PLUS one such collections  
        
        FOR step FROM one TO maximum_step  
            FOR index FROM total_numbers MINUS one DOWN TO zero  
                IF index PLUS step LESS THAN total_numbers  
                    SET element at position index of prefix_sums at position step TO element at position index of nums PLUS element at position index PLUS step of prefix_sums at position step  
                ELSE  
                    SET element at position index of prefix_sums at position step TO element at position index of nums  
                END IF  
            END FOR  
        END FOR  
        
        SET answer_list TO an empty collection  
        FOR each pair of variables x AND y IN queries  
            APPEND element at position x of prefix_sums at position y MODULO MODULO_VALUE TO answer_list  
        END FOR  
        
        RETURN answer_list  
    END FUNCTION  
END CLASS