CLASS Solution  
    FUNCTION checkRecord(n)  
        SET MODULO_VALUE TO ten POWERED BY nine PLUS seven  
        INITIALIZE three dimensional collection dp WITH zero VALUES  
            WITH dimension one FROM zero TO n INCLUSIVE  
            WITH dimension two FROM zero TO one INCLUSIVE  
            WITH dimension three FROM zero TO two INCLUSIVE  
        
        SET element at position zero of dimension one  
            position zero of dimension two  
            position zero of dimension three of dp TO one  
        
        FOR index i FROM one TO n INCLUSIVE  
            FOR index j FROM zero TO one INCLUSIVE  
                FOR index k FROM zero TO two INCLUSIVE  
                    SET element at position i  
                        position j  
                        position zero of dp TO the CURRENT VALUE OF element at position i  
                        position j  
                        position zero of dp PLUS element at position i MINUS one  
                        position j  
                        position k of dp  
                    COMPUTE element at position i  
                        position j  
                        position zero of dp AS the REMAINDER OF DIVIDING the ABOVE SUM BY MODULO_VALUE  
                    
                    IF j EQUALS zero THEN  
                        SET element at position i  
                            position one  
                            position zero of dp TO the CURRENT VALUE OF element at position i  
                            position one  
                            position zero of dp PLUS element at position i MINUS one  
                            position zero  
                            position k of dp  
                        COMPUTE element at position i  
                            position one  
                            position zero of dp AS the REMAINDER OF DIVIDING the ABOVE SUM BY MODULO_VALUE  
                    END IF  
                    
                    IF k LESS THAN two THEN  
                        SET element at position i  
                            position j  
                            position k PLUS one of dp TO the CURRENT VALUE OF element at position i  
                            position j  
                            position k PLUS one of dp PLUS element at position i MINUS one  
                            position j  
                            position k of dp  
                        COMPUTE element at position i  
                            position j  
                            position k PLUS one of dp AS the REMAINDER OF DIVIDING the ABOVE SUM BY MODULO_VALUE  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        SET result TO zero  
        FOR index j FROM zero TO one INCLUSIVE  
            FOR index k FROM zero TO two INCLUSIVE  
                SET result TO the REMAINDER OF DIVIDING the SUM OF result PLUS element at position n  
                    position j  
                    position k of dp BY MODULO_VALUE  
            END FOR  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS