CLASS Solution  
    FUNCTION hasValidPath(grid)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero of grid  
        
        IF the SUM OF m PLUS n MINUS one MODULO two NOT EQUALS zero THEN  
            RETURN false  
        END IF  
        
        SET total_length TO m PLUS n PLUS one  
        
        CREATE three dimensional list dp with dimensions m PLUS one by n PLUS one by total_length FILLED WITH false  
        
        SET element at position zero of position one of position zero of dp TO true  
        
        FOR index i FROM zero TO m MINUS one  
            FOR index j FROM zero TO n MINUS one  
                FOR index k FROM zero TO total_length MINUS one  
                    IF element at position i of position j PLUS one of dp OR element at position i PLUS one of position j of dp THEN  
                        IF character at position j of element at position i of grid EQUALS opening parenthesis AND k PLUS one LESS THAN total_length THEN  
                            SET element at position i PLUS one of position j PLUS one of dp at position k PLUS one TO true  
                        ELSE IF character at position j of element at position i of grid EQUALS closing parenthesis AND k MINUS one GREATER THAN OR EQUAL TO zero THEN  
                            SET element at position i PLUS one of position j PLUS one of dp at position k MINUS one TO true  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        RETURN element at position m of position n of dp at position zero  
    END FUNCTION  
END CLASS