CLASS Solution  
    FUNCTION boxDelivering(boxes ports list OF lists OF integers portsCount integer maxBoxes integer maxWeight integer) RETURNS integer  
        SET total_number_of_boxes TO the LENGTH OF boxes  
        SET dp TO a list filled with infinity repeated total_number_of_boxes PLUS one times  
        SET the element at position zero of dp TO zero  
          
        SET left_pointer TO zero  
        SET current_weight_total TO zero  
        SET extra_trips_count TO zero  
          
        FOR right_pointer FROM zero TO total_number_of_boxes MINUS one  
            INCREMENT current_weight_total BY the element at position one of the element at position right_pointer of boxes  
            IF right_pointer GREATER THAN zero AND the element at position zero of the element at position right_pointer of boxes NOT EQUALS the element at position zero of the element at position right_pointer MINUS one of boxes  
                INCREMENT extra_trips_count BY one  
            END IF  
              
            WHILE left_pointer LESS THAN OR EQUAL TO right_pointer AND ((right_pointer MINUS left_pointer PLUS one) GREATER THAN maxBoxes OR current_weight_total GREATER THAN maxWeight)  
                DECREMENT current_weight_total BY the element at position one of the element at position left_pointer of boxes  
                IF left_pointer GREATER THAN zero AND the element at position zero of the element at position left_pointer of boxes NOT EQUALS the element at position zero of the element at position left_pointer MINUS one of boxes  
                    DECREMENT extra_trips_count BY one  
                END IF  
                INCREMENT left_pointer BY one  
            END WHILE  
              
            SET the element at position right_pointer PLUS one of dp TO the element at position left_pointer of dp PLUS two PLUS extra_trips_count  
        END FOR  
          
        RETURN the element at position total_number_of_boxes of dp  
    END FUNCTION  
END CLASS