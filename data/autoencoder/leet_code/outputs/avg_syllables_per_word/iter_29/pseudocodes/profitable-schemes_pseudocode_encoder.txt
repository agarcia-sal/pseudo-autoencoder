CLASS Solution  
    FUNCTION profitableSchemes(n number_of_members, minProfit minimum_profit_required, group list_of_group_sizes, profit list_of_profits)  
        SET MODULO TO one billion PLUS seven  
        SET dp TO two dimensional list with the number of rows equal to number_of_members PLUS one and the number of columns equal to minimum_profit_required PLUS one each element initialized to zero  
        FOR index i FROM zero TO number_of_members  
            SET element at position zero of row i in dp TO one  
        END FOR  
        FOR each element p WITH corresponding element g IN list_of_profits AND list_of_group_sizes  
            FOR index i FROM number_of_members DOWN TO g  
                FOR index j FROM minimum_profit_required DOWN TO zero  
                    SET element at position j of row i in dp TO the sum of the element at position j of row i in dp AND the element at position the greater of zero AND j MINUS p of row i MINUS g in dp  
                    THEN the remainder after division by MODULO  
                END FOR  
            END FOR  
        END FOR  
        RETURN element at position minimum_profit_required of row number_of_members in dp  
    END FUNCTION  
END CLASS