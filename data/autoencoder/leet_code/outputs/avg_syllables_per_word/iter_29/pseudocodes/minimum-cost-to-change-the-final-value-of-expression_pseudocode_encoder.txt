CLASS Solution  
    FUNCTION minOperationsToFlip(expression)  
        SET stack TO an empty list  

        FOR each element IN expression  
            IF element IS one of the characters open parenthesis OR ampersand OR vertical bar  
                APPEND a pair containing the element and zero TO stack  
                CONTINUE to the next iteration  
            END IF  

            IF element IS a closing parenthesis  
                SET lastPair TO the result of removing the last element from stack  
                REMOVE the last element from stack  
            ELSE  
                SET lastPair TO a pair containing element and one  
            END IF  

            IF stack IS NOT empty AND the first part of the last pair in stack IS one of the characters ampersand OR vertical bar  
                SET op TO the first part of the result of removing the last element from stack  
                SET a and costA TO the result of removing the last element from stack  
                SET b and costB TO lastPair  

                IF op IS ampersand  
                    IF a IS character zero AND b IS character zero  
                        SET lastPair TO a pair containing character zero and one PLUS the smaller of costA and costB  
                    ELSE IF a IS character zero AND b IS character one  
                        SET lastPair TO a pair containing character zero and one  
                    ELSE IF a IS character one AND b IS character zero  
                        SET lastPair TO a pair containing character zero and one  
                    ELSE  
                        SET lastPair TO a pair containing character one and the smaller of costA and costB  
                    END IF  
                ELSE  
                    IF a IS character zero AND b IS character zero  
                        SET lastPair TO a pair containing character zero and the smaller of costA and costB  
                    ELSE IF a IS character zero AND b IS character one  
                        SET lastPair TO a pair containing character one and one  
                    ELSE IF a IS character one AND b IS character zero  
                        SET lastPair TO a pair containing character one and one  
                    ELSE  
                        SET lastPair TO a pair containing character one and one PLUS the smaller of costA and costB  
                    END IF  
                END IF  
            END IF  

            APPEND lastPair TO stack  
        END FOR  

        RETURN the second part of the last element in stack  
    END FUNCTION  
END CLASS