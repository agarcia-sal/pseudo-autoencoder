CLASS Solution  
    FUNCTION largestPalindrome(n)  
        IF n EQUALS one  
            RETURN nine  
        END IF  
        
        SET upper_limit TO ten POWERED BY n MINUS one  
        SET lower_limit TO ten POWERED BY n MINUS one MINUS one  
        
        SET max_palindrome TO zero  
        
        FOR i FROM upper_limit DOWN TO lower_limit INCLUSIVE  
            FOR j FROM i DOWN TO lower_limit INCLUSIVE  
                SET product TO i MULTIPLIED BY j  
                IF product LESS THAN OR EQUAL TO max_palindrome  
                    BREAK  
                END IF  
                SET string_representation TO the string form of product  
                SET reversed_string TO string formed by characters of string_representation in reverse order  
                IF string_representation EQUALS reversed_string  
                    SET max_palindrome TO product  
                END IF  
            END FOR  
        END FOR  
        
        RETURN max_palindrome MODULO one thousand three hundred thirty seven  
    END FUNCTION  
END CLASS