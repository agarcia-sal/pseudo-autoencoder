CLASS Solution  
    FUNCTION isValid(code)  
        IMPORT regular_expression_library  
        
        SET CDATA pattern TO the natural language representation of the pattern that matches the sequence starting with less than followed by exclamation mark followed by open square bracket followed by CDATA followed by open square bracket followed by any characters as few as possible followed by close square bracket followed by close square bracket followed by greater than  
        
        SET code TO the result of replacing all substrings matching the CDATA pattern in the original code with empty text using the replace function from the regular expression library  
        
        SET stack TO an empty list  
        
        SET i TO zero  
        WHILE i IS LESS THAN the LENGTH OF code  
            IF character at position i of code EQUALS less than symbol  
                SET j TO the position of the first occurrence of greater than symbol in code starting from position i plus one  
                IF j EQUALS negative one  
                    RETURN false indicating no matching greater than symbol was found  
                END IF  
                
                SET tag_content TO the substring from position i plus one TO position j minus one of code  
                
                IF tag_content IS EMPTY  
                    RETURN false indicating empty tag content  
                END IF  
                
                IF character at position zero of tag_content EQUALS forward slash  
                    SET tag_name TO the substring from position one TO the end of tag_content  
                    IF stack IS EMPTY OR the last element in stack DOES NOT EQUAL tag_name  
                        RETURN false indicating mismatched or unbalanced tag  
                    END IF  
                    REMOVE the last element from stack  
                ELSE IF character at position zero of tag_content EQUALS exclamation mark  
                    RETURN false indicating invalid CDATA section presence  
                ELSE  
                    IF the LENGTH OF tag_content IS LESS THAN one OR GREATER THAN nine OR tag_content IS NOT EQUAL TO its own uppercase form  
                        RETURN false indicating invalid tag name  
                    END IF  
                    APPEND tag_content TO stack  
                END IF  
                
                SET i TO j plus one  
            ELSE  
                INCREMENT i BY one  
            END IF  
        END WHILE  
        
        SET number_of_valid_tags TO the number of substrings in code matching the pattern of less than followed by one or more uppercase letters followed by greater than followed by any characters followed by less than followed by forward slash followed by one or more uppercase letters followed by greater than using the regular expression library  
        
        RETURN true if stack IS EMPTY AND number_of_valid_tags IS GREATER THAN zero OTHERWISE return false  
    END FUNCTION  
END CLASS