CLASS Solution  
    FUNCTION maxValueOfCoins(piles list_of_list_of_integers k integer) RETURNS integer  
        SET number_of_piles TO the LENGTH OF piles  
        INITIALIZE dp AS a two dimensional collection of zeros with number_of_piles PLUS one rows and k PLUS one columns  
        
        FOR index_i FROM one TO number_of_piles  
            FOR index_j FROM one TO k  
                SET current_pile TO element at position index_i MINUS one of piles  
                SET current_value TO zero  
                SET maximum_coins_to_take TO the MINIMUM OF index_j AND the LENGTH OF current_pile  
                
                FOR index_l FROM zero TO maximum_coins_to_take  
                    IF index_l IS GREATER THAN zero THEN  
                        INCREMENT current_value BY element at position index_l MINUS one of current_pile  
                    END IF  
                    SET dp element at row index_i column index_j TO the GREATER OF dp element at row index_i column index_j AND the SUM OF dp element at row index_i MINUS one column index_j MINUS index_l AND current_value  
                END FOR  
            END FOR  
        END FOR  
        RETURN dp element at row number_of_piles column k  
    END FUNCTION  
END CLASS