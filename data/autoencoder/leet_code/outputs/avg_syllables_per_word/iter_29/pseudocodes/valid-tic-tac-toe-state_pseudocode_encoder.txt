CLASS Solution  
    FUNCTION validTicTacToe(board)  
        SET countX TO zero  
        SET countO TO zero  
        FOR each row IN board  
            INCREMENT countX BY the NUMBER OF OCCURRENCES OF character X IN row  
        END FOR  
        FOR each row IN board  
            INCREMENT countO BY the NUMBER OF OCCURRENCES OF character O IN row  
        END FOR  
        IF countX LESS THAN countO OR countX GREATER THAN countO PLUS one  
            RETURN false  
        END IF  
        FUNCTION check_win(player)  
            FOR each row IN board  
                IF the row IS EQUAL TO the player REPEATED three TIMES  
                    RETURN true  
                END IF  
            END FOR  
            FOR column FROM zero TO two  
                IF the character at position column OF the first row OF board IS EQUAL TO player AND the character at position column OF the second row OF board IS EQUAL TO player AND the character at position column OF the third row OF board IS EQUAL TO player  
                    RETURN true  
                END IF  
            END FOR  
            IF the character at position zero OF the first row OF board IS EQUAL TO player AND the character at position one OF the second row OF board IS EQUAL TO player AND the character at position two OF the third row OF board IS EQUAL TO player  
                RETURN true  
            END IF  
            IF the character at position two OF the first row OF board IS EQUAL TO player AND the character at position one OF the second row OF board IS EQUAL TO player AND the character at position zero OF the third row OF board IS EQUAL TO player  
                RETURN true  
            END IF  
            RETURN false  
        END FUNCTION  
        SET winX TO the RESULT OF check_win WITH player AS character X  
        SET winO TO the RESULT OF check_win WITH player AS character O  
        IF winX AND winO  
            RETURN false  
        END IF  
        IF winX AND countX IS EQUAL TO countO  
            RETURN false  
        END IF  
        IF winO AND countX IS NOT EQUAL TO countO  
            RETURN false  
        END IF  
        RETURN true  
    END FUNCTION  
END CLASS