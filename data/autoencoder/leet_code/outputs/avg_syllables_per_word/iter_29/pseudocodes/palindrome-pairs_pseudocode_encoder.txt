CLASS Solution  
    FUNCTION palindromePairs(words)  
        FUNCTION is_palindrome(s)  
            RETURN s EQUALS the STRING s REVERSED  
        END FUNCTION  
        
        SET word_dictionary TO an empty MAPPING from string TO integer  
        FOR each index FROM zero TO the LENGTH OF words MINUS one  
            SET word_dictionary AT element at position index of words TO index  
        END FOR  
        
        SET result TO an empty LIST  
        
        FOR each index FROM zero TO the LENGTH OF words MINUS one  
            SET word TO element at position index of words  
            
            IF word EQUALS empty string THEN  
                CONTINUE  
            END IF  
            
            IF the empty string IS a key in word_dictionary AND is_palindrome(word) THEN  
                APPEND LIST containing index AND word_dictionary AT the empty string TO result  
                APPEND LIST containing word_dictionary AT the empty string AND index TO result  
            END IF  
            
            SET reversed_word TO the STRING word REVERSED  
            IF reversed_word IS a key in word_dictionary AND word_dictionary AT reversed_word NOT EQUALS index THEN  
                APPEND LIST containing index AND word_dictionary AT reversed_word TO result  
            END IF  
            
            FOR partition_index FROM one TO the LENGTH OF word MINUS one  
                SET prefix TO substring from position zero TO position partition_index MINUS one of word  
                SET suffix TO substring from position partition_index TO position LENGTH OF word MINUS one of word  
                SET reversed_prefix TO the STRING prefix REVERSED  
                SET reversed_suffix TO the STRING suffix REVERSED  
                
                IF is_palindrome(suffix) AND reversed_prefix IS a key in word_dictionary THEN  
                    APPEND LIST containing index AND word_dictionary AT reversed_prefix TO result  
                END IF  
                
                IF is_palindrome(prefix) AND reversed_suffix IS a key in word_dictionary THEN  
                    APPEND LIST containing word_dictionary AT reversed_suffix AND index TO result  
                END IF  
            END FOR  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS