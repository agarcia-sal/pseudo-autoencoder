CLASS Solution  
    FUNCTION maximumBeauty(flowers)  
        DEFINE a new empty dictionary named indices that maps values TO empty lists  
        DEFINE prefix_sum AS a new list filled with zero OF LENGTH the LENGTH OF flowers PLUS one  
        
        FOR each index i FROM zero TO the LENGTH OF flowers MINUS one  
            SET the element at position i PLUS one of prefix_sum TO the element at position i of prefix_sum PLUS the GREATER OF the element at position i of flowers AND zero  
            APPEND the index i TO the list mapped by the element at position i of flowers IN indices  
        END FOR  
        
        SET max_beauty TO the SMALLEST POSSIBLE VALUE  
        
        FOR each beauty_value IN the keys of indices  
            IF the LENGTH OF the list mapped by beauty_value IN indices IS GREATER THAN OR EQUAL TO two THEN  
                SET first TO the element at position zero of the list mapped by beauty_value IN indices  
                SET last TO the element at the LAST POSITION of the list mapped by beauty_value IN indices  
                
                SET current_beauty TO two MULTIPLIED BY beauty_value PLUS the element at position last of prefix_sum MINUS the element at position first PLUS one of prefix_sum  
                
                IF max_beauty IS LESS THAN current_beauty THEN  
                    SET max_beauty TO current_beauty  
                END IF  
            END IF  
        END FOR  
        
        RETURN max_beauty  
    END FUNCTION  
END CLASS