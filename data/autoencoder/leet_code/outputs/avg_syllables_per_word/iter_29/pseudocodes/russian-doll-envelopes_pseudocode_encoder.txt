CLASS Solution  
    FUNCTION maxEnvelopes(envelopes)  
        CALL method TO sort envelopes BY the first element of envelope IN ascending order AND BY the negative of the second element of envelope IN ascending order  
        
        SET dp TO empty list  
        
        FOR each element IGNORE first_value AND ASSIGN second_value TO h IN envelopes  
            SET idx TO the position FOUND BY binary search FROM dp TO insert h TO MAINTAIN sorted order  
            IF idx EQUALS the LENGTH OF dp  
                APPEND h TO dp  
            ELSE  
                SET element at position idx OF dp TO h  
            END IF  
        END FOR  
        
        RETURN the LENGTH OF dp  
    END FUNCTION  
END CLASS