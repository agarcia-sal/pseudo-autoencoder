CLASS Solution  
    FUNCTION maxNumOfSubstrings(s)  
        SET dictionary_of_first_occurrences TO an empty dictionary  
        SET dictionary_of_last_occurrences TO an empty dictionary  
        FOR each index AND character IN the enumeration of string s  
            IF the character is NOT a key IN dictionary_of_first_occurrences  
                SET the value at key character IN dictionary_of_first_occurrences TO index  
            END IF  
            SET the value at key character IN dictionary_of_last_occurrences TO index  
        END FOR  
  
        SET list_of_intervals TO an empty list  
        FOR each character IN the keys of dictionary_of_first_occurrences  
            SET variable start TO the value at key character IN dictionary_of_first_occurrences  
            SET variable end TO the value at key character IN dictionary_of_last_occurrences  
            SET variable i TO start  
            WHILE i IS LESS THAN OR EQUAL TO end  
                IF the value at key character at position i of string s IN dictionary_of_first_occurrences IS LESS THAN start  
                    BREAK the WHILE loop  
                END IF  
                SET end TO the GREATER THAN value BETWEEN end AND the value at key character at position i of string s IN dictionary_of_last_occurrences  
                INCREMENT i BY one  
            END WHILE  
            IF the WHILE loop completed without a BREAK  
                APPEND the tuple consisting of start AND end TO list_of_intervals  
            END IF  
        END FOR  
  
        SORT the elements of list_of_intervals by the second element of each tuple in ascending order  
  
        SET list_of_results TO an empty list  
        SET variable previous_end TO negative one  
        FOR each tuple of start AND end IN list_of_intervals  
            IF start IS GREATER THAN previous_end  
                APPEND the substring of string s from position start TO position end to list_of_results  
                SET previous_end TO end  
            END IF  
        END FOR  
  
        RETURN list_of_results  
    END FUNCTION  
END CLASS