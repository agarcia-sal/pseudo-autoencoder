CLASS Solution  
    FUNCTION longestSubsequenceRepeatedK(s k)  
        SET frequency_map TO a mapping FROM characters TO their counts IN s  
        SET valid_characters TO an empty list  
        FOR each character AND its count IN frequency_map  
            IF count GREATER THAN OR EQUAL TO k  
                APPEND character TO valid_characters  
            END IF  
        END FOR  
        SORT valid_characters IN descending lexicographical order  
        
        FUNCTION is_valid_subsequence(candidate)  
            SET occurrence_count TO zero  
            SET candidate_index TO zero  
            FOR each character IN s  
                IF character EQUALS character at position candidate_index OF candidate  
                    INCREMENT candidate_index BY one  
                    IF candidate_index EQUALS the LENGTH OF candidate  
                        INCREMENT occurrence_count BY one  
                        SET candidate_index TO zero  
                        IF occurrence_count EQUALS k  
                            RETURN true  
                        END IF  
                    END IF  
                END IF  
            END FOR  
            RETURN false  
        END FUNCTION  
        
        SET best_candidate TO empty string  
        
        FUNCTION backtrack(candidate)  
            IF the LENGTH OF candidate GREATER THAN the LENGTH OF best_candidate  
                SET best_candidate TO candidate  
            END IF  
            FOR each character IN valid_characters  
                SET new_candidate TO candidate FOLLOWED BY character  
                IF is_valid_subsequence(new_candidate)  
                    CALL backtrack WITH new_candidate  
                END IF  
            END FOR  
        END FUNCTION  
        
        CALL backtrack WITH empty string  
        RETURN best_candidate  
    END FUNCTION  
END CLASS