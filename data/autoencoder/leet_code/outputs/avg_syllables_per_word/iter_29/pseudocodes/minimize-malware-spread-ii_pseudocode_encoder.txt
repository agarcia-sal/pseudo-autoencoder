CLASS Solution  
    FUNCTION minMalwareSpread(graph AS list of list of integers initial AS list of integers) RETURNS integer  
        SET n TO the LENGTH OF graph  
        SET adj_list TO a new empty map from integer to list of integers with default empty list  
  
        FOR index i FROM zero TO n MINUS one  
            FOR index j FROM i PLUS one TO n MINUS one  
                IF element at position j of element at position i of graph EQUALS one  
                    APPEND j TO the list at key i in adj_list  
                    APPEND i TO the list at key j in adj_list  
                END IF  
            END FOR  
        END FOR  
  
        FUNCTION dfs(node AS integer visited AS set of integers) RETURNS integer  
            IF node IS IN visited  
                RETURN zero  
            END IF  
            ADD node TO visited  
            SET size TO one  
            FOR each neighbor IN the list at key node in adj_list  
                INCREMENT size BY the RESULT OF dfs with neighbor AND visited AS arguments  
            END FOR  
            RETURN size  
        END FUNCTION  
  
        SET infected TO a new set containing all elements of initial  
  
        SET component_sizes TO a new empty list of integers  
        SET visited TO a new empty set of integers  
        SET component_index TO a new empty map from integer to integer  
  
        FOR node FROM zero TO n MINUS one  
            IF node IS NOT IN visited AND node IS NOT IN infected  
                SET size TO the RESULT OF dfs with node AND visited AS arguments  
                APPEND size TO component_sizes  
  
                FOR i FROM the LENGTH OF component_sizes MINUS one DOWN TO zero  
                    IF element at position i of component_sizes EQUALS size  
                        BREAK the loop of i  
                    END IF  
                END FOR  
  
                FOR each neighbor IN the list at key node in adj_list  
                    SET the value at key neighbor in component_index TO i  
                END FOR  
            END IF  
        END FOR  
  
        SET infected_in_component TO a new map from integer to integer with default zero  
  
        FOR each node IN infected  
            IF node IS IN component_index  
                INCREMENT the value at key component_index at key node in infected_in_component BY one  
            END IF  
        END FOR  
  
        SET max_size TO zero  
        SET node_to_remove TO the smallest element in initial  
  
        FOR each node IN infected  
            IF node IS IN component_index  
                SET comp_idx TO the value at key node in component_index  
                IF the value at key comp_idx in infected_in_component EQUALS one  
                    IF the element at position comp_idx of component_sizes IS GREATER THAN max_size  
                        SET max_size TO the element at position comp_idx of component_sizes  
                        SET node_to_remove TO node  
                    ELSE IF the element at position comp_idx of component_sizes EQUALS max_size  
                        IF node IS LESS THAN node_to_remove  
                            SET node_to_remove TO node  
                        END IF  
                    END IF  
                END IF  
            END IF  
        END FOR  
  
        RETURN node_to_remove  
    END FUNCTION  
END CLASS