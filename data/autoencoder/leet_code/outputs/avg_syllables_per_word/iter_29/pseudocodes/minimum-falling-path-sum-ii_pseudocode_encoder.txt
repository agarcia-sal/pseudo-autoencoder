CLASS Solution  
    FUNCTION minFallingPathSum(grid)  
        IF grid IS EMPTY OR the LENGTH OF grid IS ZERO OR the LENGTH OF element at position zero of grid IS ZERO  
            RETURN zero  
        END IF  
        
        SET n TO the LENGTH OF grid  
        
        IF n EQUALS one  
            RETURN the MINIMUM ELEMENT IN element at position zero of grid  
        END IF  
        
        SET dp TO a NEW LIST CONTAINING all elements of element at position zero of grid  
        
        FOR i FROM one TO n MINUS one  
            SET new_dp TO a NEW LIST OF LENGTH n FILLED WITH zero  
            SET min1 TO positive infinity  
            SET min2 TO positive infinity  
            SET min1_index TO negative one  
            
            FOR j FROM zero TO n MINUS one  
                IF element at position j of dp IS LESS THAN min1  
                    SET min2 TO min1  
                    SET min1 TO element at position j of dp  
                    SET min1_index TO j  
                ELSE IF element at position j of dp IS LESS THAN min2  
                    SET min2 TO element at position j of dp  
                END ELSE IF  
            END FOR  
            
            FOR j FROM zero TO n MINUS one  
                IF j EQUALS min1_index  
                    SET element at position j of new_dp TO element at position i of grid AT position j PLUS min2  
                ELSE  
                    SET element at position j of new_dp TO element at position i of grid AT position j PLUS min1  
                END IF  
            END FOR  
            
            SET dp TO a NEW LIST CONTAINING all elements of new_dp  
        END FOR  
        
        RETURN the MINIMUM ELEMENT IN dp  
    END FUNCTION  
END CLASS