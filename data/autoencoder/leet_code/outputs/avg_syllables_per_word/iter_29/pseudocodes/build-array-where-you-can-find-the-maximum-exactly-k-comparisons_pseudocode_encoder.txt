CLASS Solution  
    FUNCTION numOfArrays(n length_parameter m max_element_parameter k search_cost_parameter)  
        SET MODULO_VALUE TO ten POWERED BY nine PLUS seven  
        
        INITIALIZE three_dimensional_list dp WITH dimensions length_parameter PLUS one BY max_element_parameter PLUS one BY search_cost_parameter PLUS one FILLED WITH zero  
        
        FOR max_element_index FROM one TO max_element_parameter  
            SET element at position one of dp at position max_element_index at position one TO one  
        END FOR  
        
        FOR array_length FROM two TO length_parameter  
            FOR max_element_index FROM one TO max_element_parameter  
                FOR search_cost_value FROM one TO search_cost_parameter  
                    
                    FOR smaller_max_element FROM one TO max_element_index MINUS one  
                        SET element at position array_length of dp at position max_element_index at position search_cost_value TO the element at position array_length of dp at position max_element_index at position search_cost_value PLUS the element at position array_length MINUS one of dp at position smaller_max_element at position search_cost_value MINUS one  
                        SET element at position array_length of dp at position max_element_index at position search_cost_value TO the remainder of division of the previous sum BY MODULO_VALUE  
                    END FOR  
                    
                    SET element at position array_length of dp at position max_element_index at position search_cost_value TO the element at position array_length of dp at position max_element_index at position search_cost_value PLUS the product of the element at position array_length MINUS one of dp at position max_element_index at position search_cost_value AND max_element_index  
                    SET element at position array_length of dp at position max_element_index at position search_cost_value TO the remainder of division of the previous sum BY MODULO_VALUE  
                END FOR  
            END FOR  
        END FOR  
        
        SET total_result TO zero  
        FOR max_element_index FROM one TO max_element_parameter  
            SET total_result TO total_result PLUS the element at position length_parameter of dp at position max_element_index at position search_cost_parameter  
            SET total_result TO the remainder of division of total_result BY MODULO_VALUE  
        END FOR  
        
        RETURN total_result  
    END FUNCTION  
END CLASS