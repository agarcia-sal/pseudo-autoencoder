CLASS Solution  
    FUNCTION atMostNGivenDigitSet(digits WITH TYPE List OF string, n WITH TYPE integer) RETURNS integer  
        FUNCTION count_numbers_with_length(length WITH TYPE integer) RETURNS integer  
            RETURN the LENGTH OF digits POWERED BY length  
        END FUNCTION  
          
        FUNCTION count_numbers_up_to_n(n WITH TYPE integer) RETURNS integer  
            SET string_representation_of_n TO the string conversion of n  
            SET length_of_string TO the LENGTH OF string_representation_of_n  
            SET total_count TO zero  
            
            FOR each integer l FROM one TO the number before length_of_string  
                INCREMENT total_count BY the result of count_numbers_with_length WITH l  
            END FOR  
            
            FOR each integer i FROM zero TO the number before length_of_string  
                SET current_digit TO the integer conversion of the character at position i of string_representation_of_n  
                FOR each digit_string IN digits  
                    SET digit_value TO the integer conversion of digit_string  
                    IF digit_value LESS THAN current_digit THEN  
                        INCREMENT total_count BY the result of count_numbers_with_length WITH length_of_string MINUS i MINUS one  
                    ELSE IF digit_value EQUALS current_digit THEN  
                        IF i EQUALS length_of_string MINUS one THEN  
                            INCREMENT total_count BY one  
                        END IF  
                    ELSE  
                        BREAK the inner loop  
                    END IF  
                END FOR  
            END FOR  
            
            RETURN total_count  
        END FUNCTION  
          
        RETURN the result of count_numbers_up_to_n WITH n  
    END FUNCTION  
END CLASS