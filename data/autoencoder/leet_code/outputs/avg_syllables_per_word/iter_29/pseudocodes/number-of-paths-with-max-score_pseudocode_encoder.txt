CLASS Solution  
    FUNCTION pathsWithMaxScore(board)  
        SET MODULO TO ten POWERED BY nine PLUS one  
        SET board_size TO the LENGTH OF board  
        
        INITIALIZE dp_matrix AS a two dimensional collection of size board_size BY board_size  
        WHERE each element is a two element collection WITH the first element SET TO negative infinity AND the second element SET TO zero  
        
        SET element at position board_size MINUS one AND board_size MINUS one OF dp_matrix TO a two element collection WITH zero AS the first element AND one AS the second element  
        
        FOR i FROM board_size MINUS one DOWNTO zero  
            FOR j FROM board_size MINUS one DOWNTO zero  
                IF the character at position i AND j OF board IS equal TO the character X OR the character at position i AND j OF board IS equal TO the character S  
                    CONTINUE TO the next iteration of the inner loop  
                END IF  
                
                IF the character at position i AND j OF board IS equal TO the character E  
                    SET current_value TO zero  
                ELSE  
                    SET current_value TO the integer conversion of the character at position i AND j OF board  
                END IF  
                
                FOR each pair OF increments x AND y IN the collection of pairs where x IS one AND y IS zero OR x IS zero AND y IS one OR x IS one AND y IS one  
                    SET new_i TO i PLUS x  
                    SET new_j TO j PLUS y  
                    
                    IF new_i IS greater than or equal TO zero AND new_i IS less than board_size AND new_j IS greater than or equal TO zero AND new_j IS less than board_size  
                        IF the first element of the pair at dp_matrix position new_i AND new_j IS GREATER THAN the first element of the pair at dp_matrix position i AND j  
                            SET the pair at dp_matrix position i AND j TO a two element collection WHERE the first element IS the sum OF the first element at dp_matrix position new_i AND new_j PLUS current_value AND the second element IS the second element at dp_matrix position new_i AND new_j  
                        ELSE IF the first element of the pair at dp_matrix position new_i AND new_j EQUALS the first element of the pair at dp_matrix position i AND j  
                            SET the second element of the pair at dp_matrix position i AND j TO the sum OF the second element at dp_matrix position i AND j PLUS the second element at dp_matrix position new_i AND new_j MODULO BY MODULO  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        IF the first element of the pair at dp_matrix position zero AND zero EQUALS negative infinity  
            RETURN a two element collection WITH zero AS the first element AND zero AS the second element  
        END IF  
        
        RETURN the two element collection at dp_matrix position zero AND zero  
    END FUNCTION  
END CLASS