CLASS Solution
    FUNCTION ways(pizza, k)
        FUNCTION dfs(i, j, k)
            IF k EQUALS zero
                RETURN integer value of the expression: element at position m of list s at position n MINUS element at position i of list s at position n MINUS element at position m of list s at position j PLUS element at position i of list s at position j GREATER THAN zero
            END IF
            SET ans TO zero
            FOR x FROM i PLUS one TO m MINUS one
                IF element at position x of list s at position n MINUS element at position i of list s at position n MINUS element at position x of list s at position j PLUS element at position i of list s at position j GREATER THAN zero
                    INCREMENT ans BY result of dfs with parameters x, j, k MINUS one
                END IF
            END FOR
            FOR y FROM j PLUS one TO n MINUS one
                IF element at position m of list s at position y MINUS element at position i of list s at position y MINUS element at position m of list s at position j PLUS element at position i of list s at position j GREATER THAN zero
                    INCREMENT ans BY result of dfs with parameters i, y, k MINUS one
                END IF
            END FOR
            RETURN ans MODULO mod
        END FUNCTION

        SET mod TO one billion PLUS seven
        SET m TO length of list pizza
        SET n TO length of element at position zero of list pizza
        SET s TO a list containing m PLUS one elements each being a list containing n PLUS one zeros
        FOR i FROM one TO m
            FOR j FROM one TO n
                SET s at position i at position j TO element at position i MINUS one of list s at position j PLUS element at position i of list s at position j MINUS one MINUS element at position i MINUS one of list s at position j MINUS one PLUS integer value of the expression: element at position i MINUS one of list pizza at position j MINUS one EQUALS character A
            END FOR
        END FOR
        RETURN result of dfs with parameters zero, zero, k MINUS one
    END FUNCTION
END CLASS