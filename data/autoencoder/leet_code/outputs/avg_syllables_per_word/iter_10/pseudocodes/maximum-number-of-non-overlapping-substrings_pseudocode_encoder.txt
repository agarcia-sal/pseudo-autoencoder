CLASS Solution  
    FUNCTION maxNumOfSubstrings(s)  
        SET first TO empty mapping  
        SET last TO empty mapping  
        FOR each index i AND character c IN s enumerated  
            IF c NOT IN first  
                SET the value at key c IN first TO i  
            END IF  
            SET the value at key c IN last TO i  
        END FOR  
        
        SET intervals TO empty list  
        FOR each character c IN first keys  
            SET start TO the value at key c IN first  
            SET end TO the value at key c IN last  
            SET i TO start  
            WHILE i LESS THAN OR EQUAL TO end  
                IF the value at key s at position i IN first LESS THAN start  
                    BREAK the WHILE loop  
                END IF  
                SET end TO the GREATER OF end AND the value at key s at position i IN last  
                INCREMENT i BY one  
            END WHILE  
            IF i GREATER THAN end  
                APPEND the pair of start and end TO intervals  
            END IF  
        END FOR  
        
        SORT intervals BY the second element of each pair in ascending order  
        
        SET result TO empty list  
        SET prev_end TO negative one  
        FOR each pair start and end IN intervals  
            IF start GREATER THAN prev_end  
                APPEND the substring of s from position start TO position end INCLUSIVE TO result  
                SET prev_end TO end  
            END IF  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS