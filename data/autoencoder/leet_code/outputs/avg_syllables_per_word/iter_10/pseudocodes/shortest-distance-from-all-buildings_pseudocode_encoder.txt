CLASS Solution  
    FUNCTION shortestDistance(grid)  
        IF grid EQUALS empty OR element at position zero of grid EQUALS empty  
            RETURN minus one  
        END IF  
        
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero of grid  
        SET total_distance TO the result of calling initialize_matrix WITH parameters m, n, zero  
        SET reach_count TO the result of calling initialize_matrix WITH parameters m, n, zero  
        SET building_count TO zero
        
        SET directions TO list containing (one, zero), (minus one, zero), (zero, one), and (zero, minus one)  
        
        FUNCTION bfs(start_x, start_y)  
            SET queue TO a new deque containing the tuple of start_x and start_y  
            SET visited TO the result of calling initialize_matrix WITH parameters m, n, False  
            SET distance TO zero  
            SET reachable TO zero  
            
            WHILE queue is not empty  
                SET size TO the LENGTH OF queue  
                INCREMENT distance BY one  
                FOR index FROM one TO size  
                    SET x, y TO the first element of queue  
                    REMOVE first element FROM queue  
                    FOR each dx, dy IN directions  
                        SET nx TO x PLUS dx  
                        SET ny TO y PLUS dy  
                        IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n AND element at position nx of visited at position ny EQUALS False AND element at position nx of grid at position ny EQUALS zero  
                            SET element at position nx of visited at position ny TO True  
                            APPEND the tuple of nx and ny TO queue  
                            INCREMENT element at position nx of total_distance at position ny BY distance  
                            INCREMENT element at position nx of reach_count at position ny BY one  
                            INCREMENT reachable BY one  
                        END IF  
                    END FOR  
                END FOR  
            END WHILE  
            RETURN reachable  
        END FUNCTION  
        
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF element at position i of grid at position j EQUALS one  
                    INCREMENT building_count BY one  
                    IF result of calling bfs WITH parameters i, j LESS THAN building_count MINUS one  
                        RETURN minus one  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        
        SET min_distance TO infinity  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF element at position i of grid at position j EQUALS zero AND element at position i of reach_count at position j EQUALS building_count  
                    SET min_distance TO the lesser of min_distance AND element at position i of total_distance at position j  
                END IF  
            END FOR  
        END FOR  
        
        IF min_distance NOT EQUALS infinity  
            RETURN min_distance  
        ELSE  
            RETURN minus one  
        END IF  
    END FUNCTION  
  
    FUNCTION initialize_matrix(rows, columns, initial_value)  
        CREATE a list called matrix  
        FOR each index FROM zero TO rows MINUS one  
            CREATE a list called row  
            FOR each index FROM zero TO columns MINUS one  
                APPEND initial_value TO row  
            END FOR  
            APPEND row TO matrix  
        END FOR  
        RETURN matrix  
    END FUNCTION  
END CLASS