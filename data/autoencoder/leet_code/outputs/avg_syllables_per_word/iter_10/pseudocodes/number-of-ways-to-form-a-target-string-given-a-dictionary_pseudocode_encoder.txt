CLASS Solution  
    FUNCTION numWays(words, target)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF the first element of words  
        SET m TO the LENGTH OF target  
        
        CALL initialize frequency list freq AS a list with n elements each as a new default mapping from character to integer zero  
        
        FOR each word IN words  
            FOR each position j FROM zero TO n MINUS one  
                SET char TO the element at position j of word  
                INCREMENT the value at key char of freq at position j BY one  
            END FOR  
        END FOR  
        
        CALL initialize two dimensional list dp with (m PLUS one) rows and (n PLUS one) columns each element set to zero  
        
        FOR each position j FROM zero TO n  
            SET element at row zero column j of dp TO one  
        END FOR  
        
        FOR each position i FROM one TO m  
            FOR each position j FROM one TO n  
                SET element at row i column j of dp TO element at row i column j MINUS one of dp  
                IF value at key element at position i MINUS one of target of freq at position j MINUS one GREATER THAN zero THEN  
                    INCREMENT element at row i column j of dp BY element at row i MINUS one column j MINUS one of dp MULTIPLIED BY value at key element at position i MINUS one of target of freq at position j MINUS one  
                    SET element at row i column j of dp TO element at row i column j of dp MODULO MOD  
                END IF  
            END FOR  
        END FOR  
        
        RETURN element at row m column n of dp  
    END FUNCTION  
END CLASS