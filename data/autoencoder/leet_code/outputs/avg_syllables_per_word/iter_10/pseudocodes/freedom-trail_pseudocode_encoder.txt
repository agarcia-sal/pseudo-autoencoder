CLASS Solution  
    FUNCTION findRotateSteps(ring, key)  
        DEFINE COLLECTION char_positions AS mapping from character TO list of integer positions  
        FOR each index i FROM zero TO the LENGTH OF ring MINUS one  
            APPEND the element at position i of ring TO the list at key the element at position i of ring IN char_positions  
        END FOR  
        
        SET n TO the LENGTH OF ring  
        
        FUNCTION dp(i, prev_pos)  
            IF i EQUALS the LENGTH OF key  
                RETURN zero  
            END IF  
            
            SET min_steps TO infinity  
            FOR each pos IN the list of char_positions at key element at position i  
                SET clockwise TO the remainder of pos MINUS prev_pos DIVIDED BY n  
                SET anticlockwise TO the remainder of prev_pos MINUS pos DIVIDED BY n  
                SET steps TO the minimum of clockwise AND anticlockwise PLUS one PLUS dp the sum of i PLUS one AND pos  
                SET min_steps TO the minimum of min_steps AND steps  
            END FOR  
            
            RETURN min_steps  
        END FUNCTION  
        
        RETURN dp zero AND zero  
    END FUNCTION  
END CLASS