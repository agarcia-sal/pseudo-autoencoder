CLASS Solution  
    FUNCTION countRangeSum(nums, lower, upper)  
        SET prefix_sums TO list containing zero  
        SET current_sum TO zero  
        SET count TO zero  
        
        FOR each num IN nums  
            INCREMENT current_sum BY num  
            SET left TO current_sum MINUS upper  
            SET right TO current_sum MINUS lower  
            
            SET right_insertion_index TO position where right would be inserted in prefix_sums to maintain sorted order beyond right  
            SET left_insertion_index TO position where left would be inserted in prefix_sums to maintain sorted order before left  
            
            INCREMENT count BY right_insertion_index MINUS left_insertion_index  
            
            Insert current_sum into prefix_sums maintaining sorted order  
        END FOR  
        
        RETURN count  
    END FUNCTION  
END CLASS