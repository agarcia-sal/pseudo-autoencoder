CLASS Solution
    FUNCTION numberOfCombinations(num)
        SET MOD TO one billion PLUS seven
        SET n TO the LENGTH OF num
        
        SET memo TO an empty dictionary
        
        FUNCTION dp(index, prev_len)
            IF index EQUALS n
                RETURN one
            END IF
            
            IF the tuple of index and prev_len IS IN memo
                RETURN the value AT the tuple of index and prev_len IN memo
            END IF
            
            SET count TO zero
            FOR length FROM one TO n MINUS index
                IF the character AT position index OF num EQUALS zero
                    BREAK the loop
                END IF
                
                SET current_num TO the substring OF num FROM position index TO position index PLUS length
                
                IF prev_len EQUALS zero OR current_num GREATER THAN OR EQUAL TO the substring OF num FROM position index MINUS prev_len TO position index
                    SET count TO the sum OF count AND dp OF index PLUS length AND length MODULO MOD
                END IF
            END FOR
            
            SET the value AT the tuple of index and prev_len IN memo TO count
            RETURN count
        END FUNCTION
        
        RETURN dp OF zero AND zero
    END FUNCTION
END CLASS