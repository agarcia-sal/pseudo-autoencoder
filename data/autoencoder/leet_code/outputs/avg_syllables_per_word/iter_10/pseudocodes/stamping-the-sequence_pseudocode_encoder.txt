CLASS Solution  
    FUNCTION movesToStamp(stamp, target)  
        SET m TO the LENGTH OF stamp  
        SET n TO the LENGTH OF target  
        SET indeg TO a list of size (n MINUS m PLUS one) with each element SET TO m  
        SET q TO an empty deque  
        SET g TO a list of size n where each element is an empty list  
        FOR i FROM zero TO (n MINUS m)  
            FOR each position j and character c IN stamp  
                IF the character at position (i PLUS j) of target EQUALS c  
                    DECREMENT indeg at position i BY one  
                    IF indeg at position i EQUALS zero  
                        APPEND i TO q  
                    END IF  
                ELSE  
                    APPEND i TO the list at position (i PLUS j) of g  
                END IF  
            END FOR  
        END FOR  
        SET ans TO an empty list  
        SET vis TO a list of size n with all elements SET TO False  
        WHILE q is not empty  
            SET i TO the first element REMOVED FROM q  
            APPEND i TO ans  
            FOR j FROM zero TO (m MINUS one)  
                IF vis at position (i PLUS j) IS False  
                    SET vis at position (i PLUS j) TO True  
                    FOR each element k IN the list at position (i PLUS j) of g  
                        DECREMENT indeg at position k BY one  
                        IF indeg at position k EQUALS zero  
                            APPEND k TO q  
                        END IF  
                    END FOR  
                END IF  
            END FOR  
        END WHILE  
        IF all elements of vis ARE True  
            RETURN ans in REVERSED ORDER  
        ELSE  
            RETURN an empty list  
        END IF  
    END FUNCTION  
END CLASS