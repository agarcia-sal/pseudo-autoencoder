CLASS Solution  
    FUNCTION profitableSchemes(n, minProfit, group, profit)  
        SET MOD TO one billion PLUS seven  
        CALL initialize_dp WITH n, minProfit RETURNING dp  
        
        FOR each index i FROM zero TO n  
            SET element at position zero of dp at position i TO one  
        END FOR  
        
        FOR each element p AND element g IN profit AND group  
            FOR index i FROM n DOWN TO g  
                FOR index j FROM minProfit DOWN TO zero  
                    SET dp at position i at position j TO dp at position i at position j PLUS dp at position i MINUS g at position MAXIMUM of zero AND j MINUS p  
                    SET dp at position i at position j TO dp at position i at position j MODULO MOD  
                END FOR  
            END FOR  
        END FOR  
        
        RETURN dp at position n at position minProfit  
    END FUNCTION  

    FUNCTION initialize_dp(n, minProfit)  
        SET dp TO a list  
        FOR index i FROM zero TO n  
            APPEND a list of zeroes of length minProfit PLUS one TO dp  
        END FOR  
        RETURN dp  
    END FUNCTION  
END CLASS