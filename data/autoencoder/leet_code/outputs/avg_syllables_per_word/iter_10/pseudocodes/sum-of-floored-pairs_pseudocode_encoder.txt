CLASS Solution  
    FUNCTION sumOfFlooredPairs(nums)  
        SET MOD TO one billion plus seven  
        SET max_num TO the maximum element IN nums  
        SET count TO a mapping FROM elements IN nums TO their frequencies  
        SET prefix_sum TO a list OF zeros WITH LENGTH max_num plus one  
        
        FOR each num IN count  
            INCREMENT element at position num OF prefix_sum BY count of num  
        END FOR  
        
        FOR index FROM one TO max_num  
            INCREMENT element at position index OF prefix_sum BY element at position index minus one OF prefix_sum  
        END FOR  
        
        SET result TO zero  
        
        FOR each num IN count  
            FOR multiple FROM one TO the integer division OF max_num BY num  
                SET start TO num MULTIPLIED BY multiple  
                SET end TO the smaller value BETWEEN num MULTIPLIED BY (multiple plus one) MINUS one AND max_num  
                SET multiples_count TO element at position end OF prefix_sum MINUS element at position start minus one OF prefix_sum  
                INCREMENT result BY multiples_count MULTIPLIED BY multiple MULTIPLIED BY count of num  
                SET result TO result MODULO MOD  
            END FOR  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS