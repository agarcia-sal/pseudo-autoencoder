CLASS Solution  
    FUNCTION exclusiveTime(n, logs)  
        SET exclusive_time TO a list of zero repeated n times  
        SET stack TO an empty list  
        
        FOR each log IN logs  
            SPLIT log BY colon INTO function_id, action, timestamp  
            SET function_id TO function_id converted to integer  
            SET timestamp TO timestamp converted to integer  
            
            IF action EQUALS "start"  
                IF stack is not empty  
                    SET prev_function_id TO first element of last element of stack  
                    SET prev_timestamp TO second element of last element of stack  
                    INCREMENT exclusive_time at position prev_function_id BY timestamp MINUS prev_timestamp  
                END IF  
                APPEND a pair of function_id and timestamp TO stack  
            ELSE  
                REMOVE last element FROM stack AND SET TO prev_function_id, prev_timestamp  
                INCREMENT exclusive_time at position prev_function_id BY timestamp MINUS prev_timestamp PLUS one  
                IF stack is not empty  
                    SET function_id_at_top TO first element of last element of stack  
                    SET new_timestamp TO timestamp PLUS one  
                    REPLACE last element of stack WITH pair of function_id_at_top and new_timestamp  
                END IF  
            END IF  
        END FOR  
        
        RETURN exclusive_time  
    END FUNCTION  
END CLASS