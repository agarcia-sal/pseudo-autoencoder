CLASS Solution  
    FUNCTION getCoprimes(nums, edges)  
        SET n TO the LENGTH OF nums  
        CALL build_tree WITH edges RETURNING tree  
        
        CALL initialize_coprime_matrix RETURNING coprime  
        
        SET result TO a list of n elements all SET TO negative one  
        SET ancestor_stack TO a list of 51 elements all SET TO None  
        
        FUNCTION dfs(node, parent, depth)  
            SET closest_ancestor TO negative one  
            SET max_depth TO negative one  
            FOR value FROM one TO fifty  
                IF the element at position node of nums IS coprime WITH value AND the element at position value of ancestor_stack IS NOT None  
                    SET anc_node TO the first element of the element at position value of ancestor_stack  
                    SET anc_depth TO the second element of the element at position value of ancestor_stack  
                    IF anc_depth GREATER THAN max_depth  
                        SET max_depth TO anc_depth  
                        SET closest_ancestor TO anc_node  
                    END IF  
                END IF  
            END FOR  
            SET the element at position node of result TO closest_ancestor  
            
            SET original_ancestor TO the element at position element at position node of nums of ancestor_stack  
            SET the element at position element at position node of nums of ancestor_stack TO a tuple of node and depth  
            
            FOR each child IN the element at position node of tree  
                IF child NOT EQUALS parent  
                    CALL dfs WITH child, node, depth PLUS one  
                END IF  
            END FOR  
            
            SET the element at position element at position node of nums of ancestor_stack TO original_ancestor  
        END FUNCTION  
        
        CALL dfs WITH zero, negative one, zero  
        
        RETURN result  
    END FUNCTION  
    
    FUNCTION build_tree(edges)  
        SET tree TO a new default dictionary with list as default value  
        FOR each edge_pair IN edges  
            SET u TO the first element of edge_pair  
            SET v TO the second element of edge_pair  
            APPEND v TO the element at position u of tree  
            APPEND u TO the element at position v of tree  
        END FOR  
        RETURN tree  
    END FUNCTION  
    
    FUNCTION initialize_coprime_matrix()  
        SET coprime TO a list of fifty-one elements each SET TO a list of fifty-one elements all SET TO False  
        FOR i FROM one TO fifty  
            FOR j FROM one TO fifty  
                SET gcd_value TO CALL gcd_function WITH i, j  
                IF gcd_value EQUALS one  
                    SET the element at position j of the element at position i of coprime TO True  
                ELSE  
                    SET the element at position j of the element at position i of coprime TO False  
                END IF  
            END FOR  
        END FOR  
        RETURN coprime  
    END FUNCTION  
    
    FUNCTION gcd_function(a, b)  
        WHILE b NOT EQUALS zero  
            SET temp TO b  
            SET b TO a MODULO b  
            SET a TO temp  
        END WHILE  
        RETURN a  
    END FUNCTION  
END CLASS