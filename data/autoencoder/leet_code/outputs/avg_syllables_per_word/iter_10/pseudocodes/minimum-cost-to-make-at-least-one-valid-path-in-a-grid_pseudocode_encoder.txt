CLASS Solution  
    FUNCTION minCost(grid)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero of grid  
        SET directions TO the LIST of four tuples representing zero and one, zero and minus one, one and zero, minus one and zero  
        SET costs TO a LIST of m elements where each element is a LIST of n elements set to infinity  
        SET element at position zero of element at position zero of costs TO zero  
        SET pq TO a LIST containing a tuple of zero, zero, zero  
        SET visited TO an empty SET  
        WHILE pq is not empty  
            SET cost and i and j TO the result of removing the smallest element from pq according to the first tuple element  
            IF the tuple of i and j IS IN visited  
                CONTINUE to the next iteration  
            END IF  
            ADD the tuple of i and j TO visited  
            IF i EQUALS m minus one AND j EQUALS n minus one  
                RETURN cost  
            END IF  
            FOR each k and tuple of di and dj IN the enumeration of directions  
                SET ni TO i PLUS di  
                SET nj TO j PLUS dj  
                IF ni IS GREATER THAN OR EQUAL TO zero AND ni IS LESS THAN m AND nj IS GREATER THAN OR EQUAL TO zero AND nj IS LESS THAN n  
                    SET new_cost TO cost PLUS one IF k PLUS one DOES NOT EQUAL element at position i of grid at position j ELSE zero  
                    IF new_cost IS LESS THAN element at position ni of costs at position nj  
                        SET element at position ni of costs at position nj TO new_cost  
                        INSERT the tuple of new_cost, ni, nj INTO pq maintaining heap property  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        RETURN minus one  
    END FUNCTION  
END CLASS