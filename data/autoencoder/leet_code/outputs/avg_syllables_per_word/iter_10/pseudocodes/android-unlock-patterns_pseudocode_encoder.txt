CLASS Solution  
    FUNCTION numberOfPatterns(m, n)  
        SET jumps TO a mapping with pairs as keys and corresponding intermediate points as values:  
            pair one and three TO two  
            pair one and seven TO four  
            pair one and nine TO five  
            pair two and eight TO five  
            pair three and one TO two  
            pair three and seven TO five  
            pair three and nine TO six  
            pair four and six TO five  
            pair five and five TO five  
            pair six and four TO five  
            pair seven and one TO four  
            pair seven and three TO five  
            pair seven and nine TO eight  
            pair eight and two TO five  
            pair nine and one TO five  
            pair nine and three TO six  
            pair nine and seven TO eight  
        
        FUNCTION countPatternsFromDot(current, visited, length)  
            IF length EQUALS n  
                RETURN one  
            END IF  
            IF length GREATER THAN OR EQUAL TO m  
                SET count TO one  
            ELSE  
                SET count TO zero  
            END IF  
            FOR next_dot FROM one TO nine  
                IF visited element at position next_dot IS false  
                    SET jump TO jumps value at pair current and next_dot IF EXISTS  
                    IF jump DOES NOT EXIST OR visited element at position jump IS true  
                        SET visited element at position next_dot TO true  
                        SET count TO count PLUS countPatternsFromDot(next_dot, visited, length PLUS one)  
                        SET visited element at position next_dot TO false  
                    END IF  
                END IF  
            END FOR  
            RETURN count  
        END FUNCTION  
        
        SET visited TO a list of false repeated ten times  
        SET result TO zero  
        FOR i FROM one TO nine  
            SET visited element at position i TO true  
            SET result TO result PLUS countPatternsFromDot(i, visited, one)  
            SET visited element at position i TO false  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS