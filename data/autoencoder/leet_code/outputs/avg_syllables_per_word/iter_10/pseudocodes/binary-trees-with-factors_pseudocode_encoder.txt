CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MOD TO one billion PLUS seven  
        SORT arr  
        SET dp TO a mapping from each element num in arr TO one  
        
        FOR index i FROM zero TO the LENGTH OF arr MINUS one  
            SET num TO element at position i of arr  
            FOR index j FROM zero TO i MINUS one  
                SET potential_factor TO element at position j of arr  
                IF num MODULO potential_factor EQUALS zero  
                    SET right_child TO num DIVIDED BY potential_factor  
                    IF right_child IS IN dp  
                        SET dp at key num TO dp at key num PLUS dp at key potential_factor MULTIPLIED BY dp at key right_child  
                        SET dp at key num TO dp at key num MODULO MOD  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        
        SET total_trees TO the SUM OF all VALUES in dp  
        RETURN total_trees MODULO MOD  
    END FUNCTION  
END CLASS