CLASS Solution  
    FUNCTION minNumberOfSemesters(n, relations, k)  
        INITIALIZE graph AS a new dictionary with default empty list values  
        INITIALIZE in_degree AS a list of zeros of length n PLUS one  
        FOR each pair prevCourse and nextCourse IN relations  
            APPEND nextCourse TO the list at graph with key prevCourse  
            INCREMENT the element at position nextCourse of in_degree BY one  
        END FOR  
        INITIALIZE queue AS a new empty double-ended queue  
        FOR course FROM one TO n  
            IF the element at position course of in_degree EQUALS zero  
                APPEND course TO queue  
            END IF  
        END FOR  
        SET semesters TO zero  
        WHILE queue IS NOT EMPTY  
            SET limit TO the smaller value of k AND the length of queue  
            FOR index FROM one TO limit  
                SET current_course TO the removal of first element FROM queue  
                FOR each next_course IN graph at key current_course  
                    DECREMENT the element at position next_course of in_degree BY one  
                    IF the element at position next_course of in_degree EQUALS zero  
                        APPEND next_course TO queue  
                    END IF  
                END FOR  
            END FOR  
            INCREMENT semesters BY one  
        END WHILE  
        RETURN semesters  
    END FUNCTION  
END CLASS