CLASS Solution  
    FUNCTION dieSimulator(n, rollMax)  
        SET MOD TO one billion PLUS seven  
        SET dp TO a three-dimensional collection of zeroes with dimensions n PLUS one, six, and the maximum value in rollMax PLUS one  
        
        FOR j FROM zero TO five  
            SET the element at position one of dp at position one and j TO one  
        END FOR  
        
        FOR i FROM two TO n  
            FOR j FROM zero TO five  
                FOR k FROM one TO the element at position j of rollMax  
                    IF k GREATER THAN one  
                        SET dp at position i, j, k TO dp at position i MINUS one, j, k MINUS one  
                    ELSE  
                        SET dp at position i, j, k TO zero  
                        FOR x FROM zero TO five  
                            IF x NOT EQUALS j  
                                FOR y FROM one TO the element at position x of rollMax  
                                    INCREMENT dp at position i, j, k BY dp at position i MINUS one, x, y  
                                END FOR  
                            END IF  
                        END FOR  
                        SET dp at position i, j, k TO dp at position i, j, k MODULO MOD  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        SET result TO zero  
        FOR j FROM zero TO five  
            FOR k FROM one TO the element at position j of rollMax  
                INCREMENT result BY dp at position n, j, k  
            END FOR  
        END FOR  
        
        RETURN result MODULO MOD  
    END FUNCTION  
END CLASS