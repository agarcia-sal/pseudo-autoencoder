CLASS Solution  
    FUNCTION hasValidPath(grid)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero of grid  
        
        IF the SUM of m PLUS n MINUS one MODULO two NOT EQUALS zero  
            RETURN False  
        END IF  
        
        CALL dp INITIALIZED BY call initialize_dp WITH m PLUS one AND n PLUS one AND m PLUS n PLUS one  
        
        SET element at position zero of element at position one of dp TO True  
        
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                FOR k FROM zero TO m PLUS n  
                    IF element at position i of element at position j PLUS one of dp AT position k OR element at position i PLUS one of element at position j of dp AT position k  
                        IF element at position i of element at position j of grid EQUALS opening parenthesis  
                            IF k PLUS one LESS THAN m PLUS n PLUS one  
                                SET element at position i PLUS one of element at position j PLUS one of dp AT position k PLUS one TO True  
                            END IF  
                        ELSE IF element at position i of element at position j of grid EQUALS closing parenthesis  
                            IF k MINUS one GREATER THAN OR EQUAL TO zero  
                                SET element at position i PLUS one of element at position j PLUS one of dp AT position k MINUS one TO True  
                            END IF  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        RETURN element at position m of element at position n of dp AT position zero  
    END FUNCTION  
    
    FUNCTION initialize_dp(rows, columns, depth)  
        SET result TO empty list  
        FOR index_rows FROM zero TO rows MINUS one  
            SET current_row TO empty list  
            FOR index_columns FROM zero TO columns MINUS one  
                SET current_column TO empty list  
                FOR index_depth FROM zero TO depth MINUS one  
                    APPEND False TO current_column  
                END FOR  
                APPEND current_column TO current_row  
            END FOR  
            APPEND current_row TO result  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS