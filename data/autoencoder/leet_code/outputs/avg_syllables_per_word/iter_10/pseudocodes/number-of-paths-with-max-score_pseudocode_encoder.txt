CLASS Solution
    FUNCTION pathsWithMaxScore(board)
        SET MOD TO one billion PLUS seven
        SET n TO the LENGTH OF board

        CALL initialize dp WITH n AS PARAMETER
        SET dp element at position n MINUS one AND n MINUS one TO list containing zero AND one

        FOR i FROM n MINUS one DOWN TO zero
            FOR j FROM n MINUS one DOWN TO zero
                IF element at position i AND j of board EQUALS element in the set containing character X OR character S
                    CONTINUE to next iteration of inner loop
                END IF

                IF element at position i AND j of board EQUALS character E
                    SET value TO zero
                ELSE
                    SET value TO integer conversion of element at position i AND j of board
                END IF

                FOR each pair (x, y) IN collection containing pair one AND zero, pair zero AND one, pair one AND one
                    SET ni TO i PLUS x
                    SET nj TO j PLUS y

                    IF ni GREATER THAN OR EQUAL TO zero AND ni LESS THAN n AND nj GREATER THAN OR EQUAL TO zero AND nj LESS THAN n
                        IF first element of dp element at position ni AND nj GREATER THAN first element of dp element at position i AND j
                            SET dp element at position i AND j TO list containing first element of dp element at position ni AND nj PLUS value AND second element of dp element at position ni AND nj
                        ELSE IF first element of dp element at position ni AND nj EQUALS first element of dp element at position i AND j
                            SET second element of dp element at position i AND j TO the SUM of second element of dp element at position i AND j AND second element of dp element at position ni AND nj MODULO MOD
                        END IF
                    END IF
                END FOR
            END FOR
        END FOR

        IF first element of dp element at position zero AND zero EQUALS negative infinity
            RETURN list containing zero AND zero
        END IF

        RETURN list containing first element of dp element at position zero AND zero AND second element of dp element at position zero AND zero
    END FUNCTION

    FUNCTION initialize dp WITH n
        CREATE dp AS list containing n elements where each element is a list containing n elements where each element is list containing negative infinity AND zero
    END FUNCTION
END CLASS