CLASS Solution  
    FUNCTION shortestPathAllKeys(grid)  
        SET directions TO list consisting of pair zero and one and pair zero and negative one and pair one and zero and pair negative one and zero  
        SET m TO LENGTH OF grid  
        SET n TO LENGTH OF element at position zero of grid  
        SET start TO None  
        SET num_keys TO zero  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF element at position i of grid at position j EQUALS character at symbol at sign THEN  
                    SET start TO pair i and j  
                ELSE IF character at element at position i of grid at position j IS LOWERCASE LETTER THEN  
                    INCREMENT num_keys BY one  
                END IF  
            END FOR  
        END FOR  
        SET queue TO a new double ended queue initialized with the quadruple consisting of first element of start second element of start zero zero  
        SET visited TO a new set initialized with the triple consisting of first element of start second element of start zero  
        WHILE queue IS NOT empty  
            REMOVE first element from queue AND ASSIGN TO x y keys steps  
            FOR each pair dx dy IN directions  
                SET nx TO x PLUS dx  
                SET ny TO y PLUS dy  
                IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n THEN  
                    SET cell TO element at position nx of grid at position ny  
                    IF cell EQUALS hash sign THEN  
                        CONTINUE TO next iteration of the FOR loop  
                    END IF  
                    IF cell IS UPPERCASE LETTER THEN  
                        SET key_needed TO one SHIFT LEFT BY ordinal number of lowercase equivalent of cell MINUS ordinal number of letter a  
                        IF keys BITWISE AND key_needed EQUALS zero THEN  
                            CONTINUE TO next iteration of the FOR loop  
                        END IF  
                    END IF  
                    IF cell IS LOWERCASE LETTER THEN  
                        SET new_keys TO keys BITWISE OR one SHIFT LEFT BY ordinal number of cell MINUS ordinal number of letter a  
                        IF new_keys EQUALS one SHIFT LEFT BY num_keys MINUS one THEN  
                            RETURN steps PLUS one  
                        END IF  
                    ELSE  
                        SET new_keys TO keys  
                    END IF  
                    IF the triple consisting of nx ny new_keys IS NOT IN visited THEN  
                        ADD the triple consisting of nx ny new_keys TO visited  
                        APPEND the quadruple consisting of nx ny new_keys steps PLUS one TO queue  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        RETURN negative one  
    END FUNCTION  
END CLASS