CLASS Solution  
    FUNCTION kthSmallest(mat, k)  
        SET m TO the LENGTH OF mat  
        SET n TO the LENGTH OF element at position zero of mat  
        SET min_heap TO a list containing one element which is a pair of  
            the SUM OF element at position zero of each row in mat AND  
            a tuple of zeros with the count equal to m  
        SET visited TO a set containing the tuple of zeros from min_heap element at position zero at position one  
        
        WHILE k GREATER THAN zero holds  
            EXTRACT the element with the smallest current sum and indices from min_heap  
            DECREMENT k BY one  
            
            IF k EQUALS zero THEN  
                RETURN the current sum  
            END IF  
            
            FOR i FROM zero TO m MINUS one  
                IF the element at position i of indices PLUS one LESS THAN n THEN  
                    SET new_indices TO a list copy of indices  
                    INCREMENT element at position i of new_indices BY one  
                    SET new_indices_tuple TO a tuple from new_indices  
                    SET new_sum TO current sum MINUS element at position i at position indices at position i of mat PLUS element at position i at position new_indices at position i of mat  
                    
                    IF new_indices_tuple is not in visited THEN  
                        ADD new_indices_tuple TO visited  
                        INSERT the pair of new_sum AND new_indices_tuple INTO min_heap maintaining heap property  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN minus one  
    END FUNCTION  
END CLASS