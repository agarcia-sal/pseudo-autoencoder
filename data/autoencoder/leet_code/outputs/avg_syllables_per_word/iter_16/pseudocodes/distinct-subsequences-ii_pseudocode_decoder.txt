CLASS Solution  
    FUNCTION distinctSubseqII(s)  
        SET MODULO TO one billion PLUS seven  
        SET n TO the LENGTH OF s  
        SET dp TO a list of zeros with the LENGTH EQUAL TO n PLUS one  
        SET element at position zero of dp TO one  
        SET last TO an empty dictionary  
        
        FOR index FROM one TO n  
            SET character TO element at position index MINUS one of s  
            SET element at position index of dp TO the element at position index MINUS one of dp MULTIPLIED BY two  
            SET element at position index of dp TO the remainder when element at position index of dp is DIVIDED BY MODULO  
            
            IF character IS a key in last  
                SET element at position index of dp TO element at position index of dp MINUS element at position last of character MINUS one of dp PLUS MODULO  
                SET element at position index of dp TO the remainder when element at position index of dp is DIVIDED BY MODULO  
            END IF  
            
            SET last of character TO index  
        END FOR  
        
        SET result TO element at position n of dp MINUS one  
        SET result TO the remainder when result is DIVIDED BY MODULO  
        RETURN result  
    END FUNCTION  
END CLASS