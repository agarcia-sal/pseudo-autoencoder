CLASS Solution  
    FUNCTION medianSlidingWindow(nums WITH TYPE List of integers, k WITH TYPE integer) RETURNS List of floats  
        SET lo TO empty list for maximum heap with inverted values  
        SET hi TO empty list for minimum heap  
          
        FUNCTION balance_heaps()  
            IF the LENGTH OF lo IS GREATER THAN the LENGTH OF hi PLUS one THEN  
                REMOVE the element from lo with the highest priority and MULTIPLY it BY negative one  
                ADD this value TO hi maintaining heap order  
            ELSE IF the LENGTH OF hi IS GREATER THAN the LENGTH OF lo THEN  
                REMOVE the element from hi with the highest priority  
                MULTIPLY it BY negative one  
                ADD this value TO lo maintaining heap order  
            END IF  
        END FUNCTION  
          
        FUNCTION add_num(num)  
            IF lo IS empty OR num IS LESS THAN OR EQUAL TO the negative of the element at position zero of lo THEN  
                ADD the negative of num TO lo maintaining heap order  
            ELSE  
                ADD num TO hi maintaining heap order  
            END IF  
            CALL balance_heaps()  
        END FUNCTION  
          
        FUNCTION remove_num(num)  
            IF num IS LESS THAN OR EQUAL TO the negative of the element at position zero of lo THEN  
                REMOVE the negative of num FROM lo  
                IF lo IS NOT empty THEN  
                    REBUILD lo INTO a heap structure  
                END IF  
            ELSE  
                REMOVE num FROM hi  
                IF hi IS NOT empty THEN  
                    REBUILD hi INTO a heap structure  
                END IF  
            END IF  
            CALL balance_heaps()  
        END FUNCTION  
          
        FUNCTION get_median() RETURNS float  
            IF the LENGTH OF lo IS GREATER THAN the LENGTH OF hi THEN  
                RETURN the negative of the element at position zero of lo  
            ELSE  
                CALCULATE the sum of the negative of the element at position zero of lo PLUS the element at position zero of hi  
                DIVIDE this sum BY two  
                RETURN the result  
            END IF  
        END FUNCTION  
          
        FOR index FROM zero TO k MINUS one DO  
            CALL add_num WITH the element at position index of nums  
        END FOR  
          
        SET medians TO a list containing the result of get_median()  
          
        FOR index FROM k TO the LENGTH OF nums MINUS one DO  
            CALL add_num WITH the element at position index of nums  
            CALL remove_num WITH the element at position index MINUS k of nums  
            APPEND the result of get_median() TO medians  
        END FOR  
          
        RETURN medians  
    END FUNCTION  
END CLASS