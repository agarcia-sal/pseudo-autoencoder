CLASS Solution  
    FUNCTION maskPII WITH PARAMETER s  
        IF the character at any position in s EQUALS at symbol  
            SET local and domain TO the two parts of s SPLIT AT the position of at symbol  
            SET masked_local TO concatenation of the character at first position of local, five repetitions of the character asterisk, and the character at last position of local  
            SET result TO concatenation of masked_local CONVERTED TO lowercase, at symbol, and domain CONVERTED TO lowercase  
            RETURN result  
        ELSE  
            SET digits TO concatenation of all characters in s FOR WHICH the character is a digit  
            SET local_number TO concatenation of three asterisks, dash, three asterisks, dash, and the last four characters of digits  
            IF the LENGTH OF digits EQUALS ten  
                RETURN local_number  
            ELSE  
                SET country_code_length TO the LENGTH OF digits MINUS ten  
                SET country_code TO concatenation of plus symbol, asterisk REPEATED country_code_length times, and dash  
                SET result TO concatenation of country_code and local_number  
                RETURN result  
            END IF  
        END IF  
    END FUNCTION  
END CLASS