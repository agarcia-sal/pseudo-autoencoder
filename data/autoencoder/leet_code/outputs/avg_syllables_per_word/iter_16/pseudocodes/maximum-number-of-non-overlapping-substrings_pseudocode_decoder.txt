CLASS Solution  
    FUNCTION maxNumOfSubstrings(s)  
        SET first TO an empty mapping from character TO integer  
        SET last TO an empty mapping from character TO integer  
        FOR each position index and character c IN s with index starting from zero  
            IF character c is not present as a key in first  
                SET the value at key character c of mapping first TO position index  
            END IF  
            SET the value at key character c of mapping last TO position index  
        END FOR  

        SET intervals TO an empty list  
        FOR each character c IN the keys of mapping first  
            SET start TO the value at key character c of mapping first  
            SET end TO the value at key character c of mapping last  
            SET i TO start  
            WHILE i is less than or equal to end  
                IF the value at key character s element at position i of string s in mapping first is less than start  
                    BREAK the WHILE loop  
                END IF  
                SET end TO the GREATER THAN OR EQUAL TO maximum of end AND the value at key character s element at position i of string s in mapping last  
                INCREMENT i BY one  
            END WHILE  
            IF the WHILE loop was not broken prematurely  
                APPEND the pair consisting of start and end TO intervals  
            END IF  
        END FOR  

        SORT intervals in order of ascending value of the second element of each pair  

        SET result TO an empty list  
        SET prev_end TO negative one  
        FOR each pair start and end IN intervals  
            IF start is greater than prev_end  
                APPEND the substring from position start TO position end inclusive of string s TO result  
                SET prev_end TO end  
            END IF  
        END FOR  

        RETURN result  
    END FUNCTION  
END CLASS