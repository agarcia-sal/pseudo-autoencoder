CLASS UnionFind  
    FUNCTION __init__ (size)  
        SET root TO a new list created by assigning each position from zero TO size MINUS one  
        SET rank TO a new list where each element is one repeated size times  
    END FUNCTION  

    FUNCTION find (x)  
        IF element at position x of root EQUALS x THEN  
            RETURN x  
        END IF  
        SET element at position x of root TO the result of calling find with element at position x of root  
        RETURN element at position x of root  
    END FUNCTION  

    FUNCTION union (x, y)  
        SET rootX TO result of calling find with x  
        SET rootY TO result of calling find with y  
        IF rootX NOT EQUALS rootY THEN  
            IF element at position rootX of rank GREATER THAN element at position rootY of rank THEN  
                SET element at position rootY of root TO rootX  
            ELSE IF element at position rootX of rank LESS THAN element at position rootY of rank THEN  
                SET element at position rootX of root TO rootY  
            ELSE  
                SET element at position rootY of root TO rootX  
                INCREMENT element at position rootX of rank BY one  
            END IF  
        END IF  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION accountsMerge (accounts)  
        SET email_to_id TO an empty mapping from string TO integer  
        SET uf TO a new UnionFind object initialized with the length of accounts  

        FOR each index i and a tuple where the first element is discarded and the rest assigned TO emails IN the enumeration of accounts  
            FOR each email IN emails  
                IF email NOT IN email_to_id THEN  
                    SET element at key email of email_to_id TO i  
                ELSE  
                    CALL union on uf with arguments i and element at key email of email_to_id  
                END IF  
            END FOR  
        END FOR  

        SET merged_emails TO a new mapping from integer TO list of strings with default empty list  

        FOR each email and account_id IN email_to_id  
            SET root_id TO result of calling find on uf with account_id  
            APPEND email TO element at key root_id of merged_emails  
        END FOR  

        SET result TO an empty list  
        FOR each account_id and emails IN merged_emails  
            SET name TO the element at position zero of element at position account_id of accounts  
            APPEND a new list created by concatenating name and the result of sorting emails to result  
        END FOR  

        RETURN result  
    END FUNCTION  
END CLASS