CLASS Solution  
    FUNCTION largestPathValue(colors, edges)  
        SET n TO the LENGTH OF colors  
        SET graph TO a new mapping of default empty list  
        SET in_degree TO a new list of zero repeated n times  
        
        FOR each pair u v IN edges  
            APPEND v TO element at position u of graph  
            INCREMENT element at position v of in_degree BY one  
        END FOR  
        
        SET queue TO a new double-ended queue with elements being all indices i FROM zero TO n MINUS one where element at position i of in_degree EQUALS zero  
        SET dp TO a new list of length n each containing a new list of length twenty six filled with zero  
        SET visited TO zero  
        SET max_color_value TO zero  
        
        WHILE queue is not empty  
            REMOVE the element from the front of queue and ASSIGN IT TO node  
            INCREMENT element at position (the ASCII code of element at position node of colors MINUS the ASCII code of lowercase letter a) of element at position node of dp BY one  
            SET max_color_value TO the maximum of max_color_value AND element at position (the ASCII code of element at position node of colors MINUS the ASCII code of lowercase letter a) of element at position node of dp  
            INCREMENT visited BY one  
            
            FOR each neighbor IN element at position node of graph  
                FOR c FROM zero TO twenty five  
                    SET element at position c of element at position neighbor of dp TO the maximum of element at position c of element at position neighbor of dp AND element at position c of element at position node of dp  
                END FOR  
                DECREMENT element at position neighbor of in_degree BY one  
                IF element at position neighbor of in_degree EQUALS zero  
                    APPEND neighbor TO queue  
                END IF  
            END FOR  
        END WHILE  
        
        IF visited EQUALS n  
            RETURN max_color_value  
        ELSE  
            RETURN negative one  
        END IF  
    END FUNCTION  
END CLASS