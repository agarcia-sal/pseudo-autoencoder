CLASS Solution  
    FUNCTION lenLongestFibSubseq WITH PARAMETER arr  
        SET index TO an empty mapping FROM numbers TO their positions  
        FOR each position i AND each element x IN arr  
            MAP x TO i IN index  
        END FOR  
        
        SET dp TO an empty mapping FROM pairs OF positions TO lengths  
        SET max_length TO zero  
        
        FOR each position k FROM zero TO the LENGTH OF arr MINUS one  
            FOR each position j FROM zero TO k MINUS one  
                SET difference TO element at position k OF arr MINUS element at position j OF arr  
                SET i TO the value MAPPED BY difference IN index OR negative one IF NOT FOUND  
                IF i IS GREATER THAN OR EQUAL TO zero AND i IS LESS THAN j THEN  
                    SET previous_length TO the value MAPPED BY the pair of i AND j IN dp OR two IF NOT FOUND  
                    SET dp MAPPED BY the pair j AND k TO previous_length PLUS one  
                    SET max_length TO the GREATER OF max_length AND the value MAPPED BY the pair j AND k IN dp  
                END IF  
            END FOR  
        END FOR  
        
        IF max_length IS GREATER THAN OR EQUAL TO three THEN  
            RETURN max_length  
        ELSE  
            RETURN zero  
        END IF  
    END FUNCTION  
END CLASS