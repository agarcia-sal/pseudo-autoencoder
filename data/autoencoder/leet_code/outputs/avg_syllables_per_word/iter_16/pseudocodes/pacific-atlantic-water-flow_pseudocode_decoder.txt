CLASS Solution  
    FUNCTION pacificAtlantic WITH parameter heights  
        FUNCTION bfs WITH parameters queue AND visited_set  
            WHILE queue is not empty  
                FOR each element in a sequence of the LENGTH OF queue  
                    ASSIGN i TO element at position zero of queue DEQUEUED  
                    ASSIGN j TO element at position one of queue DEQUEUED  
                    FOR each pair a and b IN list of pairs zero MINUS one zero one one zero MINUS one zero  
                        SET x TO i PLUS a  
                        SET y TO j PLUS b  
                        IF x IS GREATER THAN OR EQUAL TO zero AND x IS LESS THAN m AND y IS GREATER THAN OR EQUAL TO zero AND y IS LESS THAN n AND pair x and y IS NOT IN visited_set AND element at position x and y of heights IS GREATER THAN OR EQUAL TO element at position i and j of heights  
                            ADD pair x and y TO visited_set  
                            APPEND pair x and y TO queue  
                        END IF  
                    END FOR  
                END FOR  
            END WHILE  
        END FUNCTION  

        SET m TO LENGTH OF heights  
        SET n TO LENGTH OF element at position zero of heights  
        INITIALIZE visited_set_one AS empty set  
        INITIALIZE visited_set_two AS empty set  
        INITIALIZE queue_one AS empty double ended queue  
        INITIALIZE queue_two AS empty double ended queue  

        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF i EQUALS zero OR j EQUALS zero  
                    ADD pair i and j TO visited_set_one  
                    APPEND pair i and j TO queue_one  
                END IF  
                IF i EQUALS m MINUS one OR j EQUALS n MINUS one  
                    ADD pair i and j TO visited_set_two  
                    APPEND pair i and j TO queue_two  
                END IF  
            END FOR  
        END FOR  

        CALL bfs WITH queue_one AND visited_set_one  
        CALL bfs WITH queue_two AND visited_set_two  

        INITIALIZE result_list AS empty list  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                IF pair i and j IS IN visited_set_one AND pair i and j IS IN visited_set_two  
                    APPEND pair i and j TO result_list  
                END IF  
            END FOR  
        END FOR  
        RETURN result_list  
    END FUNCTION  
END CLASS