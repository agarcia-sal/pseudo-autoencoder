CLASS Solution  
    FUNCTION confusingNumberII(n)  
        SET rotate_map TO a mapping from digit zero TO zero digit one TO one digit six TO nine digit eight TO eight digit nine TO six  
        SET valid_digits TO the list zero one six eight nine  
        
        FUNCTION is_confusing(num)  
            SET original_num TO num  
            SET rotated_num TO zero  
            WHILE num IS GREATER THAN zero  
                SET digit TO the remainder of num DIVIDED BY ten  
                SET rotated_num TO rotated_num MULTIPLIED BY ten PLUS the element at position digit of rotate_map  
                SET num TO the quotient of num DIVIDED BY ten  
            END WHILE  
            RETURN rotated_num IS NOT EQUAL TO original_num  
        END FUNCTION  
        
        FUNCTION count_confusing_numbers(limit, current EQUALS zero)  
            IF current IS GREATER THAN limit  
                RETURN zero  
            END IF  
            SET count TO one IF current IS NOT EQUAL TO zero AND is_confusing(current) HOLDS, OTHERWISE zero  
            FOR each digit IN valid_digits  
                SET new_number TO current MULTIPLIED BY ten PLUS digit  
                IF new_number IS EQUAL TO zero  
                    CONTINUE TO the next iteration  
                END IF  
                INCREMENT count BY count_confusing_numbers(limit, new_number)  
            END FOR  
            RETURN count  
        END FUNCTION  
        
        RETURN count_confusing_numbers(n)  
    END FUNCTION  
END CLASS