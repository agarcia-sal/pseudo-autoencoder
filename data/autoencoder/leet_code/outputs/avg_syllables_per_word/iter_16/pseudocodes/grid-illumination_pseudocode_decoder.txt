CLASS Solution  
    FUNCTION gridIllumination(n, lamps, queries)  
        SET row_count TO a default dictionary mapping integers to zero  
        SET col_count TO a default dictionary mapping integers to zero  
        SET diag_count TO a default dictionary mapping integers to zero representing row minus column  
        SET anti_diag_count TO a default dictionary mapping integers to zero representing row plus column  
        SET lamp_positions TO an empty set representing positions of turned on lamps  

        FOR each pair r and c IN lamps  
            IF the pair r and c is not IN lamp_positions  
                ADD the pair r and c TO lamp_positions  
                INCREMENT the value at key r IN row_count BY one  
                INCREMENT the value at key c IN col_count BY one  
                INCREMENT the value at key corresponding to r MINUS c IN diag_count BY one  
                INCREMENT the value at key corresponding to r PLUS c IN anti_diag_count BY one  
            END IF  
        END FOR  

        SET directions TO a list of nine pairs representing all adjacent positions including the center position  
        SET result TO an empty list  

        FOR each pair r and c IN queries  
            IF the value at key r IN row_count IS GREATER THAN zero OR the value at key c IN col_count IS GREATER THAN zero OR the value at key corresponding to r MINUS c IN diag_count IS GREATER THAN zero OR the value at key corresponding to r PLUS c IN anti_diag_count IS GREATER THAN zero  
                APPEND one TO result  
            ELSE  
                APPEND zero TO result  
            END IF  

            FOR each pair dr and dc IN directions  
                SET nr TO r PLUS dr  
                SET nc TO c PLUS dc  
                IF the pair nr and nc IS IN lamp_positions  
                    REMOVE the pair nr and nc FROM lamp_positions  
                    DECREMENT the value at key nr IN row_count BY one  
                    DECREMENT the value at key nc IN col_count BY one  
                    DECREMENT the value at key corresponding to nr MINUS nc IN diag_count BY one  
                    DECREMENT the value at key corresponding to nr PLUS nc IN anti_diag_count BY one  
                END IF  
            END FOR  
        END FOR  

        RETURN result  
    END FUNCTION  
END CLASS