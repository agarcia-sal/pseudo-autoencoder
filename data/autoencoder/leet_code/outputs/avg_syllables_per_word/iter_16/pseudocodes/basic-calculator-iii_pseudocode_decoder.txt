CLASS Solution  
    FUNCTION calculate WITH PARAMETER s  
        FUNCTION helper WITH PARAMETER s_list  
            SET stack TO an empty list  
            SET num TO zero  
            SET sign TO the character plus  
            WHILE the LENGTH OF s_list IS GREATER THAN zero  
                SET char TO the element at position zero of s_list  
                REMOVE the element at position zero FROM s_list  
                IF char IS a digit  
                    SET num TO num MULTIPLIED BY ten PLUS the integer value of char  
                END IF  
                IF char EQUALS the character left parenthesis  
                    SET num TO the result of calling helper WITH PARAMETER s_list  
                END IF  
                IF char IS one of the characters plus or minus or multiply or divide or left parenthesis or right parenthesis OR the LENGTH OF s_list EQUALS zero  
                    IF sign EQUALS the character plus  
                        APPEND num TO stack  
                    ELSE IF sign EQUALS the character minus  
                        APPEND negative num TO stack  
                    ELSE IF sign EQUALS the character multiply  
                        SET the element at the last position of stack TO the element at the last position of stack MULTIPLIED BY num  
                    ELSE IF sign EQUALS the character divide  
                        SET the element at the last position of stack TO the integer value of the element at the last position of stack DIVIDED BY num with truncation towards zero  
                    END IF  
                    SET sign TO char  
                    SET num TO zero  
                END IF  
                IF char EQUALS the character right parenthesis  
                    BREAK the WHILE loop  
                END IF  
            END WHILE  
            RETURN the sum of all elements in stack  
        END FUNCTION  
        
        SET s TO the list of characters of the string s  
        RETURN the result of calling helper WITH PARAMETER s  
    END FUNCTION  
END CLASS