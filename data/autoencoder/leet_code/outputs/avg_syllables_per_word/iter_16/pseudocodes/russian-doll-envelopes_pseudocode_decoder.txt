CLASS Solution  
    FUNCTION maxEnvelopes(envelopes)  
        CALL sort envelopes BY width IN ASCENDING ORDER AND BY height IN DESCENDING ORDER WHEN widths ARE EQUAL  
        SET dp TO an empty list  
        FOR each underscore comma height IN envelopes  
            SET index TO the position found by binary searching dp for height WHERE height can be inserted to maintain sorted order  
            IF index EQUALS the LENGTH OF dp  
                APPEND height TO dp  
            ELSE  
                SET element at position index OF dp TO height  
            END IF  
        END FOR  
        RETURN the LENGTH OF dp  
    END FUNCTION  
END CLASS