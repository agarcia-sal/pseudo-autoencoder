CLASS Solution  
    FUNCTION nthSuperUglyNumber(n, primes)  
        SET ugly_numbers TO a list containing the number one  
        SET heap TO a list of pairs each containing the element at position i of primes and the index i for each index i and element p in primes  
        CONVERT heap INTO a heap structure maintaining the heap property  
        SET indices TO a list of zeros with the length equal to the length of primes  
        WHILE the length of ugly_numbers is less than n  
            REMOVE and RETURN the smallest pair from heap and ASSIGN to next_ugly and prime_index  
            IF next_ugly does not equal the last element of ugly_numbers  
                APPEND next_ugly TO ugly_numbers  
            END IF  
            INCREMENT the element at position prime_index of indices BY one  
            SET next_multiple TO the element at position prime_index of primes MULTIPLIED BY the element at position element at position prime_index of indices of ugly_numbers  
            ADD next_multiple and prime_index as a pair INTO heap maintaining the heap property  
        END WHILE  
        RETURN the last element of ugly_numbers  
    END FUNCTION  
END CLASS