CLASS Solution  
    FUNCTION numWays(words AS List OF String, target AS String) RETURNS Integer  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF element at position zero of words  
        SET m TO the LENGTH OF target  
        
        CREATE a list named freq of length n where each element is a mapping from character TO integer defaulting to zero  
        
        FOR each word IN words  
            FOR each position j AND character char IN word  
                INCREMENT the value mapped by character char in the element at position j of freq BY one  
            END FOR  
        END FOR  
        
        CREATE a two-dimensional list dp with dimensions m PLUS one BY n PLUS one with all elements initialized TO zero  
        
        FOR each index j FROM zero TO n  
            SET the element at row zero column j of dp TO one  
        END FOR  
        
        FOR each index i FROM one TO m  
            FOR each index j FROM one TO n  
                SET the element at row i column j of dp TO the value of the element at row i column j MINUS one of dp  
                
                IF the value mapped by character at position i MINUS one of target in the element at position j MINUS one of freq is GREATER THAN zero  
                    INCREMENT the element at row i column j of dp BY the product of the element at row i MINUS one column j MINUS one of dp AND the value mapped by character at position i MINUS one of target in the element at position j MINUS one of freq  
                    SET the element at row i column j of dp TO the remainder of its value DIVIDED BY MOD  
                END IF  
            END FOR  
        END FOR  
        
        RETURN the element at row m column n of dp  
    END FUNCTION  
END CLASS