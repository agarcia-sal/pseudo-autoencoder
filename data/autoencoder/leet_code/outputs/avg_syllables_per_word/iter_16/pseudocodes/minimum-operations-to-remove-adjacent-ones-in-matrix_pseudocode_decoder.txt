CLASS Solution  
    FUNCTION minimumOperations(grid)  
        FUNCTION bfs()  
            SET queue TO a new double ended queue  
            FOR u FROM zero TO n MINUS one  
                IF match element at position u EQUALS minus one  
                    SET dist element at position u TO zero  
                    APPEND u TO queue  
                ELSE  
                    SET dist element at position u TO infinity  
                END IF  
            END FOR  
            SET dist element at position minus one TO infinity  
            WHILE queue IS NOT empty  
                REMOVE and GET element from the left of queue INTO u  
                IF dist element at position u LESS THAN dist element at position minus one  
                    FOR each v IN collection of graph element at position u  
                        IF dist element at position match element at position v EQUALS infinity  
                            SET dist element at position match element at position v TO dist element at position u PLUS one  
                            APPEND match element at position v TO queue  
                        END IF  
                    END FOR  
                END IF  
            END WHILE  
            RETURN result of condition dist element at position minus one LESS THAN infinity  
        END FUNCTION  
        
        FUNCTION dfs(u)  
            IF u NOT EQUALS minus one  
                FOR each v IN collection of graph element at position u  
                    IF dist element at position match element at position v EQUALS dist element at position u PLUS one  
                        IF dfs call with argument match element at position v RETURNS true  
                            SET match element at position v TO u  
                            SET match element at position u TO v  
                            RETURN true  
                        END IF  
                    END IF  
                END FOR  
                SET dist element at position u TO infinity  
                RETURN false  
            END IF  
            RETURN true  
        END FUNCTION  
        
        SET rows TO the LENGTH OF grid  
        SET cols TO the LENGTH OF element at position zero in grid  
        SET n TO rows MULTIPLIED BY cols  
        SET graph TO a list of new empty sets repeated n PLUS one times  
        SET match TO a list filled with minus one repeated n PLUS one times  
        SET dist TO a list filled with zero repeated n PLUS one times  
        
        FOR r FROM zero TO rows MINUS one  
            FOR c FROM zero TO cols MINUS one  
                IF element at position r of grid element at position c EQUALS one  
                    SET u TO r MULTIPLIED BY cols PLUS c  
                    FOR each dr and dc IN the collection of pairs of minus one and zero, one and zero, zero and minus one, zero and one  
                        SET nr TO r PLUS dr  
                        SET nc TO c PLUS dc  
                        IF nr GREATER THAN OR EQUAL TO zero AND nr LESS THAN rows AND nc GREATER THAN OR EQUAL TO zero AND nc LESS THAN cols AND element at position nr of grid element at position nc EQUALS one  
                            SET v TO nr MULTIPLIED BY cols PLUS nc  
                            ADD v TO the set at graph element at position u  
                        END IF  
                    END FOR  
                END IF  
            END FOR  
        END FOR  
        
        SET matching TO zero  
        WHILE result of bfs call RETURNS true  
            FOR u FROM zero TO n MINUS one  
                IF match element at position u EQUALS minus one AND dfs call with argument u RETURNS true  
                    INCREMENT matching BY one  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN matching  
    END FUNCTION  
END CLASS