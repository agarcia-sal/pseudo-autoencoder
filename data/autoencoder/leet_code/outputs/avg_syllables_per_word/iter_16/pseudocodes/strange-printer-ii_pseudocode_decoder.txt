CLASS Solution  
    FUNCTION isPrintable(targetGrid)  
        SET color_bounds TO a default dictionary with default value being a list of four values where the first value is positive infinity the second value is positive infinity the third value is negative infinity and the fourth value is negative infinity  
        
        FOR each row_index FROM zero TO the LENGTH OF targetGrid MINUS one  
            FOR each column_index FROM zero TO the LENGTH OF element at position zero of targetGrid MINUS one  
                SET color TO the element at position row_index of targetGrid at position column_index  
                SET element at position zero of color_bounds at position color TO the SMALLER OF element at position zero of color_bounds at position color AND row_index  
                SET element at position one of color_bounds at position color TO the SMALLER OF element at position one of color_bounds at position color AND column_index  
                SET element at position two of color_bounds at position color TO the LARGER OF element at position two of color_bounds at position color AND row_index  
                SET element at position three of color_bounds at position color TO the LARGER OF element at position three of color_bounds at position color AND column_index  
            END FOR  
        END FOR  
        
        SET graph TO a default dictionary with default value being an empty list  
        SET in_degree TO a default dictionary with default value being zero  
        
        FOR each color IN the keys of color_bounds  
            SET minr TO element at position zero of color_bounds at position color  
            SET minc TO element at position one of color_bounds at position color  
            SET maxr TO element at position two of color_bounds at position color  
            SET maxc TO element at position three of color_bounds at position color  
            
            FOR each row_index FROM minr TO maxr  
                FOR each column_index FROM minc TO maxc  
                    IF the element at position row_index of targetGrid at position column_index DOES NOT EQUAL color THEN  
                        SET other_color TO the element at position row_index of targetGrid at position column_index  
                        APPEND color TO the list at position other_color of graph  
                        INCREMENT element at position color of in_degree BY one  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        SET queue TO a double ended queue INITIALIZED WITH all colors FROM color_bounds WHERE element at position color of in_degree EQUALS zero  
        SET visited_colors TO zero  
        
        WHILE queue is not empty  
            REMOVE the element from the left side of queue AND SET it TO color  
            INCREMENT visited_colors BY one  
            
            FOR each next_color IN the list at position color of graph  
                DECREMENT element at position next_color of in_degree BY one  
                IF element at position next_color of in_degree EQUALS zero THEN  
                    APPEND next_color TO queue  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN visited_colors EQUALS the LENGTH OF color_bounds  
    END FUNCTION  
END CLASS