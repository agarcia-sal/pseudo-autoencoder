CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MOD TO one billion PLUS seven  
        SORT arr IN ascending order  
        INITIALIZE dp AS a MAPPING where each element of arr is MAPPED TO one  
        
        FOR index FROM zero TO the LENGTH OF arr MINUS one  
            SET num TO element at position index of arr  
            FOR inner_index FROM zero TO index MINUS one  
                SET factor TO element at position inner_index of arr  
                IF num MODULO factor EQUALS zero THEN  
                    SET right_child TO num DIVIDED BY factor  
                    IF right_child IS A KEY IN dp THEN  
                        SET dp[num] TO dp[num] PLUS dp[factor] MULTIPLIED BY dp[right_child] MODULO MOD  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        
        SET total_trees TO the SUM OF all values IN dp  
        RETURN total_trees MODULO MOD  
    END FUNCTION  
END CLASS