CLASS Solution  
    FUNCTION braceExpansionII(expression)  
        FUNCTION parse_expression(index)  
            SET current_set TO an empty set  
            SET current_product TO a list containing an empty string  
            
            WHILE index IS LESS THAN the LENGTH OF expression  
                SET char TO the element at position index of expression  
                
                IF char EQUALS the character open brace  
                    SET inner_set AND index TO the result of calling parse_expression with the value index PLUS one  
                    SET current_product TO a new list formed by concatenating each string a in current_product with each string b in inner_set  
                
                ELSE IF char EQUALS the character close brace  
                    ADD to current_set each string formed by joining the elements of current_product without separator  
                    RETURN current_set AND index  
                
                ELSE IF char EQUALS the character comma  
                    ADD to current_set each string formed by joining the elements of current_product without separator  
                    SET current_product TO a list containing an empty string  
                
                ELSE  
                    SET current_product TO a new list formed by concatenating each string a in current_product with the character char  
                
                INCREMENT index BY one  
            
            ADD to current_set each string formed by joining the elements of current_product without separator  
            RETURN current_set AND index  
        
        SET result_set AND an unused variable TO the result of calling parse_expression with zero  
        RETURN the sorted sequence of elements in result_set  
    END FUNCTION  
END CLASS