CLASS Solution  
    FUNCTION tallestBillboard(rods)  
        SET dp TO dictionary with key zero associated with value zero  
        FOR each rod IN rods  
            SET new_dp TO a copy of dp  
            FOR each key d and value y IN dp  
                SET key_for_taller_support TO d PLUS rod  
                SET value_for_taller_support TO the maximum OF the value associated with key_for_taller_support in new_dp OR zero AND y  
                ASSIGN value_for_taller_support TO new_dp AT key_for_taller_support  
                
                IF d MINUS rod IS GREATER THAN OR EQUAL TO zero  
                    SET difference TO d MINUS rod  
                    SET minimum_support TO rod  
                ELSE  
                    SET difference TO rod MINUS d  
                    SET minimum_support TO d  
                END IF  
                
                SET key_for_shorter_support TO difference  
                SET value_for_shorter_support TO the maximum OF the value associated with key_for_shorter_support in new_dp OR zero AND y PLUS minimum_support  
                ASSIGN value_for_shorter_support TO new_dp AT key_for_shorter_support  
            END FOR  
            ASSIGN new_dp TO dp  
        END FOR  
        RETURN the value associated with key zero in dp  
    END FUNCTION  
END CLASS