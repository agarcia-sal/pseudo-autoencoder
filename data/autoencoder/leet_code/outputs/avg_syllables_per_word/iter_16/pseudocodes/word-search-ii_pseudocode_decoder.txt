CLASS Trie  
    FUNCTION __init__  
        SET children TO a list of twenty six None elements  
        SET ref TO negative one  
    END FUNCTION  

    FUNCTION insert WITH PARAMETERS w AND ref  
        SET node TO self  
        FOR each character c IN w  
            SET idx TO the Unicode code point of character c MINUS the Unicode code point of lowercase letter a  
            IF element at position idx of node children IS None  
                ASSIGN pointer/reference AT element position idx of node children TO a new instance of Trie  
            END IF  
            SET node TO element at position idx of node children  
        END FOR  
        SET ref attribute of node TO ref  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION findWords WITH PARAMETERS board AND words  
        FUNCTION dfs WITH PARAMETERS node AND i AND j  
            SET idx TO the Unicode code point of element at position j of element at position i of board MINUS the Unicode code point of lowercase letter a  
            IF element at position idx of node children IS None  
                RETURN  
            END IF  
            SET node TO element at position idx of node children  
            IF ref attribute of node IS GREATER THAN OR EQUAL TO zero  
                APPEND element at position ref attribute of node of words TO ans  
                SET ref attribute of node TO negative one  
            END IF  
            SET c TO element at position j of element at position i of board  
            SET element at position j of element at position i of board TO the character hash symbol  
            FOR each pair of values a AND b IN adjacent pairs of the sequence negative one zero one zero negative one  
                SET x TO i PLUS a  
                SET y TO j PLUS b  
                IF x IS GREATER THAN OR EQUAL TO zero AND x IS LESS THAN the LENGTH OF board AND y IS GREATER THAN OR EQUAL TO zero AND y IS LESS THAN the LENGTH OF element at position zero of board AND element at position y of element at position x of board IS NOT the character hash symbol  
                    CALL dfs WITH node AND x AND y  
                END IF  
            END FOR  
            SET element at position j of element at position i of board TO c  
        END FUNCTION  

        SET tree TO a new instance of Trie  
        FOR each index i AND word w IN enumeration of words  
            CALL insert function of tree WITH w AND i  
        END FOR  
        SET m TO the LENGTH OF board  
        SET n TO the LENGTH OF element at position zero of board  
        SET ans TO an empty list  
        FOR i FROM zero TO m MINUS one  
            FOR j FROM zero TO n MINUS one  
                CALL dfs WITH tree AND i AND j  
            END FOR  
        END FOR  
        RETURN ans  
    END FUNCTION  
END CLASS