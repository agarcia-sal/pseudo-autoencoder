CLASS Solution  
    FUNCTION findRedundantDirectedConnection(edges)  
        FUNCTION find(parent, i)  
            IF the element at position i of parent IS NOT EQUAL TO i  
                SET the element at position i of parent TO the result of calling find with parameters parent and the element at position i of parent  
            END IF  
            RETURN the element at position i of parent  
        END FUNCTION  
        
        FUNCTION union(parent, rank, x, y)  
            SET rootX TO the result of calling find with parameters parent and x  
            SET rootY TO the result of calling find with parameters parent and y  
            IF rootX IS NOT EQUAL TO rootY  
                IF the element at position rootX of rank IS GREATER THAN the element at position rootY of rank  
                    SET the element at position rootY of parent TO rootX  
                ELSE IF the element at position rootX of rank IS LESS THAN the element at position rootY of rank  
                    SET the element at position rootX of parent TO rootY  
                ELSE  
                    SET the element at position rootY of parent TO rootX  
                    INCREMENT the element at position rootX of rank BY one  
                END IF  
                RETURN true  
            END IF  
            RETURN false  
        END FUNCTION  
        
        SET n TO the LENGTH OF edges  
        SET parent TO the list of integer values from zero TO n INCLUSIVE  
        SET rank TO the list of zeros with LENGTH equal TO n PLUS one  
        
        SET candidate1 TO none  
        SET candidate2 TO none  
        SET last TO none  
        
        FOR each pair u and v IN edges  
            IF the element at position v of parent IS NOT EQUAL TO v  
                SET candidate1 TO a list containing the element at position v of parent AND v  
                SET candidate2 TO a list containing u AND v  
            ELSE  
                IF the result of calling union with parameters parent rank u and v IS false  
                    SET last TO a list containing u AND v  
                END IF  
            END IF  
        END FOR  
        
        IF candidate1 IS none  
            RETURN last  
        END IF  
        
        IF last IS NOT none  
            RETURN candidate1  
        END IF  
        
        RETURN candidate2  
    END FUNCTION  
END CLASS