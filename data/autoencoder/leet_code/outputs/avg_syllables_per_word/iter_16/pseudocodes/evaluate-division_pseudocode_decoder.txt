CLASS Solution  
    FUNCTION calcEquation(equations AS list of list of string, values AS list of floating point number, queries AS list of list of string) RETURNS list of floating point number  
        SET graph TO a mapping with default value as an empty mapping from string to floating point number  
        FOR each pair of elements consisting of equation AND value IN the pairing of equations AND values  
            SET variable a TO the first element of equation  
            SET variable b TO the second element of equation  
            SET the element at key b of the mapping at key a of graph TO value  
            SET the element at key a of the mapping at key b of graph TO one DIVIDED BY value  
        END FOR  
        
        FUNCTION dfs(start AS string, end AS string, visited AS set of string) RETURNS floating point number  
            IF start is not a key in graph OR end is not a key in graph THEN  
                RETURN negative one point zero  
            END IF  
            IF start EQUALS end THEN  
                RETURN one point zero  
            END IF  
            ADD start TO visited  
            FOR each pair of elements consisting of neighbor AND weight IN the items of the mapping at key start of graph  
                IF neighbor is not an element of visited THEN  
                    SET variable result TO the call of dfs with arguments neighbor AND end AND visited  
                    IF result NOT EQUALS negative one point zero THEN  
                        RETURN weight MULTIPLIED BY result  
                    END IF  
                END IF  
            END FOR  
            REMOVE start FROM visited  
            RETURN negative one point zero  
        END FUNCTION  
        
        SET results TO an empty list  
        FOR each query IN queries  
            SET variable start TO the first element of query  
            SET variable end TO the second element of query  
            SET visited TO an empty set  
            SET variable result TO the call of dfs with arguments start AND end AND visited  
            APPEND result TO results  
        END FOR  
        
        RETURN results  
    END FUNCTION  
END CLASS