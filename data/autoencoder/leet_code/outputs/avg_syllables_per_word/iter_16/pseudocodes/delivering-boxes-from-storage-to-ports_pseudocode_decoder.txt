CLASS Solution  
    FUNCTION boxDelivering WITH parameters boxes AS list of list of integers portsCount AS integer maxBoxes AS integer maxWeight AS integer  
        SET n TO the LENGTH OF boxes  
        INITIALIZE dp TO a list OF length n PLUS one WITH all elements SET TO infinity  
        SET the element at position zero of dp TO zero  
        
        SET left TO zero  
        SET current_weight TO zero  
        SET extra_trips TO zero  
        
        FOR right FROM zero TO n MINUS one  
            INCREMENT current_weight BY the element at position one of the element at position right of boxes  
            IF right IS GREATER THAN zero AND the element at position zero of the element at position right of boxes IS NOT EQUALS the element at position zero of the element at position right MINUS one of boxes  
                INCREMENT extra_trips BY one  
            END IF  
            
            WHILE left IS LESS THAN OR EQUAL TO right AND the number of boxes from left TO right INCLUSIVE IS GREATER THAN maxBoxes OR current_weight IS GREATER THAN maxWeight  
                DECREMENT current_weight BY the element at position one of the element at position left of boxes  
                IF left IS GREATER THAN zero AND the element at position zero of the element at position left of boxes IS NOT EQUALS the element at position zero of the element at position left MINUS one of boxes  
                    DECREMENT extra_trips BY one  
                END IF  
                INCREMENT left BY one  
            END WHILE  
            
            SET the element at position right PLUS one of dp TO the element at position left of dp PLUS two PLUS extra_trips  
        END FOR  
        
        RETURN the element at position n of dp  
    END FUNCTION  
END CLASS