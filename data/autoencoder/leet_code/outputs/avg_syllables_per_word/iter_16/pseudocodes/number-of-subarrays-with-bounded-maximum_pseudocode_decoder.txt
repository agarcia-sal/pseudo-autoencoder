CLASS Solution  
    FUNCTION numSubarrayBoundedMax(nums AS List OF integers, left AS integer, right AS integer) RETURNS integer  
        FUNCTION count(max_value AS integer) RETURNS integer  
            SET count TO zero  
            SET current_length TO zero  
            FOR each num IN nums  
                IF num IS LESS THAN OR EQUAL TO max_value  
                    INCREMENT current_length BY one  
                    INCREMENT count BY current_length  
                ELSE  
                    SET current_length TO zero  
                END IF  
            END FOR  
            RETURN count  
        END FUNCTION  
        SET result TO count(right) MINUS count(left MINUS one)  
        RETURN result  
    END FUNCTION  
END CLASS