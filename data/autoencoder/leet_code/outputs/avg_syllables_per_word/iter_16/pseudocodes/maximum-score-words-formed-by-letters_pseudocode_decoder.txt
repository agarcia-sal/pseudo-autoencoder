CLASS Solution  
    FUNCTION maxScoreWords(words AS List OF string, letters AS List OF string, score AS List OF integer) RETURNS integer  
        FUNCTION word_score(word AS string, score_map AS mapping FROM string TO integer) RETURNS integer  
            SET total_score TO zero  
            FOR each character IN word  
                INCREMENT total_score BY the value at character key of score_map  
            END FOR  
            RETURN total_score  
        END FUNCTION  
        
        FUNCTION can_form(word AS string, letter_count AS mapping FROM string TO integer) RETURNS boolean  
            SET word_count TO a mapping from characters to their frequencies in word  
            FOR each character AND its count IN word_count  
                IF the value at character key of letter_count IS LESS THAN count THEN  
                    RETURN false  
                END IF  
            END FOR  
            RETURN true  
        END FUNCTION  
        
        FUNCTION update_letter_count(letter_count AS mapping FROM string TO integer, word AS string, add AS boolean EQUAL TO true)  
            FOR each character IN word  
                IF add IS true THEN  
                    INCREMENT the value at character key of letter_count BY one  
                ELSE  
                    DECREMENT the value at character key of letter_count BY one  
                END IF  
            END FOR  
        END FUNCTION  
        
        FUNCTION backtrack(index AS integer, current_score AS integer, letter_count AS mapping FROM string TO integer) RETURNS integer  
            IF index EQUALS the length of words THEN  
                RETURN current_score  
            END IF  
            
            SET max_score TO current_score  
            FOR each position FROM index TO the length of words MINUS one  
                IF can_form(the element at position of words, letter_count) IS true THEN  
                    CALL update_letter_count(letter_count, the element at position of words, add EQUAL TO false)  
                    SET candidate_score TO backtrack(position PLUS one, current_score PLUS word_score(the element at position of words, score_map), letter_count)  
                    IF candidate_score IS GREATER THAN max_score THEN  
                        SET max_score TO candidate_score  
                    END IF  
                    CALL update_letter_count(letter_count, the element at position of words, add EQUAL TO true)  
                END IF  
            END FOR  
            
            RETURN max_score  
        END FUNCTION  
        
        SET score_map TO a mapping from each lowercase letter from a TO z TO corresponding element at position of score AS its value  
        SET letter_count TO a mapping from characters to their frequencies in letters  
        
        RETURN backtrack(zero, zero, letter_count)  
    END FUNCTION  
END CLASS