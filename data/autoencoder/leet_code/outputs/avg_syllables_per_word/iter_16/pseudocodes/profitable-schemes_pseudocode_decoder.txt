CLASS Solution  
    FUNCTION profitableSchemes(n integer, minProfit integer, group list of integers, profit list of integers) RETURNS integer  
        SET MOD TO one billion PLUS seven  
        SET dp TO a list containing n PLUS one elements where each element is a list of minProfit PLUS one zeros  
        FOR each integer i FROM zero TO n  
            SET element at position zero of element at position i of dp TO one  
        END FOR  
        FOR each pair of elements p and g IN profit and group respectively  
            FOR each integer i FROM n DOWN TO g  
                FOR each integer j FROM minProfit DOWN TO zero  
                    SET dp at position i then j TO the sum of dp at position i then j PLUS dp at position i MINUS g then the maximum of zero AND j MINUS p  
                    APPLY modulo MOD to dp at position i then j  
                END FOR  
            END FOR  
        END FOR  
        RETURN element at position n then minProfit of dp  
    END FUNCTION  
END CLASS