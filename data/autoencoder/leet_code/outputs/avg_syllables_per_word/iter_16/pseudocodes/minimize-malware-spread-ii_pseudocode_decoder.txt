CLASS Solution  
    FUNCTION minMalwareSpread(graph, initial)  
        SET number_of_nodes TO the LENGTH OF graph  
        CREATE adj_list AS A DEFAULT DICTIONARY THAT RETURNS empty list  
        
        FOR index_i FROM zero TO number_of_nodes MINUS one  
            FOR index_j FROM index_i PLUS one TO number_of_nodes MINUS one  
                IF the element at position index_i of graph AT position index_j EQUALS one  
                    APPEND index_j TO the list at position index_i of adj_list  
                    APPEND index_i TO the list at position index_j of adj_list  
                END IF  
            END FOR  
        END FOR  
        
        FUNCTION dfs(node, visited)  
            IF node IS IN visited  
                RETURN zero  
            END IF  
            ADD node TO visited  
            SET component_size TO one  
            FOR each neighbor IN adj_list AT position node  
                INCREMENT component_size BY dfs(neighbor, visited)  
            END FOR  
            RETURN component_size  
        END FUNCTION  
        
        CREATE infected AS A SET CONTAINING ALL ELEMENTS OF initial  
        
        CREATE component_sizes AS AN empty list  
        CREATE visited AS AN empty set  
        CREATE component_index AS AN empty dictionary  
        
        FOR node FROM zero TO number_of_nodes MINUS one  
            IF node IS NOT IN visited AND node IS NOT IN infected  
                SET size_of_component TO dfs(node, visited)  
                APPEND size_of_component TO component_sizes  
                FOR index_i FROM the LENGTH OF component_sizes MINUS one DOWN TO zero  
                    IF the element at position index_i of component_sizes EQUALS size_of_component  
                        BREAK THE LOOP  
                    END IF  
                END FOR  
                FOR each neighbor IN adj_list AT position node  
                    SET the value at position neighbor of component_index TO index_i  
                END FOR  
            END IF  
        END FOR  
        
        CREATE infected_in_component AS A DEFAULT DICTIONARY THAT RETURNS zero  
        FOR each node IN infected  
            IF node IS IN component_index  
                INCREMENT infected_in_component AT position component_index[node] BY one  
            END IF  
        END FOR  
        
        SET maximum_component_size TO zero  
        SET node_to_remove TO the MINIMUM ELEMENT OF initial  
        
        FOR each node IN infected  
            IF node IS IN component_index  
                SET component_index_for_node TO component_index AT position node  
                IF infected_in_component AT position component_index_for_node EQUALS one  
                    IF component_sizes AT position component_index_for_node IS GREATER THAN maximum_component_size  
                        SET maximum_component_size TO component_sizes AT position component_index_for_node  
                        SET node_to_remove TO node  
                    ELSE IF component_sizes AT position component_index_for_node EQUALS maximum_component_size  
                        SET node_to_remove TO the MINIMUM OF node_to_remove AND node  
                    END IF  
                END IF  
            END IF  
        END FOR  
        
        RETURN node_to_remove  
    END FUNCTION  
END CLASS