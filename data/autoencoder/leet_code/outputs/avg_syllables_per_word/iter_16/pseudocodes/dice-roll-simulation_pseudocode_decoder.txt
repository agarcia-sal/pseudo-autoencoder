CLASS Solution  
    FUNCTION dieSimulator WITH PARAMETERS n AND rollMax  
        SET MOD TO one billion PLUS seven  
        SET dp TO a three dimensional list of zeros with dimensions n PLUS one BY six BY the maximum value in rollMax PLUS one  
        FOR each j FROM zero TO five  
            SET element at position one at position j at position one of dp TO one  
        END FOR  
        FOR each i FROM two TO n  
            FOR each j FROM zero TO five  
                FOR each k FROM one TO the element at position j of rollMax  
                    IF k IS GREATER THAN one  
                        SET element at position i at position j at position k of dp TO element at position i MINUS one at position j at position k MINUS one of dp  
                    ELSE  
                        SET element at position i at position j at position k of dp TO the sum of element at position i MINUS one at position x at position y of dp FOR each x FROM zero TO five AND for each y FROM one TO the element at position x of rollMax WHERE x IS NOT EQUAL TO j MODULO MOD  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        SET result TO the sum of element at position n at position j at position k of dp FOR each j FROM zero TO five AND for each k FROM one TO the element at position j of rollMax MODULO MOD  
        RETURN result  
    END FUNCTION  
END CLASS