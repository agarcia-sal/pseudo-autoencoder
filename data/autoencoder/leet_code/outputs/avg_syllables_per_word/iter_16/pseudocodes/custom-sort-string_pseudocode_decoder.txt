CLASS Solution  
    FUNCTION customSortString(order, s)  
        SET d TO result of calling helper FUNCTION build_dictionary WITH order  
        SET sorted_characters TO result of calling helper FUNCTION sort_characters WITH s AND d  
        SET result_string TO result of calling helper FUNCTION join_characters WITH sorted_characters  
        RETURN result_string  
    END FUNCTION  
  
    FUNCTION build_dictionary(order)  
        SET dictionary d TO empty mapping from character TO integer  
        SET index TO zero  
        FOR each character c IN order  
            SET element at character c OF dictionary d TO index  
            INCREMENT index BY one  
        END FOR  
        RETURN dictionary d  
    END FUNCTION  
  
    FUNCTION sort_characters(s, d)  
        SET character_list TO list of all characters IN s  
        SORT character_list BY the value IN dictionary d FOR each character USING zero AS default value WHEN character NOT FOUND  
        RETURN character_list  
    END FUNCTION  
  
    FUNCTION join_characters(character_list)  
        SET result TO empty string  
        FOR each character IN character_list  
            SET result TO result APPENDED WITH character  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS