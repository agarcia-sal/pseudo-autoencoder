CLASS Solution  
    FUNCTION maximumBeauty(flowers)  
        SET indices TO the result of calling a dictionary type that produces an empty list for new keys  
        SET prefix_sum TO a list of zero values with the length equal to the LENGTH OF flowers PLUS one  
        FOR index FROM zero TO the LENGTH OF flowers MINUS one  
            SET element_at_position index PLUS one of prefix_sum TO the element at position index of prefix_sum PLUS the MAXIMUM OF the element at position index of flowers AND zero  
            APPEND index TO the list at key equal to the element at position index of flowers within indices  
        END FOR  
        SET max_beauty TO negative infinity  
        FOR each beauty_value IN the keys of indices  
            IF the LENGTH OF the list at key beauty_value of indices IS GREATER THAN OR EQUAL TO two  
                SET first TO the element at position zero of the list at key beauty_value of indices  
                SET last TO the element at position LENGTH OF the list at key beauty_value of indices MINUS one of the list at key beauty_value of indices  
                SET current_beauty TO two MULTIPLIED BY beauty_value PLUS the element at position last of prefix_sum MINUS the element at position first PLUS one of prefix_sum  
                SET max_beauty TO the GREATER OF max_beauty AND current_beauty  
            END IF  
        END FOR  
        RETURN max_beauty  
    END FUNCTION  
END CLASS