CLASS Solution  
    FUNCTION constrainedSubsetSum(nums AS List OF integers, k AS integer) RETURNS integer  
        SET n TO the LENGTH OF nums  
        SET dp TO list OF integers OF LENGTH n WITH ALL ELEMENTS INITIALIZED TO zero  
        SET element at position zero of dp TO element at position zero of nums  
        SET max_sum TO element at position zero of nums  
        ASSIGN q TO A DEQUE CONTAINING element at position zero  
        FOR i FROM one TO n MINUS one  
            SET value AT position zero OF q TO first element of q  
            IF element at position value of dp IS GREATER THAN zero  
                SET dp at position i TO element at position i of nums PLUS element at position value of dp  
            ELSE  
                SET dp at position i TO element at position i of nums PLUS zero  
            END IF  
            IF max_sum IS GREATER THAN OR EQUAL TO dp at position i  
                SET max_sum TO max_sum  
            ELSE  
                SET max_sum TO dp at position i  
            END IF  
            WHILE q IS NOT EMPTY AND dp at position i IS GREATER THAN OR EQUAL TO dp at position last element of q  
                REMOVE last element FROM q  
            END WHILE  
            APPEND i TO q  
            IF element at position zero of q EQUALS i MINUS k  
                REMOVE first element FROM q  
            END IF  
        END FOR  
        RETURN max_sum  
    END FUNCTION  
END CLASS