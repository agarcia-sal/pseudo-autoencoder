```
init ugly_numbers = [1]
init heap = [(p, i) for i, p in enumerate(primes)]
heapify(heap)
init indices = [0]*len(primes)
while len(ugly_numbers) < n:
    next_ugly, pi = heappop(heap)
    if next_ugly != ugly_numbers[-1]:
        append next_ugly to ugly_numbers
    indices[pi] += 1
    push (primes[pi]*ugly_numbers[indices[pi]], pi) into heap
return last element of ugly_numbers
```