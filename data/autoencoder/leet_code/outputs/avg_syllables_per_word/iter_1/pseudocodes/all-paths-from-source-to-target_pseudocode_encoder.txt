```
func allPathsSourceTarget(graph):
  n = length(graph)
  q = queue([[0]])
  ans = []
  while q not empty:
    path = dequeue(q)
    u = last(path)
    if u == n-1:
      append(ans, path)
    else:
      for v in graph[u]:
        enqueue(q, path + [v])
  return ans
```