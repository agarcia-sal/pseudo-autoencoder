```
build graph: u->v for (u,v) in pairs; count out_degree[u]++, in_degree[v]++
find start_node where out_degree == in_degree +1 else pick any graph node
stack = [start_node], path = []
while stack not empty:
  u = top(stack)
  if graph[u]:
    v = pop graph[u]
    push v to stack
  else:
    pop stack -> append to path
reverse path
return [[path[i], path[i+1]] for i in 0..len(path)-2]
```