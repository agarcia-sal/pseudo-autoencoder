```
for each row in matrix:
    update heights: heights[j] = (heights[j] + 1 if matrix[row][j] == '1' else 0)
    max_area = max(max_area, largestRectangleArea(heights))
return max_area

largestRectangleArea(heights):
    stack = []
    max_area = 0
    for i in range(len(heights)+1):
        h = heights[i] if i < len(heights) else 0
        while stack and h < heights[stack[-1]]:
            top = stack.pop()
            w = i if not stack else i - stack[-1] - 1
            max_area = max(max_area, heights[top] * w)
        stack.append(i)
    return max_area
```