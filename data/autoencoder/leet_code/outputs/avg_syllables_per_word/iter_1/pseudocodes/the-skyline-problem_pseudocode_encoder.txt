```
for b in buildings:
    events += [(b.left, -b.height, b.right), (b.right, 0, 0)]
events.sort()

res = [[0,0]]
heap = [(0,∞)]

for x, h, r in events:
    while heap[0].end ≤ x: pop heap
    if h ≠ 0: push (h, r) to heap
    if res[-1].height ≠ -heap[0].height: append [x, -heap[0].height] to res

if res[0] == [0,0]: remove res[0]
return res
```