```
func magicalString(n):
  if n=0: return 0
  if n<=3: return 1

  s = [1,2,2]; count=1; i=2
  while len(s)<n:
    next_num = 3 - s[-1]
    s.extend([next_num]*s[i])
    if next_num=1: count+=s[i]
    i+=1

  if len(s)>n: count -= (len(s)-n) * (1 if s[n]==1 else 0)
  return count
```