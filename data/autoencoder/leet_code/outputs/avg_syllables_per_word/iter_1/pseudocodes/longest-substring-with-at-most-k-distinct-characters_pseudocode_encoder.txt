```
if k = 0: return 0
map ← empty dict; left ← 0; maxLen ← 0
for right in 0 to len(s)-1:
    map[s[right]] ← right
    if size(map) > k:
        leftChar ← char with min index in map
        left ← map.pop(leftChar) + 1
    maxLen ← max(maxLen, right - left + 1)
return maxLen
```