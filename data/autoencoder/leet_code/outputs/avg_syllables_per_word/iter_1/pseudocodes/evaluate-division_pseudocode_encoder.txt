```
build graph G with edges a->b=val and b->a=1/val for (a,b), val in equations & values
define dfs(s,e,visited):
  return -1 if s or e not in G
  return 1 if s==e
  add s to visited
  for n,w in G[s]:
    if n not in visited:
      r = dfs(n,e,visited)
      if r!=-1: return w*r
  remove s from visited
  return -1
for (s,e) in queries:
  append dfs(s,e,set()) to results
return results
```