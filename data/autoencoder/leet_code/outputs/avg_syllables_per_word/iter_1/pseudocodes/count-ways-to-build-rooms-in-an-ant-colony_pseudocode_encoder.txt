```
set MOD = 10^9+7
waysToBuildRooms(prev):
  n = length(prev)
  graph = map from int to list
  for r in 1 to n-1:
    graph[prev[r]] += r

  dp(node):
    if graph[node] empty: return (1, 1)
    ways = 1; size = 1
    children = [dp(c) for c in graph[node]]
    for (w,s) in children:
      ways = ways * comb(size+s-1, s) * w mod MOD
      size += s
    return (ways, size)

  return dp(0)[0]
```