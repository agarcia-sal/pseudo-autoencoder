```
n = len(text)
subs = set()
for L in 1 to n//2:
  for i in 0 to n - 2*L:
    if text[i:i+L] == text[i+L:i+2*L]:
      subs.add(text[i:i+2*L])
return size(subs)
```