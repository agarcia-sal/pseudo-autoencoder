```
sort nums
n = length(nums)

define count(d):
  c = 0
  l = 0
  for r in [0..n-1]:
    while nums[r] - nums[l] > d:
      l += 1
    c += r - l
  return c

l, r = 0, nums[n-1] - nums[0]
while l < r:
  m = (l + r) // 2
  if count(m) < k:
    l = m + 1
  else:
    r = m

return l
```