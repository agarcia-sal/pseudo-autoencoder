```
init m,n = dims(mat)
target = zero matrix tuple(m,n)
start = tuple-form(mat)
queue = [(start,0)]
visited = {start}

while queue not empty:
    state, steps = dequeue(queue)
    if state == target: return steps
    matrix = list-form(state)
    for i in 0..m-1:
        for j in 0..n-1:
            nxt = copy(matrix)
            flip cell (i,j) and neighbors in nxt
            nxt_state = tuple-form(nxt)
            if nxt_state not in visited:
                visited add nxt_state
                enqueue(queue, (nxt_state, steps+1))

return -1
```