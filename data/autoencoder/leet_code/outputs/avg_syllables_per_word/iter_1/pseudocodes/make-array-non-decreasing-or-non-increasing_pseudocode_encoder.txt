```
def min_ops_non_dec(nums):
  max_h = []
  ops = 0
  for x in nums:
    if max_h and -max_h[0] > x:
      ops += -heappop(max_h) - x
      heappush(max_h, -x)
    heappush(max_h, -x)
  return ops

def min_ops_non_inc(nums):
  min_h = []
  ops = 0
  for x in nums:
    if min_h and min_h[0] < x:
      ops += x - heappop(min_h)
      heappush(min_h, x)
    heappush(min_h, x)
  return ops

return min(min_ops_non_dec(nums), min_ops_non_inc(nums))
```