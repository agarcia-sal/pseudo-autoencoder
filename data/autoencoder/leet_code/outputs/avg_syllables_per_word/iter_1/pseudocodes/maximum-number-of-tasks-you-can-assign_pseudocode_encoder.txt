```
sort tasks, workers
define canAssign(k):
    W = last k workers
    used = 0
    for i in descending k-1 to 0:
        t = tasks[i]
        idx = bisect_left(W, t)
        if idx < len(W):
            pop W[idx]
        else if used < pills:
            idx = bisect_left(W, t - strength)
            if idx < len(W):
                pop W[idx]
                used += 1
            else:
                return False
        else:
            return False
    return True

left, right = 0, min(len(tasks), len(workers)) + 1
while left < right:
    mid = (left + right) // 2
    if canAssign(mid):
        left = mid + 1
    else:
        right = mid
return left - 1
```