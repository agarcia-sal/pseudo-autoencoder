```
n ← len(nums)
prefix_sum ← array of size n+1 with 0
for i in 0 to n-1: prefix_sum[i+1] ← prefix_sum[i] + nums[i]

average(i,j) ← (prefix_sum[j+1] - prefix_sum[i]) / (j - i + 1)

dp ← 2D array (n+1)×(k+1) filled with 0
for i in 0 to n-1: dp[i][1] ← average(i, n-1)

for i in n-1 down to 0:
  for p in 2 to k:
    for j in i+1 to n-1:
      dp[i][p] ← max(dp[i][p], dp[j][p-1] + average(i, j-1))

return dp[0][k]
```