```
if prices empty or k=0: return 0
n = len(prices)
if k >= n//2:
  profit=0
  for i in 1 to n-1:
    if prices[i]>prices[i-1]: profit += prices[i]-prices[i-1]
  return profit
hold = array(k+1, -âˆž)
release = array(k+1, 0)
for price in prices:
  for i in 1 to k:
    hold[i] = max(hold[i], release[i-1]-price)
    release[i] = max(release[i], hold[i]+price)
return release[k]
```