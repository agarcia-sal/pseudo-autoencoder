```
add virtual node 0 to pipes with cost wells[i] for i in [1..n]
sort pipes by cost
parent = [0..n]

function find(x):
  while parent[x] != x: x = parent[x]
  return x

function union(x,y):
  rx, ry = find(x), find(y)
  if rx != ry: parent[rx] = ry; return True
  return False

min_cost = 0
for h1,h2,c in pipes:
  if union(h1,h2): min_cost += c

return min_cost
```