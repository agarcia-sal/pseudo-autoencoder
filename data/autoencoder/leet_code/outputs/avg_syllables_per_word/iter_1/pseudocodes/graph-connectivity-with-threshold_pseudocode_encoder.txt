```
init parent = [0..n]
fn find(x):
  if parent[x] != x: parent[x] = find(parent[x])
  return parent[x]

fn union(x, y):
  px, py = find(x), find(y)
  if px != py: parent[py] = px

if threshold == 0: return [True] * len(queries)

for i in (threshold+1) to n:
  for j in (2*i) to n step i:
    union(i, j)

return [find(a) == find(b) for (a,b) in queries]
```