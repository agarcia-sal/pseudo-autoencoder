```
if n = 1: return [0]

graph ← defaultdict(list)
degree ← array of 0 size n

for (u, v) in edges:
  graph[u].append(v)
  graph[v].append(u)
  degree[u]++, degree[v]++

leaves ← deque of i where degree[i] = 1

remain ← n
while remain > 2:
  count ← size(leaves)
  remain -= count
  for _ in 1..count:
    leaf ← leaves.popleft()
    for nbr in graph[leaf]:
      degree[nbr]--
      if degree[nbr] = 1: leaves.append(nbr)

return list(leaves)
```