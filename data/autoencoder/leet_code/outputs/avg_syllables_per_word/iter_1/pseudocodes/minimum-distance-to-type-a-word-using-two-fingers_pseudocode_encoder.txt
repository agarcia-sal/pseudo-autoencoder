```
dist(c1,c2) = 0 if c1=None else abs((ord(c1)-65)//6-(ord(c2)-65)//6) + abs((ord(c1)-65)%6-(ord(c2)-65)%6)

dp(i,f1,f2) = 0 if i=len(word) else 
              min(dist(f1,word[i]) + dp(i+1, word[i], f2), dist(f2,word[i]) + dp(i+1, f1, word[i]))

return dp(0,None,None)
```