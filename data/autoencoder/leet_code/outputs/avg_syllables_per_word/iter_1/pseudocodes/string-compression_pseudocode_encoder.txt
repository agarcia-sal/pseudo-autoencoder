```
if chars empty then return 0
wi, ri ← 0, 0
while ri < length(chars):
    c ← chars[ri]
    count ← 0
    while ri < length(chars) and chars[ri] = c:
        ri++, count++
    chars[wi] ← c
    wi++
    if count > 1:
        for d in str(count):
            chars[wi] ← d
            wi++
return wi
```