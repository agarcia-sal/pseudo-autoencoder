```
input: left, right (str)
L, R = int(left), int(right)
limit = int(R**0.5) + 1

func is_pal(num):
    return str(num) == reverse(str(num))

func gen_pal(limit):
    pals = []
    for i in 1 to 99999:
        s = str(i)
        pals.append(int(s + reverse(s[:-1])))
        pals.append(int(s + reverse(s)))
    return filter(p -> p <= limit, pals)

pals = gen_pal(limit)
count = 0
for p in pals:
    sq = p * p
    if L <= sq <= R and is_pal(sq):
        count += 1

return count
```