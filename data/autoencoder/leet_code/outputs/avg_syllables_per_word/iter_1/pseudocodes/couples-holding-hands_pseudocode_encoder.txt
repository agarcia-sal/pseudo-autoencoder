```
pos ← map person to index in row
swaps ← 0
for i in 0 to len(row)-1 step 2:
    pair ← row[i] XOR 1
    if row[i+1] ≠ pair:
        j ← pos[pair]
        swap row[i+1] and row[j]
        pos[row[j]] ← j
        pos[row[i+1]] ← i+1
        swaps ← swaps + 1
return swaps
```