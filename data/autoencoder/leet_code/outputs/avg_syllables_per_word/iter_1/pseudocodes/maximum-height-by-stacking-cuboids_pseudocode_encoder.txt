```
for c in cuboids: sort c
sort cuboids
n = len(cuboids)
dp = [0]*n
for i in [0..n-1]:
    dp[i] = cuboids[i][2]
    for j in [0..i-1]:
        if cuboids[j][0] ≤ cuboids[i][0] and cuboids[j][1] ≤ cuboids[i][1] and cuboids[j][2] ≤ cuboids[i][2]:
            dp[i] = max(dp[i], dp[j] + cuboids[i][2])
return max(dp)
```