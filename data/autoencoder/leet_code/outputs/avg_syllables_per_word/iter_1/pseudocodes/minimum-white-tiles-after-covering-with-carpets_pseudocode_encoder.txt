```
n = len(floor)
dp = array(n+1, numCarpets+1, 0)
for i in 1 to n: dp[i][0] = dp[i-1][0] + (floor[i-1] == '1')
for j in 1 to numCarpets:
  for i in 1 to n:
    dp[i][j] = min(dp[i-1][j] + (floor[i-1] == '1'), dp[max(0,i-carpetLen)][j-1])
return dp[n][numCarpets]
```