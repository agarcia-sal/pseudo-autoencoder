```
count chars in s → cnt
mid ← ''
for c, v in cnt:
  if v odd:
    if mid not empty: return []
    mid ← c
    cnt[c] -= 1
ans ← []
define dfs(t):
  if len(t) = len(s): ans.append(t); return
  for c, v in cnt:
    if v > 1:
      cnt[c] -= 2
      dfs(c + t + c)
      cnt[c] += 2
dfs(mid)
return ans
```