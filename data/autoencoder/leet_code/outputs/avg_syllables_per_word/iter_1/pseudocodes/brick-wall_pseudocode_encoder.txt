```
init gap_counts as empty map
for each row in wall:
    sum = 0
    for brick in row except last:
        sum += brick
        gap_counts[sum] += 1
max_gaps = max value in gap_counts or 0 if empty
return size of wall - max_gaps
```