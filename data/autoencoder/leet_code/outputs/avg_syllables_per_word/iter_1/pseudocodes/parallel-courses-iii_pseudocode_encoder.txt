```
graph ← map from course to list of prerequisites based on relations
memo ← array[n+1] filled with -1

func dfs(c):
    if memo[c] ≠ -1: return memo[c]
    max_prev ← max(dfs(p) for p in graph[c]) or 0
    memo[c] ← max_prev + time[c-1]
    return memo[c]

return max(dfs(c) for c in 1..n)
```