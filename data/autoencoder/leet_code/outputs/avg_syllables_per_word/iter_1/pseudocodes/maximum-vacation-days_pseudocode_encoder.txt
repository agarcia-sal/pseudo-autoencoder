```
n ← len(flights)
k ← len(days[0])
dp ← array of size n with -1; dp[0] ← 0
graph ← map each i to [j for j in 0..n-1 if flights[i][j] = 1]

for week in 0..k-1:
    new_dp ← array of size n with -1
    for i in 0..n-1:
        if dp[i] = -1: continue
        new_dp[i] ← max(new_dp[i], dp[i] + days[i][week])
        for j in graph[i]:
            new_dp[j] ← max(new_dp[j], dp[i] + days[j][week])
    dp ← new_dp

return max(dp)
```