```
if k ≤ 1: return 0
prod ← 1, left ← 0, count ← 0
for right in 0..len(nums)-1:
    prod *= nums[right]
    while prod ≥ k and left ≤ right:
        prod //= nums[left]
        left += 1
    count += right - left + 1
return count
```