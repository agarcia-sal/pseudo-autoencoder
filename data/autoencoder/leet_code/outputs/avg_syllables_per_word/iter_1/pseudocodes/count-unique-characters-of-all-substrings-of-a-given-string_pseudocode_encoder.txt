```
set MOD=10^9+7, n=len(s)
init last, last2 = arrays of size 26 with -1
result=0
for i,char in s:
    idx=ord(char)-ord('A')
    result += (i - last[idx]) * (last[idx] - last2[idx]) mod MOD
    last2[idx], last[idx] = last[idx], i
for i in [0..25]:
    result += (n - last[i]) * (last[i] - last2[i]) mod MOD
return result mod MOD
```