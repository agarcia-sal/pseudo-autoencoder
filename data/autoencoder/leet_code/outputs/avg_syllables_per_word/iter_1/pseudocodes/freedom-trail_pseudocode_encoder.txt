```
map charâ†’positions in ring
n = len(ring)

define dp(i, pos) memo:
  if i==len(key) return 0
  return min over p in positions[key[i]] of (min((p-pos)%n,(pos-p)%n)+1+dp(i+1,p))

return dp(0,0)
```