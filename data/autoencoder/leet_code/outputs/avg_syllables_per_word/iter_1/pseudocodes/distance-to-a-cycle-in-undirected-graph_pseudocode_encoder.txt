```
build graph from edges
define dfs(node, parent, path, visited):
  if node in visited: return path from first node occurrence to end
  add node to visited and path
  for neighbor in graph[node]:
    if neighbor != parent:
      c = dfs(neighbor, node, path, visited)
      if c: return c
  remove node from path
  return None

visited = empty set
for node in [0..n-1]:
  if node not in visited:
    cycle = dfs(node, -1, [], visited)
    if cycle: break

distance = array of zeros size n
queue = deque of cycle nodes
visited = set of cycle nodes
level = 0
while queue not empty:
  for each node in current queue length:
    pop node from queue
    distance[node] = level
    for neighbor in graph[node]:
      if neighbor not in visited:
        add neighbor to visited and queue
  level += 1

return distance
```