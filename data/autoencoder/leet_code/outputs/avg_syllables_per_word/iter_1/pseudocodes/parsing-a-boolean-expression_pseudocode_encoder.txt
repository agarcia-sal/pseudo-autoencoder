```
init stk = []
for c in expr:
  if c in {t,f,!,&,|}: push c to stk
  else if c == ')':
    t=f=0
    while top stk in {t,f}: 
      t+= (top stk == t)
      f+= (top stk == f)
      pop stk
    op = pop stk
    c = (t|f) depending on op:
      !: c=t if f=0 else f
      &: c=f if f>0 else t
      |: c=t if t>0 else f
    push c to stk
return (stk[0] == t)
```