```
map ← {a..z} → score[i]
letter_cnt ← count letters
def w_score(w): sum(map[c] for c in w)
def can_make(w): all(letter_cnt[c] ≥ freq for c,freq in count(w).items())
def upd_cnt(w, add): for c in w: letter_cnt[c] += (1 if add else -1)
def bt(i, cur):
  if i = len(words): return cur
  res ← cur
  for j in i..end:
    if can_make(words[j]):
      upd_cnt(words[j], false)
      res ← max(res, bt(j+1, cur + w_score(words[j])))
      upd_cnt(words[j], true)
  return res
return bt(0, 0)
```