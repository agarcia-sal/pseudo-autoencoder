```
convert n to digits list d
find i from right where d[i]<d[i+1], else return -1
find j from right where d[j]>d[i]
swap d[i], d[j]
reverse d[i+1:]
res = int(join d)
return res if res < 2^31 else -1
```