```
build graph: for (a,b) in richer add a to graph[b]
init answer = [-1]*n
dfs(p):
  if answer[p] == -1:
    answer[p] = p
    for nb in graph[p]:
      c = dfs(nb)
      if quiet[c] < quiet[answer[p]]: answer[p] = c
  return answer[p]
for i in 0..n-1: dfs(i)
return answer
```