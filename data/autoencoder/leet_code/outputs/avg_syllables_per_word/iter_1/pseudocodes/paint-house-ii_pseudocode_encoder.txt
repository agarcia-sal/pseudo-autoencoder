```
if costs empty: return 0
n, k = len(costs), len(costs[0])
if k == 1: return costs[0][0] if n == 1 else inf

for i in 1 to n-1:
    min1, idx1, min2 = inf, -1, inf
    for j in 0 to k-1:
        c = costs[i-1][j]
        if c < min1:
            min2, min1, idx1 = min1, c, j
        else if c < min2:
            min2 = c
    for j in 0 to k-1:
        costs[i][j] += (min2 if j == idx1 else min1)

return min(costs[n-1])
```