```
MOD ← 10^9+7
max_num ← max(nums)
count ← frequency of each element in nums
prefix_sum ← array[0..max_num] of 0

for num in count: prefix_sum[num] += count[num]
for i in 1 to max_num: prefix_sum[i] += prefix_sum[i-1]

result ← 0
for num in count:
   for k in 1 to floor(max_num/num):
       start ← num*k
       end ← min(num*(k+1)-1, max_num)
       c ← prefix_sum[end] - prefix_sum[start-1]
       result ← (result + c*k*count[num]) mod MOD

return result
```