Set min1, min2 = ∞  
Set prof1, prof2 = 0  
For price in prices:  
 min1 = min(min1, price)  
 prof1 = max(prof1, price - min1)  
 min2 = min(min2, price - prof1)  
 prof2 = max(prof2, price - min2)  
Return prof2