```
set left = 1, right = max pile  
while left ≤ right:  
    mid = (left + right) // 2  
    hours = sum(ceil(pile / mid) for pile in piles)  
    if hours ≤ h: right = mid - 1  
    else: left = mid + 1  
return left
```