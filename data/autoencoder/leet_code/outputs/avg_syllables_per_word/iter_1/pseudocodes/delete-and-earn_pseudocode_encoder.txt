```
count ← frequency map of nums
unique ← sorted keys of count
dp[0] ← 0
dp[1] ← unique[0] * count[unique[0]]

for i in 2 to length(unique):
    num ← unique[i-1]
    if num = unique[i-2] + 1 then
        dp[i] ← max(dp[i-1], dp[i-2] + num * count[num])
    else
        dp[i] ← dp[i-1] + num * count[num]

return dp[end]
```