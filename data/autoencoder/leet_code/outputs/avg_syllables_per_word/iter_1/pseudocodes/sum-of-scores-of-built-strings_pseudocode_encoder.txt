```
func sumScores(s):
  n ← length(s)
  lcp ← array of size n with 0
  l, r ← 0, 0

  for i in 1 to n-1:
    if i ≤ r:
      lcp[i] ← min(r - i + 1, lcp[i - l])
    while i + lcp[i] < n and s[lcp[i]] = s[i + lcp[i]]:
      lcp[i] += 1
    if i + lcp[i] - 1 > r:
      l, r ← i, i + lcp[i] - 1

  return sum of lcp + n
```