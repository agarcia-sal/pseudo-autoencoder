```
init empty stack S
for each num in nums:
    while S not empty:
        g = gcd(S.top, num)
        if g == 1: break
        num = (S.top * num) / g
        pop S
    push num to S
return S
```