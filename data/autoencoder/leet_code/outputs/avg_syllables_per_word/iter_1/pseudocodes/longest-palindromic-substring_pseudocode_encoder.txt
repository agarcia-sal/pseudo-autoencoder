```
n = len(s)
f = matrix(n, n, True)
k, mx = 0, 1
for i from n-2 downto 0:
  for j from i+1 to n-1:
    f[i][j] = (s[i] == s[j]) and f[i+1][j-1]
    if f[i][j] and j - i + 1 > mx:
      k, mx = i, j - i + 1
return s[k : k + mx]
```