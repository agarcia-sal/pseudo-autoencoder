```
perm(m,n) = product of (m-i) for i in 0..n-1 if n>0 else 1

count_unique_digits(x):
  s = str(x); L = len(s)
  count = sum(9 * perm(9,i-1) for i in 1..L-1)
  seen = empty set
  for i, d in s:
    for digit in (0 if i>0 else 1) .. d-1:
      if digit not in seen:
        count += perm(9 - i, L - i - 1)
    if d in seen: break
    add d to seen
  else: count += 1
  return count

numDupDigitsAtMostN(n):
  return n - count_unique_digits(n)
```