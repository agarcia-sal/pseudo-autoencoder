```
combine projects = zip(capital, profits), sort by capital ascending
init max_heap = [], i = 0, n = len(projects)

repeat k times:
    while i < n and projects[i].capital <= w:
        push -projects[i].profit into max_heap
        i += 1
    if max_heap empty: break
    w += -pop max_heap

return w
```