```
for each row in grid:
    if first element == 0: flip entire row
for col in 1 to last column:
    if count of 1s in col < half of rows: flip entire column
score = sum(int(concat row as binary) for each row in grid)
return score
```