CLASS Solution  
    FUNCTION numWays WITH PARAMETERS words and target  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF the first element of words  
        SET m TO the LENGTH OF target  
        SET freq TO a list of n elements where each element is a mapping from character to zero  
        FOR each word IN words  
            FOR each index j and character char IN word enumerated from zero  
                INCREMENT the count of char in freq at position j BY one  
            END FOR  
        END FOR  
        SET dp TO a two-dimensional list with m PLUS one rows and n PLUS one columns all set to zero  
        FOR each integer j FROM zero TO n  
            SET the element at row zero column j in dp TO one  
        END FOR  
        FOR each integer i FROM one TO m  
            FOR each integer j FROM one TO n  
                SET the element at row i column j in dp TO the element at row i column j MINUS one in dp  
                IF the value corresponding to character at position i MINUS one in target in freq at position j MINUS one IS GREATER THAN zero  
                    INCREMENT the element at row i column j in dp BY the element at row i MINUS one column j MINUS one in dp MULTIPLIED BY the value corresponding to character at position i MINUS one in target in freq at position j MINUS one  
                    SET the element at row i column j in dp TO the remainder when divided by MOD  
                END IF  
            END FOR  
        END FOR  
        RETURN the element at row m column n in dp  
    END FUNCTION  
END CLASS