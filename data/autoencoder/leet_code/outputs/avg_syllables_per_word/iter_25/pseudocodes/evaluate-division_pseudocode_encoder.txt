CLASS Solution  
    FUNCTION calcEquation WITH parameters equations AS List OF List OF string values AS List OF float queries AS List OF List OF string RETURNS List OF float  
        SET graph TO a new dictionary that has a default value of a dictionary  
        FOR each pair of a and b AND corresponding value IN equations and values zipped together  
            SET the value at key b in the dictionary at key a in graph TO value  
            SET the value at key a in the dictionary at key b in graph TO one DIVIDED BY value  
        END FOR  
        
        FUNCTION dfs WITH parameters start end visited  
            IF start is NOT a key in graph OR end is NOT a key in graph  
                RETURN negative one float  
            END IF  
            IF start EQUALS end  
                RETURN one float  
            END IF  
            ADD start TO visited  
            FOR each neighbor AND corresponding weight IN the dictionary at key start in graph items  
                IF neighbor is NOT IN visited  
                    SET result TO the value returned by calling dfs WITH neighbor end visited  
                    IF result NOT EQUALS negative one float  
                        RETURN weight MULTIPLIED BY result  
                    END IF  
                END IF  
            END FOR  
            REMOVE start FROM visited  
            RETURN negative one float  
        END FUNCTION  
        
        SET results TO an empty list  
        FOR each query IN queries  
            SET start TO the first element of query  
            SET end TO the second element of query  
            SET visited TO an empty set  
            SET result TO the value returned by calling dfs WITH start end visited  
            APPEND result TO results  
        END FOR  
        
        RETURN results  
    END FUNCTION  
END CLASS