CLASS Solution  
    FUNCTION findReplaceString with parameters s indices sources targets  
        SET replacements TO a list of tuples each consisting of one element from indices one element from sources and one element from targets sorted by the first element of the tuples  
        SET result TO an empty list  
        SET prev_end TO zero  
        FOR each index source target IN replacements  
            APPEND to result the substring of s starting from position prev_end up to position index minus one as natural language substring from prev_end TO one less than index  
            IF the substring of s starting at position index and spanning the length of source EQUALS source THEN  
                APPEND target TO result  
            ELSE  
                APPEND to result the substring of s starting at position index and spanning the length of source  
            END IF  
            SET prev_end TO index PLUS the length of source  
        END FOR  
        APPEND to result the substring of s starting from position prev_end to the end of s  
        RETURN the concatenation of all elements in result as a single string  
    END FUNCTION  
END CLASS