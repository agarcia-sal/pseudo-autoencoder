CLASS Solution  
    FUNCTION numFactoredBinaryTrees(arr)  
        SET MOD TO ten MULTIPLIED BY ten MULTIPLIED BY ten MULTIPLIED BY ten MULTIPLIED BY ten MULTIPLIED BY ten MULTIPLIED BY ten PLUS seven  
        SORT arr IN ascending order  
        SET dp TO an empty mapping from number TO one  
        FOR each number IN arr  
            SET in dp the value at number TO one  
        END FOR  
        FOR each index i and number num IN arr with enumeration  
            FOR each index j FROM zero TO i MINUS one  
                IF the remainder when num is DIVIDED BY element at position j of arr EQUALS zero  
                    SET right_child TO num DIVIDED BY element at position j of arr  
                    IF right_child exists as a key in dp  
                        SET dp at num TO the remainder when the sum of dp at num PLUS the product of dp at element at position j of arr AND dp at right_child IS DIVIDED BY MOD  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        SET total TO the sum of all values in dp  
        RETURN the remainder when total IS DIVIDED BY MOD  
    END FUNCTION  
END CLASS