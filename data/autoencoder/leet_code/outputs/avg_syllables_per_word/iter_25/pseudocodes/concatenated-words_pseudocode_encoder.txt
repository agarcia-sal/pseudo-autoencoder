CLASS Trie  
    FUNCTION __init__  
        SET children TO a list containing twenty six None values  
        SET is_end TO False  
    END FUNCTION  

    FUNCTION insert WITH PARAMETER w  
        SET node TO the current Trie instance  
        FOR each character c IN the string w  
            SET idx TO the Unicode code point of c MINUS the Unicode code point of the lowercase letter a  
            IF element at position idx of node children IS None  
                SET element at position idx of node children TO a new Trie instance  
            END IF  
            SET node TO element at position idx of node children  
        END FOR  
        SET node is_end TO True  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION findAllConcatenatedWordsInADict WITH PARAMETERS words  
        FUNCTION dfs WITH PARAMETERS w start  
            IF start EQUALS the length of w  
                RETURN True  
            END IF  
            SET node TO trie  
            FOR i FROM start TO the length of w MINUS one  
                SET idx TO the Unicode code point of the element at position i of w MINUS the Unicode code point of the lowercase letter a  
                IF element at position idx of node children IS None  
                    RETURN False  
                END IF  
                SET node TO element at position idx of node children  
                IF node is_end AND dfs WITH PARAMETERS w i PLUS one RETURNS True  
                    RETURN True  
                END IF  
            END FOR  
            RETURN False  
        END FUNCTION  

        SET trie TO a new Trie instance  
        SET ans TO an empty list  
        SORT the list words IN ascending order according to the length of each element  
        FOR each element w IN words  
            IF w IS NOT an empty string  
                IF dfs WITH PARAMETERS w zero RETURNS True  
                    APPEND w TO ans  
                ELSE  
                    CALL insert METHOD of trie WITH PARAMETER w  
                END IF  
            END IF  
        END FOR  
        RETURN ans  
    END FUNCTION  
END CLASS