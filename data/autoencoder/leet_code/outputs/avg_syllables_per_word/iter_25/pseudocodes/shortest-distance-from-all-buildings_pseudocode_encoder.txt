CLASS Solution  
    FUNCTION shortestDistance(grid)  
        IF grid is empty OR element at position zero of grid is empty THEN  
            RETURN negative one  
        END IF  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero of grid  
        INITIALIZE total_distance AS a two dimensional list of zeroes with m rows and n columns  
        INITIALIZE reach_count AS a two dimensional list of zeroes with m rows and n columns  
        SET building_count TO zero  
        SET directions TO a list containing the pairs one zero MINUS one zero zero one zero MINUS one  
        FUNCTION bfs(start_x start_y)  
            INITIALIZE queue AS a double ended queue containing the tuple start_x start_y  
            INITIALIZE visited AS a two dimensional list of False values with m rows and n columns  
            SET distance TO zero  
            SET reachable TO zero  
            WHILE queue is not empty DO  
                SET size TO the LENGTH OF queue  
                INCREMENT distance BY one  
                FOR each element from zero TO size MINUS one DO  
                    REMOVE the element from the front of queue and ASSIGN values to x and y  
                    FOR each pair dx dy IN directions DO  
                        SET nx TO x PLUS dx  
                        SET ny TO y PLUS dy  
                        IF zero LESS THAN OR EQUAL TO nx AND nx LESS THAN m AND zero LESS THAN OR EQUAL TO ny AND ny LESS THAN n AND visited at position nx ny IS False AND grid at position nx ny EQUALS zero THEN  
                            SET visited at position nx ny TO True  
                            APPEND the tuple nx ny TO queue  
                            INCREMENT total_distance at position nx ny BY distance  
                            INCREMENT reach_count at position nx ny BY one  
                            INCREMENT reachable BY one  
                        END IF  
                    END FOR  
                END FOR  
            END WHILE  
            RETURN reachable  
        END FUNCTION  
        FOR i FROM zero TO m MINUS one DO  
            FOR j FROM zero TO n MINUS one DO  
                IF grid at position i j EQUALS one THEN  
                    INCREMENT building_count BY one  
                    IF bfs with arguments i j LESS THAN building_count MINUS one THEN  
                        RETURN negative one  
                    END IF  
                END IF  
            END FOR  
        END FOR  
        SET min_distance TO infinity  
        FOR i FROM zero TO m MINUS one DO  
            FOR j FROM zero TO n MINUS one DO  
                IF grid at position i j EQUALS zero AND reach_count at position i j EQUALS building_count THEN  
                    SET min_distance TO the smaller value between min_distance AND total_distance at position i j  
                END IF  
            END FOR  
        END FOR  
        IF min_distance NOT EQUAL TO infinity THEN  
            RETURN min_distance  
        ELSE  
            RETURN negative one  
        END IF  
    END FUNCTION  
END CLASS