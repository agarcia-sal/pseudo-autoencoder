CLASS Solution  
    FUNCTION outerTrees WITH PARAMETER trees  
        FUNCTION cross WITH PARAMETERS i j k  
            SET a TO element at position i of trees  
            SET b TO element at position j of trees  
            SET c TO element at position k of trees  
            RETURN the product of quantity b at position zero MINUS quantity a at position zero AND quantity c at position one MINUS quantity b at position one MINUS the product of quantity b at position one MINUS quantity a at position one AND quantity c at position zero MINUS quantity b at position zero  
        END FUNCTION  
        
        SET n TO the LENGTH OF trees  
        IF n LESS THAN four THEN  
            RETURN trees  
        END IF  
        
        SORT trees in ascending order  
        
        SET vis TO a list of boolean FALSE repeated n times  
        SET stk TO a list containing only zero  
        
        FOR i FROM one TO n MINUS one  
            WHILE the LENGTH OF stk GREATER THAN one AND cross with arguments element at position LENGTH OF stk MINUS two of stk element at position LENGTH OF stk MINUS one of stk AND i LESS THAN zero holds  
                SET vis at element popped from the end of stk TO FALSE  
            END WHILE  
            SET vis at position i TO TRUE  
            APPEND i TO stk  
        END FOR  
        
        SET m TO the LENGTH OF stk  
        
        FOR i FROM n MINUS two DOWN TO zero DECREMENT BY one  
            IF vis at position i IS TRUE THEN  
                CONTINUE  
            END IF  
            WHILE the LENGTH OF stk GREATER THAN m AND cross with arguments element at position LENGTH OF stk MINUS two of stk element at position LENGTH OF stk MINUS one of stk AND i LESS THAN zero holds  
                REMOVE the last element from stk  
            END WHILE  
            APPEND i TO stk  
        END FOR  
        
        REMOVE the last element from stk  
        
        SET result TO an empty list  
        FOR each index IN stk  
            APPEND element at position index of trees TO result  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS