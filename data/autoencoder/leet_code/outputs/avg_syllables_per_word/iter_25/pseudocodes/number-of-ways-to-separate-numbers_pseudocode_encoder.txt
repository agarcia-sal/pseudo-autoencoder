CLASS Solution  
    FUNCTION numberOfCombinations WITH PARAMETERS num  
        SET MOD TO ten MULTIPLIED BY ten MULTIPLIED BY ten MULTIPLIED BY ten MULTIPLIED BY ten MULTIPLIED BY ten MULTIPLIED BY ten MULTIPLIED BY ten MULTIPLIED BY ten PLUS seven  
        SET n TO the LENGTH OF num  
        SET memo TO an empty dictionary  
        
        FUNCTION dp WITH PARAMETERS index prev_len  
            IF index EQUALS n THEN  
                RETURN one  
            END IF  
            IF the PAIR of index AND prev_len IS A KEY IN memo THEN  
                RETURN the VALUE ASSOCIATED WITH the PAIR of index AND prev_len IN memo  
            END IF  
            
            SET count TO zero  
            FOR length FROM one TO n MINUS index  
                IF the element at position index OF num EQUALS the character zero THEN  
                    BREAK THE LOOP  
                END IF  
                
                SET current_num TO the substring FROM position index TO position index PLUS length OF num  
                
                IF prev_len EQUALS zero OR current_num IS GREATER THAN OR EQUAL TO the substring FROM position index MINUS prev_len TO position index OF num THEN  
                    SET count TO the REMAINDER WHEN the sum of count AND the CALL TO dp WITH ARGUMENTS index PLUS length AND length IS DIVIDED BY MOD  
                END IF  
            END FOR  
            
            ASSIGN count TO memo AT KEY the PAIR of index AND prev_len  
            RETURN count  
        END FUNCTION  
        
        RETURN the CALL TO dp WITH ARGUMENTS zero AND zero  
    END FUNCTION  
END CLASS