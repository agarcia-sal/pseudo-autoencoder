CLASS Solution  
    FUNCTION minMalwareSpread WITH PARAMETERS graph AND initial  
        SET n TO the LENGTH OF graph  
        CREATE adj_list AS a new DEFAULT DICTIONARY with LIST as default value  
        FOR i FROM zero TO n MINUS one  
            FOR j FROM i PLUS one TO n MINUS one  
                IF the element at position j of the element at position i of graph EQUALS one  
                    APPEND j TO the element at position i IN adj_list  
                    APPEND i TO the element at position j IN adj_list  
                END IF  
            END FOR  
        END FOR  

        FUNCTION dfs WITH PARAMETERS node AND visited  
            IF node IS IN visited  
                RETURN zero  
            END IF  
            ADD node TO visited  
            SET size TO one  
            FOR each neighbor IN the element at position node IN adj_list  
                INCREMENT size BY CALL dfs WITH neighbor AND visited  
            END FOR  
            RETURN size  
        END FUNCTION  

        CREATE infected AS a new SET INITIALIZED WITH initial  
        CREATE component_sizes AS a new empty LIST  
        CREATE visited AS a new empty SET  
        CREATE component_index AS a new EMPTY DICTIONARY  

        FOR node FROM zero TO n MINUS one  
            IF node IS NOT IN visited AND node IS NOT IN infected  
                SET size TO CALL dfs WITH node AND visited  
                APPEND size TO component_sizes  
                FOR i FROM the LENGTH OF component_sizes MINUS one DOWN TO zero  
                    IF the element at position i IN component_sizes EQUALS size  
                        BREAK  
                    END IF  
                END FOR  
                FOR each neighbor IN the element at position node IN adj_list  
                    SET the element at key neighbor IN component_index TO i  
                END FOR  
            END IF  
        END FOR  

        CREATE infected_in_component AS a new DEFAULT DICTIONARY with integer zero as default value  
        FOR each node IN infected  
            IF node IS IN component_index  
                INCREMENT the element at key component_index of node IN infected_in_component BY one  
            END IF  
        END FOR  

        SET max_size TO zero  
        SET node_to_remove TO the MINIMUM value IN initial  

        FOR each node IN infected  
            IF node IS IN component_index  
                SET comp_idx TO the element at key node IN component_index  
                IF the element at key comp_idx IN infected_in_component EQUALS one  
                    IF the element at position comp_idx IN component_sizes GREATER THAN max_size  
                        SET max_size TO the element at position comp_idx IN component_sizes  
                        SET node_to_remove TO node  
                    ELSE IF the element at position comp_idx IN component_sizes EQUALS max_size  
                        SET node_to_remove TO the MINIMUM value BETWEEN node_to_remove AND node  
                    END IF  
                END IF  
            END IF  
        END FOR  

        RETURN node_to_remove  
    END FUNCTION  
END CLASS