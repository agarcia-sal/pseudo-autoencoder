CLASS Solution  
    FUNCTION maxNumOfSubstrings WITH PARAMETERS s  
        SET first TO an empty dictionary  
        SET last TO an empty dictionary  
        FOR each index i AND character c IN s with index  
            IF c NOT IN first THEN  
                SET the value of first at key c TO i  
            END IF  
            SET the value of last at key c TO i  
        END FOR  
        SET intervals TO an empty list  
        FOR each character c IN first keys  
            SET start TO the value of first at key c  
            SET end TO the value of last at key c  
            SET i TO start  
            WHILE i LESS THAN OR EQUAL TO end  
                IF the value of first at key the element at position i of s LESS THAN start THEN  
                    BREAK the loop  
                END IF  
                SET end TO the greater of end and the value of last at key the element at position i of s  
                INCREMENT i BY one  
            END WHILE  
            IF the loop was not broken THEN  
                APPEND a tuple of start and end TO intervals  
            END IF  
        END FOR  
        SORT intervals by the second element in each tuple in ascending order  
        SET result TO an empty list  
        SET prev_end TO negative one  
        FOR each tuple of start and end IN intervals  
            IF start GREATER THAN prev_end THEN  
                APPEND the substring of s from position start TO position end inclusive TO result  
                SET prev_end TO end  
            END IF  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS