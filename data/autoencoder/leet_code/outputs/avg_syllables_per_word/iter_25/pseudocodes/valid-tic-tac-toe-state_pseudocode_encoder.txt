CLASS Solution  
    FUNCTION validTicTacToe(board)  
        SET countX TO zero  
        FOR each row IN board  
            INCREMENT countX BY the number of times character X OCCURS IN row  
        END FOR  
        SET countO TO zero  
        FOR each row IN board  
            INCREMENT countO BY the number of times character O OCCURS IN row  
        END FOR  
        IF countX LESS THAN countO OR countX GREATER THAN countO PLUS one THEN  
            RETURN False  
        END IF  
        FUNCTION check_win(player)  
            FOR each row IN board  
                IF every character in row EQUALS player THEN  
                    RETURN True  
                END IF  
            END FOR  
            FOR col FROM zero TO two  
                IF element at position col of element at position zero of board EQUALS player AND element at position col of element at position one of board EQUALS player AND element at position col of element at position two of board EQUALS player THEN  
                    RETURN True  
                END IF  
            END FOR  
            IF element at position zero of element at position zero of board EQUALS player AND element at position one of element at position one of board EQUALS player AND element at position two of element at position two of board EQUALS player THEN  
                RETURN True  
            END IF  
            IF element at position two of element at position zero of board EQUALS player AND element at position one of element at position one of board EQUALS player AND element at position zero of element at position two of board EQUALS player THEN  
                RETURN True  
            END IF  
            RETURN False  
        END FUNCTION  
        SET winX TO the result of check_win with argument character X  
        SET winO TO the result of check_win with argument character O  
        IF winX AND winO THEN  
            RETURN False  
        END IF  
        IF winX AND countX EQUALS countO THEN  
            RETURN False  
        END IF  
        IF winO AND countX NOT EQUALS countO THEN  
            RETURN False  
        END IF  
        RETURN True  
    END FUNCTION  
END CLASS