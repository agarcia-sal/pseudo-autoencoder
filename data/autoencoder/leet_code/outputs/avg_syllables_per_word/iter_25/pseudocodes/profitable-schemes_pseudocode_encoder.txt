CLASS Solution  
    FUNCTION profitableSchemes WITH PARAMETERS n minProfit group profit  
        SET MOD TO one billion PLUS seven  
        SET dp TO a list of lists where each inner list contains zeros with length minProfit PLUS one and the outer list contains such inner lists with count n PLUS one  
        FOR i FROM zero TO n  
            SET element at position zero of the inner list at position i of dp TO one  
        END FOR  
        FOR each element p and g taken simultaneously from profit and group  
            FOR i FROM n DOWN TO g  
                FOR j FROM minProfit DOWN TO zero  
                    SET dp at position i at position j TO the remainder after division by MOD of the sum of dp at position i at position j PLUS dp at position i MINUS g at position the maximum between zero and j MINUS p  
                END FOR  
            END FOR  
        END FOR  
        RETURN dp at position n at position minProfit  
    END FUNCTION  
END CLASS