CLASS Solution  
    FUNCTION minOperationsToFlip WITH PARAMETER expression AS string  
        SET stack TO an empty list  
        FOR each element e IN expression  
            IF e is one of the characters open parenthesis AND ampersand AND vertical bar  
                APPEND the tuple consisting of e AND zero TO stack  
                CONTINUE to the next iteration  
            END IF  
            IF e EQUALS closing parenthesis  
                SET lastPair TO the last element popped from stack  
                REMOVE the last element from stack (which is an open parenthesis)  
            ELSE  
                SET lastPair TO the tuple consisting of e AND one  
            END IF  
            IF stack is not empty AND the first element of the last tuple in stack is one of ampersand AND vertical bar  
                SET op TO the first element popped from the last tuple in stack  
                SET a AND costA TO the last tuple popped from stack  
                SET b AND costB TO lastPair  
                IF op EQUALS ampersand  
                    IF a EQUALS zero AND b EQUALS zero  
                        SET lastPair TO the tuple of zero AND one PLUS the minimum of costA AND costB  
                    ELSE IF a EQUALS zero AND b EQUALS one  
                        SET lastPair TO the tuple of zero AND one  
                    ELSE IF a EQUALS one AND b EQUALS zero  
                        SET lastPair TO the tuple of zero AND one  
                    ELSE /* a EQUALS one AND b EQUALS one */  
                        SET lastPair TO the tuple of one AND the minimum of costA AND costB  
                    END IF  
                ELSE /* op EQUALS vertical bar */  
                    IF a EQUALS zero AND b EQUALS zero  
                        SET lastPair TO the tuple of zero AND the minimum of costA AND costB  
                    ELSE IF a EQUALS zero AND b EQUALS one  
                        SET lastPair TO the tuple of one AND one  
                    ELSE IF a EQUALS one AND b EQUALS zero  
                        SET lastPair TO the tuple of one AND one  
                    ELSE /* a EQUALS one AND b EQUALS one */  
                        SET lastPair TO the tuple of one AND one PLUS the minimum of costA AND costB  
                    END IF  
                END IF  
            END IF  
            APPEND lastPair TO stack  
        END FOR  
        RETURN the second element of the last tuple in stack  
    END FUNCTION  
END CLASS