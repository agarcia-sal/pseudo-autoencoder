CLASS Solution  
    FUNCTION getLengthOfOptimalCompression WITH PARAMETERS s AND k  
        FUNCTION dp WITH PARAMETERS i AND k AND prev_char AND prev_count  
            IF k LESS THAN zero THEN  
                RETURN positive infinity  
            END IF  
            IF i EQUALS the LENGTH OF s THEN  
                RETURN zero  
            END IF  
            IF element at position i of s EQUALS prev_char THEN  
                SET increment TO one IF prev_count EQUALS one OR prev_count EQUALS nine OR prev_count EQUALS ninety nine OTHERWISE zero  
                RETURN increment PLUS the RESULT OF dp WITH PARAMETERS i PLUS one AND k AND prev_char AND prev_count PLUS one  
            ELSE  
                SET keep TO one PLUS the RESULT OF dp WITH PARAMETERS i PLUS one AND k AND element at position i of s AND one  
                SET delete TO the RESULT OF dp WITH PARAMETERS i PLUS one AND k MINUS one AND prev_char AND prev_count  
                RETURN the MINIMUM OF keep AND delete  
            END IF  
        END FUNCTION  
        RETURN the RESULT OF dp WITH PARAMETERS zero AND k AND an empty string AND zero  
    END FUNCTION  
END CLASS