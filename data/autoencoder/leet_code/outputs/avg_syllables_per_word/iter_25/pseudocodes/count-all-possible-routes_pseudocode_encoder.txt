CLASS Solution  
    FUNCTION countRoutes(locations AS List of integers COMMA start AS integer COMMA finish AS integer COMMA fuel AS integer) RETURNS integer  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF locations  

        FUNCTION dp(city AS integer COMMA remaining_fuel AS integer) RETURNS integer  
            IF remaining_fuel LESS THAN zero THEN  
                RETURN zero  
            END IF  
            SET routes TO zero  
            IF city EQUALS finish THEN  
                SET routes TO one  
            END IF  
            FOR next_city FROM zero TO n MINUS one  
                IF next_city NOT EQUALS city THEN  
                    SET fuel_cost TO the ABSOLUTE VALUE OF locations element at position city MINUS locations element at position next_city  
                    IF remaining_fuel GREATER THAN OR EQUAL TO fuel_cost THEN  
                        SET routes TO routes PLUS dp(next_city COMMA remaining_fuel MINUS fuel_cost) MODULO MOD  
                    END IF  
                END IF  
            END FOR  
            RETURN routes  
        END FUNCTION  

        RETURN dp(start COMMA fuel)  
    END FUNCTION  
END CLASS