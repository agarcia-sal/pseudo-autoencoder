CLASS Solution  
    FUNCTION smallestSubsequence WITH PARAMETERS s k letter repetition  
        SET letter_count TO the number of occurrences of letter in the string s  
        SET stack TO an empty list  
        FOR each index i and character char IN the sequence of pairs combining indices and characters of s  
            WHILE the stack is not empty AND character char is strictly less than the element at the last position of stack AND the length of s minus i plus the length of stack minus one is greater than or equal to k  
                IF the element at the last position of stack is equal to letter  
                    IF letter_count is strictly greater than repetition  
                        INCREMENT repetition BY one  
                        REMOVE the last element from stack  
                    ELSE  
                        BREAK from the while loop  
                ELSE  
                    REMOVE the last element from stack  
            END WHILE  
            IF the length of stack is less than k  
                IF char is equal to letter  
                    APPEND char TO stack  
                    DECREMENT repetition BY one  
                ELSE IF k minus the length of stack is strictly greater than repetition  
                    APPEND char TO stack  
                END IF  
                IF char is equal to letter  
                    DECREMENT letter_count BY one  
                END IF  
            END IF  
        END FOR  
        WHILE the length of stack is less than k  
            APPEND letter TO stack  
        END WHILE  
        RETURN the concatenation of all elements in stack to form a string  
    END FUNCTION  
END CLASS