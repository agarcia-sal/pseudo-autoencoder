CLASS Solution  
    FUNCTION longestDupSubstring WITH PARAMETER s  
        FUNCTION search WITH PARAMETER length  
            SET seen TO an empty set  
            FOR each integer i FROM zero TO the LENGTH OF s MINUS length PLUS one MINUS one  
                SET substring TO the string composed of characters starting at position i TO position i PLUS length MINUS one of s  
                IF substring IS IN seen THEN  
                    RETURN substring  
                END IF  
                ADD substring TO seen  
            END FOR  
            RETURN an empty string  
        END FUNCTION  
        SET left TO one  
        SET right TO the LENGTH OF s MINUS one  
        SET longest TO an empty string  
        WHILE left IS LESS THAN OR EQUAL TO right  
            SET mid TO the INTEGER DIVISION of left PLUS right BY two  
            SET candidate TO the result of calling search WITH ARGUMENT mid  
            IF candidate IS NOT an empty string THEN  
                SET longest TO candidate  
                SET left TO mid PLUS one  
            ELSE  
                SET right TO mid MINUS one  
            END IF  
        END WHILE  
        RETURN longest  
    END FUNCTION  
END CLASS