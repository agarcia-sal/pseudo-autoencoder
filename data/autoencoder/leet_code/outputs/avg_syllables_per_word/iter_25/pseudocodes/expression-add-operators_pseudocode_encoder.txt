CLASS Solution  
    FUNCTION addOperators WITH PARAMETERS num AND target  
        FUNCTION dfs WITH PARAMETERS index AND path AND value AND prev  
            IF index EQUALS the LENGTH OF num  
                IF value EQUALS target  
                    APPEND path TO result  
                END IF  
                RETURN  
            END IF  
            FOR i FROM index PLUS one TO the LENGTH OF num PLUS one  
                SET operand TO the SUBSTRING OF num FROM position index TO position i MINUS one  
                IF the LENGTH OF operand GREATER THAN one AND the CHARACTER AT position zero OF operand EQUALS THE CHARACTER ZERO  
                    CONTINUE  
                END IF  
                IF index EQUALS zero  
                    CALL dfs WITH ARGUMENTS i AND operand AND the INTEGER VALUE OF operand AND the INTEGER VALUE OF operand  
                ELSE  
                    CALL dfs WITH ARGUMENTS i AND path CONCATENATED WITH the PLUS SIGN CONCATENATED WITH operand AND value PLUS the INTEGER VALUE OF operand AND the INTEGER VALUE OF operand  
                    CALL dfs WITH ARGUMENTS i AND path CONCATENATED WITH the MINUS SIGN CONCATENATED WITH operand AND value MINUS the INTEGER VALUE OF operand AND NEGATIVE the INTEGER VALUE OF operand  
                    CALL dfs WITH ARGUMENTS i AND path CONCATENATED WITH the MULTIPLICATION SIGN CONCATENATED WITH operand AND value MINUS prev PLUS prev MULTIPLIED BY the INTEGER VALUE OF operand AND prev MULTIPLIED BY the INTEGER VALUE OF operand  
                END IF  
            END FOR  
        END FUNCTION  
        SET result TO an EMPTY LIST  
        CALL dfs WITH ARGUMENTS zero AND an EMPTY STRING AND zero AND zero  
        RETURN result  
    END FUNCTION  
END CLASS