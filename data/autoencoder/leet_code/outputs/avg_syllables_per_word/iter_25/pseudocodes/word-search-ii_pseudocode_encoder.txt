CLASS Trie  
    FUNCTION __init__ with no parameters  
        SET children TO list containing twenty six None elements  
        SET ref TO negative one  
    END FUNCTION  
  
    FUNCTION insert with parameters w and ref  
        ASSIGN reference TO self as node  
        FOR each character c IN w  
            SET idx TO the Unicode ordinal value of character c MINUS the Unicode ordinal value of character a  
            IF the element at position idx of the children list in node IS None THEN  
                ASSIGN reference TO a new Trie instance at the element at position idx of the children list in node  
            END IF  
            ASSIGN reference TO the element at position idx of the children list in node  
        END FOR  
        SET the ref attribute of node TO ref  
    END FUNCTION  
END CLASS  
  
CLASS Solution  
    FUNCTION findWords with parameters board and words  
        FUNCTION dfs with parameters node and i and j  
            SET idx TO the Unicode ordinal value of the element at position j of the element at position i of board MINUS the Unicode ordinal value of character a  
            IF the element at position idx of the children list in node IS None THEN  
                RETURN  
            END IF  
            ASSIGN reference TO the element at position idx of the children list in node  
            IF the ref attribute of node IS GREATER THAN OR EQUAL TO zero THEN  
                APPEND the element at position ref of words TO ans  
                SET the ref attribute of node TO negative one  
            END IF  
            SET c TO the element at position j of the element at position i of board  
            SET the element at position j of the element at position i of board TO the character symbol representing hash  
            FOR each pair of consecutive elements a and b IN the sequence negative one zero one zero negative one  
                SET x TO i PLUS a  
                SET y TO j PLUS b  
                IF x IS GREATER THAN OR EQUAL TO zero AND x IS LESS THAN m AND y IS GREATER THAN OR EQUAL TO zero AND y IS LESS THAN n AND the element at position y of the element at position x of board IS NOT the character symbol representing hash THEN  
                    CALL dfs with arguments node x and y  
                END IF  
            END FOR  
            SET the element at position j of the element at position i of board TO c  
        END FUNCTION  
  
        ASSIGN reference TO a new Trie instance as tree  
        FOR each index i and word w AS enumeration of words  
            CALL the insert method of tree with arguments w and i  
        END FOR  
        SET m TO the length of board  
        SET n TO the length of the first element of board  
        SET ans TO an empty list  
        FOR each integer i FROM zero TO m MINUS one  
            FOR each integer j FROM zero TO n MINUS one  
                CALL dfs with arguments tree i and j  
            END FOR  
        END FOR  
        RETURN ans  
    END FUNCTION  
END CLASS