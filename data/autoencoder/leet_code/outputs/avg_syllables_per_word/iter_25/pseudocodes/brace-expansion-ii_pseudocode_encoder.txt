CLASS Solution  
    FUNCTION braceExpansionII WITH PARAMETER expression  
        FUNCTION parse_expression WITH PARAMETER index  
            SET current_set TO an empty set  
            SET current_product TO a list containing an empty string  
            
            WHILE index is less than the length of expression  
                SET char TO the character at position index of expression  
                
                IF char is equal to the left curly brace  
                    CALL parse_expression WITH parameter index plus one AND STORE the returned values in inner_set and index  
                    SET current_product TO a new list formed by concatenating each element a in current_product with each element b in inner_set  
                ELSE IF char is equal to the right curly brace  
                    ADD to current_set each string formed by joining the elements of each sequence p in current_product  
                    RETURN current_set and index  
                ELSE IF char is equal to the comma character  
                    ADD to current_set each string formed by joining the elements of each sequence p in current_product  
                    SET current_product TO a list containing an empty string  
                ELSE  
                    SET current_product TO a new list formed by concatenating each element a in current_product with the character char  
                END IF  
                
                INCREMENT index BY one  
            END WHILE  
            
            ADD to current_set each string formed by joining the elements of each sequence p in current_product  
            RETURN current_set and index  
        END FUNCTION  
        
        CALL parse_expression WITH parameter zero AND STORE the returned values in result_set and an unused variable  
        RETURN the sorted list of elements in result_set  
    END FUNCTION  
END CLASS