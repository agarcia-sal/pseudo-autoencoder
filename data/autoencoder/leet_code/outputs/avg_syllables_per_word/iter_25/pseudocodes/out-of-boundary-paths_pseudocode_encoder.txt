CLASS Solution  
    FUNCTION findPaths WITH PARAMETERS m n maxMove startRow startColumn  
        SET MOD TO one billion PLUS seven  
        SET directions TO a list containing the tuples zero AND one zero AND negative one one AND zero negative one AND zero  
        SET dp TO a three dimensional list where each element is zero with dimensions m by n by maxMove PLUS one  
        FOR k FROM one TO maxMove  
            FOR i FROM zero TO m MINUS one  
                FOR j FROM zero TO n MINUS one  
                    FOR each direction tuple di dj IN directions  
                        SET ni TO i PLUS di  
                        SET nj TO j PLUS dj  
                        IF ni LESS THAN zero OR ni GREATER THAN OR EQUAL TO m OR nj LESS THAN zero OR nj GREATER THAN OR EQUAL TO n THEN  
                            SET dp element at i j k TO dp element at i j k PLUS one MODULO MOD  
                        ELSE  
                            SET dp element at i j k TO dp element at i j k PLUS dp element at ni nj k MINUS one MODULO MOD  
                        END IF  
                    END FOR  
                END FOR  
            END FOR  
        END FOR  
        RETURN dp element at startRow startColumn maxMove  
    END FUNCTION  
END CLASS