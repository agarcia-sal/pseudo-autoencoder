CLASS Solution  
    FUNCTION areConnected WITH PARAMETERS n threshold queries  
        IF threshold EQUALS zero THEN  
            RETURN a list of True repeated the LENGTH OF queries times  
        END IF  
        SET parent TO a list of integers from zero TO n inclusive  
        FUNCTION find WITH PARAMETER x  
            IF the element at position x of parent DOES NOT EQUAL x THEN  
                SET the element at position x of parent TO the result of calling find with the element at position x of parent  
            END IF  
            RETURN the element at position x of parent  
        END FUNCTION  
        FUNCTION union WITH PARAMETERS x y  
            SET rootX TO the result of calling find with x  
            SET rootY TO the result of calling find with y  
            IF rootX DOES NOT EQUAL rootY THEN  
                SET the element at position rootY of parent TO rootX  
            END IF  
        END FUNCTION  
        FOR i FROM threshold PLUS one TO n inclusive  
            FOR j FROM i MULTIPLIED BY two TO n inclusive IN STEPS OF i  
                CALL union WITH i AND j  
            END FOR  
        END FOR  
        SET result TO an empty list  
        FOR each pair a b IN queries  
            APPEND the evaluation of whether find of a EQUALS find of b TO result  
        END FOR  
        RETURN result  
    END FUNCTION  
END CLASS