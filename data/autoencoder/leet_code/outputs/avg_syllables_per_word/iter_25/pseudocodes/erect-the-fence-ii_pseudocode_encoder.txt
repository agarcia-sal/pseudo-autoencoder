CLASS Solution  
    FUNCTION outerTrees WITH PARAMETER trees  
        FUNCTION dist_sq WITH PARAMETERS p1 AND p2  
            CALCULATE the difference of element at position zero of p1 MINUS element at position zero of p2  
            RAISE the result TO THE POWER of two  
            CALCULATE the difference of element at position one of p1 MINUS element at position one of p2  
            RAISE the result TO THE POWER of two  
            RETURN the sum of the two above results  
        END FUNCTION  
        
        FUNCTION circumcenter WITH PARAMETERS p1 AND p2 AND p3  
            ASSIGN ax TO element at position zero of p1  
            ASSIGN ay TO element at position one of p1  
            ASSIGN bx TO element at position zero of p2  
            ASSIGN by TO element at position one of p2  
            ASSIGN cx TO element at position zero of p3  
            ASSIGN cy TO element at position one of p3  
            CALCULATE two MULTIPLIED BY (ax MULTIPLIED BY (by MINUS cy) PLUS bx MULTIPLIED BY (cy MINUS ay) PLUS cx MULTIPLIED BY (ay MINUS by)) AND ASSIGN TO d  
            CALCULATE ((ax MULTIPLIED BY ax PLUS ay MULTIPLIED BY ay) MULTIPLIED BY (by MINUS cy) PLUS (bx MULTIPLIED BY bx PLUS by MULTIPLIED BY by) MULTIPLIED BY (cy MINUS ay) PLUS (cx MULTIPLIED BY cx PLUS cy MULTIPLIED BY cy) MULTIPLIED BY (ay MINUS by)) DIVIDED BY d AND ASSIGN TO ux  
            CALCULATE ((ax MULTIPLIED BY ax PLUS ay MULTIPLIED BY ay) MULTIPLIED BY (cx MINUS bx) PLUS (bx MULTIPLIED BY bx PLUS by MULTIPLIED BY by) MULTIPLIED BY (ax MINUS cx) PLUS (cx MULTIPLIED BY cx PLUS cy MULTIPLIED BY cy) MULTIPLIED BY (bx MINUS ax)) DIVIDED BY d AND ASSIGN TO uy  
            RETURN a list containing ux and uy AND the square root of ((ux MINUS ax) RAISED TO THE POWER of two PLUS (uy MINUS ay) RAISED TO THE POWER of two)  
        END FUNCTION  
        
        FUNCTION welzl WITH PARAMETERS points AND boundary AND n  
            IF n EQUALS zero OR the LENGTH OF boundary EQUALS three THEN  
                IF the LENGTH OF boundary EQUALS zero THEN  
                    RETURN a list containing zero and zero AND zero  
                ELSE IF the LENGTH OF boundary EQUALS one THEN  
                    RETURN the first element of boundary AND zero  
                ELSE IF the LENGTH OF boundary EQUALS two THEN  
                    CALCULATE the center as a list containing the sum of element at position zero of the first element of boundary PLUS element at position zero of the second element of boundary DIVIDED BY two AND the sum of element at position one of the first element of boundary PLUS element at position one of the second element of boundary DIVIDED BY two  
                    CALCULATE the radius as the square root of dist_sq called with the two elements of boundary DIVIDED BY two  
                    RETURN the center AND the radius  
                ELSE  
                    RETURN circumcenter called with the elements of boundary unpacked as arguments  
                END IF  
            END IF  
            
            ASSIGN p TO element at position n MINUS one of points  
            CALL welzl with points AND boundary AND n MINUS one AND ASSIGN results to center AND radius  
            IF dist_sq called with center AND p IS LESS THAN OR EQUAL TO radius MULTIPLIED BY radius THEN  
                RETURN center AND radius  
            END IF  
            
            RETURN welzl called with points AND boundary appended with p AND n MINUS one  
        END FUNCTION  
        
        CALL shuffle on trees to reorder elements randomly  
        CALL welzl with trees AND an empty list AND the LENGTH OF trees AND ASSIGN results to center AND radius  
        RETURN a list containing element at position zero of center AND element at position one of center AND radius  
    END FUNCTION  
END CLASS