CLASS Solution  
    FUNCTION dieSimulator WITH PARAMETERS n rollMax  
        SET MOD TO one billion PLUS seven  
        SET dp TO three dimensional collection of zeroes with dimensions n PLUS one by six by maximum value in rollMax PLUS one  
        FOR each j FROM zero TO five  
            SET element at position one of element at position j of element at position one of dp TO one  
        END FOR  
        FOR each i FROM two TO n  
            FOR each j FROM zero TO five  
                FOR each k FROM one TO the element at position j of rollMax  
                    IF k GREATER THAN one THEN  
                        SET element at position k of element at position j of element at position i of dp TO the element at position k MINUS one of element at position j of element at position i MINUS one of dp  
                    ELSE  
                        SET element at position k of element at position j of element at position i of dp TO the sum over all x FROM zero TO five and y FROM one TO the element at position x of rollMax of element at position y of element at position x of element at position i MINUS one of dp for all x NOT EQUALS j  
                        SET that sum TO that sum MODULO MOD  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        SET result TO the sum over all j FROM zero TO five and k FROM one TO the element at position j of rollMax of element at position k of element at position j of element at position n of dp MODULO MOD  
        RETURN result  
    END FUNCTION  
END CLASS