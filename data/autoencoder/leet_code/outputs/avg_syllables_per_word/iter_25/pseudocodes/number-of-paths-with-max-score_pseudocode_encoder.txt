CLASS Solution  
    FUNCTION pathsWithMaxScore WITH PARAMETER board  
        SET MOD TO one billion plus seven  
        SET n TO the LENGTH OF board  
        INITIALIZE dp AS a two dimensional array of size n by n where each element is a list containing negative infinity and zero  
        SET element at position n minus one of dp and at position n minus one inside that TO a list containing zero and one  
        FOR i FROM n minus one DOWN TO zero  
            FOR j FROM n minus one DOWN TO zero  
                IF the element at position i of board and at position j inside that IS EQUAL TO letter X OR IS EQUAL TO letter S  
                    CONTINUE to the next iteration  
                END IF  
                IF the element at position i of board and at position j inside that IS NOT EQUAL TO letter E  
                    SET value TO the integer conversion of the element at position i of board and at position j inside that  
                ELSE  
                    SET value TO zero  
                END IF  
                FOR each tuple x comma y IN the collection of tuples containing one and zero comma zero and one comma one and one  
                    SET ni TO i PLUS x  
                    SET nj TO j PLUS y  
                    IF ni IS GREATER THAN OR EQUAL TO zero AND ni IS LESS THAN n AND nj IS GREATER THAN OR EQUAL TO zero AND nj IS LESS THAN n  
                        IF the first element of the element at position ni of dp and at position nj inside that IS GREATER THAN the first element of the element at position i of dp and at position j inside that  
                            SET the element at position i of dp and at position j inside that TO a list containing the first element of the element at position ni of dp and at position nj inside that PLUS value AND the second element of the element at position ni of dp and at position nj inside that  
                        ELSE IF the first element of the element at position ni of dp and at position nj inside that IS EQUAL TO the first element of the element at position i of dp and at position j inside that  
                            SET the second element of the element at position i of dp and at position j inside that TO the sum of the second element of the element at position i of dp and at position j inside that AND the second element of the element at position ni of dp and at position nj inside that MODULO MOD  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        IF the first element of the element at position zero of dp and at position zero inside that IS EQUAL TO negative infinity  
            RETURN a list containing zero and zero  
        END IF  
        RETURN a list containing the first element of the element at position zero of dp and at position zero inside that AND the second element of the element at position zero of dp and at position zero inside that  
    END FUNCTION  
END CLASS