CLASS Solution  
    FUNCTION largestPathValue(colors  
                               edges)  
        SET n TO the LENGTH OF colors  
        ASSIGN reference TO a mapping FROM default lists NAMED graph  
        SET in_degree TO a list of zeros with length n  
        FOR each pair u AND v IN edges  
            APPEND v TO the list associated WITH u IN graph  
            INCREMENT the element at position v OF in_degree BY one  
        END FOR  
        ASSIGN reference TO a double-ended queue containing elements i FOR each i FROM zero TO n MINUS one WHERE the element at position i of in_degree EQUALS zero NAMED queue  
        SET dp TO a list containing n lists EACH containing twenty-six zeros  
        SET visited TO zero  
        SET max_color_value TO zero  
        WHILE queue IS NOT empty  
            REMOVE the leftmost element FROM queue AND ASSIGN it TO node  
            INCREMENT the element at position the difference between the ASCII code of the element at position node of colors AND the ASCII code of lowercase 'a' OF the list at position node OF dp BY one  
            IF max_color_value LESS THAN the element at position the difference between the ASCII code of the element at position node of colors AND the ASCII code of lowercase 'a' OF the list at position node OF dp THEN  
                SET max_color_value TO that element value  
            END IF  
            INCREMENT visited BY one  
            FOR each neighbor IN the list associated WITH node IN graph  
                FOR each integer c FROM zero TO twenty-five  
                    IF the element at position c of the list at position neighbor OF dp LESS THAN the element at position c of the list at position node OF dp THEN  
                        SET the element at position c of the list at position neighbor OF dp TO the element at position c of the list at position node OF dp  
                    END IF  
                END FOR  
                DECREMENT the element at position neighbor OF in_degree BY one  
                IF the element at position neighbor OF in_degree EQUALS zero THEN  
                    APPEND neighbor TO queue  
                END IF  
            END FOR  
        END WHILE  
        IF visited EQUALS n THEN  
            RETURN max_color_value  
        ELSE  
            RETURN the negative of one  
        END IF  
    END FUNCTION  
END CLASS