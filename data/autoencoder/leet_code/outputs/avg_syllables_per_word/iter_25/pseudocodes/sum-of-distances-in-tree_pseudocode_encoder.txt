CLASS Solution  
    FUNCTION sumOfDistancesInTree WITH PARAMETERS n AND edges  
        SET graph TO a dictionary that provides an empty list for new keys  
        FOR each pair a and b IN edges  
            APPEND b TO the list at key a in graph  
            APPEND a TO the list at key b in graph  
        END FOR  

        SET count TO a list containing n elements each set to one  
        SET dist TO a list containing n elements each set to zero  

        FUNCTION dfs1 WITH PARAMETERS u AND p  
            FOR each v IN the list at key u in graph  
                IF v IS NOT EQUAL TO p THEN  
                    CALL dfs1 WITH v AND u  
                    INCREMENT count at position u BY count at position v  
                    INCREMENT dist at position u BY dist at position v PLUS count at position v  
                END IF  
            END FOR  
        END FUNCTION  

        CALL dfs1 WITH zero AND negative one  

        FUNCTION dfs2 WITH PARAMETERS u AND p  
            FOR each v IN the list at key u in graph  
                IF v IS NOT EQUAL TO p THEN  
                    SET dist at position v TO dist at position u MINUS count at position v PLUS n MINUS count at position v  
                    CALL dfs2 WITH v AND u  
                END IF  
            END FOR  
        END FUNCTION  

        CALL dfs2 WITH zero AND negative one  

        RETURN dist  
    END FUNCTION  
END CLASS