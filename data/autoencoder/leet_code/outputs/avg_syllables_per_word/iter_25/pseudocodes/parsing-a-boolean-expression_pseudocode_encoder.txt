CLASS Solution  
    FUNCTION parseBoolExpr(expression)  
        SET stk TO an empty list  
        FOR each character c IN expression  
            IF character c is one of the set consisting of letter t letter f exclamation mark ampersand or vertical bar  
                APPEND character c TO stk  
            ELSE IF character c is a closing parenthesis  
                SET count of true values t TO zero  
                SET count of false values f TO zero  
                WHILE the last element of stk is either letter t or letter f  
                    INCREMENT count t BY one if the last element of stk equals letter t otherwise increment by zero  
                    INCREMENT count f BY one if the last element of stk equals letter f otherwise increment by zero  
                    REMOVE the last element from stk  
                END WHILE  
                SET operator op TO the last element removed from stk  
                IF operator op equals exclamation mark  
                    SET character c TO letter t if count f is not zero otherwise to letter f  
                ELSE IF operator op equals ampersand  
                    SET character c TO letter f if count f is not zero otherwise to letter t  
                ELSE IF operator op equals vertical bar  
                    SET character c TO letter t if count t is not zero otherwise to letter f  
                END IF  
                APPEND character c TO stk  
            END IF  
        END FOR  
        RETURN whether the first element of stk equals letter t  
    END FUNCTION  
END CLASS