CLASS Solution  
    FUNCTION minCost(grid)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero of grid  
        SET directions TO a list containing tuples zero and one zero and MINUS one one and zero MINUS one and zero  
        SET costs TO a list containing m elements each being a list containing n elements each set to positive infinity  
        SET element at position zero of element at position zero of costs TO zero  
        SET pq TO a list containing a tuple of zero zero zero  
        SET visited TO an empty set  
        
        WHILE the LENGTH OF pq is greater than zero  
            REMOVE the smallest element FROM pq storing the resulting tuple in cost i j  
            
            IF the tuple i j is in visited  
                CONTINUE  
            END IF  
            ADD the tuple i j TO visited  
            
            IF i EQUALS m MINUS one AND j EQUALS n MINUS one  
                RETURN cost  
            END IF  
            
            FOR each tuple di dj in directions WITH index k  
                SET ni TO i PLUS di  
                SET nj TO j PLUS dj  
                IF ni is GREATER THAN OR EQUAL TO zero AND ni is LESS THAN m AND nj is GREATER THAN OR EQUAL TO zero AND nj is LESS THAN n  
                    IF the sum of cost PLUS one is LESS THAN costs at position ni index nj AND k PLUS one is NOT EQUAL TO element at position i index j of grid  
                        SET new_cost TO the sum of cost PLUS one  
                    ELSE  
                        SET new_cost TO cost  
                    END IF  
                    IF new_cost is LESS THAN costs at position ni index nj  
                        SET element at position ni index nj of costs TO new_cost  
                        ADD the tuple new_cost ni nj TO pq preserving heap property  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        RETURN MINUS one  
    END FUNCTION  
END CLASS