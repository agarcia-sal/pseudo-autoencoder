CLASS Solution  
    FUNCTION kthSmallestProduct(nums1, nums2, k)  
        FUNCTION count(p)  
            SET cnt TO zero  
            SET n TO the LENGTH OF nums2  
            FOR each x IN nums1  
                IF x GREATER THAN zero  
                    INCREMENT cnt BY the POSITION AFTER THE LAST OCCURRENCE IN nums2 OF THE VALUE p DIVIDED BY x  
                ELSE IF x LESS THAN zero  
                    INCREMENT cnt BY n MINUS the POSITION OF THE FIRST OCCURRENCE IN nums2 OF THE VALUE p DIVIDED BY x  
                ELSE  
                    IF p GREATER THAN OR EQUAL TO zero  
                        INCREMENT cnt BY n  
                    END IF  
                END IF  
            END FOR  
            RETURN cnt  
        END FUNCTION  
        SET mx TO the MAXIMUM OF the ABSOLUTE VALUE OF the ELEMENT AT POSITION zero OF nums1 AND the ABSOLUTE VALUE OF the ELEMENT AT THE LAST POSITION OF nums1 MULTIPLIED BY the MAXIMUM OF the ABSOLUTE VALUE OF the ELEMENT AT POSITION zero OF nums2 AND the ABSOLUTE VALUE OF the ELEMENT AT THE LAST POSITION OF nums2  
        RETURN the POSITION OF THE FIRST OCCURRENCE IN the SEQUENCE OF INTEGERS FROM NEGATIVE mx TO POSITIVE mx INCLUSIVE WHERE THE count FUNCTION RETURNS A VALUE GREATER THAN OR EQUAL TO k MINUS mx  
    END FUNCTION  
END CLASS