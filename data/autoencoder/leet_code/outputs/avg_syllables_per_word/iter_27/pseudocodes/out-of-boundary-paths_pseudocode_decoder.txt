CLASS Solution  
    FUNCTION findPaths(m n maxMove startRow startColumn)  
        SET MOD TO the number one followed by nine zeroes PLUS one  
        SET directions TO a collection of pairs representing zero and one zero and negative one one zero and negative one zero  
        INITIALIZE dp AS a three dimensional collection where each element is zero with dimensions m by n by maxMove PLUS one  
        FOR k FROM one TO maxMove  
            FOR i FROM zero TO m MINUS one  
                FOR j FROM zero TO n MINUS one  
                    FOR each pair di dj IN directions  
                        SET ni TO i PLUS di  
                        SET nj TO j PLUS dj  
                        IF ni LESS THAN zero OR ni GREATER THAN OR EQUAL TO m OR nj LESS THAN zero OR nj GREATER THAN OR EQUAL TO n  
                            SET dp element at position i j k TO dp element at position i j k PLUS one MODULO MOD  
                        ELSE  
                            SET dp element at position i j k TO dp element at position i j k PLUS dp element at position ni nj k MINUS one MODULO MOD  
                        END IF  
                    END FOR  
                END FOR  
            END FOR  
        END FOR  
        RETURN dp element at position startRow startColumn maxMove  
    END FUNCTION  
END CLASS