CLASS UnionFind  
    FUNCTION __init__(self, size)  
        SET self root TO empty list  
        SET self rank TO empty list  
        FOR element_id FROM zero TO size MINUS one  
            APPEND element_id TO self root  
            APPEND value one TO self rank  
        END FOR  
    END FUNCTION  
  
    FUNCTION find(self, x)  
        IF element at position x of self root EQUALS x  
            RETURN x  
        END IF  
        SET element at position x of self root TO self find(element at position x of self root)  
        RETURN element at position x of self root  
    END FUNCTION  
  
    FUNCTION union(self, x, y)  
        SET rootX TO self find of x  
        SET rootY TO self find of y  
        IF rootX NOT EQUALS rootY  
            IF element at position rootX of self rank GREATER THAN element at position rootY of self rank  
                SET element at position rootY of self root TO rootX  
            ELSE IF element at position rootX of self rank LESS THAN element at position rootY of self rank  
                SET element at position rootX of self root TO rootY  
            ELSE  
                SET element at position rootY of self root TO rootX  
                INCREMENT element at position rootX of self rank BY one  
            END IF  
        END IF  
    END FUNCTION  
END CLASS  
  
CLASS Solution  
    FUNCTION accountsMerge(self, accounts)  
        SET email_to_id TO empty mapping  
        ASSIGN reference TO new UnionFind object with the length of accounts as size in uf  
  
        FOR i, account IN enumeration of accounts  
            SET name TO element at position zero of account  
            SET emails TO elements from position one to the end of account  
            FOR each email IN emails  
                IF email NOT IN keys of email_to_id  
                    SET element at key email of email_to_id TO i  
                ELSE  
                    CALL union method of uf with arguments i and element at key email of email_to_id  
                END IF  
            END FOR  
        END FOR  
  
        SET merged_emails TO empty mapping from default of list  
  
        FOR each email, account_id IN items of email_to_id  
            SET root_id TO call find method of uf with argument account_id  
            APPEND email TO element at key root_id of merged_emails  
        END FOR  
  
        SET result TO empty list  
  
        FOR each account_id, emails IN items of merged_emails  
            SET name TO element at position zero of element at position account_id of accounts  
            SET sorted_emails TO emails sorted in ascending order  
            APPEND list created by concatenation of list containing name and sorted_emails TO result  
        END FOR  
  
        RETURN result  
    END FUNCTION  
END CLASS