CLASS Solution  
    FUNCTION isValid(code)  
        IMPORT regular expression module as re  
        
        SET cdata_pattern TO string representing start of CDATA section PLUS any characters minimally PLUS end of CDATA section  
        
        SET code TO result of replacing all occurrences of cdata_pattern in code with empty string using regular expression substitution  
        
        SET stack TO empty list  
        
        SET i TO zero  
        WHILE i LESS THAN the LENGTH OF code  
            IF element at position i of code EQUALS character less than  
                SET j TO position of character greater than in code starting from position i PLUS one  
                IF j EQUALS negative one  
                    RETURN false  
                END IF  
                
                SET tag_content TO substring of code from position i PLUS one TO position j MINUS one  
                
                IF LENGTH OF tag_content EQUALS zero  
                    RETURN false  
                END IF  
                
                IF element at position zero of tag_content EQUALS character forward slash  
                    SET tag_name TO substring of tag_content from position one TO end  
                    IF stack IS empty OR element at last position of stack NOT EQUALS tag_name  
                        RETURN false  
                    END IF  
                    REMOVE element at last position FROM stack  
                ELSE IF element at position zero of tag_content EQUALS character exclamation mark  
                    RETURN false  
                ELSE  
                    IF LENGTH OF tag_content LESS THAN one OR LENGTH OF tag_content GREATER THAN nine OR tag_content IS NOT all uppercase letters  
                        RETURN false  
                    END IF  
                    APPEND tag_content TO stack  
                END IF  
                
                SET i TO j PLUS one  
            ELSE  
                INCREMENT i BY one  
            END IF  
        END WHILE  
        
        SET valid_tag_presence TO result of searching code with pattern matching opening tag with uppercase letters PLUS any characters PLUS corresponding closing tag with uppercase letters using regular expression find all  
        
        RETURN stack IS empty AND LENGTH OF valid_tag_presence GREATER THAN zero  
    END FUNCTION  
END CLASS