CLASS Solution  
    FUNCTION largestPathValue(colors  
                                edges)  
        SET n TO the LENGTH OF colors  
        CREATE graph AS a mapping from each node TO a LIST of its adjacent nodes initially empty  
        CREATE in_degree AS a LIST of zeroes with LENGTH n  
        
        FOR each pair of u and v IN edges  
            APPEND v TO the list of adjacent nodes for u in graph  
            INCREMENT the element at position v of in_degree BY one  
        END FOR  
        
        CREATE queue AS a double ended queue containing each index i FROM zero TO n MINUS one WHERE the element at position i of in_degree EQUALS zero  
        CREATE dp AS a LIST with n elements each of which IS a LIST of twenty six zeroes  
        SET visited TO zero  
        SET max_color_value TO zero  
        
        WHILE queue is not empty  
            REMOVE and RETURN the leftmost element of queue INTO node  
            INCREMENT the element at position (the Unicode code point of the element at position node of colors MINUS the Unicode code point of the lowercase letter a) of dp at position node BY one  
            IF max_color_value LESS THAN the element at position (the Unicode code point of the element at position node of colors MINUS the Unicode code point of the lowercase letter a) of dp at position node  
                SET max_color_value TO the element at position (the Unicode code point of the element at position node of colors MINUS the Unicode code point of the lowercase letter a) of dp at position node  
            END IF  
            INCREMENT visited BY one  
            
            FOR each neighbor IN the adjacency list of node in graph  
                FOR c FROM zero TO twenty five  
                    IF the element at position c of dp at position neighbor LESS THAN the element at position c of dp at position node  
                        SET the element at position c of dp at position neighbor TO the element at position c of dp at position node  
                    END IF  
                END FOR  
                DECREMENT the element at position neighbor of in_degree BY one  
                IF the element at position neighbor of in_degree EQUALS zero  
                    APPEND neighbor TO queue  
                END IF  
            END FOR  
        END WHILE  
        
        IF visited EQUALS n  
            RETURN max_color_value  
        ELSE  
            RETURN minus one  
        END IF  
    END FUNCTION  
END CLASS