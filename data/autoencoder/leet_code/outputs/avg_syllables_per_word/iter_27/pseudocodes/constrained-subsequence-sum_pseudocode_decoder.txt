CLASS Solution  
    FUNCTION constrainedSubsetSum(nums, k)  
        SET n TO the LENGTH OF nums  
        INITIALIZE dp AS a list of zero repeated n times  
        SET element at position zero of dp TO element at position zero of nums  
        SET max_sum TO element at position zero of nums  
        
        INITIALIZE q AS a deque containing element zero  
        
        FOR i FROM one TO n MINUS one  
            IF element at position q at zero of dp GREATER THAN zero  
                SET dp_at_q_front TO element at position q at zero of dp  
            ELSE  
                SET dp_at_q_front TO zero  
            END IF  
            SET element at position i of dp TO element at position i of nums PLUS dp_at_q_front  
            
            IF max_sum LESS THAN element at position i of dp  
                SET max_sum TO element at position i of dp  
            END IF  
            
            WHILE the LENGTH OF q GREATER THAN zero AND element at position i of dp GREATER THAN OR EQUAL TO element at position at the last index of q of dp  
                REMOVE the last element FROM q  
            END WHILE  
            
            APPEND i TO q  
            
            IF element at position q at zero EQUALS i MINUS k  
                REMOVE the first element FROM q  
            END IF  
        END FOR  
        
        RETURN max_sum  
    END FUNCTION  
END CLASS