CLASS Solution  
    FUNCTION maximumBeauty(flowers)  
        CREATE empty dictionary named indices with list as default value  
        
        CREATE list named prefix_sum with length equal to the length of flowers PLUS one  
        SET element at position zero of prefix_sum TO zero  
        
        FOR index FROM zero TO the length of flowers MINUS one  
            SET element at position index PLUS one of prefix_sum TO element at position index of prefix_sum PLUS the greater value BETWEEN element at position index of flowers AND zero  
            APPEND index TO the list in indices indexed by element at position index of flowers  
        END FOR  
        
        SET max_beauty TO negative infinity  
        
        FOR each beauty_value IN keys of indices  
            IF length of the list in indices indexed by beauty_value IS GREATER THAN OR EQUAL TO two  
                SET first TO element at position zero of the list in indices indexed by beauty_value  
                SET last TO element at position length of the list in indices indexed by beauty_value MINUS one  
                
                SET current_beauty TO two MULTIPLIED BY beauty_value PLUS element at position last of prefix_sum MINUS element at position first PLUS one of prefix_sum  
                IF current_beauty IS GREATER THAN max_beauty  
                    SET max_beauty TO current_beauty  
                END IF  
            END IF  
        END FOR  
        
        RETURN max_beauty  
    END FUNCTION  
END CLASS