CLASS Solution  
    FUNCTION nextPalindrome(num)  
        SET n TO the LENGTH OF num  
        SET half TO the SUBSTRING from position zero TO position n DIVIDED BY two MINUS one OF num  
        
        SET half_list TO the LIST OF characters IN half  
        SET k TO negative one  
        SET l TO negative one  
        
        FOR i FROM the LENGTH OF half_list MINUS two TO zero DECREMENTED BY one  
            IF the character at position i of half_list IS LESS THAN the character at position i PLUS one of half_list  
                SET k TO i  
                BREAK the loop  
            END IF  
        END FOR  
        
        IF k EQUALS negative one  
            RETURN an empty string  
        END IF  
        
        FOR i FROM the LENGTH OF half_list MINUS one TO k PLUS one DECREMENTED BY one  
            IF the character at position i of half_list IS GREATER THAN the character at position k of half_list  
                SET l TO i  
                BREAK the loop  
            END IF  
        END FOR  
        
        SET temporary TO the character at position k of half_list  
        SET the character at position k of half_list TO the character at position l of half_list  
        SET the character at position l of half_list TO temporary  
        
        SET half_list TO the elements from position zero TO position k PLUS one of half_list CONCATENATED WITH the SORTED elements from position k PLUS one TO the END OF half_list  
        
        SET new_half TO the STRING FORMED BY the concatenation of characters IN half_list  
        
        IF n MODULO two EQUALS zero  
            RETURN new_half CONCATENATED WITH the REVERSE OF new_half  
        ELSE  
            RETURN new_half CONCATENATED WITH the character at position n DIVIDED BY two of num CONCATENATED WITH the REVERSE OF new_half  
        END IF  
    END FUNCTION  
END CLASS