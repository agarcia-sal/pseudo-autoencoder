CLASS Solution  
    FUNCTION containVirus(isInfected)  
        FUNCTION neighbors(r, c)  
            RETURN a list consisting of element at position r PLUS one and element at position c  
            followed by element at position r MINUS one and element at position c  
            followed by element at position r and element at position c PLUS one  
            followed by element at position r and element at position c MINUS one  
        END FUNCTION  

        FUNCTION bfs(r, c)  
            SET infected TO an empty set  
            SET threatened TO an empty set  
            SET queue TO a double ended queue initialized with a tuple of r and c  
            SET visited TO a set initialized with a tuple of r and c  
            WHILE the LENGTH OF queue GREATER THAN zero holds  
                REMOVE the element from the left of queue and DESTRUCTURE it INTO x and y  
                ADD the tuple of x and y TO infected  
                FOR each tuple nx, ny IN neighbors(x, y)  
                    IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n AND the tuple nx, ny NOT IN visited holds  
                        ADD the tuple nx, ny TO visited  
                        IF the element at position nx of isInfected and element at position ny EQUALS one  
                            APPEND the tuple nx, ny TO queue  
                        ELSE IF the element at position nx of isInfected and element at position ny EQUALS zero  
                            ADD the tuple nx, ny TO threatened  
                        END IF  
                    END IF  
                END FOR  
            END WHILE  
            RETURN the tuple infected and threatened  
        END FUNCTION  

        FUNCTION build_walls(infected)  
            SET walls TO zero  
            FOR each tuple x, y IN infected  
                FOR each tuple nx, ny IN neighbors(x, y)  
                    IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n AND the element at position nx of isInfected and element at position ny EQUALS zero  
                        INCREMENT walls BY one  
                    END IF  
                END FOR  
            END FOR  
            RETURN walls  
        END FUNCTION  

        FUNCTION spread_virus(threatened)  
            FOR each tuple x, y IN threatened  
                SET the element at position x of isInfected and element at position y TO one  
            END FOR  
        END FUNCTION  

        SET m TO the LENGTH OF isInfected  
        SET n TO the LENGTH OF element at position zero of isInfected  
        SET total_walls TO zero  

        WHILE TRUE holds  
            SET regions TO an empty list  
            SET visited TO an empty set  
            FOR r FROM zero TO m MINUS one  
                FOR c FROM zero TO n MINUS one  
                    IF the element at position r of isInfected and element at position c EQUALS one AND the tuple r, c NOT IN visited  
                        CALL bfs WITH r and c AND DESTRUCTURE RESULT INTO infected and threatened  
                        APPEND the tuple infected and threatened TO regions  
                        UNION visited WITH infected  
                    END IF  
                END FOR  
            END FOR  

            IF the LENGTH OF regions EQUALS zero  
                BREAK  
            END IF  

            SORT regions in descending order based on the LENGTH OF the threatened set in each tuple  

            INCREMENT total_walls BY the RESULT OF build_walls CALLED WITH the infected set of the first element of regions  

            FOR each tuple x, y IN the infected set of the first element of regions  
                SET the element at position x of isInfected and element at position y TO negative one  
            END FOR  

            FOR i FROM one TO the LENGTH OF regions MINUS one  
                CALL spread_virus WITH the threatened set of the element at position i of regions  
            END FOR  
        END WHILE  

        RETURN total_walls  
    END FUNCTION  
END CLASS