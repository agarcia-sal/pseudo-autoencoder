CLASS Solution  
    FUNCTION minMalwareSpread(graph parameter initial parameter)  
        SET n TO the LENGTH OF graph  
        CREATE empty mapping adj_list FROM integers TO lists  
        FOR i FROM zero TO n MINUS one  
            FOR j FROM i PLUS one TO n MINUS one  
                IF element at position j of element at position i of graph EQUALS one  
                    APPEND j TO the list at key i in adj_list  
                    APPEND i TO the list at key j in adj_list  
                END IF  
            END FOR  
        END FOR  
        
        FUNCTION dfs(node parameter visited parameter)  
            IF node IS IN visited  
                RETURN zero  
            END IF  
            ADD node TO visited  
            SET size TO one  
            FOR each neighbor IN the list at key node in adj_list  
                INCREMENT size BY the RESULT OF dfs with neighbor and visited  
            END FOR  
            RETURN size  
        END FUNCTION  
        
        CREATE set infected AND ADD all elements FROM initial INTO infected  
        
        CREATE empty list component_sizes  
        CREATE empty set visited  
        CREATE empty mapping component_index FROM integers TO integers  
        
        FOR node FROM zero TO n MINUS one  
            IF node IS NOT IN visited AND node IS NOT IN infected  
                SET size TO the RESULT OF dfs with node and visited  
                APPEND size TO component_sizes  
                FOR i FROM the LENGTH OF component_sizes MINUS one DOWNTO zero  
                    IF element at position i of component_sizes EQUALS size  
                        BREAK the loop  
                    END IF  
                END FOR  
                FOR each neighbor IN the list at key node in adj_list  
                    SET component_index at key neighbor TO i  
                END FOR  
            END IF  
        END FOR  
        
        CREATE mapping infected_in_component FROM integers TO zero  
        
        FOR each node IN infected  
            IF node IS IN component_index  
                INCREMENT infected_in_component at key component_index at key node BY one  
            END IF  
        END FOR  
        
        SET max_size TO zero  
        SET node_to_remove TO the smallest element IN initial  
        
        FOR each node IN infected  
            IF node IS IN component_index  
                SET comp_idx TO component_index at key node  
                IF infected_in_component at key comp_idx EQUALS one  
                    IF element at position comp_idx of component_sizes GREATER THAN max_size  
                        SET max_size TO element at position comp_idx of component_sizes  
                        SET node_to_remove TO node  
                    ELSE IF element at position comp_idx of component_sizes EQUALS max_size  
                        SET node_to_remove TO the smaller of node_to_remove AND node  
                    END IF  
                END IF  
            END IF  
        END FOR  
        
        RETURN node_to_remove  
    END FUNCTION  
END CLASS