CLASS Solution  
    FUNCTION maxEqualFreq(nums)  
        SET count TO an empty mapping of elements to counts  
        SET freq TO an empty mapping of counts to their frequencies  
        SET max_len TO zero  
        
        FOR each pair of index i and element num IN enumeration of nums  
            INCREMENT the count of element num BY one in count  
            
            IF the count of element num is GREATER THAN one  
                DECREMENT the frequency of count of element num MINUS one BY one in freq  
                IF the frequency of count of element num MINUS one EQUALS zero  
                    REMOVE the element count of element num MINUS one FROM freq  
                END IF  
            END IF  
            
            INCREMENT the frequency of count of element num BY one in freq  
            
            IF the number of distinct keys in freq EQUALS one AND  
               (freq CONTAINS the key one OR the only value in freq EQUALS one)  
                SET max_len TO i PLUS one  
            ELSE IF the number of distinct keys in freq EQUALS two AND  
                    (freq CONTAINS the key one AND the frequency for key one EQUALS one OR  
                     the difference BETWEEN the maximum key in freq AND the minimum key in freq EQUALS one AND  
                     the frequency of the maximum key in freq EQUALS one)  
                SET max_len TO i PLUS one  
            END IF  
        END FOR  
        
        RETURN max_len  
    END FUNCTION  
END CLASS