CLASS Solution  
    FUNCTION profitableSchemes WITH PARAMETERS n minProfit group profit  
        SET MOD TO one billion PLUS seven  
        INITIALIZE dp AS list OF lists WITH zero values WITH LENGTH n PLUS one BY minProfit PLUS one  
        FOR each i FROM zero TO n  
            SET element at position zero of dp at position i TO one  
        END FOR  
        FOR each pair of p and g FROM profit AND group correspondingly  
            FOR each i FROM n DOWN TO g  
                FOR each j FROM minProfit DOWN TO zero  
                    SET dp at position i at position j TO dp at position i at position j PLUS dp at position i MINUS g at position maximum of zero AND j MINUS p  
                    SET dp at position i at position j TO dp at position i at position j MODULO MOD  
                END FOR  
            END FOR  
        END FOR  
        RETURN dp at position n at position minProfit  
    END FUNCTION  
END CLASS