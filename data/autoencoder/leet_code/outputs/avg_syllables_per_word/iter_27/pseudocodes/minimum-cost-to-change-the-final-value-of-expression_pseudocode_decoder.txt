CLASS Solution  
    FUNCTION minOperationsToFlip(expression)  
        SET stack TO empty list  
        
        FOR each element e IN expression  
            IF element e EQUALS opening parenthesis OR element e EQUALS logical AND operator OR element e EQUALS logical OR operator  
                APPEND tuple of element e AND zero TO stack  
                CONTINUE to next iteration  
            ELSE IF element e EQUALS closing parenthesis  
                SET lastPair TO the last element popped from stack  
                POP the last element from stack  
            ELSE  
                SET lastPair TO tuple of element e AND one  
            END IF  
            
            IF stack is not empty AND the first element of the last element in stack EQUALS logical AND operator OR EQUALS logical OR operator  
                SET op TO the first element popped from stack  
                SET a TO the first element popped from stack  
                SET costA TO the second element of the last popped element  
                SET b TO the first element of lastPair  
                SET costB TO the second element of lastPair  
                
                IF op EQUALS logical AND operator  
                    IF a EQUALS character zero AND b EQUALS character zero  
                        SET lastPair TO tuple of character zero AND one PLUS the smaller of costA AND costB  
                    ELSE IF a EQUALS character zero AND b EQUALS character one  
                        SET lastPair TO tuple of character zero AND one  
                    ELSE IF a EQUALS character one AND b EQUALS character zero  
                        SET lastPair TO tuple of character zero AND one  
                    ELSE  
                        SET lastPair TO tuple of character one AND the smaller of costA AND costB  
                    END IF  
                ELSE  
                    IF a EQUALS character zero AND b EQUALS character zero  
                        SET lastPair TO tuple of character zero AND the smaller of costA AND costB  
                    ELSE IF a EQUALS character zero AND b EQUALS character one  
                        SET lastPair TO tuple of character one AND one  
                    ELSE IF a EQUALS character one AND b EQUALS character zero  
                        SET lastPair TO tuple of character one AND one  
                    ELSE  
                        SET lastPair TO tuple of character one AND one PLUS the smaller of costA AND costB  
                    END IF  
                END IF  
            END IF  
            
            APPEND lastPair TO stack  
        END FOR  
        
        RETURN the second element of the last element in stack  
    END FUNCTION  
END CLASS