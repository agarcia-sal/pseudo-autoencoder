CLASS Solution  
    FUNCTION countSubranges(nums1 nums1List OF INTEGERS nums2 nums2List OF INTEGERS) RETURNS INTEGER  
        SET n TO the LENGTH OF nums1List  
        SET count TO zero  
        SET dp TO a LIST WITH n ELEMENTS WHERE each ELEMENT IS a new DICTIONARY with INTEGER keys AND INTEGER values  
        
        FOR i FROM zero TO n MINUS one  
            INCREMENT the VALUE at key element at position i of nums1List IN the DICTIONARY at position i OF dp BY one  
            INCREMENT the VALUE at key NEGATIVE of element at position i of nums2List IN the DICTIONARY at position i OF dp BY one  
            
            IF i GREATER THAN zero THEN  
                FOR each key balance AND corresponding value freq IN the DICTIONARY at position i MINUS one OF dp  
                    SET the VALUE at key balance PLUS element at position i of nums1List IN the DICTIONARY at position i OF dp TO the VALUE at the same key PLUS freq MODULO MOD  
                    SET the VALUE at key balance MINUS element at position i of nums2List IN the DICTIONARY at position i OF dp TO the VALUE at the same key PLUS freq MODULO MOD  
                END FOR  
            END IF  
            
            SET count TO count PLUS the VALUE at key zero IN the DICTIONARY at position i OF dp MODULO MOD  
        END FOR  
        
        RETURN count  
    END FUNCTION  
END CLASS