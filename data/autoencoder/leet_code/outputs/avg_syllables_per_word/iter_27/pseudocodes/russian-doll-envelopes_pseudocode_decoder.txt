CLASS Solution  
    FUNCTION maxEnvelopes(envelopes)  
        SORT envelopes IN ASCENDING ORDER BY element at position zero OF envelope AND IN DESCENDING ORDER BY element at position one OF envelope WHEN element at position zero OF envelope IS EQUAL TO element at position zero OF another envelope  
        SET dp TO empty list  
        FOR each unused_variable AND height IN envelopes  
            SET idx TO the position found by binary search on dp FOR height to be inserted at the leftmost position without changing order  
            IF idx EQUALS the LENGTH OF dp  
                APPEND height TO dp  
            ELSE  
                SET element at position idx OF dp TO height  
            END IF  
        END FOR  
        RETURN the LENGTH OF dp  
    END FUNCTION  
END CLASS