CLASS Solution  
    FUNCTION leastBricks(wall)  
        ASSIGN reference TO a new empty mapping from keys to numbers named gap_counts  
        
        FOR each row IN wall  
            SET total TO zero  
            FOR each element at positions from first position TO the second last position of row  
                INCREMENT total BY element at current position of row  
                IF element total EXISTS AS key in gap_counts  
                    INCREMENT the value associated with key total in gap_counts BY one  
                ELSE  
                    SET the value associated with key total in gap_counts TO one  
                END IF  
            END FOR  
        END FOR  
        
        SET max_gaps TO zero  
        FOR each value IN the collection of all values in gap_counts  
            IF value GREATER THAN max_gaps  
                SET max_gaps TO value  
            END IF  
        END FOR  
        
        SET result TO the length of wall MINUS max_gaps  
        RETURN result  
    END FUNCTION  
END CLASS