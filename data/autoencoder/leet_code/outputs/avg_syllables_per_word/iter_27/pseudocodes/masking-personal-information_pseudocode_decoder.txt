CLASS Solution  
    FUNCTION maskPII(s)  
        IF character AT position one of s EQUALS the at symbol OR s CONTAINS the at symbol  
            SET list_of_parts TO the list of elements obtained by splitting s at the at symbol  
            SET local TO element at position one of list_of_parts  
            SET domain TO element at position two of list_of_parts  
            SET first_character TO character at position one of local  
            SET last_character TO character at position equal to the length of local of local  
            SET masked_local TO first_character PLUS the string consisting of the character asterisk repeated five times PLUS last_character  
            SET masked_local_lower TO the lowercase form of masked_local  
            SET domain_lower TO the lowercase form of domain  
            RETURN the concatenation of masked_local_lower PLUS the at symbol PLUS domain_lower  
        ELSE  
            SET list_of_characters TO the list of characters in s  
            SET list_of_digits TO the list obtained by filtering list_of_characters keeping only those characters that are digits  
            SET digits TO the concatenation of all elements in list_of_digits as a string  
            SET last_four_digits TO the substring of digits from position equal to the length of digits minus three TO position equal to the length of digits  
            SET local_number TO the concatenation of the string consisting of three asterisks PLUS a dash PLUS three asterisks PLUS a dash PLUS last_four_digits  
            IF the length of digits EQUALS ten  
                RETURN local_number  
            ELSE  
                SET country_code_length TO the length of digits MINUS ten  
                SET country_code TO the concatenation of the plus symbol PLUS the string consisting of the character asterisk repeated country_code_length times PLUS a dash  
                RETURN the concatenation of country_code PLUS local_number  
            END IF  
        END IF  
    END FUNCTION  
END CLASS