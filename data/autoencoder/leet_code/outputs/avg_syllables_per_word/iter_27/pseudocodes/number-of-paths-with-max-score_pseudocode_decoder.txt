CLASS Solution  
    FUNCTION pathsWithMaxScore(board)  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF board  
          
        SET dp TO a two dimensional collection of size n by n where each element is a pair containing NEGATIVE infinity and zero  
          
        SET the element at position n MINUS one n MINUS one of dp TO a pair containing zero and one  
          
        FOR i FROM n MINUS one DOWN TO zero  
            FOR j FROM n MINUS one DOWN TO zero  
                IF the character at position j of the string at position i of board EQUALS one of the characters X or S  
                    CONTINUE to the next iteration  
                END IF  
                  
                IF the character at position j of the string at position i of board EQUALS the character E  
                    SET value TO zero  
                ELSE  
                    SET value TO the integer value of the character at position j of the string at position i of board  
                END IF  
                  
                FOR each pair of offsets x y IN the collection containing the pairs one zero zero one and one one  
                    SET ni TO i PLUS x  
                    SET nj TO j PLUS y  
                    IF ni IS GREATER THAN OR EQUAL TO zero AND ni IS LESS THAN n AND nj IS GREATER THAN OR EQUAL TO zero AND nj IS LESS THAN n  
                        IF the first element of the pair at position ni nj of dp IS GREATER THAN the first element of the pair at position i j of dp  
                            SET the element at position i j of dp TO a pair containing the sum of the first element of the pair at position ni nj of dp PLUS value and the second element of the pair at position ni nj of dp  
                        ELSE IF the first element of the pair at position ni nj of dp EQUALS the first element of the pair at position i j of dp  
                            SET the second element of the pair at position i j of dp TO the sum of the second element of the pair at position i j of dp PLUS the second element of the pair at position ni nj of dp MODULO MOD  
                        END IF  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
          
        IF the first element of the pair at position zero zero of dp EQUALS NEGATIVE infinity  
            RETURN a collection containing zero and zero  
        END IF  
          
        RETURN a collection containing the first element of the pair at position zero zero of dp and the second element of the pair at position zero zero of dp  
    END FUNCTION  
END CLASS