CLASS Solution  
    FUNCTION leastInterval(tasks, n)  
        SET task_counts TO a mapping of each distinct element of tasks TO the number of times the element appears  
        SET max_heap TO an empty list  
        FOR each count IN the list of values of task_counts  
            APPEND the negative of count TO max_heap  
        END FOR  
        TRANSFORM max_heap INTO a heap structure where the smallest element is always accessible  
        
        SET time TO zero  
        SET queue TO an empty list for storing pairs of time and task count  
        
        WHILE max_heap is not empty OR queue is not empty  
            WHILE queue is not empty AND the time value of the first element of queue EQUALS time  
                REMOVE the first element FROM queue AND UNPACK INTO expired_time and count  
                IF count LESS THAN zero  
                    ADD count TO max_heap maintaining heap structure  
                END IF  
            END WHILE  
            
            IF max_heap is not empty  
                REMOVE the smallest element FROM max_heap AND STORE IN count  
                INCREMENT count BY one  
                IF count LESS THAN zero  
                    APPEND the pair of the sum of time PLUS n PLUS one AND count TO queue  
                END IF  
            END IF  
            
            INCREMENT time BY one  
        END WHILE  
        
        RETURN time  
    END FUNCTION  
END CLASS