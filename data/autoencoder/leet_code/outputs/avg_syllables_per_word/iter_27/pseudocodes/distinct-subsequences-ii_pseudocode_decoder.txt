CLASS Solution  
    FUNCTION distinctSubseqII(s)  
        SET MODULO TO one billion PLUS seven  
        SET length_of_s TO the LENGTH OF s  
        SET dp TO a list of zeroes of size length_of_s PLUS one  
        SET element at position zero of dp TO one  
        SET last_occurrence TO an empty dictionary  
        
        FOR index FROM one TO length_of_s  
            SET current_character TO element at position index MINUS one of s  
            SET element at position index of dp TO the element at position index MINUS one of dp MULTIPLIED BY two MODULO MODULO  
            
            IF current_character EXISTS IN last_occurrence  
                SET element at position index of dp TO element at position index of dp MINUS element at position last_occurrence of current_character MINUS one of dp PLUS MODULO MODULO MODULO  
            END IF  
            
            SET the last_occurrence of current_character TO index  
        END FOR  
        
        RETURN element at position length_of_s of dp MINUS one MODULO MODULO  
    END FUNCTION  
END CLASS