CLASS Solution  
    FUNCTION ways(pizza, k)  
        FUNCTION dfs(i, j, k)  
            IF k EQUALS zero  
                IF the value at position row m and column n of matrix s MINUS the value at position row i and column n of matrix s MINUS the value at position row m and column j of matrix s PLUS the value at position row i and column j of matrix s GREATER THAN zero  
                    RETURN one  
                ELSE  
                    RETURN zero  
                END IF  
            END IF  
            SET ans TO zero  
            FOR each x FROM i PLUS one TO m MINUS one  
                IF the value at position row x and column n of matrix s MINUS the value at position row i and column n of matrix s MINUS the value at position row x and column j of matrix s PLUS the value at position row i and column j of matrix s GREATER THAN zero  
                    INCREMENT ans BY the result of dfs with parameters x, j, k MINUS one  
                END IF  
            END FOR  
            FOR each y FROM j PLUS one TO n MINUS one  
                IF the value at position row m and column y of matrix s MINUS the value at position row i and column y of matrix s MINUS the value at position row m and column j of matrix s PLUS the value at position row i and column j of matrix s GREATER THAN zero  
                    INCREMENT ans BY the result of dfs with parameters i, y, k MINUS one  
                END IF  
            END FOR  
            RETURN ans MODULO mod  
        END FUNCTION  
        SET mod TO ten RAISED TO THE POWER OF nine PLUS seven  
        SET m TO the LENGTH OF pizza  
        SET n TO the LENGTH OF the element at position zero of pizza  
        INITIALIZE s AS a two dimensional matrix of zeros with number of rows equal to m PLUS one and number of columns equal to n PLUS one  
        FOR each i WITH corresponding row IN pizza STARTING FROM one  
            FOR each j WITH corresponding character c IN row STARTING FROM one  
                SET the value at position row i and column j of matrix s TO the value at position row i MINUS one and column j of matrix s PLUS the value at position row i and column j MINUS one of matrix s MINUS the value at position row i MINUS one and column j MINUS one of matrix s PLUS one IF character c EQUALS uppercase letter A OTHERWISE zero  
            END FOR  
        END FOR  
        RETURN the result of dfs with parameters zero, zero, k MINUS one  
    END FUNCTION  
END CLASS