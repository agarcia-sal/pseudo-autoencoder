CLASS Solution  
    FUNCTION minNumberOfSemesters(n parameter, relations parameter, k parameter)  
        SET graph TO a new mapping from items to empty lists  
        SET in_degree TO a list of zeros with length equal to n parameter PLUS one  
        FOR each pair previous course COMMA next course IN relations parameter  
            APPEND next course TO the list at key previous course in graph  
            INCREMENT the element at position next course of in_degree BY one  
        END FOR  
        SET queue TO a new double-ended queue  
        FOR course FROM one TO n parameter  
            IF the element at position course of in_degree EQUALS zero  
                APPEND course TO queue  
            END IF  
        END FOR  
        SET semesters TO zero  
        WHILE the LENGTH OF queue IS GREATER THAN zero  
            SET limit TO the smaller value BETWEEN k parameter AND the LENGTH OF queue  
            FOR counter FROM one TO limit  
                REMOVE the first element FROM queue AND ASSIGN it TO current course  
                FOR each next course IN the list at key current course of graph  
                    DECREMENT the element at position next course of in_degree BY one  
                    IF the element at position next course of in_degree EQUALS zero  
                        APPEND next course TO queue  
                    END IF  
                END FOR  
            END FOR  
            INCREMENT semesters BY one  
        END WHILE  
        RETURN semesters  
    END FUNCTION  
END CLASS