CLASS Solution  
    FUNCTION countRangeSum(nums lower upper)  
        SET prefix_sums TO a list containing zero  
        SET current_sum TO zero  
        SET count TO zero  
        
        FOR each num IN nums  
            SET current_sum TO current_sum PLUS num  
            
            SET left TO current_sum MINUS upper  
            SET right TO current_sum MINUS lower  
            
            SET number_of_elements_to_right TO the number of elements in prefix_sums strictly less than or equal to right  
            SET number_of_elements_to_left TO the number of elements in prefix_sums strictly less than left  
            INCREMENT count BY number_of_elements_to_right MINUS number_of_elements_to_left  
            
            INSERT current_sum into prefix_sums maintaining sorted order  
        END FOR  
        
        RETURN count  
    END FUNCTION  
END CLASS