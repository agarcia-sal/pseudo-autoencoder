CLASS Solution  
    FUNCTION wallsAndGates WITH PARAMETER rooms  
        IF rooms EQUALS nothing OR the LENGTH OF rooms EQUALS zero OR the LENGTH OF element at position zero of rooms EQUALS zero  
            RETURN nothing  
        END IF  
        SET rows TO the LENGTH OF rooms  
        SET cols TO the LENGTH OF element at position zero of rooms  
        ASSIGN reference TO a new double ended queue named queue  
        FOR variable r FROM zero TO rows MINUS one  
            FOR variable c FROM zero TO cols MINUS one  
                IF element at position r of rooms AND element at position c EQUALS zero  
                    APPEND tuple consisting of r AND c TO queue  
                END IF  
            END FOR  
        END FOR  
        SET directions TO list consisting of tuple zero AND one AND tuple one AND zero AND tuple zero AND minus one AND tuple minus one AND zero  
        WHILE the LENGTH OF queue IS GREATER THAN zero  
            REMOVE element from the left side of queue AND SET TO variables r AND c  
            FOR each tuple dr AND dc IN directions  
                SET nr TO r PLUS dr  
                SET nc TO c PLUS dc  
                IF zero LESS THAN OR EQUAL TO nr AND nr LESS THAN rows AND zero LESS THAN OR EQUAL TO nc AND nc LESS THAN cols AND element at position nr of rooms AND element at position nc EQUALS two billion one hundred forty seven million four hundred eighty three thousand six hundred forty seven  
                    SET element at position nr of rooms AND element at position nc TO element at position r of rooms AND element at position c PLUS one  
                    APPEND tuple consisting of nr AND nc TO queue  
                END IF  
            END FOR  
        END WHILE  
    END FUNCTION  
END CLASS