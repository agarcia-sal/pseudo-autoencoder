CLASS Solution  
    FUNCTION mostSimilar(n names targetPath)  
        SET graph TO a mapping from default empty list  
        FOR each road WITH elements u AND v IN roads  
            APPEND element v TO list at element u of graph  
            APPEND element u TO list at element v of graph  
        END FOR  
        SET m TO the LENGTH OF targetPath  

        FUNCTION dp(i j)  
            IF i EQUALS zero THEN  
                IF element j of names NOT EQUALS element i of targetPath THEN  
                    RETURN one AND list containing element j  
                ELSE  
                    RETURN zero AND list containing element j  
                END IF  
            END IF  
            SET min_cost TO positive infinite value  
            SET min_path TO empty list  
            FOR each element k IN list at element j of graph  
                SET cost AND path TO result of dp(i MINUS one j)  
                IF cost LESS THAN min_cost THEN  
                    SET min_cost TO cost  
                    SET min_path TO path  
                END IF  
            END FOR  
            SET current_cost TO min_cost PLUS one IF element j of names NOT EQUALS element i of targetPath OTHERWISE zero  
            RETURN current_cost AND concatenation of min_path WITH list containing element j  
        END FUNCTION  

        SET min_cost TO positive infinite value  
        SET min_path TO empty list  
        FOR j FROM zero TO n MINUS one  
            SET cost AND path TO result of dp(m MINUS one j)  
            IF cost LESS THAN min_cost THEN  
                SET min_cost TO cost  
                SET min_path TO path  
            END IF  
        END FOR  
        RETURN min_path  
    END FUNCTION  
END CLASS