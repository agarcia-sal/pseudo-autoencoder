CLASS Solution  
    FUNCTION leastInterval(tasks, n)  
        SET task_counts TO the frequency count of each element in tasks  
        SET max_heap TO a list containing each element of task_counts values converted to negative values  
        TRANSFORM max_heap into a heap structure for efficient retrieval of the smallest element  
        
        SET time TO zero  
        SET queue TO an empty list storing pairs of time plus n plus one and task count  
        
        WHILE max_heap is not empty OR queue is not empty  
            WHILE queue is not empty AND the first element of the first pair in queue EQUALS time  
                REMOVE the first pair from queue and unpack into discard_time and count  
                IF count LESS THAN zero  
                    ADD count into max_heap maintaining the heap property  
                END IF  
            END WHILE  
            
            IF max_heap is not empty  
                REMOVE the smallest element from max_heap and assign to count  
                SET count TO count PLUS one  
                IF count LESS THAN zero  
                    APPEND a pair consisting of time PLUS n PLUS one and count to queue  
                END IF  
            END IF  
            
            INCREMENT time BY one  
        END WHILE  
        
        RETURN time  
    END FUNCTION  
END CLASS