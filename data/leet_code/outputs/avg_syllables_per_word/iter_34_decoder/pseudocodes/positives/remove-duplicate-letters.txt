CLASS Solution  
    FUNCTION removeDuplicateLetters(s)  
        CREATE last_occurrence AS an empty dictionary mapping characters to indices  
        FOR index FROM zero TO the LENGTH OF s MINUS one  
            SET character TO element at position index of s  
            SET the value associated to character in last_occurrence TO index  
        END FOR  

        CREATE stack AS an empty list  
        CREATE in_stack AS an empty set  

        FOR index FROM zero TO the LENGTH OF s MINUS one  
            SET character TO element at position index of s  

            IF character IS IN in_stack  
                CONTINUE TO the next iteration  
            END IF  

            WHILE the LENGTH OF stack IS GREATER THAN zero AND character IS LESS THAN element at the last position of stack AND index IS LESS THAN the value associated to element at the last position of stack in last_occurrence  
                SET removed_char TO the element popped from the end of stack  
                REMOVE removed_char FROM in_stack  
            END WHILE  

            APPEND character TO stack  
            ADD character TO in_stack  
        END FOR  

        SET result_string TO the concatenation of all elements in stack in order  
        RETURN result_string  
    END FUNCTION  
END CLASS