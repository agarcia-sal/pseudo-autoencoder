CLASS Solution  
    FUNCTION numWays(words WITH TYPE List of string, target WITH TYPE string) RETURNS integer  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF element at position zero of words  
        SET m TO the LENGTH OF target  
        
        SET freq TO list containing n elements each being a mapping from character to zero integer  
        
        FOR each word IN words  
            FOR each position j AND character char IN word  
                INCREMENT value at character char IN freq at position j BY one  
            END FOR  
        END FOR  
        
        SET dp TO two dimensional list with m PLUS one rows AND n PLUS one columns filled with zero integer  
        
        FOR each position j FROM zero TO n  
            SET element at row zero AND column j of dp TO one  
        END FOR  
        
        FOR each position i FROM one TO m  
            FOR each position j FROM one TO n  
                SET element at row i AND column j of dp TO element at row i AND column j MINUS one of dp  
                IF value at character at position i MINUS one of target IN freq at position j MINUS one GREATER THAN zero  
                    INCREMENT element at row i AND column j of dp BY element at row i MINUS one AND column j MINUS one of dp MULTIPLIED BY value at character at position i MINUS one of target IN freq at position j MINUS one  
                    SET element at row i AND column j of dp TO element at row i AND column j of dp MODULO MOD  
                END IF  
            END FOR  
        END FOR  
        
        RETURN element at row m AND column n of dp  
    END FUNCTION  
END CLASS