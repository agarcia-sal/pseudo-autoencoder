CLASS Solution  
    FUNCTION shortestPath(grid, k)  
        IF grid EQUALS empty OR element at position zero of grid EQUALS empty  
            RETURN the negative of one  
        END IF  
        
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero of grid  
        
        IF k GREATER THAN OR EQUAL TO m PLUS n MINUS two  
            RETURN m PLUS n MINUS two  
        END IF  
        
        SET directions TO the list containing the elements: a pair of zero and one, a pair of one and zero, a pair of zero and negative one, a pair of negative one and zero  
        
        SET queue TO a double-ended queue initialized with a tuple containing zero zero k zero  
        
        SET visited TO a set initialized with the tuple containing zero zero k  
        
        WHILE queue is not empty  
            SET x y remaining_k steps TO the first element removed from the left of queue  
            
            IF x EQUALS m MINUS one AND y EQUALS n MINUS one  
                RETURN steps  
            END IF  
            
            FOR each pair dx dy IN directions  
                SET nx TO x PLUS dx  
                SET ny TO y PLUS dy  
                
                IF nx GREATER THAN OR EQUAL TO zero AND nx LESS THAN m AND ny GREATER THAN OR EQUAL TO zero AND ny LESS THAN n  
                    SET new_k TO remaining_k MINUS element at position nx of grid at position ny  
                    IF new_k GREATER THAN OR EQUAL TO zero AND the tuple containing nx ny new_k NOT IN visited  
                        ADD the tuple containing nx ny new_k TO visited  
                        APPEND the tuple containing nx ny new_k steps PLUS one TO queue  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN the negative of one  
    END FUNCTION  
END CLASS