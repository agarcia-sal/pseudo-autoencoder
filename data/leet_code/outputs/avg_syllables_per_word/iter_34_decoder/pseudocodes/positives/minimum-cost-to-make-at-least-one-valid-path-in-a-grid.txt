CLASS Solution  
    FUNCTION minCost(grid)  
        SET m TO the LENGTH OF grid  
        SET n TO the LENGTH OF element at position zero of grid  
        SET directions TO a LIST containing four PAIRS as follows  
            PAIR of zero PLUS zero AND one PLUS zero  
            PAIR of zero PLUS zero AND MINUS one PLUS zero  
            PAIR of one PLUS zero AND zero PLUS zero  
            PAIR of MINUS one PLUS zero AND zero PLUS zero  
        SET costs TO an EMPTY LIST  
        FOR each element IN range FROM zero TO m MINUS one  
            APPEND a LIST of length n where each element IS positive infinity TO costs  
        END FOR  
        SET element at position zero of element at position zero of costs TO zero  
        SET pq TO a LIST containing one TRIPLE of zero PLUS zero PLUS zero  
        SET visited TO an EMPTY SET  
        WHILE pq is NOT empty  
            REMOVE the SMALLEST element FROM pq AND DESTRUCTURE INTO cost PLUS i PLUS j  
            IF PAIR of i AND j IS IN visited  
                CONTINUE to next iteration OF THE WHILE LOOP  
            END IF  
            ADD PAIR of i AND j TO visited  
            IF i EQUALS m MINUS one AND j EQUALS n MINUS one  
                RETURN cost  
            END IF  
            FOR each index k PLUS pair di AND dj IN directions USING enumeration  
                SET ni TO i PLUS di  
                SET nj TO j PLUS dj  
                IF ni IS GREATER THAN OR EQUAL TO zero AND ni IS LESS THAN m AND nj IS GREATER THAN OR EQUAL TO zero AND nj IS LESS THAN n  
                    SET new_cost TO cost PLUS one IF k PLUS one IS NOT EQUAL TO element at position i of element at position j of grid OTHERWISE zero  
                    IF new_cost IS LESS THAN element at position ni of element at position nj of costs  
                        SET element at position ni of element at position nj of costs TO new_cost  
                        INSERT TRIPLE new_cost PLUS ni PLUS nj INTO pq MAINTAINING PRIORITY ORDER BY THE FIRST ELEMENT  
                    END IF  
                END IF  
            END FOR  
        END WHILE  
        RETURN negative one  
    END FUNCTION  
END CLASS