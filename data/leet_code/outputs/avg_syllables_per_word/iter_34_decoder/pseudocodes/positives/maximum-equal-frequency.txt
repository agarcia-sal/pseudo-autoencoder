CLASS Solution  
    FUNCTION maxEqualFreq(nums)  
        SET count TO a new empty counter mapping each number to zero  
        SET freq TO a new empty counter mapping each frequency to zero  
        SET max_len TO zero  
        
        FOR each index i AND element num IN nums with enumeration starting from zero  
            INCREMENT the value associated with num in count by one  
            
            IF the value associated with num in count is GREATER THAN one THEN  
                DECREMENT the value associated with the value associated with num in count MINUS one in freq by one  
                IF the value associated with the value associated with num in count MINUS one in freq EQUALS zero THEN  
                    REMOVE the entry for the value associated with num in count MINUS one FROM freq  
                END IF  
            END IF  
            
            INCREMENT the value associated with the value associated with num in count in freq by one  
            
            IF the number of distinct keys in freq EQUALS one AND (freq has key one OR the single value in freq EQUALS one) THEN  
                SET max_len TO i PLUS one  
            ELSE IF the number of distinct keys in freq EQUALS two AND ((freq has key one AND the value for key one in freq EQUALS one) OR (the difference between the maximum key in freq AND the minimum key in freq EQUALS one AND the value for the maximum key in freq EQUALS one)) THEN  
                SET max_len TO i PLUS one  
            END IF  
        END FOR  
        
        RETURN max_len  
    END FUNCTION  
END CLASS