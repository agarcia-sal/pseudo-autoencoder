CLASS Solution  
    FUNCTION canPartitionKSubsets(nums, k)  
        SET total_sum TO the SUM of all elements IN nums  
        IF total_sum MODULO k NOT EQUALS zero THEN  
            RETURN false  
        END IF  
        SET target TO total_sum DIVIDED BY k  
        SORT nums IN descending order  
        
        FUNCTION can_partition(index, k_remaining, current_sum, used_flags)  
            IF k_remaining EQUALS zero THEN  
                RETURN true  
            END IF  
            IF current_sum EQUALS target THEN  
                RETURN the RESULT of can_partition WITH parameters zero, k_remaining MINUS one, zero, used_flags  
            END IF  
            
            FOR each position FROM index TO the LENGTH of nums MINUS one  
                IF the element at position IN used_flags IS false AND current_sum PLUS the element at position IN nums IS LESS THAN OR EQUAL TO target THEN  
                    SET the element at position IN used_flags TO true  
                    IF the RESULT of can_partition WITH parameters position PLUS one, k_remaining, current_sum PLUS the element at position IN nums, used_flags IS true THEN  
                        RETURN true  
                    END IF  
                    SET the element at position IN used_flags TO false  
                END IF  
            END FOR  
            RETURN false  
        END FUNCTION  
        
        SET used TO a list OF boolean false values WITH the LENGTH of nums  
        RETURN the RESULT of can_partition WITH parameters zero, k, zero, used  
    END FUNCTION  
END CLASS