CLASS Solution  
    FUNCTION isPrintable(targetGrid)  
        SET color_bounds TO a new dictionary with default value as list of four elements where the first two are positive infinity and the last two are negative infinity  
        FOR r FROM zero TO the length of targetGrid MINUS one  
            FOR c FROM zero TO the length of the element at position zero of targetGrid MINUS one  
                SET color TO the element at position r of targetGrid at position c  
                SET the first element of color_bounds at key color TO the minimum value BETWEEN the first element of color_bounds at key color AND r  
                SET the second element of color_bounds at key color TO the minimum value BETWEEN the second element of color_bounds at key color AND c  
                SET the third element of color_bounds at key color TO the maximum value BETWEEN the third element of color_bounds at key color AND r  
                SET the fourth element of color_bounds at key color TO the maximum value BETWEEN the fourth element of color_bounds at key color AND c  
            END FOR  
        END FOR  
        
        SET graph TO a new dictionary with default value as an empty list  
        SET in_degree TO a new dictionary with default value as zero  
        
        FOR each color AND its bounds unpacked as minr minc maxr maxc IN color_bounds  
            FOR r FROM minr TO maxr  
                FOR c FROM minc TO maxc  
                    IF the element at position r of targetGrid at position c NOT EQUALS color THEN  
                        SET other_color TO the element at position r of targetGrid at position c  
                        APPEND color TO the list in graph at key other_color  
                        INCREMENT the value in in_degree at key color BY one  
                    END IF  
                END FOR  
            END FOR  
        END FOR  
        
        SET queue TO a new deque initialized with all colors in color_bounds for which the corresponding value in in_degree EQUALS zero  
        SET visited_colors TO zero  
        
        WHILE the queue is not empty  
            SET color TO the element removed from the left side of queue  
            INCREMENT visited_colors BY one  
            FOR each next_color IN the list in graph at key color  
                DECREMENT the value in in_degree at key next_color BY one  
                IF the value in in_degree at key next_color EQUALS zero THEN  
                    APPEND next_color TO the right side of queue  
                END IF  
            END FOR  
        END WHILE  
        
        RETURN whether visited_colors EQUALS the number of keys in color_bounds  
    END FUNCTION  
END CLASS