CLASS TrieNode  
    FUNCTION __init__(self)  
        SET children TO a new default dictionary with default value as TrieNode  
        SET count TO zero  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION maxGeneticDifference(self, parents, queries)  
        SET tree TO a new default dictionary with default value as an empty list  
        FOR index FROM zero TO the length of parents MINUS one  
            SET parent TO element at position index of parents  
            IF parent NOT EQUALS negative one THEN  
                APPEND index TO element at position parent of tree  
            END IF  
        END FOR  

        SET node_queries TO a new default dictionary with default value as an empty list  
        FOR each node_value_pair IN queries  
            SET node TO element at position zero of node_value_pair  
            SET val TO element at position one of node_value_pair  
            APPEND val TO element at position node of node_queries  
        END FOR  

        SET root TO a new instance of TrieNode  
        SET result TO a list of zeros with length equal to the length of queries  

        FUNCTION dfs(node)  
            CALL insert WITH trie_root AS root AND value AS node  

            FOR each val IN element at position node of node_queries  
                SET result at position element at position node and val in query_idx TO call max_xor WITH trie_root AS root AND value AS val  
            END FOR  

            FOR each child IN element at position node of tree  
                CALL dfs WITH child  
            END FOR  

            CALL erase WITH trie_root AS root AND value AS node  
        END FUNCTION  

        FUNCTION insert(trie_root, value)  
            SET current_node TO trie_root  
            FOR i FROM seventeen DOWNTO zero  
                SET bit TO value DIVIDED BY two RAISED TO the power i MODULO two  
                SET current_node TO element at position bit of current_node.children  
                INCREMENT current_node.count BY one  
            END FOR  
        END FUNCTION  

        FUNCTION erase(trie_root, value)  
            SET current_node TO trie_root  
            FOR i FROM seventeen DOWNTO zero  
                SET bit TO value DIVIDED BY two RAISED TO the power i MODULO two  
                SET current_node TO element at position bit of current_node.children  
                DECREMENT current_node.count BY one  
            END FOR  
        END FUNCTION  

        FUNCTION max_xor(trie_root, value)  
            SET current_node TO trie_root  
            SET max_xor_val TO zero  
            FOR i FROM seventeen DOWNTO zero  
                SET bit TO value DIVIDED BY two RAISED TO the power i MODULO two  
                SET toggled_bit TO one MINUS bit  
                IF element at position toggled_bit of current_node.children EXISTS AND count of element at position toggled_bit of current_node.children GREATER THAN zero THEN  
                    INCREMENT max_xor_val BY two RAISED TO the power i  
                    SET current_node TO element at position toggled_bit of current_node.children  
                ELSE  
                    SET current_node TO element at position bit of current_node.children  
                END IF  
            END FOR  
            RETURN max_xor_val  
        END FUNCTION  

        SET query_idx TO an empty dictionary  
        FOR index FROM zero TO the length of queries MINUS one  
            SET node TO element at position zero of element at position index of queries  
            SET val TO element at position one of element at position index of queries  
            SET element at position node and val of query_idx TO index  
        END FOR  

        FOR index FROM zero TO the length of parents MINUS one  
            SET parent TO element at position index of parents  
            IF parent EQUALS negative one THEN  
                CALL dfs WITH index  
                BREAK  
            END IF  
        END FOR  

        RETURN result  
    END FUNCTION  
END CLASS