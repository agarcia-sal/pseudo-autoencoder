CLASS TrieNode  
    FUNCTION __init__()  
        SET children TO a mapping from keys to new TrieNode instances by default  
        SET count TO zero  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION maxGeneticDifference(parents, queries)  
        SET tree TO a mapping from keys to empty lists by default  
        FOR index FROM zero TO LENGTH OF parents MINUS one  
            SET parent TO element at position index of parents  
            IF parent NOT EQUALS negative one THEN  
                APPEND index TO the list at key parent in tree  
            END IF  
        END FOR  

        SET node_queries TO a mapping from keys to empty lists by default  
        FOR each pair consisting of node and val IN queries  
            APPEND val TO the list at key node in node_queries  
        END FOR  

        SET root TO a new TrieNode instance  

        SET result TO a list of zeros of LENGTH EQUAL TO LENGTH OF queries  

        FUNCTION dfs(node)  
            CALL insert WITH trie_root EQUAL TO root AND value EQUAL TO node  
            FOR each val IN the list at key node in node_queries  
                SET index TO the value at key pair node val in query_idx  
                SET element at position index of result TO CALL max_xor WITH trie_root EQUAL TO root AND value EQUAL TO val  
            END FOR  
            FOR each child IN the list at key node in tree  
                CALL dfs WITH child  
            END FOR  
            CALL erase WITH trie_root EQUAL TO root AND value EQUAL TO node  
        END FUNCTION  

        FUNCTION insert(trie_root, value)  
            SET node TO trie_root  
            FOR i FROM seventeen DOWN TO zero  
                SET bit TO the value of the bit at position i of value where zero is least significant bit  
                SET node TO the element at key bit in the children of node  
                INCREMENT the count of node BY one  
            END FOR  
        END FUNCTION  

        FUNCTION erase(trie_root, value)  
            SET node TO trie_root  
            FOR i FROM seventeen DOWN TO zero  
                SET bit TO the value of the bit at position i of value where zero is least significant bit  
                SET node TO the element at key bit in the children of node  
                DECREMENT the count of node BY one  
            END FOR  
        END FUNCTION  

        FUNCTION max_xor(trie_root, value)  
            SET node TO trie_root  
            SET max_xor_val TO zero  
            FOR i FROM seventeen DOWN TO zero  
                SET bit TO the value of the bit at position i of value where zero is least significant bit  
                SET toggled_bit TO one MINUS bit  
                IF toggled_bit IS A key IN the children of node AND the count of the child at toggled_bit IS GREATER THAN zero THEN  
                    SET max_xor_val TO max_xor_val PLUS the value of one MULTIPLIED BY two RAISED TO THE power of i  
                    SET node TO the child at toggled_bit in the children of node  
                ELSE  
                    SET node TO the child at bit in the children of node  
                END IF  
            END FOR  
            RETURN max_xor_val  
        END FUNCTION  

        SET query_idx TO a mapping from pairs node val to their indices generated by enumerating queries  

        FOR i FROM zero TO LENGTH OF parents MINUS one  
            IF element at position i of parents EQUALS negative one THEN  
                CALL dfs WITH i  
                BREAK  
            END IF  
        END FOR  

        RETURN result  
    END FUNCTION  
END CLASS