CLASS Solution  
    FUNCTION numPoints(darts, r)  
        FUNCTION distance(p1, p2)  
            SET difference_of_first_coordinates TO element at position zero of p1 MINUS element at position zero of p2  
            SET difference_of_second_coordinates TO element at position one of p1 MINUS element at position one of p2  
            SET square_of_difference_first TO difference_of_first_coordinates MULTIPLIED BY difference_of_first_coordinates  
            SET square_of_difference_second TO difference_of_second_coordinates MULTIPLIED BY difference_of_second_coordinates  
            SET sum_of_squares TO square_of_difference_first PLUS square_of_difference_second  
            SET result TO square root of sum_of_squares  
            RETURN result  
        END FUNCTION  
        
        FUNCTION circle_center(p1, p2, r)  
            SET d TO distance of p1 AND p2  
            IF d GREATER THAN two MULTIPLIED BY r  
                RETURN None  
            END IF  
            SET a TO square root of r MULTIPLIED BY r MINUS d DIVIDED BY two MULTIPLIED BY d DIVIDED BY two  
            SET midpoint_first_coordinate TO element at position zero of p1 PLUS element at position zero of p2 DIVIDED BY two  
            SET midpoint_second_coordinate TO element at position one of p1 PLUS element at position one of p2 DIVIDED BY two  
            SET h TO list of midpoint_first_coordinate AND midpoint_second_coordinate  
            SET dx TO element at position one of p2 MINUS element at position one of p1 MULTIPLIED BY a DIVIDED BY d  
            SET dy TO element at position zero of p2 MINUS element at position zero of p1 MULTIPLIED BY a DIVIDED BY d  
            SET first_center_first_coordinate TO element at position zero of h MINUS dx  
            SET first_center_second_coordinate TO element at position one of h PLUS dy  
            SET second_center_first_coordinate TO element at position zero of h PLUS dx  
            SET second_center_second_coordinate TO element at position one of h MINUS dy  
            SET centers TO list containing list of first_center_first_coordinate AND first_center_second_coordinate AND list of second_center_first_coordinate AND second_center_second_coordinate  
            RETURN centers  
        END FUNCTION  
        
        FUNCTION is_inside(circle, point, r)  
            SET dist TO distance of circle AND point  
            IF dist LESS THAN OR EQUAL TO r  
                RETURN True  
            ELSE  
                RETURN False  
            END IF  
        END FUNCTION  
        
        SET n TO length of darts  
        IF n EQUALS one  
            RETURN one  
        END IF  
        
        SET max_count TO one  
        
        FOR i FROM zero TO n MINUS one  
            FOR j FROM i PLUS one TO n MINUS one  
                SET centers TO circle_center of element at position i of darts AND element at position j of darts AND r  
                IF centers IS NOT None  
                    FOR each center IN centers  
                        SET count TO zero  
                        FOR each dart IN darts  
                            IF is_inside of center AND dart AND r  
                                INCREMENT count BY one  
                            END IF  
                        END FOR  
                        IF count GREATER THAN max_count  
                            SET max_count TO count  
                        END IF  
                    END FOR  
                END IF  
            END FOR  
        END FOR  
        
        RETURN max_count  
    END FUNCTION  
END CLASS