CLASS Solution  
    FUNCTION canPartitionKSubsets(nums k)  
        SET total_sum TO zero  
        FOR each number IN nums  
            INCREMENT total_sum BY number  
        END FOR  

        IF total_sum MODULO k NOT EQUALS zero  
            RETURN false  
        END IF  

        SET target TO total_sum DIVIDED BY k  

        SORT nums IN DESCENDING ORDER  

        FUNCTION can_partition(index k current_sum used)  
            IF k EQUALS zero  
                RETURN true  
            END IF  

            IF current_sum EQUALS target  
                RETURN can_partition WITH PARAMETERS zero k MINUS one zero used  
            END IF  

            FOR i FROM index TO LENGTH OF nums MINUS one  
                IF element at position i of used EQUALS false AND current_sum PLUS element at position i of nums LESS THAN OR EQUAL TO target  
                    SET element at position i of used TO true  
                    IF can_partition WITH PARAMETERS i PLUS one k current_sum PLUS element at position i of nums used  
                        RETURN true  
                    END IF  
                    SET element at position i of used TO false  
                END IF  
            END FOR  

            RETURN false  
        END FUNCTION  

        SET used TO list OF false WITH THE LENGTH OF nums  

        RETURN can_partition WITH PARAMETERS zero k zero used  
    END FUNCTION  
END CLASS