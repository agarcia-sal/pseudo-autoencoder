CLASS UnionFind  
    FUNCTION __init__(self)  
        SET self.parent TO empty mapping  
        SET self.count TO zero  
    END FUNCTION  
  
    FUNCTION make_set(self, x)  
        IF x NOT IN self.parent THEN  
            SET the element at position x of self.parent TO x  
            INCREMENT self.count BY one  
        END IF  
    END FUNCTION  
  
    FUNCTION find(self, x)  
        IF the element at position x of self.parent NOT EQUALS x THEN  
            SET the element at position x of self.parent TO the result of calling self.find with the argument being the element at position x of self.parent  
        END IF  
        RETURN the element at position x of self.parent  
    END FUNCTION  
  
    FUNCTION union(self, x, y)  
        SET rootX TO the result of calling self.find with argument x  
        SET rootY TO the result of calling self.find with argument y  
        IF rootX NOT EQUALS rootY THEN  
            SET the element at position rootX of self.parent TO rootY  
            DECREMENT self.count BY one  
        END IF  
    END FUNCTION  
END CLASS  
  
CLASS Solution  
    FUNCTION numIslands2(self, m, n, positions)  
        FUNCTION is_valid(x, y)  
            RETURN the expression that zero IS LESS THAN OR EQUAL TO x AND x IS LESS THAN m AND zero IS LESS THAN OR EQUAL TO y AND y IS LESS THAN n  
        END FUNCTION  
  
        SET directions TO the list of four elements where the first element is the tuple of one and zero the second element is the tuple of minus one and zero the third element is the tuple of zero and one the fourth element is the tuple of zero and minus one  
        ASSIGN reference uf TO a new instance of UnionFind  
        SET grid TO a two-dimensional list consisting of m elements each being a list of n elements all set to zero  
        SET result TO empty list  
  
        FOR pair r c IN the list positions  
            IF the element at position r of grid at position c IS EQUALS one THEN  
                APPEND the element uf.count TO the list result  
                CONTINUE to the next iteration of the loop  
            END IF  
  
            SET the element at position r of grid at position c TO one  
            CALL the method make_set of uf with argument the tuple of r and c  
  
            FOR each pair dr dc IN directions  
                SET nr TO r PLUS dr  
                SET nc TO c PLUS dc  
                IF calling is_valid with arguments nr and nc RETURNS true AND the element at position nr of grid at position nc IS EQUALS one THEN  
                    CALL the method union of uf WITH arguments the tuple of r and c AND the tuple of nr and nc  
                END IF  
            END FOR  
  
            APPEND the element uf.count TO the list result  
        END FOR  
  
        RETURN result  
    END FUNCTION  
END CLASS