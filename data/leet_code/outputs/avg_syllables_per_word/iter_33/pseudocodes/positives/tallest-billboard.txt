CLASS Solution  
    FUNCTION tallestBillboard WITH PARAMETER rods  
        SET dp TO a dictionary with key zero and value zero  
        FOR each rod IN rods  
            SET new_dp TO a new dictionary copying all key value pairs from dp  
            FOR each key d and value y IN dp items  
                SET sum_for_taller_support TO d PLUS rod  
                IF new_dp contains key sum_for_taller_support THEN  
                    SET new_dp value at key sum_for_taller_support TO the greater value BETWEEN the current value at key sum_for_taller_support in new_dp AND y  
                ELSE  
                    SET new_dp value at key sum_for_taller_support TO y  
                END IF  
                IF d GREATER THAN rod THEN  
                    SET difference TO d MINUS rod  
                ELSE  
                    SET difference TO rod MINUS d  
                END IF  
                IF new_dp contains key difference THEN  
                    SET candidate_value TO y PLUS the smaller value BETWEEN d AND rod  
                    SET new_dp value at key difference TO the greater value BETWEEN the current value at key difference in new_dp AND candidate_value  
                ELSE  
                    SET new_dp value at key difference TO y PLUS the smaller value BETWEEN d AND rod  
                END IF  
            END FOR  
            SET dp TO new_dp  
        END FOR  
        RETURN the value in dp at key zero  
    END FUNCTION  
END CLASS