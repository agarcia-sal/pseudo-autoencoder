CLASS Solution  
    FUNCTION maxNumOfSubstrings(s)  
        SET first TO an empty dictionary mapping characters to integer positions  
        SET last TO an empty dictionary mapping characters to integer positions  
        FOR each index and character in the enumeration of s  
            IF character is not a key in first  
                SET the value of first at key character TO index  
            END IF  
            SET the value of last at key character TO index  
        END FOR  

        SET intervals TO an empty list of pairs of integers  
        FOR each character in the keys of first  
            SET start TO the value of first at key character  
            SET end TO the value of last at key character  
            SET i TO start  
            WHILE i is less than or equal to end  
                IF the value of first at key element at position i of s is less than start  
                    EXIT the WHILE loop  
                END IF  
                SET end TO the maximum of end and the value of last at key element at position i of s  
                INCREMENT i BY one  
            END WHILE  
            IF the WHILE loop completed without exiting early  
                APPEND the pair consisting of start and end TO intervals  
            END IF  
        END FOR  

        SORT the list intervals in ascending order according to the second element of each pair  

        SET result TO an empty list of substrings  
        SET prev_end TO the integer value less than zero by one unit  
        FOR each pair of start and end IN intervals  
            IF start is greater than prev_end  
                APPEND the substring of s from position start TO position end inclusive TO result  
                SET prev_end TO end  
            END IF  
        END FOR  

        RETURN result  
    END FUNCTION  
END CLASS