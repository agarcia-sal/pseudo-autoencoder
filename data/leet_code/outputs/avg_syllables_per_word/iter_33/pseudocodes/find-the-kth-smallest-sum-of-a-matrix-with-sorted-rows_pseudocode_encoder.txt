CLASS Solution  
    FUNCTION kthSmallest(mat parameter, k parameter)  
        SET m TO the LENGTH OF mat  
        SET n TO the LENGTH OF the element at position zero of mat  
        SET initial_sum TO zero  
        FOR each row IN mat  
            INCREMENT initial_sum BY element at position zero of row  
        END FOR  
        SET initial_indices TO a sequence of zeros of length m  
        SET min_heap TO a list containing a pair of initial_sum AND initial_indices converted to a tuple  
        SET visited TO a set containing the tuple of initial_indices  

        WHILE k GREATER THAN zero holds  
            REMOVE and ASSIGN the pair current_sum AND indices FROM the smallest element of min_heap  
            DECREMENT k BY one  

            IF k EQUALS zero THEN  
                RETURN current_sum  
            END IF  

            FOR i FROM zero TO m MINUS one  
                IF element at position i of indices PLUS one LESS THAN n THEN  
                    SET new_indices TO a copy of indices converted to a list  
                    INCREMENT element at position i of new_indices BY one  
                    SET new_indices_tuple TO new_indices converted to a tuple  
                    SET new_sum TO current_sum MINUS element at position i AND element at position i of indices of mat PLUS element at position i AND element at position i of new_indices of mat  
                    
                    IF new_indices_tuple NOT IN visited THEN  
                        ADD new_indices_tuple TO visited  
                        ADD the pair new_sum AND new_indices_tuple TO min_heap maintaining heap property  
                    END IF  
                END IF  
            END FOR  
        END WHILE  

        RETURN the negative value of one  
    END FUNCTION  
END CLASS