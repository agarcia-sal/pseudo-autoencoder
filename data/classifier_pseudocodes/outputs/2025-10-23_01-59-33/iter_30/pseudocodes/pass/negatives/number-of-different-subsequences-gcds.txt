```
max_num := max(nums)
num_set := set(nums)
count := 0
for g in 1 to max_num do
    gcd_val := 0
    for m in g to max_num step g do
        if m in num_set then
            gcd_val := gcd(gcd_val, m)
            if gcd_val = g then
                count := count + 1
                break
return count
```