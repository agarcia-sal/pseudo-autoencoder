CLASS Solution
    FUNCTION findDerangement(n)
        ASSIGN (10 ^ 9 + 7) TO modulus
        
        IF NOT (n <> 1) THEN
            RETURN 0
        END IF
        
        IF NOT (n <> 2) THEN
            RETURN 1
        END IF
        
        ASSIGN 1 TO alpha
        ASSIGN 0 TO beta
        
        ASSIGN 3 TO omega
        
        WHILE omega <= n
            ASSIGN (omega - 1) * (beta + alpha) TO delta
            ASSIGN delta - (delta / modulus) * modulus TO delta        # delta MOD modulus without using MOD operator directly
            ASSIGN alpha TO beta
            ASSIGN delta TO alpha
            ASSIGN omega + 1 TO omega
        END WHILE
        
        RETURN alpha
    END FUNCTION
END CLASS