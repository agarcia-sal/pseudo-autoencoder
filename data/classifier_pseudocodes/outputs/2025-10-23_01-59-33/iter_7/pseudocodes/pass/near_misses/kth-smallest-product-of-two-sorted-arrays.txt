CLASS Solution  
    FUNCTION kthSmallestProduct(nums1 PARAMETER, nums2 PARAMETER, k PARAMETER)  
        FUNCTION count(p PARAMETER)  
            SET cnt TO zero  
            SET n TO the LENGTH OF nums2  
            FOR each element x IN nums1  
                IF x GREATER THAN zero THEN  
                    INCREMENT cnt BY the NUMBER OF ELEMENTS IN nums2 UP TO AND INCLUDING THE HIGHEST POSITION WHERE the VALUE OF element at that POSITION IS LESS THAN OR EQUAL TO p DIVIDED BY x  
                ELSE IF x LESS THAN zero THEN  
                    INCREMENT cnt BY n MINUS the NUMBER OF ELEMENTS IN nums2 UP TO THE LOWEST POSITION WHERE the VALUE OF element at that POSITION IS GREATER THAN OR EQUAL TO p DIVIDED BY x  
                ELSE  
                    INCREMENT cnt BY n MULTIPLIED BY one IF p GREATER THAN OR EQUAL TO zero OTHERWISE zero  
                END IF  
            END FOR  
            RETURN cnt  
        END FUNCTION  

        SET mx TO the MAXIMUM OF the ABSOLUTE VALUE OF the FIRST element of nums1 AND the ABSOLUTE VALUE OF the LAST element of nums1 MULTIPLIED BY the MAXIMUM OF the ABSOLUTE VALUE OF the FIRST element of nums2 AND the ABSOLUTE VALUE OF the LAST element of nums2  
        RETURN the LOWEST POSITION IN the RANGE FROM the NEGATIVE OF mx TO mx PLUS one WHERE the VALUE OF k EQUALS the count FUNCTION APPLIED TO the CURRENT ELEMENT MINUS mx  
    END FUNCTION  
END CLASS