```
define TrieNode:
    children = map with default TrieNode
    deleted = false

define deleteDuplicateFolder(paths):
    ans = []
    root = TrieNode()
    subtreeToNodes = map default list

    for path in sorted(paths):
        node = root
        for s in path:
            node = node.children[s]

    define buildSubtreeToRoots(node):
        subtree = '(' + concat(s + buildSubtreeToRoots(node.children[s]) for s in node.children) + ')'
        if subtree != '()': subtreeToNodes[subtree].append(node)
        return subtree

    buildSubtreeToRoots(root)

    for nodes in subtreeToNodes.values:
        if len(nodes) > 1:
            for node in nodes: node.deleted = true

    define constructPath(node, path):
        for s, child in node.children.items:
            if not child.deleted: constructPath(child, path + [s])
        if path: ans.append(path)

    constructPath(root, [])
    return ans
```