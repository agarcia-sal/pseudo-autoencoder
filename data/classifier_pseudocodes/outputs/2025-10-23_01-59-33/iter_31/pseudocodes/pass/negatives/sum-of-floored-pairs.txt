CLASS Solution  
    FUNCTION sumOfFlooredPairs(nums)  
        SET MOD TO one billion PLUS seven  
        SET max_num TO the maximum value IN nums  
        SET count TO the collection of element counts IN nums  
        SET prefix_sum TO a list OF zeros WITH length max_num PLUS one  
        
        FOR each num IN count  
            INCREMENT the element at position num OF prefix_sum BY the count at key num  
        END FOR  
        
        FOR i FROM one TO max_num  
            INCREMENT the element at position i OF prefix_sum BY the element at position i MINUS one OF prefix_sum  
        END FOR  
        
        SET result TO zero  
        
        FOR each num IN count  
            FOR multiple FROM one TO the integer division OF max_num BY num  
                SET start TO the product of num AND multiple  
                IF the product of num AND multiple PLUS one MINUS one LESS THAN OR EQUAL TO max_num  
                    SET end TO the product of num AND multiple PLUS one MINUS one  
                ELSE  
                    SET end TO max_num  
                END IF  
                SET multiples_count TO the element at position end OF prefix_sum MINUS the element at position start MINUS one OF prefix_sum  
                INCREMENT result BY the product of multiples_count, multiple, AND the count at key num  
                SET result TO the remainder of result DIVIDED BY MOD  
            END FOR  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS