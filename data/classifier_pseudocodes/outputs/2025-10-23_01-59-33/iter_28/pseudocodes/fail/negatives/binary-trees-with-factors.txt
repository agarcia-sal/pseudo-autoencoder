CLASS Solution
    FUNCTION numFactoredBinaryTrees(list_of_numbers)
        SET MODULO_VALUE TO ten POWERED BY nine PLUS seven
        CALL sort ON list_of_numbers
        CALL initialize_dp_mapping WITH list_of_numbers ASSIGN TO dp_mapping

        FOR index FROM zero TO the LENGTH OF list_of_numbers MINUS one
            SET current_number TO element at position index of list_of_numbers

            FOR inner_index FROM zero TO index MINUS one
                SET potential_factor TO element at position inner_index of list_of_numbers

                IF current_number MODULO potential_factor EQUALS zero
                    SET corresponding_factor TO current_number DIVIDED BY potential_factor

                    IF corresponding_factor IS IN dp_mapping
                        SET product_count TO dp_mapping AT key potential_factor MULTIPLIED BY dp_mapping AT key corresponding_factor
                        SET dp_mapping AT key current_number TO dp_mapping AT key current_number PLUS product_count MODULO MODULO_VALUE
                    END IF
                END IF
            END FOR
        END FOR

        SET total_trees TO CALL sum_of_mapping_values WITH dp_mapping
        SET result TO total_trees MODULO MODULO_VALUE
        RETURN result
    END FUNCTION

    FUNCTION initialize_dp_mapping(list_of_numbers)
        CREATE empty_mapping named dp_mapping
        FOR each number IN list_of_numbers
            SET dp_mapping AT key number TO one
        END FOR
        RETURN dp_mapping
    END FUNCTION

    FUNCTION sum_of_mapping_values(mapping)
        SET total_sum TO zero
        FOR each value IN mapping
            INCREMENT total_sum BY value
        END FOR
        RETURN total_sum
    END FUNCTION
END CLASS