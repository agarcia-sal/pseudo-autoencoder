CLASS Solution
    FUNCTION maximizeXor(list_of_numbers, list_of_queries)
        CALL sort ON list_of_numbers
        SET indexed_sorted_queries TO CALL sort ON the ENUMERATE OF list_of_queries BY the second element at position one of each query
        SET result_list TO a list containing negative one repeated the LENGTH OF list_of_queries times
        SET trie_structure TO an empty collection
        SET current_index TO zero

        FOR each query_index AND query_pair IN indexed_sorted_queries
            SET number_xi TO element at position zero of query_pair
            SET max_limit_mi TO element at position one of query_pair

            WHILE current_index LESS THAN the LENGTH OF list_of_numbers AND element at position current_index of list_of_numbers LESS THAN OR EQUAL TO max_limit_mi
                SET current_number TO element at position current_index of list_of_numbers
                SET current_node TO trie_structure

                FOR bit_position FROM thirty one DOWNTO zero
                    SET bit_value TO integer division of current_number RIGHT SHIFTED BY bit_position MODULO two
                    IF bit_value IS NOT IN current_node
                        SET element at key bit_value of current_node TO an empty collection
                    END IF
                    SET current_node TO element at key bit_value of current_node
                END FOR

                INCREMENT current_index BY one
            END WHILE

            IF trie_structure IS empty
                CONTINUE to the next iteration of the FOR loop
            END IF

            SET current_node TO trie_structure
            SET maximum_xor_value TO zero

            FOR bit_position FROM thirty one DOWNTO zero
                SET bit_value TO integer division of number_xi RIGHT SHIFTED BY bit_position MODULO two
                SET toggled_bit TO one MINUS bit_value

                IF toggled_bit IS IN current_node
                    SET maximum_xor_value TO maximum_xor_value OR BITWISE LEFT SHIFTED one BY bit_position
                    SET current_node TO element at key toggled_bit of current_node
                ELSE
                    SET current_node TO element at key bit_value of current_node
                END IF
            END FOR

            SET element at position query_index of result_list TO maximum_xor_value
        END FOR

        RETURN result_list
    END FUNCTION
END CLASS