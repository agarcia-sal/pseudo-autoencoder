CLASS Solution  
    FUNCTION longestRepeating(s character string parameter, queryCharacters character string parameter, queryIndices list of integers parameter) RETURNS list of integers  
        FUNCTION merge_intervals()  
            SET i TO zero  
            WHILE i LESS THAN LENGTH OF intervals MINUS one  
                SET first_interval_character TO the character element at position two of the element at position i of intervals  
                SET second_interval_character TO the character element at position two of the element at position i PLUS one of intervals  
                IF first_interval_character EQUALS second_interval_character  
                    SET first_interval_start TO the start element at position zero of the element at position i of intervals  
                    SET second_interval_end TO the end element at position one of the element at position i PLUS one of intervals  
                    SET merged_character TO first_interval_character  
                    SET the element at position i of intervals TO a tuple composed of merged start value, merged end value, and merged character  
                    REMOVE the element at position i PLUS one FROM intervals  
                ELSE  
                    INCREMENT i BY one  
                END IF  
            END WHILE  
        END FUNCTION  
        
        SET intervals TO an empty list  
        SET n TO the LENGTH OF s  
        SET start TO zero  
        FOR i FROM one TO n MINUS one  
            SET current_character TO the element at position i of s  
            SET start_character TO the element at position start of s  
            IF current_character NOT EQUALS start_character  
                APPEND the tuple composed of start value, i MINUS one, and start_character TO intervals  
                SET start TO i  
            END IF  
        END FOR  
        APPEND the tuple composed of start value, n MINUS one, and the element at position start of s TO intervals  
        
        SET results TO an empty list  
        SET longest TO the greatest value among the differences between end and start values PLUS one for each tuple in intervals  
        
        FOR each pair of char and idx IN parallel from queryCharacters and queryIndices  
            SET i TO zero  
            WHILE i LESS THAN LENGTH OF intervals  
                SET interval_start TO the start value at position zero of the element at position i of intervals  
                SET interval_end TO the end value at position one of the element at position i of intervals  
                SET interval_char TO the character at position two of the element at position i of intervals  
                IF interval_start LESS THAN OR EQUAL TO idx AND idx LESS THAN OR EQUAL TO interval_end  
                    BREAK the loop  
                END IF  
                INCREMENT i BY one  
            END WHILE  
            
            SET interval_start TO the start value at position zero of the element at position i of intervals  
            SET interval_end TO the end value at position one of the element at position i of intervals  
            SET interval_char TO the character at position two of the element at position i of intervals  
            
            IF idx GREATER THAN interval_start  
                INSERT at position i the tuple composed of interval_start, idx MINUS one, and interval_char INTO intervals  
                SET the element at position i PLUS one of intervals TO the tuple composed of idx, interval_end, and interval_char  
            END IF  
            IF idx LESS THAN interval_end  
                INSERT at position i PLUS one the tuple composed of idx PLUS one, interval_end, and interval_char INTO intervals  
                SET the element at position i of intervals TO the tuple composed of interval_start, idx, and interval_char  
            END IF  
            
            SET updated_interval_start TO the start value at position zero of the element at position i of intervals  
            SET updated_interval_end TO the end value at position one of the element at position i of intervals  
            SET updated_character TO char  
            SET the element at position i of intervals TO the tuple composed of updated_interval_start, updated_interval_end, and updated_character  
            
            CALL merge_intervals()  
            
            SET longest TO the greatest value among the differences between end and start values PLUS one for each tuple in intervals  
            APPEND longest TO results  
        END FOR  
        
        RETURN results  
    END FUNCTION  
END CLASS