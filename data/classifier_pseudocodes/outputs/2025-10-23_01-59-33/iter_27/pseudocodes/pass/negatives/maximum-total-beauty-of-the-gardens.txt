```pseudocode
sort flowers ascending
n ← length(flowers)
prefix_sum[0] ← 0
for i in 0 to n-1: prefix_sum[i+1] ← prefix_sum[i] + flowers[i]

complete_gardens ← count of flowers[i]≥target from right
max_beauty ← 0

for i in complete_gardens to n:
    if i > 0: newFlowers -= target - flowers[n - i]
    if newFlowers < 0: break
    
    left, right ← 0, n - i - 1
    while left ≤ right:
        mid ← (left + right)//2
        cost ← flowers[mid] * (mid+1) - prefix_sum[mid+1]
        if cost > newFlowers: right ← mid - 1
        else: left ← mid + 1
    
    if right ≥ 0:
        inc_max ← flowers[right] + (newFlowers - (flowers[right]*(right+1) - prefix_sum[right+1])) // (right+1)
    else:
        inc_max ← 0
    
    total ← i * full + min(inc_max, target-1) * partial
    max_beauty ← max(max_beauty, total)

return max_beauty
```