CLASS Solution
    FUNCTION minCut(s)
        LET length_s BE LENGTH OF s
        IF length_s <= 1 THEN
            RETURN 0
        END IF

        LET palindrome_matrix BE LIST OF LISTS OF FALSE WITH size length_s by length_s
        FUNCTION mark_palindrome(sub_len, start_idx)
            IF sub_len > length_s THEN
                RETURN
            END IF

            IF sub_len == 1 THEN
                SET palindrome_matrix[start_idx][start_idx] TO TRUE
                CALL mark_palindrome(sub_len + 1, 0)
                RETURN
            END IF

            IF start_idx > length_s - sub_len THEN
                CALL mark_palindrome(sub_len + 1, 0)
                RETURN
            END IF

            LET finish_idx BE start_idx + sub_len - 1
            IF sub_len == 2 THEN
                SET palindrome_matrix[start_idx][finish_idx] TO (s[start_idx] == s[finish_idx])
            ELSE
                SET palindrome_matrix[start_idx][finish_idx] TO (s[start_idx] == s[finish_idx]) AND palindrome_matrix[start_idx + 1][finish_idx - 1]
            END IF

            CALL mark_palindrome(sub_len, start_idx + 1)
        END FUNCTION

        CALL mark_palindrome(1, 0)

        LET minimal_cuts BE LIST OF 0 OF LENGTH length_s

        FUNCTION determine_cuts(pos)
            IF pos == length_s THEN
                RETURN
            END IF

            IF palindrome_matrix[0][pos] THEN
                SET minimal_cuts[pos] TO 0
            ELSE
                SET minimal_cuts[pos] TO INFINITY
                FUNCTION min_cut_inner(k)
                    IF k > pos THEN
                        RETURN
                    END IF

                    IF palindrome_matrix[k][pos] AND minimal_cuts[k - 1] + 1 < minimal_cuts[pos] THEN
                        SET minimal_cuts[pos] TO minimal_cuts[k - 1] + 1
                    END IF
                    CALL min_cut_inner(k + 1)
                END FUNCTION
                CALL min_cut_inner(1)
            END IF
            CALL determine_cuts(pos + 1)
        END FUNCTION

        CALL determine_cuts(0)

        RETURN minimal_cuts[length_s - 1]
    END FUNCTION
END CLASS