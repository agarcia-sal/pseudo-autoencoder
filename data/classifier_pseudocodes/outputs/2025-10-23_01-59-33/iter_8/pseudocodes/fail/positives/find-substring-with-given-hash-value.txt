CLASS Solution  
    FUNCTION subStrHash(s string power integer modulo integer k integer hashValue integer) RETURNS string  
        FUNCTION val(c character) RETURNS integer  
            RETURN the unicode code of character c MINUS the unicode code of character a PLUS one  
        END FUNCTION  

        SET n TO the LENGTH OF string s  
        SET current_hash TO zero  
        SET p_pow TO one  

        FOR i FROM n MINUS k TO n MINUS one  
            SET current_hash TO current_hash PLUS val(the element at position i of s) MULTIPLIED BY p_pow MODULO modulo  
            IF i LESS THAN n MINUS one  
                SET p_pow TO p_pow MULTIPLIED BY power MODULO modulo  
            END IF  
        END FOR  

        SET start_index TO n MINUS k  
        IF current_hash EQUALS hashValue  
            RETURN the substring from position start_index TO the position one LESS THAN n of s  
        END IF  

        SET p_pow_k_minus_1 TO p_pow  

        FOR i FROM n MINUS k MINUS one DOWN TO zero  
            SET current_hash TO current_hash MINUS val(the element at position i PLUS k of s) MULTIPLIED BY p_pow_k_minus_1 MODULO modulo  
            SET current_hash TO current_hash MULTIPLIED BY power PLUS val(the element at position i of s) MODULO modulo  

            IF current_hash EQUALS hashValue  
                SET start_index TO i  
            END IF  
        END FOR  

        RETURN the substring from position start_index TO the position start_index PLUS k MINUS one of s  
    END FUNCTION  
END CLASS