CLASS Solution  
    FUNCTION numBusesToDestination(routes PARAMETER, source PARAMETER, target PARAMETER)  
        IF NOT (source NOT EQUAL target)  
            RETURN 0  
        END IF  

        INITIALIZE busMap AS a new empty mapping DefaultDict of list  
        SET i TO 0  
        WHILE i LESS THAN LENGTH OF routes  
            SET currentRoute TO routes[i]  
            SET j TO 0  
            WHILE j LESS THAN LENGTH OF currentRoute  
                APPEND i TO busMap[currentRoute[j]]  
                SET j TO j PLUS 1  
            END WHILE  
            SET i TO i PLUS 1  
        END WHILE  

        INITIALIZE queue AS an empty double ended queue  
        INITIALIZE visitedBuses AS an empty set  
        INITIALIZE seenStops AS an empty set  

        FOR each busIndex IN busMap[source]  
            ENQUEUE (busIndex, 1) INTO queue  
            INSERT busIndex INTO visitedBuses  
        END FOR  
        INSERT source INTO seenStops  

        WHILE queue IS NOT EMPTY  
            DEQUEUE FROM queue INTO currentBus, currentCount  

            SET k TO 0  
            WHILE k LESS THAN LENGTH OF routes[currentBus]  
                SET currStop TO routes[currentBus][k]  

                IF currStop EQUALS target  
                    RETURN currentCount  
                END IF  

                IF currStop NOT IN seenStops  
                    INSERT currStop INTO seenStops  

                    FOR each nextBus IN busMap[currStop]  
                        IF nextBus NOT IN visitedBuses  
                            INSERT nextBus INTO visitedBuses  
                            ENQUEUE (nextBus, currentCount PLUS 1) INTO queue  
                        END IF  
                    END FOR  
                END IF  

                SET k TO k PLUS 1  
            END WHILE  
        END WHILE  

        RETURN -1  
    END FUNCTION  
END CLASS