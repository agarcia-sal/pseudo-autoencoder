CLASS Solution
    FUNCTION longestRepeating(s queryCharacters queryIndices)
        FUNCTION merge_intervals()
            SET counter AS 0
            WHILE counter < (LENGTH(intervals) - 1)
                SET currentTriplet TO intervals[counter]
                SET nextTriplet TO intervals[counter + 1]
                IF (currentTriplet[2] = nextTriplet[2])
                    SET mergedStart TO currentTriplet[0]
                    SET mergedEnd TO (currentTriplet[1] + 1)
                    SET mergedChar TO currentTriplet[2]
                    SET intervals[counter] AS (mergedStart, mergedEnd, mergedChar)
                    REMOVE intervals[counter + 1]
                ELSE
                    SET counter AS (counter + 1)
                END IF
            END WHILE
        END FUNCTION

        SET intervals AS []
        SET lengthOfS AS LENGTH(s)
        SET initialPos AS 0
        SET positionTracker AS 1
        WHILE positionTracker < lengthOfS
            IF s[positionTracker] ≠ s[initialPos]
                APPEND (initialPos, (positionTracker - 1), s[initialPos]) TO intervals
                SET initialPos AS positionTracker
            END IF
            SET positionTracker AS (positionTracker + 1)
        END WHILE
        APPEND (initialPos, (lengthOfS - 1), s[initialPos]) TO intervals

        SET outputList AS []
        SET maxLength AS MAXIMUM OVER EACH (start, end, c) IN intervals OF ((end - start) + 1)

        FOR EACH charValue indexValue IN PAIRS(queryCharacters, queryIndices)
            SET intervalIndex AS 0
            WHILE intervalIndex < LENGTH(intervals)
                SET (segmentStart, segmentEnd, segmentChar) AS intervals[intervalIndex]
                IF (segmentStart ≤ indexValue) AND (indexValue ≤ segmentEnd)
                    EXIT WHILE
                END IF
                SET intervalIndex AS (intervalIndex + 1)
            END WHILE

            IF indexValue > segmentStart
                INSERT AT intervals[intervalIndex] THE TUPLE (segmentStart, (indexValue - 1), segmentChar)
                SET intervals[intervalIndex + 1] AS (indexValue, segmentEnd, segmentChar)
            END IF
            IF indexValue < segmentEnd
                INSERT AT intervals[intervalIndex + 1] THE TUPLE ((indexValue + 1), segmentEnd, segmentChar)
                SET intervals[intervalIndex] AS (segmentStart, indexValue, segmentChar)
            END IF

            SET intervals[intervalIndex] AS (intervals[intervalIndex][0], intervals[intervalIndex][1], charValue)

            CALL merge_intervals()

            SET maxLength AS MAXIMUM OVER EACH (start, end, c) IN intervals OF ((end - start) + 1)
            APPEND maxLength TO outputList
        END FOR

        RETURN outputList
    END FUNCTION
END CLASS