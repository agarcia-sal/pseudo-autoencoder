CLASS Solution  
    FUNCTION pourWater(heights WITH TYPE List of integers volume WITH TYPE integer k WITH TYPE integer) RETURNS List of integers  
        SET length TO LENGTH(heights)  
        
        FUNCTION step(currentVolume WITH TYPE integer) RETURNS void
            IF currentVolume > volume THEN  
                RETURN  
            END IF  
            
            SET position TO k  
            
            WHILE position > 0 AND heights[position - 1] <= heights[position] DO  
                position = position - 1  
            END WHILE  
            
            WHILE position < k AND heights[position] = heights[position + 1] DO  
                position = position + 1  
            END WHILE  
            
            IF position < k THEN  
                heights[position] = heights[position] + 1  
                step(currentVolume + 1)  
                RETURN  
            END IF  
            
            position = k  
            
            WHILE position < length - 1 AND heights[position + 1] <= heights[position] DO  
                position = position + 1  
            END WHILE  
            
            WHILE position > k AND heights[position] = heights[position - 1] DO  
                position = position - 1  
            END WHILE  
            
            IF position > k THEN  
                heights[position] = heights[position] + 1  
                step(currentVolume + 1)  
                RETURN  
            END IF  
            
            heights[k] = heights[k] + 1  
            step(currentVolume + 1)  
        END FUNCTION
        
        CALL step(1)  
        RETURN heights  
    END FUNCTION  
END CLASS