CLASS Solution  
    FUNCTION maximizeXor(nums PARAMETER, queries PARAMETER)  
        CALL sort on nums to arrange numbers in ascending order  
        
        CALL sorted on enumeration of queries with sorting key as the second element of query sublist to arrange queries in ascending order by the maximum value parameter  
        ASSIGN sorted_queries TO this sorted result  
        
        INITIALIZE result as a list with the length equal to the length of queries filled with negative one  
        
        INITIALIZE an empty dictionary named trie  
        
        SET num_index TO zero  
        
        FOR each query_index and a tuple of two elements xi and mi IN sorted_queries  
            WHILE num_index is less than the length of nums AND the element at position num_index of nums is LESS THAN OR EQUAL TO mi  
                SET num TO element at position num_index of nums  
                ASSIGN reference TO trie in variable named node  
                
                FOR i FROM thirty-one DOWN TO zero  
                    SET bit TO the integer value of num DIVIDED BY two RAISED TO power i THEN TAKE the remainder after division by two  
                    IF bit NOT IN keys of node  
                        SET element at key bit of node TO an empty dictionary  
                    END IF  
                    ASSIGN reference TO element at key bit of node  
                END FOR  
                
                INCREMENT num_index BY one  
            END WHILE  
            
            IF trie IS empty  
                CONTINUE to next iteration of FOR loop  
            END IF  
            
            ASSIGN reference TO trie in variable named node  
            SET max_xor TO zero  
            
            FOR i FROM thirty-one DOWN TO zero  
                SET bit TO the integer value of xi DIVIDED BY two RAISED TO power i THEN TAKE the remainder after division by two  
                SET toggle_bit TO one MINUS bit  
                
                IF toggle_bit IN keys of node  
                    SET max_xor TO max_xor PLUS two RAISED TO power i  
                    ASSIGN reference TO element at key toggle_bit of node  
                ELSE  
                    ASSIGN reference TO element at key bit of node  
                END IF  
            END FOR  
            
            SET element at position query_index of result TO max_xor  
        END FOR  
        
        RETURN result  
    END FUNCTION  
END CLASS