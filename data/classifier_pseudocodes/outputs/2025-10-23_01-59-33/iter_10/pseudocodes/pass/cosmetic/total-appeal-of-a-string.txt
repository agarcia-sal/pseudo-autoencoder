CLASS Solution
    FUNCTION appealSum(s)
        DECLARE lastIndices AS list WITH size 26 INITIALIZED BY -1 REPEATEDLY
        DECLARE sumOfAppeals AS 0
        DECLARE currentValue AS 0
        DECLARE pos AS 0
        WHILE pos < LENGTH(s)
            DECLARE character AS s[pos]
            DECLARE letterIndex AS (ORD(character) - ORD('a'))
            DECLARE contribution AS (pos - lastIndices[letterIndex])
            currentValue ← currentValue + contribution
            sumOfAppeals ← sumOfAppeals + currentValue
            lastIndices[letterIndex] ← pos
            pos ← pos + 1
        END WHILE
        RETURN sumOfAppeals
    END FUNCTION
END CLASS