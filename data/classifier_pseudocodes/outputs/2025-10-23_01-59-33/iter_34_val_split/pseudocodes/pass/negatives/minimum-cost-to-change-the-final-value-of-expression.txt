CLASS Solution  
    FUNCTION minOperationsToFlip(expression)  
        SET stack TO an empty list  
        FOR each element e IN expression  
            IF element e is equal to open parenthesis OR element e is equal to ampersand OR element e is equal to vertical bar  
                APPEND a pair consisting of element e AND zero TO stack  
                CONTINUE to the next iteration  
            END IF  
            IF element e is equal to closing parenthesis  
                SET lastPair TO the result of removing the last element from stack  
                REMOVE the last element from stack  
            ELSE  
                SET lastPair TO a pair consisting of element e AND one  
            END IF  
            IF stack is not empty AND the first item of the last element in stack is equal to ampersand OR vertical bar  
                SET op TO removing the first item of the last element from stack  
                SET a AND costA TO removing the last element from stack  
                SET b AND costB TO lastPair  
                IF operator op is equal to ampersand  
                    IF a is equal to zero AND b is equal to zero  
                        SET lastPair TO a pair consisting of zero AND one PLUS the smaller of costA AND costB  
                    ELSE IF a is equal to zero AND b is equal to one  
                        SET lastPair TO a pair consisting of zero AND one  
                    ELSE IF a is equal to one AND b is equal to zero  
                        SET lastPair TO a pair consisting of zero AND one  
                    ELSE  
                        SET lastPair TO a pair consisting of one AND the smaller of costA AND costB  
                    END IF  
                ELSE  
                    IF a is equal to zero AND b is equal to zero  
                        SET lastPair TO a pair consisting of zero AND the smaller of costA AND costB  
                    ELSE IF a is equal to zero AND b is equal to one  
                        SET lastPair TO a pair consisting of one AND one  
                    ELSE IF a is equal to one AND b is equal to zero  
                        SET lastPair TO a pair consisting of one AND one  
                    ELSE  
                        SET lastPair TO a pair consisting of one AND one PLUS the smaller of costA AND costB  
                    END IF  
                END IF  
            END IF  
            APPEND lastPair TO stack  
        END FOR  
        RETURN the second item of the last element in stack  
    END FUNCTION  
END CLASS