CLASS Solution  
    FUNCTION longestRepeating(s, queryCharacters, queryIndices)  
        FUNCTION merge_intervals()  
            SET i TO 0  
            WHILE i LESS THAN LENGTH OF intervals MINUS 1  
                IF character AT intervals AT i EQUALS character AT intervals AT i PLUS 1  
                    SET intervals AT i TO new interval FROM intervals AT i start TO intervals AT i PLUS 1 end WITH character AT intervals AT i  
                    REMOVE interval AT i PLUS 1 FROM intervals  
                ELSE  
                    INCREMENT i BY 1  
                END IF  
            END WHILE  
        END FUNCTION  
        
        SET intervals TO empty list  
        SET n TO LENGTH OF s  
        SET start TO 0  
        FOR i FROM 1 TO n MINUS 1  
            IF character AT s AT i NOT EQUAL TO character AT s AT start  
                APPEND interval FROM start TO i MINUS 1 WITH character AT s AT start TO intervals  
                SET start TO i  
            END IF  
        END FOR  
        APPEND interval FROM start TO n MINUS 1 WITH character AT s AT start TO intervals  
        
        SET results TO empty list  
        SET longest TO maximum length of intervals (end MINUS start PLUS 1)  
        
        FOR each char AND idx IN queryCharacters AND queryIndices  
            SET i TO 0  
            WHILE i LESS THAN LENGTH OF intervals  
                UNPACK intervals AT i INTO start, end, c  
                IF idx GREATER THAN OR EQUAL TO start AND idx LESS THAN OR EQUAL TO end  
                    BREAK  
                END IF  
                INCREMENT i BY 1  
            END WHILE  
            
            IF idx GREATER THAN start  
                INSERT interval FROM start TO idx MINUS 1 WITH c AT position i IN intervals  
                SET intervals AT i PLUS 1 TO interval FROM idx TO end WITH c  
            END IF  
            
            IF idx LESS THAN end  
                INSERT interval FROM idx PLUS 1 TO end WITH c AT position i PLUS 1 IN intervals  
                SET intervals AT i TO interval FROM start TO idx WITH c  
            END IF  
            
            SET intervals AT i TO interval FROM intervals AT i start TO intervals AT i end WITH char  
            
            CALL merge_intervals()  
            
            SET longest TO maximum length of intervals (end MINUS start PLUS 1)  
            APPEND longest TO results  
        END FOR  
        
        RETURN results  
    END FUNCTION  
END CLASS