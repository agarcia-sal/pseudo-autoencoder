CLASS Solution  
    FUNCTION parseBoolExpr(expression)  
        SET stk TO empty list  
        FOR each character c IN expression  
            IF c EQUALS t OR c EQUALS f OR c EQUALS exclamation mark OR c EQUALS ampersand OR c EQUALS vertical bar  
                APPEND c TO stk  
            ELSE IF c EQUALS closing parenthesis  
                SET t TO zero  
                SET f TO zero  
                WHILE last element of stk EQUALS t OR last element of stk EQUALS f  
                    INCREMENT t BY one IF last element of stk EQUALS t  
                    INCREMENT f BY one IF last element of stk EQUALS f  
                    REMOVE last element FROM stk  
                END WHILE  
                SET op TO last element FROM stk AND REMOVE it  
                IF op EQUALS exclamation mark  
                    SET c TO t IF f EQUALS zero ELSE f  
                ELSE IF op EQUALS ampersand  
                    SET c TO f IF f GREATER THAN zero ELSE t  
                ELSE IF op EQUALS vertical bar  
                    SET c TO t IF t GREATER THAN zero ELSE f  
                END IF  
                APPEND c TO stk  
            END IF  
        END FOR  
        RETURN last element of stk EQUALS t  
    END FUNCTION  
END CLASS