CLASS Solution
    FUNCTION longestWord(words)
        CALL words SORTED BY (element -> LENGTH OF element, element) RETURNING sorted_words
        CREATE valid_words AS new set
        ASSIGN "" TO longest_word
        DEFINE FUNCTION process_words(index)
            IF NOT (index < LENGTH OF sorted_words) THEN RETURN
            ASSIGN sorted_words[index] TO current_str
            ASSIGN LENGTH OF current_str TO length_curr
            IF NOT (length_curr == 1 OR SUBSTRING current_str FROM 0 TO length_curr - 1 IS IN valid_words) THEN
                CALL process_words(index + 1)
                RETURN
            END IF
            CALL valid_words INSERT current_str
            IF NOT (length_curr <= LENGTH OF longest_word) THEN
                ASSIGN current_str TO longest_word
            END IF
            CALL process_words(index + 1)
        END FUNCTION
        CALL process_words(0)
        RETURN longest_word
    END FUNCTION
END CLASS