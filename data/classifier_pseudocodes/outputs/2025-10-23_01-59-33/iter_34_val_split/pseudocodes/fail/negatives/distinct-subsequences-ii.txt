CLASS Solution
    FUNCTION distinctSubseqII(string_s)
        SET MOD TO one billion PLUS seven
        SET n TO the LENGTH OF string_s
        SET dp TO a list OF zero REPEATED n PLUS one TIMES
        SET element at position zero OF dp TO one

        SET last TO an empty dictionary

        FOR index i FROM one TO n
            SET character char TO element at position i MINUS one OF string_s
            SET element at position i OF dp TO dp at position i MINUS one MULTIPLIED BY two MODULO MOD

            IF char IS IN last
                SET element at position i OF dp TO dp at position i MINUS element at position last at char MINUS one PLUS MODULO MOD
            END IF

            SET last at key char TO i
        END FOR

        RETURN element at position n OF dp MINUS one MODULO MOD
    END FUNCTION
END CLASS