CLASS Solution  
    FUNCTION solve(nums parameters LIST OF INTEGER, queries parameters LIST OF LIST OF INTEGER) RETURNS LIST OF INTEGER  
        SET MOD TO one billion PLUS seven  
        SET n TO the LENGTH OF nums  
        SET max_y TO the MAXIMUM VALUE OF the second element in each pair OF queries  
        INITIALIZE prefix_sums AS a LIST containing max_y PLUS one ELEMENTS each being a LIST of zeroes with LENGTH n  
        FOR y FROM one TO max_y  
            FOR i FROM n MINUS one DOWN TO zero  
                IF i PLUS y LESS THAN n THEN  
                    SET element at position i of prefix_sums at position y TO element at position i of nums PLUS element at position i PLUS y of prefix_sums at position y  
                ELSE  
                    SET element at position i of prefix_sums at position y TO element at position i of nums  
                END IF  
            END FOR  
        END FOR  
        INITIALIZE answer AS an empty LIST  
        FOR each pair x and y IN queries  
            APPEND to answer the element at position x of prefix_sums at position y MODULO MOD  
        END FOR  
        RETURN answer  
    END FUNCTION  
END CLASS