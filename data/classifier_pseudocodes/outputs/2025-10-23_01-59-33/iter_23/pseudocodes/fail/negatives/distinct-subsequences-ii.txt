CLASS Solution  
    FUNCTION distinctSubseqII(string_s)  
        SET MODULO_VALUE TO ten POWERED BY nine PLUS seven  
        SET length_n TO the LENGTH OF string_s  
        SET dynamic_programming_list TO a LIST OF zero ELEMENTS WITH SIZE length_n PLUS one  
        SET the ELEMENT at position zero OF dynamic_programming_list TO one  
        SET last_occurrence_map TO an EMPTY MAP  
        FOR index_i FROM one TO length_n  
            SET current_character TO the CHARACTER at position index_i MINUS one OF string_s  
            SET the ELEMENT at position index_i OF dynamic_programming_list TO the ELEMENT at position index_i MINUS one OF dynamic_programming_list MULTIPLIED BY two  
            SET the ELEMENT at position index_i OF dynamic_programming_list TO the REMAINDER OF the ELEMENT at position index_i OF dynamic_programming_list DIVIDED BY MODULO_VALUE  
            IF current_character EXISTS IN last_occurrence_map THEN  
                SET previous_index TO the VALUE ASSOCIATED WITH current_character IN last_occurrence_map  
                SUBTRACT the ELEMENT at position previous_index MINUS one OF dynamic_programming_list FROM the ELEMENT at position index_i OF dynamic_programming_list  
                ADD MODULO_VALUE TO the ELEMENT at position index_i OF dynamic_programming_list  
                SET the ELEMENT at position index_i OF dynamic_programming_list TO the REMAINDER OF the ELEMENT at position index_i OF dynamic_programming_list DIVIDED BY MODULO_VALUE  
            END IF  
            SET the VALUE ASSOCIATED WITH current_character IN last_occurrence_map TO index_i  
        END FOR  
        SET result TO the ELEMENT at position length_n OF dynamic_programming_list MINUS one  
        SET result TO the REMAINDER OF result DIVIDED BY MODULO_VALUE  
        RETURN result  
    END FUNCTION  
END CLASS