CLASS Solution
	TYPE ArrayMap = ARRAY OF TUPLE(KEY INT, VALUE ANY) 

	FUNCTION maximizeXor(nums PARAMETER, queries PARAMETER)
		CALL quicksort(nums, 0, LENGTH(nums) - 1)

		LET enumeratedQueries ARRAY OF TUPLE (INDEX INT, VAL INT, MAX INT)
		SET enumeratedQueries TO EMPTY ARRAY
		FOR idx FROM 0 TO LENGTH(queries) - 1
			LET q VAL, m MAX
			SET q, m TO queries[idx][0], queries[idx][1]
			APPEND (idx, q, m) TO enumeratedQueries
		END FOR

		LET sortedQueries ARRAY OF TUPLE (INDEX, VAL, MAX)
		SET sortedQueries TO MERGESORT(enumeratedQueries, FUNCTION(a, b) RETURN (a.MAX <= b.MAX) END FUNCTION)

		LET results ARRAY OF INT
		SET results TO ARRAY FILLED WITH (-1) SIZE LENGTH(queries)

		LET trie OBJECT DICT AS ArrayMap = EMPTY ARRAY

		LET currentNumIdx INT = 0

		FUNCTION buildTrie(currentIdx INT)
			IF currentIdx >= LENGTH(sortedQueries)
				RETURN
			END IF

			LET node REF TO trie
			WHILE currentNumIdx < LENGTH(nums) AND nums[currentNumIdx] <= sortedQueries[currentIdx].MAX
				LET number INT = nums[currentNumIdx]
				FOR bitPos FROM 31 DOWNTO 0
					LET bitVal INT = (number / (2 ^ bitPos)) % 2
					LET found BOOL = FALSE
					FOR entryIdx FROM 0 TO LENGTH(node) - 1
						IF node[entryIdx].KEY == bitVal
							node = node[entryIdx].VALUE
							found = TRUE
							BREAK
						END IF
					END FOR
					IF NOT found
						LET newNode ArrayMap = EMPTY ARRAY
						APPEND (bitVal, newNode) TO node
						node = newNode
					END IF
				END FOR
				INCREMENT currentNumIdx BY 1
			END WHILE

			SET node TO trie
			SET maxXor INT = 0
			LET xVal INT = sortedQueries[currentIdx].VAL
			FOR bitPos FROM 31 DOWNTO 0
				LET bitVal INT = (xVal / (2 ^ bitPos)) % 2
				LET toggledBit INT = 1 - bitVal
				LET toggleFound BOOL = FALSE
				LET bitFound BOOL = FALSE
				LET toggleNode ArrayMap = EMPTY ARRAY
				LET bitNode ArrayMap = EMPTY ARRAY

				FOR entryIdx FROM 0 TO LENGTH(node) - 1
					IF node[entryIdx].KEY == toggledBit
						toggleFound = TRUE
						toggleNode = node[entryIdx].VALUE
					ELSE IF node[entryIdx].KEY == bitVal
						bitFound = TRUE
						bitNode = node[entryIdx].VALUE
					END IF
				END FOR

				IF toggleFound
					maxXor = maxXor + (2 ^ bitPos)
					node = toggleNode
				ELSE IF bitFound
					node = bitNode
				END IF
			END FOR

			results[sortedQueries[currentIdx].INDEX] = maxXor
			CALL buildTrie(currentIdx + 1)
		END FUNCTION

		CALL buildTrie(0)
		RETURN results
	END FUNCTION

	FUNCTION quicksort(arr PARAMETER, low PARAMETER, high PARAMETER)
		IF low < high
			SET pivotIndex TO partition(arr, low, high)
			CALL quicksort(arr, low, pivotIndex - 1)
			CALL quicksort(arr, pivotIndex + 1, high)
		END IF
	END FUNCTION

	FUNCTION partition(arr PARAMETER, low PARAMETER, high PARAMETER)
		SET pivotVal TO arr[high]
		SET i TO low - 1
		FOR j FROM low TO high - 1
			IF arr[j] <= pivotVal
				increment i by 1
				SWAP arr[i] WITH arr[j]
			END IF
		END FOR
		SWAP arr[i + 1] WITH arr[high]
		RETURN i + 1
	END FUNCTION
END CLASS