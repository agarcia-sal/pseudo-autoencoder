```
dp(t):
  if t=0: return -1
  if t<x: return min(2*t-1, 2*(x - t))
  p = max power with x^p <= t
  res = dp(t - x^p) + p
  if x^(p+1)-t < t: res = min(res, dp(x^(p+1) - t) + p + 1)
  return res

leastOpsExpressTarget(x, target):
  return dp(target)
```