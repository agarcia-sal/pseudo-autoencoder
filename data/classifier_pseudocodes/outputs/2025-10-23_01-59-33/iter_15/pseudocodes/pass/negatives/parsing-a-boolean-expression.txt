CLASS Solution  
    FUNCTION parseBoolExpr(expression)  
        SET stk TO an empty list  
        FOR each character c IN expression  
            IF character c EQUALS one of the characters true OR false OR exclamation mark OR ampersand OR vertical bar  
                APPEND character c TO stk  
            ELSE IF character c EQUALS closing parenthesis  
                SET count_t TO zero  
                SET count_f TO zero  
                WHILE element at last position of stk EQUALS true OR element at last position of stk EQUALS false  
                    INCREMENT count_t BY one IF element at last position of stk EQUALS true  
                    INCREMENT count_f BY one IF element at last position of stk EQUALS false  
                    REMOVE element at last position FROM stk  
                END WHILE  
                SET operator TO element at last position of stk  
                REMOVE element at last position FROM stk  
                IF operator EQUALS exclamation mark  
                    SET c TO true IF count_f GREATER THAN zero IS false ELSE false  
                ELSE IF operator EQUALS ampersand  
                    SET c TO false IF count_f GREATER THAN zero ELSE true  
                ELSE IF operator EQUALS vertical bar  
                    SET c TO true IF count_t GREATER THAN zero ELSE false  
                END IF  
                APPEND c TO stk  
            END IF  
        END FOR  
        RETURN element at position zero of stk EQUALS true  
    END FUNCTION  
END CLASS