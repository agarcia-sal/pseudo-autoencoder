CLASS Solution  
    FUNCTION sumOfFlooredPairs(nums)  
        SET CONSTANT MOD TO 1000000000 + 1  
        SET ceiling TO the largest element in nums  
        SET frequency_map TO a map from keys in nums to their counts  
        SET accumulative_counts TO an array initialized with zeros of size ceiling + 1  

        FOR each key IN frequency_map.keys()  
            LET idx BE key  
            SET accumulative_counts[idx] TO accumulative_counts[idx] + frequency_map[key]  
        END FOR  

        SET step TO 1  
        WHILE step <= ceiling  
            SET accumulative_counts[step] TO accumulative_counts[step] + accumulative_counts[step - 1]  
            INCREMENT step BY 1  
        END WHILE  

        LET total_result BE 0  

        FUNCTION iterateMultiples(current_num, factor)  
            IF factor > ceiling DIV current_num THEN  
                RETURN  
            END IF  
            LET left_boundary BE current_num * factor  
            IF (current_num * (factor + 1) - 1) <= ceiling THEN  
                LET right_boundary BE current_num * (factor + 1) - 1  
            ELSE  
                LET right_boundary BE ceiling  
            END IF  
            LET count_in_range BE accumulative_counts[right_boundary] - accumulative_counts[left_boundary - 1]  
            SET total_result TO (total_result + count_in_range * factor * frequency_map[current_num]) MOD MOD  
            CALL iterateMultiples(current_num, factor + 1)  
        END FUNCTION  

        FOR each element IN frequency_map.keys()  
            CALL iterateMultiples(element, 1)  
        END FOR  

        RETURN total_result  
    END FUNCTION  
END CLASS