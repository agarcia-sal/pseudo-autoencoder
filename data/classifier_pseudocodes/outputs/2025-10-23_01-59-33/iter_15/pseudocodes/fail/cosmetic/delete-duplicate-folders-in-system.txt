CLASS TrieNode  
    FUNCTION __init__(self)  
        LET alphaChildren BE a newly created default dictionary that returns TrieNode objects  
        ASSIGN self.children ← alphaChildren  
        SET self.deleted AS False  
    END FUNCTION  
END CLASS  

CLASS Solution  
    FUNCTION deleteDuplicateFolder(self, paths)  
        LET collectedResults BE an empty list  
        INITIALIZE root TO a new TrieNode instance  
        LET groupsBySubtree BE a fresh default dictionary that defaults to empty lists  

        LET indexA BE 0  
        LET sortedPaths BE paths arranged in ascending order  
        WHILE indexA < LENGTH OF sortedPaths  
            LET currentPath BE sortedPaths[indexA]  
            LET cursorNode BE root  

            LET indexB BE 0  
            WHILE indexB < LENGTH OF currentPath  
                LET folderName BE currentPath[indexB]  
                cursorNode ← cursorNode.children[folderName]  
                indexB ← indexB + 1  
            END WHILE  

            indexA ← indexA + 1  
        END WHILE  

        FUNCTION buildSubtreeToRoots(node)  
            LET componentList BE "("  
            LET keyCollection BE KEYS OF node.children  
            LET idx BE 0  
            WHILE idx < LENGTH OF keyCollection  
                LET keyString BE keyCollection[idx]  
                LET childNode BE node.children[keyString]  
                LET childSubtree BE buildSubtreeToRoots(childNode)  
                componentList ← componentList + keyString + childSubtree  
                idx ← idx + 1  
            END WHILE  
            componentList ← componentList + ")"  

            IF componentList <> "()" THEN  
                groupsBySubtree[componentList].APPEND(node)  
            END IF  

            RETURN componentList  
        END FUNCTION  

        CALL buildSubtreeToRoots WITH root  

        FOR EACH nodeGroup IN groupsBySubtree.VALUES() DO  
            IF LENGTH OF nodeGroup > 1 THEN  
                LET pos BE 0  
                WHILE pos < LENGTH OF nodeGroup  
                    LET currentNode TO nodeGroup[pos]  
                    currentNode.deleted ← True  
                    pos ← pos + 1  
                END WHILE  
            END IF  
        END FOR  

        FUNCTION constructPath(node, path)  
            LET keysList BE node.children.KEYS()  
            LET i BE 0  
            WHILE i < LENGTH OF keysList  
                LET keyName BE keysList[i]  
                LET childNode BE node.children[keyName]  
                IF childNode.deleted = False THEN  
                    constructPath(childNode, path + [keyName])  
                END IF  
                i ← i + 1  
            END WHILE  
            IF LENGTH OF path > 0 THEN  
                collectedResults.APPEND(path)  
            END IF  
        END FUNCTION  

        constructPath(root, [])  
        RETURN collectedResults  
    END FUNCTION  
END CLASS