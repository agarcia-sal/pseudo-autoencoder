CLASS Solution  
    FUNCTION atMostNGivenDigitSet(digits, n)  
        FUNCTION numbers_of_length(k)  
            VAR base_num <- LENGTH OF digits  
            VAR total_count <- 1  
            VAR step <- 0  
            WHILE step < k  
                total_count <- total_count * base_num  
                step <- step + 1  
            END WHILE  
            RETURN total_count  
        END FUNCTION  
        
        FUNCTION count_up_to_limit(limit)  
            VAR rep <- TO_STRING(limit)  
            VAR len_rep <- LENGTH OF rep  
            VAR acc <- 0  
            
            VAR idx <- 1  
            LOOP UNTIL idx >= len_rep  
                acc <- acc + numbers_of_length(idx)  
                idx <- idx + 1  
            END LOOP  
            
            VAR pos <- 0  
            WHILE pos < len_rep  
                VAR val <- TO_INTEGER(rep[pos])  
                VAR j <- 0  
                
                REPEAT  
                    IF j >= LENGTH OF digits THEN  
                        BREAK  
                    END IF  
                    
                    VAR d_val <- TO_INTEGER(digits[j])  
                    
                    IF d_val < val THEN  
                        acc <- acc + numbers_of_length(len_rep - pos - 1)  
                        j <- j + 1  
                    ELSE IF d_val = val THEN  
                        IF pos = len_rep - 1 THEN  
                            acc <- acc + 1  
                        END IF  
                        BREAK  
                    ELSE  
                        BREAK  
                    END IF  
                UNTIL FALSE  
                pos <- pos + 1  
            END WHILE  
            
            RETURN acc  
        END FUNCTION  
        
        RETURN count_up_to_limit(n)  
    END FUNCTION  
END CLASS