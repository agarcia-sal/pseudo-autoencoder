CLASS Solution  
    FUNCTION subStrHash(s string power integer modulo integer k integer hashValue integer) RETURNS string  
        FUNCTION val(c character) RETURNS integer  
            RETURN (UNICODE(c) - UNICODE('a')) + 1  
        END FUNCTION  

        SET length_s AS LENGTH(s)  
        SET rolling_hash TO 0  
        SET multiplier TO 1  

        SET idx TO length_s - k  
        WHILE idx < length_s  
            SET char_val TO val(s[idx])  
            SET rolling_hash TO (rolling_hash + (char_val * multiplier) MOD modulo) MOD modulo  
            IF idx < length_s - 1 THEN  
                SET multiplier TO (multiplier * power) MOD modulo  
            END IF  
            SET idx TO idx + 1  
        END WHILE  

        SET substring_start TO length_s - k  
        IF rolling_hash = hashValue THEN  
            RETURN SUBSTRING(s, substring_start, length_s - 1)  
        END IF  

        SET highest_power TO multiplier  

        SET j TO length_s - k - 1  
        WHILE j >= 0  
            SET removed_char_val TO val(s[j + k])  
            SET rolling_hash TO rolling_hash - (removed_char_val * highest_power)  
            SET rolling_hash TO rolling_hash MOD modulo  
            IF rolling_hash < 0 THEN  
                SET rolling_hash TO rolling_hash + modulo  
            END IF  
            SET rolling_hash TO ((rolling_hash * power) + val(s[j])) MOD modulo  

            IF rolling_hash = hashValue THEN  
                SET substring_start TO j  
            END IF  
            SET j TO j - 1  
        END WHILE  

        RETURN SUBSTRING(s, substring_start, substring_start + k - 1)  
    END FUNCTION  
END CLASS