CLASS Solution
    FUNCTION kthSmallestProduct(nums1 PARAMETER, nums2 PARAMETER, k PARAMETER)

        FUNCTION count(p PARAMETER)
            ASSIGN 0 TO tally
            ASSIGN LENGTH OF nums2 TO lengthB
            ASSIGN 0 TO idxA
            WHILE idxA LESS THAN LENGTH OF nums1
                ASSIGN nums1[idxA] TO valA
                IF valA NOT EQUAL TO 0 THEN
                    IF valA GREATER THAN 0 THEN
                        ASSIGN TRUNCATED_UPPER_BOUND(nums2, p DIVIDED BY valA) TO pos
                        ADD pos TO tally
                    ELSE
                        ASSIGN lengthB MINUS TRUNCATED_LOWER_BOUND(nums2, p DIVIDED BY valA) TO remainder
                        ADD remainder TO tally
                    END IF
                ELSE
                    ADD (p GREATER THAN OR EQUAL TO 0) TIMES lengthB TO tally
                END IF
                ADD 1 TO idxA
            END WHILE
            YIELD tally
        END FUNCTION

        ASSIGN MAX(ABS(nums1[0]), ABS(nums1[-1])) TIMES MAX(ABS(nums2[0]), ABS(nums2[-1])) TO maximumValue
        ASSIGN -maximumValue TO leftExtreme
        ASSIGN maximumValue TO rightExtreme
        ASSIGN BINARY_SEARCH(leftExtreme, rightExtreme + 1, k, count) TO answer
        YIELD answer MINUS maximumValue
    END FUNCTION
END CLASS