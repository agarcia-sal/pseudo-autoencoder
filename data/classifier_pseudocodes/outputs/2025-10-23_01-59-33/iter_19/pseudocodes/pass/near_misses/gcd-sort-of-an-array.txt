CLASS UnionFind
    FUNCTION __init__(self, size)
        DECLARE mapping AS DICTIONARY
        FOR index FROM 0 TO size - 1
            mapping[index] = index
        END FOR
        SET self.parent TO mapping
        SET self.rank TO DICTIONARY WITH KEYS FROM 0 TO size - 1 AND VALUES ALL 1
    END FUNCTION

    FUNCTION find(self, p)
        IF self.parent[p] == p THEN
            RETURN p
        ELSE
            SET ancestor = self.find(self.parent[p])
            SET self.parent[p] = ancestor
            RETURN ancestor
        END IF
    END FUNCTION

    FUNCTION union(self, p, q)
        SET root_of_p TO self.find(p)
        SET root_of_q TO self.find(q)
        IF root_of_p == root_of_q THEN
            RETURN False
        END IF
        SWITCH TRUE
            CASE self.rank[root_of_p] > self.rank[root_of_q]:
                self.parent[root_of_q] = root_of_p
                BREAK
            CASE self.rank[root_of_p] < self.rank[root_of_q]:
                self.parent[root_of_p] = root_of_q
                BREAK
            DEFAULT:
                self.parent[root_of_q] = root_of_p
                self.rank[root_of_p] = self.rank[root_of_p] + 1
        END SWITCH
        RETURN True
    END FUNCTION
END CLASS

CLASS Solution
    FUNCTION gcdSort(self, nums)
        DECLARE ordered_nums AS EMPTY STACK
        FOR EACH element IN nums SORTED ASCENDING
            PUSH element INTO ordered_nums
        END FOR

        SET highest_val TO -âˆž
        FOR EACH val IN nums
            IF val > highest_val THEN
                highest_val = val
            END IF
        END FOR

        SET uf_instance TO NEW UnionFind(highest_val + 1)

        FUNCTION factor_connect(x, f)
            IF f * f > x THEN
                RETURN
            END IF
            IF x MOD f == 0 THEN
                uf_instance.union(x, f)
                uf_instance.union(x, x / f)
            END IF
            factor_connect(x, f + 1)
        END FUNCTION

        FOR EACH number IN nums
            CALL factor_connect(number, 2)
        END FOR

        DECLARE idx AS 0
        WHILE idx < LENGTH(nums)
            IF uf_instance.find(nums[idx]) != uf_instance.find(PEEK(ordered_nums)) THEN
                RETURN False
            END IF
            POP ordered_nums
            idx = idx + 1
        END WHILE

        RETURN True
    END FUNCTION
END CLASS