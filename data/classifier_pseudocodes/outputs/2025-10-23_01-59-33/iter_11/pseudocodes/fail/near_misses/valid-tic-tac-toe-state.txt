CLASS Solution  
    FUNCTION validTicTacToe(board)  
        ASSIGN 0 TO alpha  
        SET idx TO 0  
        WHILE idx LESS THAN LENGTH(board)  
            SET gamma TO 0  
            WHILE gamma LESS THAN LENGTH(board[idx])  
                IF board[idx][gamma] EQUALS 'X'  
                    ADD 1 TO alpha  
                END IF  
                ADD 1 TO gamma  
            END WHILE  
            ADD 1 TO idx  
        END WHILE  

        ASSIGN 0 TO beta  
        SET iota TO 0  
        WHILE iota LESS THAN LENGTH(board)  
            ASSIGN 0 TO kappa  
            WHILE kappa LESS THAN LENGTH(board[iota])  
                IF board[iota][kappa] EQUALS 'O'  
                    ADD 1 TO beta  
                END IF  
                ADD 1 TO kappa  
            END WHILE  
            ADD 1 TO iota  
        END WHILE  

        IF NOT (beta LESS OR EQUAL alpha AND alpha LESS OR EQUAL beta PLUS 1)  
            YIELD False  
        END IF  

        FUNCTION check_win(player)  
            FOR EACH nu IN board  
                IF nu EQUALS [player, player, player]  
                    YIELD True  
                END IF  
            END FOR  

            SET zeta TO 0  
            REPEAT WHILE zeta LESS THAN 3  
                IF board[0][zeta] EQUALS player AND board[1][zeta] EQUALS player AND board[2][zeta] EQUALS player  
                    YIELD True  
                END IF  
                ADD 1 TO zeta  
            END REPEAT  

            IF (board[0][0] EQUALS player AND board[1][1] EQUALS player) AND board[2][2] EQUALS player  
                YIELD True  
            END IF  
            IF (board[0][2] EQUALS player AND board[1][1] EQUALS player) AND board[2][0] EQUALS player  
                YIELD True  
            END IF  
            YIELD False  
        END FUNCTION  

        ASSIGN check_win('X') TO iota  
        ASSIGN check_win('O') TO theta  

        IF iota AND theta  
            YIELD False  
        END IF  
        IF iota AND alpha EQUALS beta  
            YIELD False  
        END IF  
        IF theta AND alpha NOT EQUAL beta  
            YIELD False  
        END IF  

        YIELD True  
    END FUNCTION  
END CLASS